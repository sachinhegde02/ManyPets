[0m19:07:52.857075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002026E5C6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202704EAAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202704EA800>]}


============================== 19:07:52.866393 | ea90d2ae-44e2-47c1-bbf7-df0f9e0f1832 ==============================
[0m19:07:52.866393 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:07:52.871232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt init', 'send_anonymous_usage_stats': 'True'}
[0m19:07:52.941042 [info ] [MainThread]: Setting up your profile.
[0m19:11:23.709033 [info ] [MainThread]: Profile ManyPets written to C:\Users\HP\.dbt\profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m19:11:23.714723 [debug] [MainThread]: Command `dbt init` succeeded at 19:11:23.714026 after 211.07 seconds
[0m19:11:23.714723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002026E5C6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202704EA770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002027003A110>]}
[0m19:11:23.714723 [debug] [MainThread]: Flushing usage events
[0m19:11:24.530176 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:15:31.972027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E92016020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E93F3A860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E93F3A680>]}


============================== 19:15:31.976987 | 87f797d5-76f0-424c-9f8b-0d7adc727681 ==============================
[0m19:15:31.976987 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:15:31.980104 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:15:32.029311 [info ] [MainThread]: dbt version: 1.9.3
[0m19:15:32.030907 [info ] [MainThread]: python version: 3.10.0
[0m19:15:32.032485 [info ] [MainThread]: python path: C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\Scripts\python.exe
[0m19:15:32.033778 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m19:15:32.686407 [info ] [MainThread]: Using profiles dir at C:\Users\HP\.dbt
[0m19:15:32.693747 [info ] [MainThread]: Using profiles.yml file at C:\Users\HP\.dbt\profiles.yml
[0m19:15:32.694745 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\HP\Documents\manypets\ManyPets\dbt_project.yml
[0m19:15:32.697722 [info ] [MainThread]: adapter type: snowflake
[0m19:15:32.699330 [info ] [MainThread]: adapter version: 1.9.2
[0m19:15:32.898113 [info ] [MainThread]: Configuration:
[0m19:15:32.905702 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:15:32.906942 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:15:32.908462 [info ] [MainThread]: Required dependencies:
[0m19:15:32.910116 [debug] [MainThread]: Executing "git --help"
[0m19:15:32.932466 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m19:15:32.937245 [info ] [MainThread]: Connection:
[0m19:15:32.939554 [info ] [MainThread]:   account: PEFTNDK-EU85561
[0m19:15:32.942396 [info ] [MainThread]:   user: SACHINHEGDE
[0m19:15:32.943718 [info ] [MainThread]:   database: DEV
[0m19:15:32.945415 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m19:15:32.947136 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m19:15:32.949082 [info ] [MainThread]:   schema: RDL
[0m19:15:32.953079 [info ] [MainThread]:   authenticator: None
[0m19:15:32.955665 [info ] [MainThread]:   oauth_client_id: None
[0m19:15:32.957665 [info ] [MainThread]:   query_tag: None
[0m19:15:32.961086 [info ] [MainThread]:   client_session_keep_alive: False
[0m19:15:32.962714 [info ] [MainThread]:   host: None
[0m19:15:32.964714 [info ] [MainThread]:   port: None
[0m19:15:32.965717 [info ] [MainThread]:   proxy_host: None
[0m19:15:32.969719 [info ] [MainThread]:   proxy_port: None
[0m19:15:32.974349 [info ] [MainThread]:   protocol: None
[0m19:15:32.975790 [info ] [MainThread]:   connect_retries: 1
[0m19:15:32.977795 [info ] [MainThread]:   connect_timeout: None
[0m19:15:32.978898 [info ] [MainThread]:   retry_on_database_errors: False
[0m19:15:32.980435 [info ] [MainThread]:   retry_all: False
[0m19:15:32.981829 [info ] [MainThread]:   insecure_mode: False
[0m19:15:32.983686 [info ] [MainThread]:   reuse_connections: True
[0m19:15:32.990216 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:15:33.584449 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m19:15:39.317735 [debug] [MainThread]: Using snowflake connection "debug"
[0m19:15:39.317735 [debug] [MainThread]: On debug: select 1 as id
[0m19:15:39.317735 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:15:40.746786 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.422 seconds
[0m19:15:40.747784 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:15:40.755945 [info ] [MainThread]: [31m1 check failed:[0m
[0m19:15:40.759299 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m19:15:40.765298 [debug] [MainThread]: Command `dbt debug` failed at 19:15:40.765298 after 8.98 seconds
[0m19:15:40.765298 [debug] [MainThread]: Connection 'debug' was left open.
[0m19:15:40.765298 [debug] [MainThread]: On debug: Close
[0m19:15:40.905248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E92016020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E94E24C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E94E24430>]}
[0m19:15:40.905248 [debug] [MainThread]: Flushing usage events
[0m19:15:41.566061 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:27:35.375810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BFAED6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BFCDFAA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BFCDFA890>]}


============================== 20:27:35.385245 | 042aa845-fe0e-4eb7-b066-e1e05ac2c645 ==============================
[0m20:27:35.385245 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:27:35.387405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:27:35.452402 [info ] [MainThread]: dbt version: 1.9.3
[0m20:27:35.453463 [info ] [MainThread]: python version: 3.10.0
[0m20:27:35.454461 [info ] [MainThread]: python path: C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\Scripts\python.exe
[0m20:27:35.456464 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m20:27:36.361883 [info ] [MainThread]: Using profiles dir at C:\Users\HP\.dbt
[0m20:27:36.369987 [info ] [MainThread]: Using profiles.yml file at C:\Users\HP\.dbt\profiles.yml
[0m20:27:36.370866 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\HP\Documents\manypets\ManyPets\dbt_project.yml
[0m20:27:36.373673 [info ] [MainThread]: adapter type: snowflake
[0m20:27:36.375679 [info ] [MainThread]: adapter version: 1.9.2
[0m20:27:36.574419 [info ] [MainThread]: Configuration:
[0m20:27:36.583133 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:27:36.585080 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:27:36.586422 [info ] [MainThread]: Required dependencies:
[0m20:27:36.587710 [debug] [MainThread]: Executing "git --help"
[0m20:27:36.607408 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m20:27:36.615577 [info ] [MainThread]: Connection:
[0m20:27:36.617118 [info ] [MainThread]:   account: PEFTNDK-EU85561
[0m20:27:36.619481 [info ] [MainThread]:   user: SACHINHEGDE
[0m20:27:36.622135 [info ] [MainThread]:   database: DEV
[0m20:27:36.625617 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m20:27:36.627532 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m20:27:36.629625 [info ] [MainThread]:   schema: RDL
[0m20:27:36.631080 [info ] [MainThread]:   authenticator: None
[0m20:27:36.633509 [info ] [MainThread]:   oauth_client_id: None
[0m20:27:36.634670 [info ] [MainThread]:   query_tag: None
[0m20:27:36.637860 [info ] [MainThread]:   client_session_keep_alive: False
[0m20:27:36.640381 [info ] [MainThread]:   host: None
[0m20:27:36.642669 [info ] [MainThread]:   port: None
[0m20:27:36.644187 [info ] [MainThread]:   proxy_host: None
[0m20:27:36.645470 [info ] [MainThread]:   proxy_port: None
[0m20:27:36.646578 [info ] [MainThread]:   protocol: None
[0m20:27:36.647690 [info ] [MainThread]:   connect_retries: 1
[0m20:27:36.649055 [info ] [MainThread]:   connect_timeout: None
[0m20:27:36.650506 [info ] [MainThread]:   retry_on_database_errors: False
[0m20:27:36.653730 [info ] [MainThread]:   retry_all: False
[0m20:27:36.657083 [info ] [MainThread]:   insecure_mode: False
[0m20:27:36.659774 [info ] [MainThread]:   reuse_connections: True
[0m20:27:36.660775 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:27:37.239150 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m20:27:37.490879 [debug] [MainThread]: Using snowflake connection "debug"
[0m20:27:37.492391 [debug] [MainThread]: On debug: select 1 as id
[0m20:27:37.493394 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:27:38.377594 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.884 seconds
[0m20:27:38.381205 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:27:38.383292 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:27:38.385345 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m20:27:38.391148 [debug] [MainThread]: Command `dbt debug` failed at 20:27:38.391148 after 3.22 seconds
[0m20:27:38.393072 [debug] [MainThread]: Connection 'debug' was left open.
[0m20:27:38.394931 [debug] [MainThread]: On debug: Close
[0m20:27:38.510899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BFAED6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BFDF7C730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BFDF7C880>]}
[0m20:27:38.520759 [debug] [MainThread]: Flushing usage events
[0m20:27:39.155416 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:36:56.374930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232173D9FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232192EE890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232192EE6B0>]}


============================== 21:36:56.382746 | 462fb6f2-02e9-4231-9c40-d846e4ad70c6 ==============================
[0m21:36:56.382746 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:36:56.391028 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:36:56.656761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '462fb6f2-02e9-4231-9c40-d846e4ad70c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023215C505E0>]}
[0m21:36:56.715999 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:36:56.718577 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:36:56.721273 [debug] [MainThread]: Command `cli deps` succeeded at 21:36:56.721273 after 0.52 seconds
[0m21:36:56.722272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232173D9FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232193F15D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023219340730>]}
[0m21:36:56.722272 [debug] [MainThread]: Flushing usage events
[0m21:36:57.508935 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:37:22.192045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6BAA55FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6BC97A9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6BC97A800>]}


============================== 21:37:22.197364 | 5112ec3d-65be-4588-a37b-1ce547a3c1e2 ==============================
[0m21:37:22.197364 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:37:22.201151 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:37:22.248303 [info ] [MainThread]: dbt version: 1.9.3
[0m21:37:22.250325 [info ] [MainThread]: python version: 3.10.0
[0m21:37:22.251576 [info ] [MainThread]: python path: C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\Scripts\python.exe
[0m21:37:22.253658 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m21:37:22.751552 [info ] [MainThread]: Using profiles dir at C:\Users\HP\.dbt
[0m21:37:22.764044 [info ] [MainThread]: Using profiles.yml file at C:\Users\HP\.dbt\profiles.yml
[0m21:37:22.765295 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\HP\Documents\manypets\ManyPets\dbt_project.yml
[0m21:37:22.768275 [info ] [MainThread]: adapter type: snowflake
[0m21:37:22.769143 [info ] [MainThread]: adapter version: 1.9.2
[0m21:37:22.953061 [info ] [MainThread]: Configuration:
[0m21:37:22.968067 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:37:22.970133 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:37:22.971165 [info ] [MainThread]: Required dependencies:
[0m21:37:22.974183 [debug] [MainThread]: Executing "git --help"
[0m21:37:23.075180 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:37:23.076182 [debug] [MainThread]: STDERR: "b''"
[0m21:37:23.077194 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:37:23.078748 [info ] [MainThread]: Connection:
[0m21:37:23.080228 [info ] [MainThread]:   account: PEFTNDK-EU85561
[0m21:37:23.082235 [info ] [MainThread]:   user: SACHINHEGDE
[0m21:37:23.083236 [info ] [MainThread]:   database: DEV
[0m21:37:23.084470 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m21:37:23.086378 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m21:37:23.087615 [info ] [MainThread]:   schema: RDL
[0m21:37:23.090388 [info ] [MainThread]:   authenticator: None
[0m21:37:23.091785 [info ] [MainThread]:   oauth_client_id: None
[0m21:37:23.096087 [info ] [MainThread]:   query_tag: None
[0m21:37:23.097100 [info ] [MainThread]:   client_session_keep_alive: False
[0m21:37:23.098632 [info ] [MainThread]:   host: None
[0m21:37:23.100235 [info ] [MainThread]:   port: None
[0m21:37:23.101621 [info ] [MainThread]:   proxy_host: None
[0m21:37:23.103107 [info ] [MainThread]:   proxy_port: None
[0m21:37:23.105149 [info ] [MainThread]:   protocol: None
[0m21:37:23.109807 [info ] [MainThread]:   connect_retries: 1
[0m21:37:23.113210 [info ] [MainThread]:   connect_timeout: None
[0m21:37:23.114973 [info ] [MainThread]:   retry_on_database_errors: False
[0m21:37:23.116067 [info ] [MainThread]:   retry_all: False
[0m21:37:23.117384 [info ] [MainThread]:   insecure_mode: False
[0m21:37:23.118663 [info ] [MainThread]:   reuse_connections: True
[0m21:37:23.121777 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m21:37:23.665884 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m21:37:23.802612 [debug] [MainThread]: Using snowflake connection "debug"
[0m21:37:23.802612 [debug] [MainThread]: On debug: select 1 as id
[0m21:37:23.802612 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:37:24.714816 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.909 seconds
[0m21:37:24.714816 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:37:24.725056 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:37:24.730847 [debug] [MainThread]: Command `dbt debug` succeeded at 21:37:24.730847 after 2.67 seconds
[0m21:37:24.730847 [debug] [MainThread]: Connection 'debug' was left open.
[0m21:37:24.740504 [debug] [MainThread]: On debug: Close
[0m21:37:24.932753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6BAA55FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6BEBD06D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6BEBD07C0>]}
[0m21:37:24.932753 [debug] [MainThread]: Flushing usage events
[0m21:37:25.666820 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:17:51.103971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157C1B65FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157C3A8E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157C3A8E740>]}


============================== 22:17:51.115331 | 37fd957d-9fc9-48a3-be06-45b400f84cfc ==============================
[0m22:17:51.115331 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:17:51.118117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:17:52.141415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37fd957d-9fc9-48a3-be06-45b400f84cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157C1EA2800>]}
[0m22:17:52.269225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37fd957d-9fc9-48a3-be06-45b400f84cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157C43B4A60>]}
[0m22:17:52.269225 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:17:52.912923 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:17:53.360385 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:17:53.360385 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:17:53.479811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37fd957d-9fc9-48a3-be06-45b400f84cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157C58B8130>]}
[0m22:17:53.670913 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:17:53.753270 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:17:53.914411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37fd957d-9fc9-48a3-be06-45b400f84cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157C43B49D0>]}
[0m22:17:53.916679 [info ] [MainThread]: Found 3 models, 4 data tests, 474 macros
[0m22:17:53.919079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37fd957d-9fc9-48a3-be06-45b400f84cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157C43B4CD0>]}
[0m22:17:53.920083 [info ] [MainThread]: 
[0m22:17:53.927077 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:17:53.929881 [info ] [MainThread]: 
[0m22:17:53.932766 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:17:53.964845 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m22:17:54.157676 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m22:17:54.157676 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m22:17:54.157676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:55.367289 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.197 seconds
[0m22:17:55.382942 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_RDL'
[0m22:17:55.421625 [debug] [ThreadPool]: Using snowflake connection "list_DEV_RDL"
[0m22:17:55.437411 [debug] [ThreadPool]: On list_DEV_RDL: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_RDL"} */
show objects in DEV.RDL limit 10000;
[0m22:17:55.437411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:56.074602 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.637 seconds
[0m22:17:56.089639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37fd957d-9fc9-48a3-be06-45b400f84cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157C5F0DEA0>]}
[0m22:17:56.223943 [debug] [Thread-1 (]: Began running node model.ManyPets.my_first_dbt_model
[0m22:17:56.224928 [info ] [Thread-1 (]: 1 of 3 START sql table model RDL.my_first_dbt_model ............................ [RUN]
[0m22:17:56.230506 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.my_first_dbt_model'
[0m22:17:56.230506 [debug] [Thread-1 (]: Began compiling node model.ManyPets.my_first_dbt_model
[0m22:17:56.264192 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.my_first_dbt_model"
[0m22:17:56.273003 [debug] [Thread-1 (]: Began executing node model.ManyPets.my_first_dbt_model
[0m22:17:56.369495 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.my_first_dbt_model"
[0m22:17:56.378203 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.my_first_dbt_model"
[0m22:17:56.380208 [debug] [Thread-1 (]: On model.ManyPets.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.my_first_dbt_model"} */
create or replace transient table DEV.RDL.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m22:17:56.380208 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:17:57.815969 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.437 seconds
[0m22:17:57.922157 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37fd957d-9fc9-48a3-be06-45b400f84cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157C3A98370>]}
[0m22:17:57.922157 [info ] [Thread-1 (]: 1 of 3 OK created sql table model RDL.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 1.68s]
[0m22:17:57.925921 [debug] [Thread-1 (]: Finished running node model.ManyPets.my_first_dbt_model
[0m22:17:57.926946 [debug] [Thread-1 (]: Began running node model.ManyPets.order_complete
[0m22:17:57.929075 [info ] [Thread-1 (]: 2 of 3 START sql view model RDL.order_complete ................................. [RUN]
[0m22:17:57.931932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.my_first_dbt_model, now model.ManyPets.order_complete)
[0m22:17:57.932857 [debug] [Thread-1 (]: Began compiling node model.ManyPets.order_complete
[0m22:17:57.949512 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.order_complete"
[0m22:17:57.953356 [debug] [Thread-1 (]: Began executing node model.ManyPets.order_complete
[0m22:17:57.995770 [debug] [Thread-1 (]: Dropping relation "DEV"."RDL"."ORDER_COMPLETE" because it is of type table
[0m22:17:58.016462 [debug] [Thread-1 (]: Applying DROP to: "DEV"."RDL"."ORDER_COMPLETE"
[0m22:17:58.033489 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.order_complete"
[0m22:17:58.033489 [debug] [Thread-1 (]: On model.ManyPets.order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.order_complete"} */
drop table if exists "DEV"."RDL"."ORDER_COMPLETE" cascade
[0m22:17:58.226287 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.192 seconds
[0m22:17:58.298021 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.order_complete"
[0m22:17:58.307087 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.order_complete"
[0m22:17:58.307087 [debug] [Thread-1 (]: On model.ManyPets.order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.order_complete"} */
create or replace   view DEV.RDL.order_complete
  
   as (
    SELECT
        data:detail:customer:first_name::STRING AS first_name,
        data:detail:customer:last_name::STRING AS last_name,
        data:detail:customer:dob::DATE AS dob,
        data:detail:customer:email::STRING AS email,
        data:detail:customer:phone::STRING AS phone,
        data:detail:customer:address:line1::STRING AS address_line1,
        data:detail:customer:address:line2::STRING AS address_line2,
        data:detail:customer:address:city::STRING AS city,
        data:detail:customer:address:country::STRING AS country,
        data:detail:customer:address:postcode::STRING AS postcode
FROM dev.rdl.orders;
[0m22:17:58.515360 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0875-0000-e393-0000-0001b3cec025
[0m22:17:58.534372 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 15 at position 19 unexpected ';'.
[0m22:17:58.586083 [debug] [Thread-1 (]: Database Error in model order_complete (models\order_complete.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 19 unexpected ';'.
  compiled code at target\run\ManyPets\models\order_complete.sql
[0m22:17:58.586083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37fd957d-9fc9-48a3-be06-45b400f84cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157C609EE00>]}
[0m22:17:58.586083 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model RDL.order_complete ........................ [[31mERROR[0m in 0.66s]
[0m22:17:58.603722 [debug] [Thread-1 (]: Finished running node model.ManyPets.order_complete
[0m22:17:58.603722 [debug] [Thread-1 (]: Began running node model.ManyPets.my_second_dbt_model
[0m22:17:58.603722 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.order_complete' to be skipped because of status 'error'.  Reason: Database Error in model order_complete (models\order_complete.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 19 unexpected ';'.
  compiled code at target\run\ManyPets\models\order_complete.sql.
[0m22:17:58.612463 [info ] [Thread-1 (]: 3 of 3 START sql view model RDL.my_second_dbt_model ............................ [RUN]
[0m22:17:58.618311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.order_complete, now model.ManyPets.my_second_dbt_model)
[0m22:17:58.625446 [debug] [Thread-1 (]: Began compiling node model.ManyPets.my_second_dbt_model
[0m22:17:58.657892 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.my_second_dbt_model"
[0m22:17:58.664873 [debug] [Thread-1 (]: Began executing node model.ManyPets.my_second_dbt_model
[0m22:17:58.678201 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.my_second_dbt_model"
[0m22:17:58.684635 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.my_second_dbt_model"
[0m22:17:58.684635 [debug] [Thread-1 (]: On model.ManyPets.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.my_second_dbt_model"} */
create or replace   view DEV.RDL.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from DEV.RDL.my_first_dbt_model
where id = 1
  );
[0m22:17:58.952412 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.267 seconds
[0m22:17:58.963950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37fd957d-9fc9-48a3-be06-45b400f84cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157C619A560>]}
[0m22:17:58.963950 [info ] [Thread-1 (]: 3 of 3 OK created sql view model RDL.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.35s]
[0m22:17:58.978592 [debug] [Thread-1 (]: Finished running node model.ManyPets.my_second_dbt_model
[0m22:17:58.984258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:17:58.984258 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m22:17:58.984258 [debug] [MainThread]: On list_DEV: Close
[0m22:17:59.120045 [debug] [MainThread]: Connection 'list_DEV_RDL' was left open.
[0m22:17:59.120045 [debug] [MainThread]: On list_DEV_RDL: Close
[0m22:17:59.232261 [debug] [MainThread]: Connection 'model.ManyPets.my_second_dbt_model' was left open.
[0m22:17:59.232261 [debug] [MainThread]: On model.ManyPets.my_second_dbt_model: Close
[0m22:17:59.365501 [info ] [MainThread]: 
[0m22:17:59.378026 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 5.43 seconds (5.43s).
[0m22:17:59.390770 [debug] [MainThread]: Command end result
[0m22:17:59.541278 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:17:59.554041 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:17:59.579920 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m22:17:59.584297 [info ] [MainThread]: 
[0m22:17:59.588399 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:17:59.590364 [info ] [MainThread]: 
[0m22:17:59.594089 [error] [MainThread]:   Database Error in model order_complete (models\order_complete.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 19 unexpected ';'.
  compiled code at target\run\ManyPets\models\order_complete.sql
[0m22:17:59.596810 [info ] [MainThread]: 
[0m22:17:59.600681 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m22:17:59.606107 [debug] [MainThread]: Command `dbt run` failed at 22:17:59.605092 after 8.68 seconds
[0m22:17:59.613681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157C1B65FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157C1E63A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157C617E140>]}
[0m22:17:59.616070 [debug] [MainThread]: Flushing usage events
[0m22:18:00.295790 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:23:19.893833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B263496020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2653BEB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2653BE980>]}


============================== 22:23:19.910493 | 2a3430f8-f25d-4776-8cf4-ce93474607c4 ==============================
[0m22:23:19.910493 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:23:19.915256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:23:20.557291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a3430f8-f25d-4776-8cf4-ce93474607c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B26538CBE0>]}
[0m22:23:20.657561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a3430f8-f25d-4776-8cf4-ce93474607c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B265CE6BC0>]}
[0m22:23:20.657561 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:23:21.111837 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:23:21.397088 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:23:21.397088 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:23:21.481746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a3430f8-f25d-4776-8cf4-ce93474607c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2671E8130>]}
[0m22:23:21.612896 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:23:21.612896 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:23:21.713181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a3430f8-f25d-4776-8cf4-ce93474607c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B265CE73A0>]}
[0m22:23:21.713181 [info ] [MainThread]: Found 3 models, 4 data tests, 474 macros
[0m22:23:21.713181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a3430f8-f25d-4776-8cf4-ce93474607c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B25F0A9EA0>]}
[0m22:23:21.728806 [info ] [MainThread]: 
[0m22:23:21.728806 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:23:21.735131 [info ] [MainThread]: 
[0m22:23:21.737243 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:23:21.754393 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m22:23:21.882154 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m22:23:21.882154 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m22:23:21.882154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:23:22.900579 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.014 seconds
[0m22:23:22.915928 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_RDL'
[0m22:23:22.947160 [debug] [ThreadPool]: Using snowflake connection "list_DEV_RDL"
[0m22:23:22.947160 [debug] [ThreadPool]: On list_DEV_RDL: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_RDL"} */
show objects in DEV.RDL limit 10000;
[0m22:23:22.947160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:23:23.789173 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.846 seconds
[0m22:23:23.789173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a3430f8-f25d-4776-8cf4-ce93474607c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2677A1E70>]}
[0m22:23:23.804813 [debug] [Thread-1 (]: Began running node model.ManyPets.my_first_dbt_model
[0m22:23:23.804813 [info ] [Thread-1 (]: 1 of 3 START sql table model RDL.my_first_dbt_model ............................ [RUN]
[0m22:23:23.804813 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.my_first_dbt_model'
[0m22:23:23.804813 [debug] [Thread-1 (]: Began compiling node model.ManyPets.my_first_dbt_model
[0m22:23:23.829426 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.my_first_dbt_model"
[0m22:23:23.829426 [debug] [Thread-1 (]: Began executing node model.ManyPets.my_first_dbt_model
[0m22:23:23.889498 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.my_first_dbt_model"
[0m22:23:23.889498 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.my_first_dbt_model"
[0m22:23:23.889498 [debug] [Thread-1 (]: On model.ManyPets.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.my_first_dbt_model"} */
create or replace transient table DEV.RDL.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m22:23:23.889498 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:23:25.373298 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.483 seconds
[0m22:23:25.410817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3430f8-f25d-4776-8cf4-ce93474607c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B265CCF490>]}
[0m22:23:25.410817 [info ] [Thread-1 (]: 1 of 3 OK created sql table model RDL.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 1.61s]
[0m22:23:25.410817 [debug] [Thread-1 (]: Finished running node model.ManyPets.my_first_dbt_model
[0m22:23:25.410817 [debug] [Thread-1 (]: Began running node model.ManyPets.order_complete
[0m22:23:25.410817 [info ] [Thread-1 (]: 2 of 3 START sql view model RDL.order_complete ................................. [RUN]
[0m22:23:25.410817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.my_first_dbt_model, now model.ManyPets.order_complete)
[0m22:23:25.410817 [debug] [Thread-1 (]: Began compiling node model.ManyPets.order_complete
[0m22:23:25.410817 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.order_complete"
[0m22:23:25.426431 [debug] [Thread-1 (]: Began executing node model.ManyPets.order_complete
[0m22:23:25.467752 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.order_complete"
[0m22:23:25.467752 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.order_complete"
[0m22:23:25.467752 [debug] [Thread-1 (]: On model.ManyPets.order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.order_complete"} */
create or replace   view DEV.RDL.order_complete
  
   as (
    SELECT
        data:detail:customer:first_name::STRING AS first_name,
        data:detail:customer:last_name::STRING AS last_name,
        data:detail:customer:dob::DATE AS dob,
        data:detail:customer:email::STRING AS email,
        data:detail:customer:phone::STRING AS phone,
        data:detail:customer:address:line1::STRING AS address_line1,
        data:detail:customer:address:line2::STRING AS address_line2,
        data:detail:customer:address:city::STRING AS city,
        data:detail:customer:address:country::STRING AS country,
        data:detail:customer:address:postcode::STRING AS postcode
FROM dev.rdl.orders
  );
[0m22:23:25.766696 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.304 seconds
[0m22:23:25.781979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3430f8-f25d-4776-8cf4-ce93474607c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2678FEA70>]}
[0m22:23:25.781979 [info ] [Thread-1 (]: 2 of 3 OK created sql view model RDL.order_complete ............................ [[32mSUCCESS 1[0m in 0.37s]
[0m22:23:25.796505 [debug] [Thread-1 (]: Finished running node model.ManyPets.order_complete
[0m22:23:25.796505 [debug] [Thread-1 (]: Began running node model.ManyPets.my_second_dbt_model
[0m22:23:25.796505 [info ] [Thread-1 (]: 3 of 3 START sql view model RDL.my_second_dbt_model ............................ [RUN]
[0m22:23:25.796505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.order_complete, now model.ManyPets.my_second_dbt_model)
[0m22:23:25.802881 [debug] [Thread-1 (]: Began compiling node model.ManyPets.my_second_dbt_model
[0m22:23:25.807793 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.my_second_dbt_model"
[0m22:23:25.807793 [debug] [Thread-1 (]: Began executing node model.ManyPets.my_second_dbt_model
[0m22:23:25.820380 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.my_second_dbt_model"
[0m22:23:25.823396 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.my_second_dbt_model"
[0m22:23:25.823396 [debug] [Thread-1 (]: On model.ManyPets.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.my_second_dbt_model"} */
create or replace   view DEV.RDL.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from DEV.RDL.my_first_dbt_model
where id = 1
  );
[0m22:23:26.075362 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.258 seconds
[0m22:23:26.075362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3430f8-f25d-4776-8cf4-ce93474607c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B26798C190>]}
[0m22:23:26.075362 [info ] [Thread-1 (]: 3 of 3 OK created sql view model RDL.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.28s]
[0m22:23:26.075362 [debug] [Thread-1 (]: Finished running node model.ManyPets.my_second_dbt_model
[0m22:23:26.090726 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:23:26.090726 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m22:23:26.090726 [debug] [MainThread]: On list_DEV: Close
[0m22:23:26.183442 [debug] [MainThread]: Connection 'list_DEV_RDL' was left open.
[0m22:23:26.183442 [debug] [MainThread]: On list_DEV_RDL: Close
[0m22:23:26.298081 [debug] [MainThread]: Connection 'model.ManyPets.my_second_dbt_model' was left open.
[0m22:23:26.313735 [debug] [MainThread]: On model.ManyPets.my_second_dbt_model: Close
[0m22:23:26.414569 [info ] [MainThread]: 
[0m22:23:26.414569 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 4.68 seconds (4.68s).
[0m22:23:26.414569 [debug] [MainThread]: Command end result
[0m22:23:26.457945 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:23:26.469356 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:23:26.484758 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m22:23:26.484758 [info ] [MainThread]: 
[0m22:23:26.484758 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:23:26.484758 [info ] [MainThread]: 
[0m22:23:26.484758 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:23:26.484758 [debug] [MainThread]: Command `dbt run` succeeded at 22:23:26.484758 after 6.72 seconds
[0m22:23:26.484758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B263496020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2671C9D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B265CE78B0>]}
[0m22:23:26.484758 [debug] [MainThread]: Flushing usage events
[0m22:23:26.979264 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:48:01.072351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ECC686020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ECE5AA860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ECE5AA680>]}


============================== 22:48:01.079351 | f4417595-a4ff-411f-9532-5c2769596c50 ==============================
[0m22:48:01.079351 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:48:01.081347 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:48:01.130068 [info ] [MainThread]: dbt version: 1.9.3
[0m22:48:01.131052 [info ] [MainThread]: python version: 3.10.0
[0m22:48:01.134066 [info ] [MainThread]: python path: C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\Scripts\python.exe
[0m22:48:01.135310 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m22:48:01.704174 [info ] [MainThread]: Using profiles dir at C:\Users\HP\.dbt
[0m22:48:01.706173 [info ] [MainThread]: Using profiles.yml file at C:\Users\HP\.dbt\profiles.yml
[0m22:48:01.707175 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\HP\Documents\manypets\ManyPets\dbt_project.yml
[0m22:48:01.709184 [info ] [MainThread]: adapter type: snowflake
[0m22:48:01.710455 [info ] [MainThread]: adapter version: 1.9.2
[0m22:48:01.893182 [info ] [MainThread]: Configuration:
[0m22:48:01.893182 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:48:01.893182 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:48:01.893182 [info ] [MainThread]: Required dependencies:
[0m22:48:01.893182 [debug] [MainThread]: Executing "git --help"
[0m22:48:01.980793 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:48:01.981790 [debug] [MainThread]: STDERR: "b''"
[0m22:48:01.981790 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:48:01.983796 [info ] [MainThread]: Connection:
[0m22:48:01.984795 [info ] [MainThread]:   account: PEFTNDK-EU85561
[0m22:48:01.985797 [info ] [MainThread]:   user: SACHINHEGDE
[0m22:48:01.987796 [info ] [MainThread]:   database: DEV
[0m22:48:01.988791 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m22:48:01.990795 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m22:48:01.991790 [info ] [MainThread]:   schema: RDL
[0m22:48:01.992791 [info ] [MainThread]:   authenticator: None
[0m22:48:01.994794 [info ] [MainThread]:   oauth_client_id: None
[0m22:48:01.995792 [info ] [MainThread]:   query_tag: None
[0m22:48:01.996793 [info ] [MainThread]:   client_session_keep_alive: False
[0m22:48:01.998793 [info ] [MainThread]:   host: None
[0m22:48:01.999793 [info ] [MainThread]:   port: None
[0m22:48:02.000794 [info ] [MainThread]:   proxy_host: None
[0m22:48:02.001790 [info ] [MainThread]:   proxy_port: None
[0m22:48:02.002790 [info ] [MainThread]:   protocol: None
[0m22:48:02.004792 [info ] [MainThread]:   connect_retries: 1
[0m22:48:02.006796 [info ] [MainThread]:   connect_timeout: None
[0m22:48:02.008834 [info ] [MainThread]:   retry_on_database_errors: False
[0m22:48:02.010800 [info ] [MainThread]:   retry_all: False
[0m22:48:02.012793 [info ] [MainThread]:   insecure_mode: False
[0m22:48:02.013793 [info ] [MainThread]:   reuse_connections: True
[0m22:48:02.015793 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:48:02.532717 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m22:48:02.651063 [debug] [MainThread]: Using snowflake connection "debug"
[0m22:48:02.652062 [debug] [MainThread]: On debug: select 1 as id
[0m22:48:02.652062 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:48:03.466066 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.813 seconds
[0m22:48:03.468265 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:48:03.470139 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:48:03.473135 [debug] [MainThread]: Command `dbt debug` succeeded at 22:48:03.472136 after 2.56 seconds
[0m22:48:03.473135 [debug] [MainThread]: Connection 'debug' was left open.
[0m22:48:03.474135 [debug] [MainThread]: On debug: Close
[0m22:48:03.584613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ECC686020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ECF734730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ECF734880>]}
[0m22:48:03.585615 [debug] [MainThread]: Flushing usage events
[0m22:48:04.141274 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:48:10.160274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DB4D56080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DB6C7EA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DB6C7E830>]}


============================== 22:48:10.165413 | a25d330c-e04b-482c-a81d-4ce4e2979329 ==============================
[0m22:48:10.165413 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:48:10.167631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:48:10.828415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a25d330c-e04b-482c-a81d-4ce4e2979329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DB6C17CD0>]}
[0m22:48:10.922685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a25d330c-e04b-482c-a81d-4ce4e2979329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DB6B228F0>]}
[0m22:48:10.924707 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:48:11.410716 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:48:11.739784 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:48:11.740786 [debug] [MainThread]: Partial parsing: updated file: ManyPets://models\order_complete.sql
[0m22:48:12.095777 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ManyPets.order_complete' (models\order_complete.sql) depends on a source named 'manypets_src.ord' which was not found
[0m22:48:12.099004 [debug] [MainThread]: Command `dbt run` failed at 22:48:12.097997 after 2.07 seconds
[0m22:48:12.100007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DB4D56080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DB8AA3460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DB8AA3430>]}
[0m22:48:12.100007 [debug] [MainThread]: Flushing usage events
[0m22:48:12.568645 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:52:09.242565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E920ED5FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E922DFE8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E922DFE710>]}


============================== 22:52:09.258208 | fd54a3e8-aa23-4b07-856d-e5c75fb30122 ==============================
[0m22:52:09.258208 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:52:09.258208 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:52:09.888975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd54a3e8-aa23-4b07-856d-e5c75fb30122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E91F71F7C0>]}
[0m22:52:09.975167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd54a3e8-aa23-4b07-856d-e5c75fb30122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9236CF910>]}
[0m22:52:09.975167 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:52:10.452583 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:52:10.779275 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:52:10.779275 [debug] [MainThread]: Partial parsing: updated file: ManyPets://models\order_complete.sql
[0m22:52:11.195977 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ManyPets.order_complete' (models\order_complete.sql) depends on a source named 'manypets_src.ord' which was not found
[0m22:52:11.210553 [debug] [MainThread]: Command `dbt run` failed at 22:52:11.209542 after 2.08 seconds
[0m22:52:11.212744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E920ED5FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9228EE410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E924C233D0>]}
[0m22:52:11.214741 [debug] [MainThread]: Flushing usage events
[0m22:52:11.698232 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:54:09.148197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1232F6020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F125228550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1252284C0>]}


============================== 22:54:09.148197 | 1a2a55d2-ce0f-4dd7-8cfb-b11c94255d5c ==============================
[0m22:54:09.148197 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:54:09.148197 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt source freshness', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:54:09.846564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a2a55d2-ce0f-4dd7-8cfb-b11c94255d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F124D68C10>]}
[0m22:54:09.937773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a2a55d2-ce0f-4dd7-8cfb-b11c94255d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12508B250>]}
[0m22:54:09.937773 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:54:10.408523 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:54:10.739360 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m22:54:10.739360 [debug] [MainThread]: Partial parsing: added file: ManyPets://models\source\manypets_src.yml
[0m22:54:10.739360 [debug] [MainThread]: Partial parsing: updated file: ManyPets://models\order_complete.sql
[0m22:54:11.269601 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ManyPets.order_complete' (models\order_complete.sql) depends on a source named 'manypets_src.ord' which was not found
[0m22:54:11.269601 [debug] [MainThread]: Command `dbt source freshness` failed at 22:54:11.269601 after 2.26 seconds
[0m22:54:11.269601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1232F6020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F127029450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1270859F0>]}
[0m22:54:11.269601 [debug] [MainThread]: Flushing usage events
[0m22:54:11.787474 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:55:52.997888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594DDC6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594FCBA350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594FB5B9A0>]}


============================== 22:55:53.013526 | 28706878-df1a-4c8e-aeea-8fede8e8ef56 ==============================
[0m22:55:53.013526 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:55:53.013526 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt source freshness', 'send_anonymous_usage_stats': 'True'}
[0m22:55:53.632094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28706878-df1a-4c8e-aeea-8fede8e8ef56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002595064F460>]}
[0m22:55:53.733291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28706878-df1a-4c8e-aeea-8fede8e8ef56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594FB928C0>]}
[0m22:55:53.733291 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:55:54.184529 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:55:54.486643 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:55:54.494710 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:55:54.587590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28706878-df1a-4c8e-aeea-8fede8e8ef56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025951B253C0>]}
[0m22:55:54.810082 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:55:54.820217 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:55:54.874190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28706878-df1a-4c8e-aeea-8fede8e8ef56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025951A9BEB0>]}
[0m22:55:54.875197 [info ] [MainThread]: Found 3 models, 4 data tests, 2 sources, 474 macros
[0m22:55:54.877191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28706878-df1a-4c8e-aeea-8fede8e8ef56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025951A98DF0>]}
[0m22:55:54.878670 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:55:54.931002 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:55:54.931002 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:55:54.938513 [debug] [MainThread]: Wrote artifact FreshnessResult to C:\Users\HP\Documents\manypets\ManyPets\target\sources.json
[0m22:55:54.938513 [info ] [MainThread]: Done.
[0m22:55:54.945285 [debug] [MainThread]: Command `dbt source freshness` succeeded at 22:55:54.945285 after 2.07 seconds
[0m22:55:54.946282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594DDC6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594E10DB40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259505F7640>]}
[0m22:55:54.947299 [debug] [MainThread]: Flushing usage events
[0m22:55:55.441885 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:56:05.292875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB927F6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB9471E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB9471E7D0>]}


============================== 22:56:05.302892 | a40e1011-bc8a-4115-93e1-8c398916a3c6 ==============================
[0m22:56:05.302892 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:56:05.302892 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:56:06.151914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a40e1011-bc8a-4115-93e1-8c398916a3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB946E8970>]}
[0m22:56:06.267837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a40e1011-bc8a-4115-93e1-8c398916a3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB9502DC30>]}
[0m22:56:06.267837 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:56:06.784569 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:56:07.122784 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:56:07.122784 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:56:07.207411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a40e1011-bc8a-4115-93e1-8c398916a3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB96555240>]}
[0m22:56:07.423678 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:56:07.439302 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:56:07.470543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a40e1011-bc8a-4115-93e1-8c398916a3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB964CFDF0>]}
[0m22:56:07.470543 [info ] [MainThread]: Found 3 models, 4 data tests, 2 sources, 474 macros
[0m22:56:07.470543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a40e1011-bc8a-4115-93e1-8c398916a3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB964CEB90>]}
[0m22:56:07.470543 [info ] [MainThread]: 
[0m22:56:07.486172 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:56:07.488101 [info ] [MainThread]: 
[0m22:56:07.490103 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:56:07.584329 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m22:56:07.770929 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m22:56:07.770929 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m22:56:07.770929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:56:08.574223 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.796 seconds
[0m22:56:08.574223 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_RDL'
[0m22:56:08.589794 [debug] [ThreadPool]: Using snowflake connection "list_DEV_RDL"
[0m22:56:08.589794 [debug] [ThreadPool]: On list_DEV_RDL: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_RDL"} */
show objects in DEV.RDL limit 10000;
[0m22:56:08.589794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:56:09.061378 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.464 seconds
[0m22:56:09.076840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a40e1011-bc8a-4115-93e1-8c398916a3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB96ADA2F0>]}
[0m22:56:09.092439 [debug] [Thread-1 (]: Began running node model.ManyPets.my_first_dbt_model
[0m22:56:09.092439 [info ] [Thread-1 (]: 1 of 3 START sql table model RDL.my_first_dbt_model ............................ [RUN]
[0m22:56:09.092439 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.my_first_dbt_model'
[0m22:56:09.092439 [debug] [Thread-1 (]: Began compiling node model.ManyPets.my_first_dbt_model
[0m22:56:09.112338 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.my_first_dbt_model"
[0m22:56:09.116507 [debug] [Thread-1 (]: Began executing node model.ManyPets.my_first_dbt_model
[0m22:56:09.166120 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.my_first_dbt_model"
[0m22:56:09.166120 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.my_first_dbt_model"
[0m22:56:09.166120 [debug] [Thread-1 (]: On model.ManyPets.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.my_first_dbt_model"} */
create or replace transient table DEV.RDL.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m22:56:09.166120 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:56:10.920693 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.753 seconds
[0m22:56:10.951961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a40e1011-bc8a-4115-93e1-8c398916a3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB90E60310>]}
[0m22:56:10.967585 [info ] [Thread-1 (]: 1 of 3 OK created sql table model RDL.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 1.86s]
[0m22:56:10.967585 [debug] [Thread-1 (]: Finished running node model.ManyPets.my_first_dbt_model
[0m22:56:10.967585 [debug] [Thread-1 (]: Began running node model.ManyPets.order_complete
[0m22:56:10.967585 [info ] [Thread-1 (]: 2 of 3 START sql view model RDL.order_complete ................................. [RUN]
[0m22:56:10.967585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.my_first_dbt_model, now model.ManyPets.order_complete)
[0m22:56:10.967585 [debug] [Thread-1 (]: Began compiling node model.ManyPets.order_complete
[0m22:56:10.967585 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.order_complete"
[0m22:56:10.967585 [debug] [Thread-1 (]: Began executing node model.ManyPets.order_complete
[0m22:56:11.020953 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.order_complete"
[0m22:56:11.020953 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.order_complete"
[0m22:56:11.020953 [debug] [Thread-1 (]: On model.ManyPets.order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.order_complete"} */
create or replace   view DEV.RDL.order_complete
  
   as (
    SELECT
        data:detail:customer:first_name::STRING AS first_name,
        data:detail:customer:last_name::STRING AS last_name,
        data:detail:customer:dob::DATE AS dob,
        data:detail:customer:email::STRING AS email,
        data:detail:customer:phone::STRING AS phone,
        data:detail:customer:address:line1::STRING AS address_line1,
        data:detail:customer:address:line2::STRING AS address_line2,
        data:detail:customer:address:city::STRING AS city,
        data:detail:customer:address:country::STRING AS country,
        data:detail:customer:address:postcode::STRING AS postcode
FROM dev.rdl.orders
  );
[0m22:56:11.353564 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.341 seconds
[0m22:56:11.368808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a40e1011-bc8a-4115-93e1-8c398916a3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB96CF27A0>]}
[0m22:56:11.368808 [info ] [Thread-1 (]: 2 of 3 OK created sql view model RDL.order_complete ............................ [[32mSUCCESS 1[0m in 0.40s]
[0m22:56:11.384465 [debug] [Thread-1 (]: Finished running node model.ManyPets.order_complete
[0m22:56:11.384465 [debug] [Thread-1 (]: Began running node model.ManyPets.my_second_dbt_model
[0m22:56:11.384465 [info ] [Thread-1 (]: 3 of 3 START sql view model RDL.my_second_dbt_model ............................ [RUN]
[0m22:56:11.384465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.order_complete, now model.ManyPets.my_second_dbt_model)
[0m22:56:11.395066 [debug] [Thread-1 (]: Began compiling node model.ManyPets.my_second_dbt_model
[0m22:56:11.406603 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.my_second_dbt_model"
[0m22:56:11.408570 [debug] [Thread-1 (]: Began executing node model.ManyPets.my_second_dbt_model
[0m22:56:11.414147 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.my_second_dbt_model"
[0m22:56:11.414147 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.my_second_dbt_model"
[0m22:56:11.414147 [debug] [Thread-1 (]: On model.ManyPets.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.my_second_dbt_model"} */
create or replace   view DEV.RDL.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from DEV.RDL.my_first_dbt_model
where id = 1
  );
[0m22:56:11.685681 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.276 seconds
[0m22:56:11.700909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a40e1011-bc8a-4115-93e1-8c398916a3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB96D54280>]}
[0m22:56:11.700909 [info ] [Thread-1 (]: 3 of 3 OK created sql view model RDL.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.32s]
[0m22:56:11.700909 [debug] [Thread-1 (]: Finished running node model.ManyPets.my_second_dbt_model
[0m22:56:11.700909 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:56:11.700909 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m22:56:11.700909 [debug] [MainThread]: On list_DEV: Close
[0m22:56:11.796040 [debug] [MainThread]: Connection 'list_DEV_RDL' was left open.
[0m22:56:11.796040 [debug] [MainThread]: On list_DEV_RDL: Close
[0m22:56:11.894819 [debug] [MainThread]: Connection 'model.ManyPets.my_second_dbt_model' was left open.
[0m22:56:11.910083 [debug] [MainThread]: On model.ManyPets.my_second_dbt_model: Close
[0m22:56:12.023739 [info ] [MainThread]: 
[0m22:56:12.023739 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 4.53 seconds (4.53s).
[0m22:56:12.023739 [debug] [MainThread]: Command end result
[0m22:56:12.082771 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:56:12.082771 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:56:12.109506 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m22:56:12.110510 [info ] [MainThread]: 
[0m22:56:12.112891 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:56:12.114320 [info ] [MainThread]: 
[0m22:56:12.116338 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:56:12.118308 [debug] [MainThread]: Command `dbt run` succeeded at 22:56:12.118308 after 6.98 seconds
[0m22:56:12.119317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB927F6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB92AF2380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB96CF2770>]}
[0m22:56:12.119317 [debug] [MainThread]: Flushing usage events
[0m22:56:12.573002 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:08:32.544131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259CEBB6080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259D0ADEA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259D0ADE830>]}


============================== 11:08:32.549101 | 6f3e2ebf-64ff-400f-91ec-2d09b84a0f0a ==============================
[0m11:08:32.549101 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:08:32.553246 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:08:33.328061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f3e2ebf-64ff-400f-91ec-2d09b84a0f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259D0A73CD0>]}
[0m11:08:33.452834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f3e2ebf-64ff-400f-91ec-2d09b84a0f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259D09828F0>]}
[0m11:08:33.452834 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:08:34.257345 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:08:34.611111 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:08:34.611111 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:08:34.735505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f3e2ebf-64ff-400f-91ec-2d09b84a0f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259D29156F0>]}
[0m11:08:35.015016 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m11:08:35.070886 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m11:08:35.125974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f3e2ebf-64ff-400f-91ec-2d09b84a0f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259D18C30A0>]}
[0m11:08:35.127482 [info ] [MainThread]: Found 4 models, 4 data tests, 2 sources, 474 macros
[0m11:08:35.130827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f3e2ebf-64ff-400f-91ec-2d09b84a0f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259D1705AB0>]}
[0m11:08:35.134491 [info ] [MainThread]: 
[0m11:08:35.136075 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:08:35.138651 [info ] [MainThread]: 
[0m11:08:35.141227 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:08:35.168525 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m11:08:35.346658 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m11:08:35.347661 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m11:08:35.347661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:36.113582 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.766 seconds
[0m11:08:36.120657 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_RDL'
[0m11:08:36.141157 [debug] [ThreadPool]: Using snowflake connection "list_DEV_RDL"
[0m11:08:36.141157 [debug] [ThreadPool]: On list_DEV_RDL: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_RDL"} */
show objects in DEV.RDL limit 10000;
[0m11:08:36.141157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:36.841899 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.694 seconds
[0m11:08:36.841899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f3e2ebf-64ff-400f-91ec-2d09b84a0f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259D2E97670>]}
[0m11:08:36.874410 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m11:08:36.874410 [info ] [Thread-1 (]: 1 of 3 START sql view model RDL.dim_customers .................................. [RUN]
[0m11:08:36.879456 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.dim_customers'
[0m11:08:36.880455 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m11:08:36.910888 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m11:08:36.913510 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m11:08:36.963533 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_customers"
[0m11:08:36.977703 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m11:08:36.977703 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace   view DEV.RDL.dim_customers
  
   as (
    SELECT
        data:detail:customer:first_name::STRING AS first_name,
        data:detail:customer:last_name::STRING AS last_name,
        data:detail:customer:dob::DATE AS dob,
        data:detail:customer:email::STRING AS email,
        data:detail:customer:phone::STRING AS phone,
        data:detail:customer:address:line1::STRING AS address_line1,
        data:detail:customer:address:line2::STRING AS address_line2,
        data:detail:customer:address:city::STRING AS city,
        data:detail:customer:address:country::STRING AS country,
        data:detail:customer:address:postcode::STRING AS postcode
FROM dev.rdl.orders
  );
[0m11:08:36.977703 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:08:37.968589 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.989 seconds
[0m11:08:38.033752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f3e2ebf-64ff-400f-91ec-2d09b84a0f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259D293A710>]}
[0m11:08:38.033752 [info ] [Thread-1 (]: 1 of 3 OK created sql view model RDL.dim_customers ............................. [[32mSUCCESS 1[0m in 1.14s]
[0m11:08:38.036588 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m11:08:38.037929 [debug] [Thread-1 (]: Began running node model.ManyPets.my_first_dbt_model
[0m11:08:38.038927 [info ] [Thread-1 (]: 2 of 3 START sql table model RDL.my_first_dbt_model ............................ [RUN]
[0m11:08:38.040971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_customers, now model.ManyPets.my_first_dbt_model)
[0m11:08:38.042795 [debug] [Thread-1 (]: Began compiling node model.ManyPets.my_first_dbt_model
[0m11:08:38.054604 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.my_first_dbt_model"
[0m11:08:38.057883 [debug] [Thread-1 (]: Began executing node model.ManyPets.my_first_dbt_model
[0m11:08:38.105942 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.my_first_dbt_model"
[0m11:08:38.111136 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.my_first_dbt_model"
[0m11:08:38.111136 [debug] [Thread-1 (]: On model.ManyPets.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.my_first_dbt_model"} */
create or replace transient table DEV.RDL.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m11:08:39.706409 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.596 seconds
[0m11:08:39.723560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f3e2ebf-64ff-400f-91ec-2d09b84a0f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259D3037370>]}
[0m11:08:39.723560 [info ] [Thread-1 (]: 2 of 3 OK created sql table model RDL.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 1.68s]
[0m11:08:39.738043 [debug] [Thread-1 (]: Finished running node model.ManyPets.my_first_dbt_model
[0m11:08:39.741168 [debug] [Thread-1 (]: Began running node model.ManyPets.my_second_dbt_model
[0m11:08:39.742602 [info ] [Thread-1 (]: 3 of 3 START sql view model RDL.my_second_dbt_model ............................ [RUN]
[0m11:08:39.745395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.my_first_dbt_model, now model.ManyPets.my_second_dbt_model)
[0m11:08:39.746395 [debug] [Thread-1 (]: Began compiling node model.ManyPets.my_second_dbt_model
[0m11:08:39.746395 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.my_second_dbt_model"
[0m11:08:39.746395 [debug] [Thread-1 (]: Began executing node model.ManyPets.my_second_dbt_model
[0m11:08:39.769620 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.my_second_dbt_model"
[0m11:08:39.771975 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.my_second_dbt_model"
[0m11:08:39.771975 [debug] [Thread-1 (]: On model.ManyPets.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.my_second_dbt_model"} */
create or replace   view DEV.RDL.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from DEV.RDL.my_first_dbt_model
where id = 1
  );
[0m11:08:40.107376 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.340 seconds
[0m11:08:40.125540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f3e2ebf-64ff-400f-91ec-2d09b84a0f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259D3078760>]}
[0m11:08:40.125540 [info ] [Thread-1 (]: 3 of 3 OK created sql view model RDL.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.38s]
[0m11:08:40.142120 [debug] [Thread-1 (]: Finished running node model.ManyPets.my_second_dbt_model
[0m11:08:40.151847 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:08:40.155931 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m11:08:40.159588 [debug] [MainThread]: On list_DEV: Close
[0m11:08:40.256858 [debug] [MainThread]: Connection 'list_DEV_RDL' was left open.
[0m11:08:40.256858 [debug] [MainThread]: On list_DEV_RDL: Close
[0m11:08:40.388894 [debug] [MainThread]: Connection 'model.ManyPets.my_second_dbt_model' was left open.
[0m11:08:40.389894 [debug] [MainThread]: On model.ManyPets.my_second_dbt_model: Close
[0m11:08:40.499915 [info ] [MainThread]: 
[0m11:08:40.505596 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 5.36 seconds (5.36s).
[0m11:08:40.509885 [debug] [MainThread]: Command end result
[0m11:08:40.571644 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m11:08:40.577057 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m11:08:40.592133 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m11:08:40.593138 [info ] [MainThread]: 
[0m11:08:40.595776 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:08:40.597184 [info ] [MainThread]: 
[0m11:08:40.598378 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:08:40.602323 [debug] [MainThread]: Command `dbt run` succeeded at 11:08:40.601322 after 8.26 seconds
[0m11:08:40.603865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259CEBB6080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259CEEFEA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259D302B2E0>]}
[0m11:08:40.605313 [debug] [MainThread]: Flushing usage events
[0m11:08:41.455423 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:09:08.808728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013404946050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001340686E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001340686E7D0>]}


============================== 11:09:08.813905 | 4cc3b643-7102-4914-b517-0d944d1a12a5 ==============================
[0m11:09:08.813905 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:09:08.816728 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:09:09.534509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cc3b643-7102-4914-b517-0d944d1a12a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001340683C970>]}
[0m11:09:09.636718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4cc3b643-7102-4914-b517-0d944d1a12a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013407171E10>]}
[0m11:09:09.636718 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:09:10.148480 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:09:10.524785 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:09:10.524785 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:09:10.625977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4cc3b643-7102-4914-b517-0d944d1a12a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134086A56C0>]}
[0m11:09:10.895165 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m11:09:10.902198 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m11:09:10.939317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4cc3b643-7102-4914-b517-0d944d1a12a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001340861F910>]}
[0m11:09:10.942761 [info ] [MainThread]: Found 4 models, 4 data tests, 2 sources, 474 macros
[0m11:09:10.944802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cc3b643-7102-4914-b517-0d944d1a12a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001340861EDD0>]}
[0m11:09:10.945803 [info ] [MainThread]: 
[0m11:09:10.945803 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:09:10.952730 [info ] [MainThread]: 
[0m11:09:10.954343 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:09:10.983606 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m11:09:11.155272 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m11:09:11.155272 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m11:09:11.155272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:11.861030 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.709 seconds
[0m11:09:11.882747 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_RDL'
[0m11:09:11.901918 [debug] [ThreadPool]: Using snowflake connection "list_DEV_RDL"
[0m11:09:11.901918 [debug] [ThreadPool]: On list_DEV_RDL: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_RDL"} */
show objects in DEV.RDL limit 10000;
[0m11:09:11.901918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:12.547613 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.643 seconds
[0m11:09:12.574009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cc3b643-7102-4914-b517-0d944d1a12a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013408C27670>]}
[0m11:09:12.590558 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m11:09:12.590558 [info ] [Thread-1 (]: 1 of 3 START sql view model RDL.dim_customers .................................. [RUN]
[0m11:09:12.597333 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.dim_customers'
[0m11:09:12.598336 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m11:09:12.642076 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m11:09:12.642076 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m11:09:12.707675 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_customers"
[0m11:09:12.711643 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m11:09:12.711643 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace   view DEV.RDL.dim_customers
  
   as (
    with cust_src AS (
    SELECT
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        ingest_date
FROM dev.rdl.orders )
,dedup AS 
(
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY email ORDER BY ingest_date DESC) AS rnk
    FROM cust_src
)
SELECT
    ROW_NUMBER() OVER(ORDER BY email)                                                                   AS cusomer_sk,  
    email                                                                                               AS cusomer_nk,  
    COALESCE(NULLIF(TRIM(COALESCE(first_name,'') || ' ' || COALESCE(last_name,'')), ''),'unknown')      AS name,
    dob                                                                                                 AS dob,
    email                                                                                               AS email,
    COALESCE(NULLIF(phone,''),'unknown')                                                                AS phone,
    address_line1|| ' ' ||address_line2                                                                 AS address,
    city                                                                                                AS city,
    country                                                                                             AS country,
    postcode                                                                                            AS postcode
FROM
    dedup
WHERE 
    rnk =1
  );
[0m11:09:12.711643 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:09:13.523868 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.811 seconds
[0m11:09:13.567550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cc3b643-7102-4914-b517-0d944d1a12a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001340635C970>]}
[0m11:09:13.569545 [info ] [Thread-1 (]: 1 of 3 OK created sql view model RDL.dim_customers ............................. [[32mSUCCESS 1[0m in 0.96s]
[0m11:09:13.571570 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m11:09:13.572927 [debug] [Thread-1 (]: Began running node model.ManyPets.my_first_dbt_model
[0m11:09:13.573928 [info ] [Thread-1 (]: 2 of 3 START sql table model RDL.my_first_dbt_model ............................ [RUN]
[0m11:09:13.575776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_customers, now model.ManyPets.my_first_dbt_model)
[0m11:09:13.577790 [debug] [Thread-1 (]: Began compiling node model.ManyPets.my_first_dbt_model
[0m11:09:13.586276 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.my_first_dbt_model"
[0m11:09:13.589188 [debug] [Thread-1 (]: Began executing node model.ManyPets.my_first_dbt_model
[0m11:09:13.640359 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.my_first_dbt_model"
[0m11:09:13.646775 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.my_first_dbt_model"
[0m11:09:13.646775 [debug] [Thread-1 (]: On model.ManyPets.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.my_first_dbt_model"} */
create or replace transient table DEV.RDL.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m11:09:14.837872 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.191 seconds
[0m11:09:14.837872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cc3b643-7102-4914-b517-0d944d1a12a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013408E72020>]}
[0m11:09:14.837872 [info ] [Thread-1 (]: 2 of 3 OK created sql table model RDL.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 1.26s]
[0m11:09:14.853012 [debug] [Thread-1 (]: Finished running node model.ManyPets.my_first_dbt_model
[0m11:09:14.855935 [debug] [Thread-1 (]: Began running node model.ManyPets.my_second_dbt_model
[0m11:09:14.855935 [info ] [Thread-1 (]: 3 of 3 START sql view model RDL.my_second_dbt_model ............................ [RUN]
[0m11:09:14.860925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.my_first_dbt_model, now model.ManyPets.my_second_dbt_model)
[0m11:09:14.863556 [debug] [Thread-1 (]: Began compiling node model.ManyPets.my_second_dbt_model
[0m11:09:14.877343 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.my_second_dbt_model"
[0m11:09:14.881360 [debug] [Thread-1 (]: Began executing node model.ManyPets.my_second_dbt_model
[0m11:09:14.891364 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.my_second_dbt_model"
[0m11:09:14.895683 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.my_second_dbt_model"
[0m11:09:14.895683 [debug] [Thread-1 (]: On model.ManyPets.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.my_second_dbt_model"} */
create or replace   view DEV.RDL.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from DEV.RDL.my_first_dbt_model
where id = 1
  );
[0m11:09:15.094658 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.211 seconds
[0m11:09:15.110324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cc3b643-7102-4914-b517-0d944d1a12a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013408DE1B70>]}
[0m11:09:15.110324 [info ] [Thread-1 (]: 3 of 3 OK created sql view model RDL.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.25s]
[0m11:09:15.125948 [debug] [Thread-1 (]: Finished running node model.ManyPets.my_second_dbt_model
[0m11:09:15.129013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:09:15.130011 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m11:09:15.130011 [debug] [MainThread]: On list_DEV: Close
[0m11:09:15.238158 [debug] [MainThread]: Connection 'list_DEV_RDL' was left open.
[0m11:09:15.238158 [debug] [MainThread]: On list_DEV_RDL: Close
[0m11:09:15.348360 [debug] [MainThread]: Connection 'model.ManyPets.my_second_dbt_model' was left open.
[0m11:09:15.348360 [debug] [MainThread]: On model.ManyPets.my_second_dbt_model: Close
[0m11:09:15.468159 [info ] [MainThread]: 
[0m11:09:15.476115 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 4.51 seconds (4.51s).
[0m11:09:15.480303 [debug] [MainThread]: Command end result
[0m11:09:15.566128 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m11:09:15.571635 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m11:09:15.589554 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m11:09:15.590556 [info ] [MainThread]: 
[0m11:09:15.593327 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:09:15.594272 [info ] [MainThread]: 
[0m11:09:15.596186 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:09:15.601260 [debug] [MainThread]: Command `dbt run` succeeded at 11:09:15.599464 after 6.95 seconds
[0m11:09:15.604601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013404946050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134086B76A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134086B7130>]}
[0m11:09:15.607697 [debug] [MainThread]: Flushing usage events
[0m11:09:16.098269 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:34:00.988797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F2D836080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F2F75EA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F2F75E830>]}


============================== 11:34:00.993848 | 9db6b850-fe83-4ff2-80e8-8337cae7ec52 ==============================
[0m11:34:00.993848 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:34:00.995990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:34:01.693068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9db6b850-fe83-4ff2-80e8-8337cae7ec52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F2F6F7CD0>]}
[0m11:34:01.793352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9db6b850-fe83-4ff2-80e8-8337cae7ec52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F2F6028F0>]}
[0m11:34:01.802042 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:34:02.317674 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:34:02.654473 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:34:02.656535 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:34:02.747765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9db6b850-fe83-4ff2-80e8-8337cae7ec52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F31595750>]}
[0m11:34:03.017492 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m11:34:03.024385 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m11:34:03.062270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9db6b850-fe83-4ff2-80e8-8337cae7ec52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F3150FD30>]}
[0m11:34:03.064949 [info ] [MainThread]: Found 4 models, 4 data tests, 2 sources, 474 macros
[0m11:34:03.067037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9db6b850-fe83-4ff2-80e8-8337cae7ec52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F3150EB30>]}
[0m11:34:03.067037 [info ] [MainThread]: 
[0m11:34:03.067037 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:34:03.074513 [info ] [MainThread]: 
[0m11:34:03.078046 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:34:03.098992 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m11:34:03.326116 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m11:34:03.326116 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m11:34:03.326116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:34:04.407128 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.071 seconds
[0m11:34:04.424203 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_RDL'
[0m11:34:04.460378 [debug] [ThreadPool]: Using snowflake connection "list_DEV_RDL"
[0m11:34:04.461377 [debug] [ThreadPool]: On list_DEV_RDL: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_RDL"} */
show objects in DEV.RDL limit 10000;
[0m11:34:04.461377 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:34:05.084945 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.633 seconds
[0m11:34:05.095964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9db6b850-fe83-4ff2-80e8-8337cae7ec52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F31B175E0>]}
[0m11:34:05.128845 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m11:34:05.128845 [info ] [Thread-1 (]: 1 of 4 START sql view model RDL.dim_customers .................................. [RUN]
[0m11:34:05.136267 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.dim_customers'
[0m11:34:05.137271 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m11:34:05.174394 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m11:34:05.174394 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m11:34:05.222053 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_customers"
[0m11:34:05.229662 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m11:34:05.229662 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace   view DEV.RDL.dim_customers
  
   as (
    with cust_src AS (
    SELECT
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        ingest_date
FROM dev.rdl.orders )
,dedup AS 
(
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY email ORDER BY ingest_date DESC) AS rnk
    FROM cust_src
)
SELECT
    ROW_NUMBER() OVER(ORDER BY email)                                                                   AS cusomer_sk,  
    email                                                                                               AS cusomer_nk,  
    COALESCE(NULLIF(TRIM(COALESCE(first_name,'') || ' ' || COALESCE(last_name,'')), ''),'unknown')      AS name,
    dob                                                                                                 AS dob,
    email                                                                                               AS email,
    COALESCE(NULLIF(phone,''),'unknown')                                                                AS phone,
    address_line1|| ' ' ||address_line2                                                                 AS address,
    city                                                                                                AS city,
    country                                                                                             AS country,
    postcode                                                                                            AS postcode
FROM
    dedup
WHERE 
    rnk =1
  );
[0m11:34:05.229662 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:34:06.347183 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.122 seconds
[0m11:34:06.415890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9db6b850-fe83-4ff2-80e8-8337cae7ec52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F2F2AB8E0>]}
[0m11:34:06.416923 [info ] [Thread-1 (]: 1 of 4 OK created sql view model RDL.dim_customers ............................. [[32mSUCCESS 1[0m in 1.27s]
[0m11:34:06.419826 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m11:34:06.419826 [debug] [Thread-1 (]: Began running node model.ManyPets.my_first_dbt_model
[0m11:34:06.421691 [info ] [Thread-1 (]: 2 of 4 START sql table model RDL.my_first_dbt_model ............................ [RUN]
[0m11:34:06.422696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_customers, now model.ManyPets.my_first_dbt_model)
[0m11:34:06.422696 [debug] [Thread-1 (]: Began compiling node model.ManyPets.my_first_dbt_model
[0m11:34:06.422696 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.my_first_dbt_model"
[0m11:34:06.422696 [debug] [Thread-1 (]: Began executing node model.ManyPets.my_first_dbt_model
[0m11:34:06.489743 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.my_first_dbt_model"
[0m11:34:06.501359 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.my_first_dbt_model"
[0m11:34:06.502370 [debug] [Thread-1 (]: On model.ManyPets.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.my_first_dbt_model"} */
create or replace transient table DEV.RDL.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m11:34:07.889251 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.388 seconds
[0m11:34:07.889251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9db6b850-fe83-4ff2-80e8-8337cae7ec52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F31D8E020>]}
[0m11:34:07.906648 [info ] [Thread-1 (]: 2 of 4 OK created sql table model RDL.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 1.47s]
[0m11:34:07.912513 [debug] [Thread-1 (]: Finished running node model.ManyPets.my_first_dbt_model
[0m11:34:07.912513 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_pets
[0m11:34:07.918364 [info ] [Thread-1 (]: 3 of 4 START sql view model RDL.dim_pets ....................................... [RUN]
[0m11:34:07.923896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.my_first_dbt_model, now model.ManyPets.dim_pets)
[0m11:34:07.928046 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_pets
[0m11:34:07.954704 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_pets"
[0m11:34:07.956844 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_pets
[0m11:34:07.961112 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_pets"
[0m11:34:07.972880 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m11:34:07.975682 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
create or replace   view DEV.RDL.dim_pets
  
   as (
    WITH cust_src AS (
    SELECT
        data:detail:customer:email::STRING AS email,
        data:detail:pets                   AS pets_array,
        ingest_date
    FROM dev.rdl.orders
),
flattened_pets AS (
    SELECT 
        d.email,
        pet.value:name::STRING              AS pet_name,
        pet.value:breed_value::STRING       AS breed,
        pet.value:dob::DATE                 AS pet_dob,
        pet.value:gender::STRING            AS pet_gender,
        pet.value:species::STRING           AS pet_species,
        pet.value:pedigree_type::STRING     AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN  AS spayed_neutered,
        pet.value:postcode::STRING          AS pet_postcode,
        d.ingest_date
    FROM cust_src d,
    LATERAL FLATTEN(input => d.pets_array) AS pet
),
dedup AS (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY email, pet_dob, pet_name ORDER BY ingest_date DESC) AS rnk
    FROM flattened_pets
)
SELECT
    ROW_NUMBER() OVER(ORDER BY d.email, d.pet_dob, d.pet_name)                                      AS pet_sk,  
    d.email || '-' || COALESCE(d.pet_name, 'unknown') || '-' || COALESCE(d.pet_dob, '1900-01-01')   AS pet_nk,
    c.cusomer_sk                                                                                    AS cusomer_sk,
    d.pet_name                                                                                AS pet_name,
    d.breed                                                                                   AS breed,
    d.pet_dob                                                                                 AS pet_dob,
    d.pet_gender                                                                              AS pet_gender,
    d.pet_species                                                                             AS pet_species,
    d.pedigree_type                                                                           AS pedigree_type,
    d.spayed_neutered                                                                         AS spayed_neutered,
    d.pet_postcode                                                                            AS pet_postcode
FROM 
    dedup AS d
    INNER JOIN DEV.RDL.dim_customers AS c ON (d.email=c.cusomer_nk)
WHERE
    rnk = 1;
[0m11:34:08.360353 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0b91-0000-e3bf-0001-b3ce00019056
[0m11:34:08.360353 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 48 at position 11 unexpected ';'.
[0m11:34:08.368803 [debug] [Thread-1 (]: Database Error in model dim_pets (models\dim_pets.sql)
  001003 (42000): SQL compilation error:
  syntax error line 48 at position 11 unexpected ';'.
  compiled code at target\run\ManyPets\models\dim_pets.sql
[0m11:34:08.370489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9db6b850-fe83-4ff2-80e8-8337cae7ec52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F31D003D0>]}
[0m11:34:08.372719 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model RDL.dim_pets .............................. [[31mERROR[0m in 0.45s]
[0m11:34:08.375318 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_pets
[0m11:34:08.377559 [debug] [Thread-1 (]: Began running node model.ManyPets.my_second_dbt_model
[0m11:34:08.378556 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.dim_pets' to be skipped because of status 'error'.  Reason: Database Error in model dim_pets (models\dim_pets.sql)
  001003 (42000): SQL compilation error:
  syntax error line 48 at position 11 unexpected ';'.
  compiled code at target\run\ManyPets\models\dim_pets.sql.
[0m11:34:08.380349 [info ] [Thread-1 (]: 4 of 4 START sql view model RDL.my_second_dbt_model ............................ [RUN]
[0m11:34:08.382668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_pets, now model.ManyPets.my_second_dbt_model)
[0m11:34:08.388692 [debug] [Thread-1 (]: Began compiling node model.ManyPets.my_second_dbt_model
[0m11:34:08.399653 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.my_second_dbt_model"
[0m11:34:08.399653 [debug] [Thread-1 (]: Began executing node model.ManyPets.my_second_dbt_model
[0m11:34:08.425209 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.my_second_dbt_model"
[0m11:34:08.428657 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.my_second_dbt_model"
[0m11:34:08.429648 [debug] [Thread-1 (]: On model.ManyPets.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.my_second_dbt_model"} */
create or replace   view DEV.RDL.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from DEV.RDL.my_first_dbt_model
where id = 1
  );
[0m11:34:08.708601 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.280 seconds
[0m11:34:08.717687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9db6b850-fe83-4ff2-80e8-8337cae7ec52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F31D1EBF0>]}
[0m11:34:08.725815 [info ] [Thread-1 (]: 4 of 4 OK created sql view model RDL.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.34s]
[0m11:34:08.734344 [debug] [Thread-1 (]: Finished running node model.ManyPets.my_second_dbt_model
[0m11:34:08.738371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:34:08.738371 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m11:34:08.738371 [debug] [MainThread]: On list_DEV: Close
[0m11:34:08.867767 [debug] [MainThread]: Connection 'list_DEV_RDL' was left open.
[0m11:34:08.883795 [debug] [MainThread]: On list_DEV_RDL: Close
[0m11:34:09.007947 [debug] [MainThread]: Connection 'model.ManyPets.my_second_dbt_model' was left open.
[0m11:34:09.007947 [debug] [MainThread]: On model.ManyPets.my_second_dbt_model: Close
[0m11:34:09.108475 [info ] [MainThread]: 
[0m11:34:09.122188 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 6.03 seconds (6.03s).
[0m11:34:09.126165 [debug] [MainThread]: Command end result
[0m11:34:09.206427 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m11:34:09.210678 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m11:34:09.226672 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m11:34:09.227678 [info ] [MainThread]: 
[0m11:34:09.230529 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:34:09.231994 [info ] [MainThread]: 
[0m11:34:09.233208 [error] [MainThread]:   Database Error in model dim_pets (models\dim_pets.sql)
  001003 (42000): SQL compilation error:
  syntax error line 48 at position 11 unexpected ';'.
  compiled code at target\run\ManyPets\models\dim_pets.sql
[0m11:34:09.235616 [info ] [MainThread]: 
[0m11:34:09.237247 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m11:34:09.239875 [debug] [MainThread]: Command `dbt run` failed at 11:34:09.239875 after 8.40 seconds
[0m11:34:09.241257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F2D836080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F315B8B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F315B90F0>]}
[0m11:34:09.242435 [debug] [MainThread]: Flushing usage events
[0m11:34:10.026142 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:34:31.347865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACCD85FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACECAE920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACECAE740>]}


============================== 11:34:31.350862 | 75a9e667-b5c8-4f8e-aa81-dbe1b3ecefff ==============================
[0m11:34:31.350862 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:34:31.356779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:34:32.071067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75a9e667-b5c8-4f8e-aa81-dbe1b3ecefff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACD0C2800>]}
[0m11:34:32.195851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75a9e667-b5c8-4f8e-aa81-dbe1b3ecefff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACF5D0A60>]}
[0m11:34:32.195851 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:34:32.679368 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:34:33.028895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:34:33.030233 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:34:33.122299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75a9e667-b5c8-4f8e-aa81-dbe1b3ecefff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD0AE56C0>]}
[0m11:34:33.406405 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m11:34:33.413345 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m11:34:33.450120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75a9e667-b5c8-4f8e-aa81-dbe1b3ecefff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACFA93AC0>]}
[0m11:34:33.452060 [info ] [MainThread]: Found 4 models, 4 data tests, 2 sources, 474 macros
[0m11:34:33.453641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75a9e667-b5c8-4f8e-aa81-dbe1b3ecefff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACFA92A70>]}
[0m11:34:33.454657 [info ] [MainThread]: 
[0m11:34:33.458838 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:34:33.465967 [info ] [MainThread]: 
[0m11:34:33.470139 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:34:33.499898 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m11:34:33.703857 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m11:34:33.703857 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m11:34:33.703857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:34:34.395810 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.692 seconds
[0m11:34:34.410951 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_RDL'
[0m11:34:34.432279 [debug] [ThreadPool]: Using snowflake connection "list_DEV_RDL"
[0m11:34:34.433279 [debug] [ThreadPool]: On list_DEV_RDL: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_RDL"} */
show objects in DEV.RDL limit 10000;
[0m11:34:34.434281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:34:35.058444 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.624 seconds
[0m11:34:35.059430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75a9e667-b5c8-4f8e-aa81-dbe1b3ecefff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD1067670>]}
[0m11:34:35.080851 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m11:34:35.080851 [info ] [Thread-1 (]: 1 of 4 START sql view model RDL.dim_customers .................................. [RUN]
[0m11:34:35.087644 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.dim_customers'
[0m11:34:35.088642 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m11:34:35.120542 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m11:34:35.120542 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m11:34:35.184486 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_customers"
[0m11:34:35.190961 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m11:34:35.190961 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace   view DEV.RDL.dim_customers
  
   as (
    with cust_src AS (
    SELECT
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        ingest_date
FROM dev.rdl.orders )
,dedup AS 
(
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY email ORDER BY ingest_date DESC) AS rnk
    FROM cust_src
)
SELECT
    ROW_NUMBER() OVER(ORDER BY email)                                                                   AS cusomer_sk,  
    email                                                                                               AS cusomer_nk,  
    COALESCE(NULLIF(TRIM(COALESCE(first_name,'') || ' ' || COALESCE(last_name,'')), ''),'unknown')      AS name,
    dob                                                                                                 AS dob,
    email                                                                                               AS email,
    COALESCE(NULLIF(phone,''),'unknown')                                                                AS phone,
    address_line1|| ' ' ||address_line2                                                                 AS address,
    city                                                                                                AS city,
    country                                                                                             AS country,
    postcode                                                                                            AS postcode
FROM
    dedup
WHERE 
    rnk =1
  );
[0m11:34:35.190961 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:34:35.946781 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.754 seconds
[0m11:34:36.035450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a9e667-b5c8-4f8e-aa81-dbe1b3ecefff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD0B0A1A0>]}
[0m11:34:36.036454 [info ] [Thread-1 (]: 1 of 4 OK created sql view model RDL.dim_customers ............................. [[32mSUCCESS 1[0m in 0.94s]
[0m11:34:36.039011 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m11:34:36.040078 [debug] [Thread-1 (]: Began running node model.ManyPets.my_first_dbt_model
[0m11:34:36.041652 [info ] [Thread-1 (]: 2 of 4 START sql table model RDL.my_first_dbt_model ............................ [RUN]
[0m11:34:36.044137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_customers, now model.ManyPets.my_first_dbt_model)
[0m11:34:36.045935 [debug] [Thread-1 (]: Began compiling node model.ManyPets.my_first_dbt_model
[0m11:34:36.051410 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.my_first_dbt_model"
[0m11:34:36.051410 [debug] [Thread-1 (]: Began executing node model.ManyPets.my_first_dbt_model
[0m11:34:36.095971 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.my_first_dbt_model"
[0m11:34:36.106884 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.my_first_dbt_model"
[0m11:34:36.107892 [debug] [Thread-1 (]: On model.ManyPets.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.my_first_dbt_model"} */
create or replace transient table DEV.RDL.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m11:34:37.062200 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.965 seconds
[0m11:34:37.079174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a9e667-b5c8-4f8e-aa81-dbe1b3ecefff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD1332020>]}
[0m11:34:37.079174 [info ] [Thread-1 (]: 2 of 4 OK created sql table model RDL.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 1.04s]
[0m11:34:37.094410 [debug] [Thread-1 (]: Finished running node model.ManyPets.my_first_dbt_model
[0m11:34:37.094410 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_pets
[0m11:34:37.100297 [info ] [Thread-1 (]: 3 of 4 START sql view model RDL.dim_pets ....................................... [RUN]
[0m11:34:37.104752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.my_first_dbt_model, now model.ManyPets.dim_pets)
[0m11:34:37.108465 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_pets
[0m11:34:37.117534 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_pets"
[0m11:34:37.120184 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_pets
[0m11:34:37.123186 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_pets"
[0m11:34:37.143317 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m11:34:37.143317 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
create or replace   view DEV.RDL.dim_pets
  
   as (
    WITH cust_src AS (
    SELECT
        data:detail:customer:email::STRING AS email,
        data:detail:pets                   AS pets_array,
        ingest_date
    FROM dev.rdl.orders
),
flattened_pets AS (
    SELECT 
        d.email,
        pet.value:name::STRING              AS pet_name,
        pet.value:breed_value::STRING       AS breed,
        pet.value:dob::DATE                 AS pet_dob,
        pet.value:gender::STRING            AS pet_gender,
        pet.value:species::STRING           AS pet_species,
        pet.value:pedigree_type::STRING     AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN  AS spayed_neutered,
        pet.value:postcode::STRING          AS pet_postcode,
        d.ingest_date
    FROM cust_src d,
    LATERAL FLATTEN(input => d.pets_array) AS pet
),
dedup AS (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY email, pet_dob, pet_name ORDER BY ingest_date DESC) AS rnk
    FROM flattened_pets
)
SELECT
    ROW_NUMBER() OVER(ORDER BY d.email, d.pet_dob, d.pet_name)                                      AS pet_sk,  
    d.email || '-' || COALESCE(d.pet_name, 'unknown') || '-' || COALESCE(d.pet_dob, '1900-01-01')   AS pet_nk,
    c.cusomer_sk                                                                                    AS cusomer_sk,
    d.pet_name                                                                                AS pet_name,
    d.breed                                                                                   AS breed,
    d.pet_dob                                                                                 AS pet_dob,
    d.pet_gender                                                                              AS pet_gender,
    d.pet_species                                                                             AS pet_species,
    d.pedigree_type                                                                           AS pedigree_type,
    d.spayed_neutered                                                                         AS spayed_neutered,
    d.pet_postcode                                                                            AS pet_postcode
FROM 
    dedup AS d
    INNER JOIN DEV.RDL.dim_customers AS c ON (d.email=c.cusomer_nk)
WHERE
    rnk = 1
  );
[0m11:34:37.481429 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.335 seconds
[0m11:34:37.490281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a9e667-b5c8-4f8e-aa81-dbe1b3ecefff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD12A1750>]}
[0m11:34:37.506359 [info ] [Thread-1 (]: 3 of 4 OK created sql view model RDL.dim_pets .................................. [[32mSUCCESS 1[0m in 0.39s]
[0m11:34:37.509704 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_pets
[0m11:34:37.509704 [debug] [Thread-1 (]: Began running node model.ManyPets.my_second_dbt_model
[0m11:34:37.513232 [info ] [Thread-1 (]: 4 of 4 START sql view model RDL.my_second_dbt_model ............................ [RUN]
[0m11:34:37.515840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_pets, now model.ManyPets.my_second_dbt_model)
[0m11:34:37.518228 [debug] [Thread-1 (]: Began compiling node model.ManyPets.my_second_dbt_model
[0m11:34:37.526654 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.my_second_dbt_model"
[0m11:34:37.526654 [debug] [Thread-1 (]: Began executing node model.ManyPets.my_second_dbt_model
[0m11:34:37.532243 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.my_second_dbt_model"
[0m11:34:37.539142 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.my_second_dbt_model"
[0m11:34:37.541082 [debug] [Thread-1 (]: On model.ManyPets.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.my_second_dbt_model"} */
create or replace   view DEV.RDL.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from DEV.RDL.my_first_dbt_model
where id = 1
  );
[0m11:34:37.781387 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.249 seconds
[0m11:34:37.798510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a9e667-b5c8-4f8e-aa81-dbe1b3ecefff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD12BEFB0>]}
[0m11:34:37.798510 [info ] [Thread-1 (]: 4 of 4 OK created sql view model RDL.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.28s]
[0m11:34:37.813848 [debug] [Thread-1 (]: Finished running node model.ManyPets.my_second_dbt_model
[0m11:34:37.820075 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:34:37.820075 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m11:34:37.820075 [debug] [MainThread]: On list_DEV: Close
[0m11:34:37.927187 [debug] [MainThread]: Connection 'list_DEV_RDL' was left open.
[0m11:34:37.927187 [debug] [MainThread]: On list_DEV_RDL: Close
[0m11:34:38.040870 [debug] [MainThread]: Connection 'model.ManyPets.my_second_dbt_model' was left open.
[0m11:34:38.040870 [debug] [MainThread]: On model.ManyPets.my_second_dbt_model: Close
[0m11:34:38.154847 [info ] [MainThread]: 
[0m11:34:38.162905 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 4.69 seconds (4.69s).
[0m11:34:38.168564 [debug] [MainThread]: Command end result
[0m11:34:38.239711 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m11:34:38.247792 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m11:34:38.260805 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m11:34:38.262807 [info ] [MainThread]: 
[0m11:34:38.263590 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:34:38.265347 [info ] [MainThread]: 
[0m11:34:38.266714 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m11:34:38.269635 [debug] [MainThread]: Command `dbt run` succeeded at 11:34:38.269635 after 7.08 seconds
[0m11:34:38.271447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACCD85FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD0AF74F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AD0AF6260>]}
[0m11:34:38.273580 [debug] [MainThread]: Flushing usage events
[0m11:34:38.846289 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:37:23.119541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023032F05FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023034E2E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023034E2E740>]}


============================== 12:37:23.124202 | a594782f-f512-48fb-a33c-a8a2236e868c ==============================
[0m12:37:23.124202 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:37:23.129563 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:37:23.864203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a594782f-f512-48fb-a33c-a8a2236e868c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023033242800>]}
[0m12:37:23.968894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a594782f-f512-48fb-a33c-a8a2236e868c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002303574CA60>]}
[0m12:37:23.976103 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:37:24.546933 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:37:24.940034 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:37:24.940034 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:37:25.051929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a594782f-f512-48fb-a33c-a8a2236e868c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023036C6E080>]}
[0m12:37:25.330358 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m12:37:25.347026 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m12:37:25.398696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a594782f-f512-48fb-a33c-a8a2236e868c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023035C166E0>]}
[0m12:37:25.399697 [info ] [MainThread]: Found 6 models, 4 data tests, 2 sources, 474 macros
[0m12:37:25.402179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a594782f-f512-48fb-a33c-a8a2236e868c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023036C280D0>]}
[0m12:37:25.405913 [info ] [MainThread]: 
[0m12:37:25.408541 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:37:25.411651 [info ] [MainThread]: 
[0m12:37:25.413954 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:37:25.435182 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m12:37:25.608380 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m12:37:25.608380 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m12:37:25.608380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:26.535141 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.924 seconds
[0m12:37:26.559193 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_RDL'
[0m12:37:26.603904 [debug] [ThreadPool]: Using snowflake connection "list_DEV_RDL"
[0m12:37:26.603904 [debug] [ThreadPool]: On list_DEV_RDL: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_RDL"} */
show objects in DEV.RDL limit 10000;
[0m12:37:26.603904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:27.344428 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.742 seconds
[0m12:37:27.361872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a594782f-f512-48fb-a33c-a8a2236e868c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230371F3C10>]}
[0m12:37:27.384175 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m12:37:27.384175 [info ] [Thread-1 (]: 1 of 5 START sql view model RDL.dim_customers .................................. [RUN]
[0m12:37:27.389632 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.dim_customers'
[0m12:37:27.389632 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m12:37:27.421210 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m12:37:27.422219 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m12:37:27.470514 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_customers"
[0m12:37:27.483628 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m12:37:27.483628 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace   view DEV.RDL.dim_customers
  
   as (
    with cust_src AS (
    SELECT
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        ingest_date
FROM dev.rdl.orders )
,dedup AS 
(
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY email ORDER BY ingest_date DESC) AS rnk
    FROM cust_src
)
SELECT
    ROW_NUMBER() OVER(ORDER BY email)                                                                   AS customer_sk,  
    email                                                                                               AS customer_nk,  
    COALESCE(NULLIF(TRIM(COALESCE(first_name,'') || ' ' || COALESCE(last_name,'')), ''),'unknown')      AS name,
    dob                                                                                                 AS dob,
    email                                                                                               AS email,
    COALESCE(NULLIF(phone,''),'unknown')                                                                AS phone,
    address_line1|| ' ' ||address_line2                                                                 AS address,
    city                                                                                                AS city,
    country                                                                                             AS country,
    postcode                                                                                            AS postcode
FROM
    dedup
WHERE 
    rnk =1
  );
[0m12:37:27.483628 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:37:28.271072 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.786 seconds
[0m12:37:28.336220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a594782f-f512-48fb-a33c-a8a2236e868c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230315802B0>]}
[0m12:37:28.337230 [info ] [Thread-1 (]: 1 of 5 OK created sql view model RDL.dim_customers ............................. [[32mSUCCESS 1[0m in 0.94s]
[0m12:37:28.339942 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m12:37:28.341977 [debug] [Thread-1 (]: Began running node model.ManyPets.my_first_dbt_model
[0m12:37:28.343979 [info ] [Thread-1 (]: 2 of 5 START sql table model RDL.my_first_dbt_model ............................ [RUN]
[0m12:37:28.346530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_customers, now model.ManyPets.my_first_dbt_model)
[0m12:37:28.347865 [debug] [Thread-1 (]: Began compiling node model.ManyPets.my_first_dbt_model
[0m12:37:28.360859 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.my_first_dbt_model"
[0m12:37:28.363186 [debug] [Thread-1 (]: Began executing node model.ManyPets.my_first_dbt_model
[0m12:37:28.417287 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.my_first_dbt_model"
[0m12:37:28.428826 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.my_first_dbt_model"
[0m12:37:28.431963 [debug] [Thread-1 (]: On model.ManyPets.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.my_first_dbt_model"} */
create or replace transient table DEV.RDL.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m12:37:29.544045 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.113 seconds
[0m12:37:29.552184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a594782f-f512-48fb-a33c-a8a2236e868c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023037422020>]}
[0m12:37:29.560182 [info ] [Thread-1 (]: 2 of 5 OK created sql table model RDL.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 1.21s]
[0m12:37:29.566795 [debug] [Thread-1 (]: Finished running node model.ManyPets.my_first_dbt_model
[0m12:37:29.569726 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_pets
[0m12:37:29.573045 [info ] [Thread-1 (]: 3 of 5 START sql view model RDL.dim_pets ....................................... [RUN]
[0m12:37:29.577997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.my_first_dbt_model, now model.ManyPets.dim_pets)
[0m12:37:29.582097 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_pets
[0m12:37:29.605755 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_pets"
[0m12:37:29.605755 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_pets
[0m12:37:29.617251 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_pets"
[0m12:37:29.623130 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m12:37:29.623130 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
create or replace   view DEV.RDL.dim_pets
  
   as (
    WITH cust_src AS (
    SELECT
        data:detail:customer:email::STRING AS email,
        data:detail:pets                   AS pets_array,
        ingest_date
    FROM dev.rdl.orders
),
flattened_pets AS (
    SELECT 
        d.email,
        pet.value:name::STRING              AS pet_name,
        pet.value:breed_value::STRING       AS breed,
        pet.value:dob::DATE                 AS pet_dob,
        pet.value:gender::STRING            AS pet_gender,
        pet.value:species::STRING           AS pet_species,
        pet.value:pedigree_type::STRING     AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN  AS spayed_neutered,
        pet.value:postcode::STRING          AS pet_postcode,
        d.ingest_date
    FROM cust_src d,
    LATERAL FLATTEN(input => d.pets_array) AS pet
),
dedup AS (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY email, pet_dob, pet_name ORDER BY ingest_date DESC) AS rnk
    FROM flattened_pets
)
SELECT
    ROW_NUMBER() OVER(ORDER BY d.email, d.pet_dob, d.pet_name)                                      AS pet_sk,  
    d.email || '-' || COALESCE(d.pet_name, 'unknown') || '-' || COALESCE(d.pet_dob, '1900-01-01')   AS pet_nk,
    c.cusomer_sk                                                                                    AS cusomer_sk,
    d.pet_name                                                                                AS pet_name,
    d.breed                                                                                   AS breed,
    d.pet_dob                                                                                 AS pet_dob,
    d.pet_gender                                                                              AS pet_gender,
    d.pet_species                                                                             AS pet_species,
    d.pedigree_type                                                                           AS pedigree_type,
    d.spayed_neutered                                                                         AS spayed_neutered,
    d.pet_postcode                                                                            AS pet_postcode
FROM 
    dedup AS d
    INNER JOIN DEV.RDL.dim_customers AS c ON (d.email=c.cusomer_nk)
WHERE
    rnk = 1
  );
[0m12:37:29.847206 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0bd0-0000-e3c5-0001-b3ce00016072
[0m12:37:29.847206 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 35 at position 4
invalid identifier 'C.CUSOMER_SK'
[0m12:37:29.855287 [debug] [Thread-1 (]: Database Error in model dim_pets (models\dim_pets.sql)
  000904 (42000): SQL compilation error: error line 35 at position 4
  invalid identifier 'C.CUSOMER_SK'
  compiled code at target\run\ManyPets\models\dim_pets.sql
[0m12:37:29.855287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a594782f-f512-48fb-a33c-a8a2236e868c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002303741FB80>]}
[0m12:37:29.864053 [error] [Thread-1 (]: 3 of 5 ERROR creating sql view model RDL.dim_pets .............................. [[31mERROR[0m in 0.28s]
[0m12:37:29.870763 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_pets
[0m12:37:29.872711 [debug] [Thread-1 (]: Began running node model.ManyPets.my_second_dbt_model
[0m12:37:29.874994 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.dim_pets' to be skipped because of status 'error'.  Reason: Database Error in model dim_pets (models\dim_pets.sql)
  000904 (42000): SQL compilation error: error line 35 at position 4
  invalid identifier 'C.CUSOMER_SK'
  compiled code at target\run\ManyPets\models\dim_pets.sql.
[0m12:37:29.874994 [info ] [Thread-1 (]: 4 of 5 START sql view model RDL.my_second_dbt_model ............................ [RUN]
[0m12:37:29.882593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_pets, now model.ManyPets.my_second_dbt_model)
[0m12:37:29.884811 [debug] [Thread-1 (]: Began compiling node model.ManyPets.my_second_dbt_model
[0m12:37:29.891740 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.my_second_dbt_model"
[0m12:37:29.896438 [debug] [Thread-1 (]: Began executing node model.ManyPets.my_second_dbt_model
[0m12:37:29.903311 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.my_second_dbt_model"
[0m12:37:29.910214 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.my_second_dbt_model"
[0m12:37:29.910214 [debug] [Thread-1 (]: On model.ManyPets.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.my_second_dbt_model"} */
create or replace   view DEV.RDL.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from DEV.RDL.my_first_dbt_model
where id = 1
  );
[0m12:37:30.211458 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.299 seconds
[0m12:37:30.219515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a594782f-f512-48fb-a33c-a8a2236e868c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230373C0FA0>]}
[0m12:37:30.227514 [info ] [Thread-1 (]: 4 of 5 OK created sql view model RDL.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.34s]
[0m12:37:30.232723 [debug] [Thread-1 (]: Finished running node model.ManyPets.my_second_dbt_model
[0m12:37:30.232723 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m12:37:30.232723 [info ] [Thread-1 (]: 5 of 5 SKIP relation RDL.fact_orders ........................................... [[33mSKIP[0m]
[0m12:37:30.242955 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m12:37:30.250326 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:37:30.250326 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m12:37:30.250326 [debug] [MainThread]: On list_DEV: Close
[0m12:37:30.377529 [debug] [MainThread]: Connection 'list_DEV_RDL' was left open.
[0m12:37:30.377529 [debug] [MainThread]: On list_DEV_RDL: Close
[0m12:37:30.501760 [debug] [MainThread]: Connection 'model.ManyPets.my_second_dbt_model' was left open.
[0m12:37:30.501760 [debug] [MainThread]: On model.ManyPets.my_second_dbt_model: Close
[0m12:37:30.619089 [info ] [MainThread]: 
[0m12:37:30.623068 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 5.20 seconds (5.20s).
[0m12:37:30.627198 [debug] [MainThread]: Command end result
[0m12:37:30.709424 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m12:37:30.714086 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m12:37:30.727535 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m12:37:30.728538 [info ] [MainThread]: 
[0m12:37:30.729567 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:37:30.731450 [info ] [MainThread]: 
[0m12:37:30.732746 [error] [MainThread]:   Database Error in model dim_pets (models\dim_pets.sql)
  000904 (42000): SQL compilation error: error line 35 at position 4
  invalid identifier 'C.CUSOMER_SK'
  compiled code at target\run\ManyPets\models\dim_pets.sql
[0m12:37:30.735453 [info ] [MainThread]: 
[0m12:37:30.737131 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m12:37:30.740804 [debug] [MainThread]: Command `dbt run` failed at 12:37:30.740804 after 7.81 seconds
[0m12:37:30.744311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023032F05FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002303241A7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023037306620>]}
[0m12:37:30.745316 [debug] [MainThread]: Flushing usage events
[0m12:37:31.448247 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:38:25.086994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237679F6020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002376991EB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002376991E980>]}


============================== 12:38:25.091651 | 17c74c20-d1fd-41f4-9432-9f0e6b8abcfe ==============================
[0m12:38:25.091651 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:38:25.094502 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:38:25.796372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17c74c20-d1fd-41f4-9432-9f0e6b8abcfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237698ECBE0>]}
[0m12:38:25.918745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17c74c20-d1fd-41f4-9432-9f0e6b8abcfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002376A246BC0>]}
[0m12:38:25.918745 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:38:26.456603 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:38:26.836371 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:38:26.836371 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:38:26.930358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17c74c20-d1fd-41f4-9432-9f0e6b8abcfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002376B75E0B0>]}
[0m12:38:27.197987 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m12:38:27.213928 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m12:38:27.259348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17c74c20-d1fd-41f4-9432-9f0e6b8abcfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002376B6D6B00>]}
[0m12:38:27.267341 [info ] [MainThread]: Found 6 models, 4 data tests, 2 sources, 474 macros
[0m12:38:27.270179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17c74c20-d1fd-41f4-9432-9f0e6b8abcfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002376B718AC0>]}
[0m12:38:27.270179 [info ] [MainThread]: 
[0m12:38:27.278172 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:38:27.280029 [info ] [MainThread]: 
[0m12:38:27.284976 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:38:27.351191 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m12:38:27.537294 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m12:38:27.537294 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m12:38:27.537294 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:28.097715 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.559 seconds
[0m12:38:28.113082 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_RDL'
[0m12:38:28.145745 [debug] [ThreadPool]: Using snowflake connection "list_DEV_RDL"
[0m12:38:28.146748 [debug] [ThreadPool]: On list_DEV_RDL: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_RDL"} */
show objects in DEV.RDL limit 10000;
[0m12:38:28.146748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:28.885234 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.739 seconds
[0m12:38:28.893469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17c74c20-d1fd-41f4-9432-9f0e6b8abcfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002376BCE3EB0>]}
[0m12:38:28.908741 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m12:38:28.910750 [info ] [Thread-1 (]: 1 of 5 START sql view model RDL.dim_customers .................................. [RUN]
[0m12:38:28.914371 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.dim_customers'
[0m12:38:28.914371 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m12:38:28.944111 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m12:38:28.947778 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m12:38:29.010197 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_customers"
[0m12:38:29.013210 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m12:38:29.013210 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace   view DEV.RDL.dim_customers
  
   as (
    with cust_src AS (
    SELECT
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        ingest_date
FROM dev.rdl.orders )
,dedup AS 
(
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY email ORDER BY ingest_date DESC) AS rnk
    FROM cust_src
)
SELECT
    ROW_NUMBER() OVER(ORDER BY email)                                                                   AS customer_sk,  
    email                                                                                               AS customer_nk,  
    COALESCE(NULLIF(TRIM(COALESCE(first_name,'') || ' ' || COALESCE(last_name,'')), ''),'unknown')      AS name,
    dob                                                                                                 AS dob,
    email                                                                                               AS email,
    COALESCE(NULLIF(phone,''),'unknown')                                                                AS phone,
    address_line1|| ' ' ||address_line2                                                                 AS address,
    city                                                                                                AS city,
    country                                                                                             AS country,
    postcode                                                                                            AS postcode
FROM
    dedup
WHERE 
    rnk =1
  );
[0m12:38:29.013210 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:38:29.916492 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.900 seconds
[0m12:38:30.052438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17c74c20-d1fd-41f4-9432-9f0e6b8abcfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237660702E0>]}
[0m12:38:30.052438 [info ] [Thread-1 (]: 1 of 5 OK created sql view model RDL.dim_customers ............................. [[32mSUCCESS 1[0m in 1.13s]
[0m12:38:30.059181 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m12:38:30.062267 [debug] [Thread-1 (]: Began running node model.ManyPets.my_first_dbt_model
[0m12:38:30.065389 [info ] [Thread-1 (]: 2 of 5 START sql table model RDL.my_first_dbt_model ............................ [RUN]
[0m12:38:30.067588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_customers, now model.ManyPets.my_first_dbt_model)
[0m12:38:30.069996 [debug] [Thread-1 (]: Began compiling node model.ManyPets.my_first_dbt_model
[0m12:38:30.083445 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.my_first_dbt_model"
[0m12:38:30.086037 [debug] [Thread-1 (]: Began executing node model.ManyPets.my_first_dbt_model
[0m12:38:30.186539 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.my_first_dbt_model"
[0m12:38:30.194024 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.my_first_dbt_model"
[0m12:38:30.194024 [debug] [Thread-1 (]: On model.ManyPets.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.my_first_dbt_model"} */
create or replace transient table DEV.RDL.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m12:38:31.329229 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.133 seconds
[0m12:38:31.332108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17c74c20-d1fd-41f4-9432-9f0e6b8abcfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002376BED2020>]}
[0m12:38:31.332108 [info ] [Thread-1 (]: 2 of 5 OK created sql table model RDL.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 1.27s]
[0m12:38:31.337663 [debug] [Thread-1 (]: Finished running node model.ManyPets.my_first_dbt_model
[0m12:38:31.338319 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_pets
[0m12:38:31.339317 [info ] [Thread-1 (]: 3 of 5 START sql view model RDL.dim_pets ....................................... [RUN]
[0m12:38:31.346583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.my_first_dbt_model, now model.ManyPets.dim_pets)
[0m12:38:31.348579 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_pets
[0m12:38:31.351309 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_pets"
[0m12:38:31.366068 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_pets
[0m12:38:31.380133 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_pets"
[0m12:38:31.396283 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m12:38:31.396283 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
create or replace   view DEV.RDL.dim_pets
  
   as (
    WITH cust_src AS (
    SELECT
        data:detail:customer:email::STRING AS email,
        data:detail:pets                   AS pets_array,
        ingest_date
    FROM dev.rdl.orders
),
flattened_pets AS (
    SELECT 
        d.email,
        pet.value:name::STRING              AS pet_name,
        pet.value:breed_value::STRING       AS breed,
        pet.value:dob::DATE                 AS pet_dob,
        pet.value:gender::STRING            AS pet_gender,
        pet.value:species::STRING           AS pet_species,
        pet.value:pedigree_type::STRING     AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN  AS spayed_neutered,
        pet.value:postcode::STRING          AS pet_postcode,
        d.ingest_date
    FROM cust_src d,
    LATERAL FLATTEN(input => d.pets_array) AS pet
),
dedup AS (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY email, pet_dob, pet_name ORDER BY ingest_date DESC) AS rnk
    FROM flattened_pets
)
SELECT
    ROW_NUMBER() OVER(ORDER BY d.email, d.pet_dob, d.pet_name)                                      AS pet_sk,  
    d.email || '-' || COALESCE(d.pet_name, 'unknown') || '-' || COALESCE(d.pet_dob, '1900-01-01')   AS pet_nk,
    c.cusomer_sk                                                                                    AS cusomer_sk,
    d.pet_name                                                                                AS pet_name,
    d.breed                                                                                   AS breed,
    d.pet_dob                                                                                 AS pet_dob,
    d.pet_gender                                                                              AS pet_gender,
    d.pet_species                                                                             AS pet_species,
    d.pedigree_type                                                                           AS pedigree_type,
    d.spayed_neutered                                                                         AS spayed_neutered,
    d.pet_postcode                                                                            AS pet_postcode
FROM 
    dedup AS d
    INNER JOIN DEV.RDL.dim_customers AS c ON (d.email=c.cusomer_nk)
WHERE
    rnk = 1
  );
[0m12:38:31.688446 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0bd1-0000-e3ba-0000-0001b3cedf1d
[0m12:38:31.695636 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 35 at position 4
invalid identifier 'C.CUSOMER_SK'
[0m12:38:31.720666 [debug] [Thread-1 (]: Database Error in model dim_pets (models\dim_pets.sql)
  000904 (42000): SQL compilation error: error line 35 at position 4
  invalid identifier 'C.CUSOMER_SK'
  compiled code at target\run\ManyPets\models\dim_pets.sql
[0m12:38:31.728734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17c74c20-d1fd-41f4-9432-9f0e6b8abcfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002376BECFBB0>]}
[0m12:38:31.728734 [error] [Thread-1 (]: 3 of 5 ERROR creating sql view model RDL.dim_pets .............................. [[31mERROR[0m in 0.38s]
[0m12:38:31.748815 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_pets
[0m12:38:31.751439 [debug] [Thread-1 (]: Began running node model.ManyPets.my_second_dbt_model
[0m12:38:31.760514 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.dim_pets' to be skipped because of status 'error'.  Reason: Database Error in model dim_pets (models\dim_pets.sql)
  000904 (42000): SQL compilation error: error line 35 at position 4
  invalid identifier 'C.CUSOMER_SK'
  compiled code at target\run\ManyPets\models\dim_pets.sql.
[0m12:38:31.768461 [info ] [Thread-1 (]: 4 of 5 START sql view model RDL.my_second_dbt_model ............................ [RUN]
[0m12:38:31.785295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_pets, now model.ManyPets.my_second_dbt_model)
[0m12:38:31.800758 [debug] [Thread-1 (]: Began compiling node model.ManyPets.my_second_dbt_model
[0m12:38:31.846057 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.my_second_dbt_model"
[0m12:38:31.846057 [debug] [Thread-1 (]: Began executing node model.ManyPets.my_second_dbt_model
[0m12:38:31.861580 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.my_second_dbt_model"
[0m12:38:31.876637 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.my_second_dbt_model"
[0m12:38:31.877631 [debug] [Thread-1 (]: On model.ManyPets.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.my_second_dbt_model"} */
create or replace   view DEV.RDL.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from DEV.RDL.my_first_dbt_model
where id = 1
  );
[0m12:38:32.169833 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.288 seconds
[0m12:38:32.190119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17c74c20-d1fd-41f4-9432-9f0e6b8abcfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002376BE70AF0>]}
[0m12:38:32.191368 [info ] [Thread-1 (]: 4 of 5 OK created sql view model RDL.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.40s]
[0m12:38:32.197966 [debug] [Thread-1 (]: Finished running node model.ManyPets.my_second_dbt_model
[0m12:38:32.197966 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m12:38:32.204109 [info ] [Thread-1 (]: 5 of 5 SKIP relation RDL.fact_orders ........................................... [[33mSKIP[0m]
[0m12:38:32.209676 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m12:38:32.216278 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:38:32.217889 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m12:38:32.218887 [debug] [MainThread]: On list_DEV: Close
[0m12:38:32.348200 [debug] [MainThread]: Connection 'list_DEV_RDL' was left open.
[0m12:38:32.348200 [debug] [MainThread]: On list_DEV_RDL: Close
[0m12:38:32.500710 [debug] [MainThread]: Connection 'model.ManyPets.my_second_dbt_model' was left open.
[0m12:38:32.500710 [debug] [MainThread]: On model.ManyPets.my_second_dbt_model: Close
[0m12:38:32.607445 [info ] [MainThread]: 
[0m12:38:32.619700 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 5.33 seconds (5.33s).
[0m12:38:32.633301 [debug] [MainThread]: Command end result
[0m12:38:32.717127 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m12:38:32.721881 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m12:38:32.742161 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m12:38:32.743162 [info ] [MainThread]: 
[0m12:38:32.744000 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:38:32.745762 [info ] [MainThread]: 
[0m12:38:32.747130 [error] [MainThread]:   Database Error in model dim_pets (models\dim_pets.sql)
  000904 (42000): SQL compilation error: error line 35 at position 4
  invalid identifier 'C.CUSOMER_SK'
  compiled code at target\run\ManyPets\models\dim_pets.sql
[0m12:38:32.749750 [info ] [MainThread]: 
[0m12:38:32.751041 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m12:38:32.753321 [debug] [MainThread]: Command `dbt run` failed at 12:38:32.753321 after 7.82 seconds
[0m12:38:32.754320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237679F6020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002376A544910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023767CF3A00>]}
[0m12:38:32.754971 [debug] [MainThread]: Flushing usage events
[0m12:38:33.493055 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:38:47.486049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026105586050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261074AE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261074AE7D0>]}


============================== 12:38:47.486936 | 97bf5f30-19ab-438a-b6ea-a74181eea3cc ==============================
[0m12:38:47.486936 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:38:47.494080 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:38:48.387618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97bf5f30-19ab-438a-b6ea-a74181eea3cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002610747C970>]}
[0m12:38:48.552158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97bf5f30-19ab-438a-b6ea-a74181eea3cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026107DB5C30>]}
[0m12:38:48.561122 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:38:49.311622 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:38:49.735021 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:38:49.735021 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:38:49.859215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97bf5f30-19ab-438a-b6ea-a74181eea3cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261092EE0E0>]}
[0m12:38:50.140492 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m12:38:50.147545 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m12:38:50.184886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97bf5f30-19ab-438a-b6ea-a74181eea3cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026109272620>]}
[0m12:38:50.187586 [info ] [MainThread]: Found 6 models, 4 data tests, 2 sources, 474 macros
[0m12:38:50.190572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97bf5f30-19ab-438a-b6ea-a74181eea3cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026109272DA0>]}
[0m12:38:50.193205 [info ] [MainThread]: 
[0m12:38:50.195752 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:38:50.197726 [info ] [MainThread]: 
[0m12:38:50.200223 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:38:50.228973 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m12:38:50.417226 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m12:38:50.425234 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m12:38:50.425234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:51.192860 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.766 seconds
[0m12:38:51.226880 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_RDL'
[0m12:38:51.283538 [debug] [ThreadPool]: Using snowflake connection "list_DEV_RDL"
[0m12:38:51.283538 [debug] [ThreadPool]: On list_DEV_RDL: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_RDL"} */
show objects in DEV.RDL limit 10000;
[0m12:38:51.288880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:51.919716 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.630 seconds
[0m12:38:51.937864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97bf5f30-19ab-438a-b6ea-a74181eea3cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002610933B670>]}
[0m12:38:51.975788 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m12:38:51.975788 [info ] [Thread-1 (]: 1 of 5 START sql view model RDL.dim_customers .................................. [RUN]
[0m12:38:51.988666 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.dim_customers'
[0m12:38:51.994019 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m12:38:52.031687 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m12:38:52.037980 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m12:38:52.093505 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_customers"
[0m12:38:52.101771 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m12:38:52.101771 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace   view DEV.RDL.dim_customers
  
   as (
    with cust_src AS (
    SELECT
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        ingest_date
FROM dev.rdl.orders )
,dedup AS 
(
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY email ORDER BY ingest_date DESC) AS rnk
    FROM cust_src
)
SELECT
    ROW_NUMBER() OVER(ORDER BY email)                                                                   AS customer_sk,  
    email                                                                                               AS customer_nk,  
    COALESCE(NULLIF(TRIM(COALESCE(first_name,'') || ' ' || COALESCE(last_name,'')), ''),'unknown')      AS name,
    dob                                                                                                 AS dob,
    email                                                                                               AS email,
    COALESCE(NULLIF(phone,''),'unknown')                                                                AS phone,
    address_line1|| ' ' ||address_line2                                                                 AS address,
    city                                                                                                AS city,
    country                                                                                             AS country,
    postcode                                                                                            AS postcode
FROM
    dedup
WHERE 
    rnk =1
  );
[0m12:38:52.106046 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:38:52.875864 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.772 seconds
[0m12:38:52.984858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97bf5f30-19ab-438a-b6ea-a74181eea3cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261092621A0>]}
[0m12:38:52.987686 [info ] [Thread-1 (]: 1 of 5 OK created sql view model RDL.dim_customers ............................. [[32mSUCCESS 1[0m in 0.99s]
[0m12:38:52.990278 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m12:38:52.991381 [debug] [Thread-1 (]: Began running node model.ManyPets.my_first_dbt_model
[0m12:38:52.992382 [info ] [Thread-1 (]: 2 of 5 START sql table model RDL.my_first_dbt_model ............................ [RUN]
[0m12:38:52.994196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_customers, now model.ManyPets.my_first_dbt_model)
[0m12:38:52.994196 [debug] [Thread-1 (]: Began compiling node model.ManyPets.my_first_dbt_model
[0m12:38:52.998935 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.my_first_dbt_model"
[0m12:38:53.004253 [debug] [Thread-1 (]: Began executing node model.ManyPets.my_first_dbt_model
[0m12:38:53.073919 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.my_first_dbt_model"
[0m12:38:53.076911 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.my_first_dbt_model"
[0m12:38:53.077919 [debug] [Thread-1 (]: On model.ManyPets.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.my_first_dbt_model"} */
create or replace transient table DEV.RDL.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m12:38:54.175524 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.101 seconds
[0m12:38:54.209872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97bf5f30-19ab-438a-b6ea-a74181eea3cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026109AE2020>]}
[0m12:38:54.209872 [info ] [Thread-1 (]: 2 of 5 OK created sql table model RDL.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 1.22s]
[0m12:38:54.228639 [debug] [Thread-1 (]: Finished running node model.ManyPets.my_first_dbt_model
[0m12:38:54.228639 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_pets
[0m12:38:54.245568 [info ] [Thread-1 (]: 3 of 5 START sql view model RDL.dim_pets ....................................... [RUN]
[0m12:38:54.258998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.my_first_dbt_model, now model.ManyPets.dim_pets)
[0m12:38:54.268017 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_pets
[0m12:38:54.332339 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_pets"
[0m12:38:54.339813 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_pets
[0m12:38:54.356774 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_pets"
[0m12:38:54.361459 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m12:38:54.361459 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
create or replace   view DEV.RDL.dim_pets
  
   as (
    WITH cust_src AS (
    SELECT
        data:detail:customer:email::STRING AS email,
        data:detail:pets                   AS pets_array,
        ingest_date
    FROM dev.rdl.orders
),
flattened_pets AS (
    SELECT 
        d.email,
        pet.value:name::STRING              AS pet_name,
        pet.value:breed_value::STRING       AS breed,
        pet.value:dob::DATE                 AS pet_dob,
        pet.value:gender::STRING            AS pet_gender,
        pet.value:species::STRING           AS pet_species,
        pet.value:pedigree_type::STRING     AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN  AS spayed_neutered,
        pet.value:postcode::STRING          AS pet_postcode,
        d.ingest_date
    FROM cust_src d,
    LATERAL FLATTEN(input => d.pets_array) AS pet
),
dedup AS (
    SELECT 
        *,
        ROW_NUMBER() OVER(PARTITION BY email, pet_dob, pet_name ORDER BY ingest_date DESC) AS rnk
    FROM flattened_pets
)
SELECT
    ROW_NUMBER() OVER(ORDER BY d.email, d.pet_dob, d.pet_name)                                      AS pet_sk,  
    d.email || '-' || COALESCE(d.pet_name, 'unknown') || '-' || COALESCE(d.pet_dob, '1900-01-01')   AS pet_nk,
    c.customer_sk                                                                                   AS customer_sk,
    d.pet_name                                                                                AS pet_name,
    d.breed                                                                                   AS breed,
    d.pet_dob                                                                                 AS pet_dob,
    d.pet_gender                                                                              AS pet_gender,
    d.pet_species                                                                             AS pet_species,
    d.pedigree_type                                                                           AS pedigree_type,
    d.spayed_neutered                                                                         AS spayed_neutered,
    d.pet_postcode                                                                            AS pet_postcode
FROM 
    dedup AS d
    INNER JOIN DEV.RDL.dim_customers AS c ON (d.email=c.customer_nk)
WHERE
    rnk = 1
  );
[0m12:38:54.711628 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.348 seconds
[0m12:38:54.734495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97bf5f30-19ab-438a-b6ea-a74181eea3cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026109A5DF00>]}
[0m12:38:54.734495 [info ] [Thread-1 (]: 3 of 5 OK created sql view model RDL.dim_pets .................................. [[32mSUCCESS 1[0m in 0.47s]
[0m12:38:54.745633 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_pets
[0m12:38:54.745633 [debug] [Thread-1 (]: Began running node model.ManyPets.my_second_dbt_model
[0m12:38:54.759262 [info ] [Thread-1 (]: 4 of 5 START sql view model RDL.my_second_dbt_model ............................ [RUN]
[0m12:38:54.769404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_pets, now model.ManyPets.my_second_dbt_model)
[0m12:38:54.769404 [debug] [Thread-1 (]: Began compiling node model.ManyPets.my_second_dbt_model
[0m12:38:54.821870 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.my_second_dbt_model"
[0m12:38:54.829967 [debug] [Thread-1 (]: Began executing node model.ManyPets.my_second_dbt_model
[0m12:38:54.856187 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.my_second_dbt_model"
[0m12:38:54.864840 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.my_second_dbt_model"
[0m12:38:54.865841 [debug] [Thread-1 (]: On model.ManyPets.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.my_second_dbt_model"} */
create or replace   view DEV.RDL.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from DEV.RDL.my_first_dbt_model
where id = 1
  );
[0m12:38:55.197670 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.336 seconds
[0m12:38:55.218762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97bf5f30-19ab-438a-b6ea-a74181eea3cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026109A80E20>]}
[0m12:38:55.226791 [info ] [Thread-1 (]: 4 of 5 OK created sql view model RDL.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.45s]
[0m12:38:55.237813 [debug] [Thread-1 (]: Finished running node model.ManyPets.my_second_dbt_model
[0m12:38:55.237813 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m12:38:55.249972 [info ] [Thread-1 (]: 5 of 5 START sql view model RDL.fact_orders .................................... [RUN]
[0m12:38:55.255244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.my_second_dbt_model, now model.ManyPets.fact_orders)
[0m12:38:55.255244 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_orders
[0m12:38:55.273954 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_orders"
[0m12:38:55.281361 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_orders
[0m12:38:55.289491 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.fact_orders"
[0m12:38:55.296038 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m12:38:55.296038 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
create or replace   view DEV.RDL.fact_orders
  
   as (
    WITH fact_src AS (
    SELECT 
        o.data:detail:customer:email::STRING    AS email,
        pet.value:name::STRING                  AS pet_name,
        pet.value:dob::DATE                     AS pet_dob,
        o.data:detail:order_id::STRING          AS order_id,
        o.data:detail:effective_date::DATE      AS order_date,
        o.data:detail:cessation_date::DATE      AS cessation_date,
        o.data:detail:affiliate_code::STRING    AS affiliate_code,
        pet.value:value::NUMBER                 AS pet_value
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet
),

fact_final AS (
    SELECT 
        f.order_id,
        f.order_date,
        f.cessation_date,
        f.affiliate_code,
        f.pet_value,
        c.customer_sk,
        p.pet_sk
    FROM fact_src f
    LEFT JOIN DEV.RDL.dim_customers c ON f.email = c.email
    LEFT JOIN DEV.RDL.dim_pets p ON c.customer_sk = p.customer_sk 
                    AND f.pet_name = p.pet_name 
                    AND f.pet_dob = p.pet_dob
)
SELECT 
    ROW_NUMBER() OVER(ORDER BY customer_sk, pet_sk, order_id) AS order_sk,
    customer_sk,
    pet_sk,
    order_id AS order_nk,
    order_date,
    cessation_date,
    affiliate_code,
    pet_value
FROM fact_final;
[0m12:38:55.409784 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0bd2-0000-e3a1-0001-b3ce0001a00e
[0m12:38:55.409784 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 42 at position 15 unexpected ';'.
[0m12:38:55.419499 [debug] [Thread-1 (]: Database Error in model fact_orders (models\fact_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 42 at position 15 unexpected ';'.
  compiled code at target\run\ManyPets\models\fact_orders.sql
[0m12:38:55.419499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97bf5f30-19ab-438a-b6ea-a74181eea3cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026109AFBEE0>]}
[0m12:38:55.419499 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model RDL.fact_orders ........................... [[31mERROR[0m in 0.17s]
[0m12:38:55.425260 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m12:38:55.426259 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_orders (models\fact_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 42 at position 15 unexpected ';'.
  compiled code at target\run\ManyPets\models\fact_orders.sql.
[0m12:38:55.430360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:38:55.430360 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m12:38:55.430360 [debug] [MainThread]: On list_DEV: Close
[0m12:38:55.537043 [debug] [MainThread]: Connection 'list_DEV_RDL' was left open.
[0m12:38:55.537043 [debug] [MainThread]: On list_DEV_RDL: Close
[0m12:38:55.655069 [debug] [MainThread]: Connection 'model.ManyPets.fact_orders' was left open.
[0m12:38:55.663765 [debug] [MainThread]: On model.ManyPets.fact_orders: Close
[0m12:38:55.787217 [info ] [MainThread]: 
[0m12:38:55.793859 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 5.59 seconds (5.59s).
[0m12:38:55.810871 [debug] [MainThread]: Command end result
[0m12:38:55.877740 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m12:38:55.882317 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m12:38:55.898643 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m12:38:55.900215 [info ] [MainThread]: 
[0m12:38:55.901799 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:38:55.903803 [info ] [MainThread]: 
[0m12:38:55.905152 [error] [MainThread]:   Database Error in model fact_orders (models\fact_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 42 at position 15 unexpected ';'.
  compiled code at target\run\ManyPets\models\fact_orders.sql
[0m12:38:55.907705 [info ] [MainThread]: 
[0m12:38:55.909401 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m12:38:55.914415 [debug] [MainThread]: Command `dbt run` failed at 12:38:55.913436 after 8.59 seconds
[0m12:38:55.915429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026105586050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026105882380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026109AEC250>]}
[0m12:38:55.915429 [debug] [MainThread]: Flushing usage events
[0m12:38:56.943543 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:35:26.143884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F0F15FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F2E3EB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F2E3E950>]}


============================== 15:35:26.154305 | 6c925f09-4d7b-4296-a41c-1b31f18103dc ==============================
[0m15:35:26.154305 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:35:26.160384 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select dim_customers', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:35:28.599371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c925f09-4d7b-4296-a41c-1b31f18103dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F379E590>]}
[0m15:35:28.753369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c925f09-4d7b-4296-a41c-1b31f18103dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F2CE31C0>]}
[0m15:35:28.770400 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:35:29.765976 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:35:30.197243 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:35:30.197243 [debug] [MainThread]: Partial parsing: updated file: ManyPets://models\dim_customers.sql
[0m15:35:30.673735 [error] [MainThread]: Encountered an error:
Compilation Error in model dim_customers (models\dim_customers.sql)
  invalid syntax for function call expression
    line 1
      {{ config(
[0m15:35:30.678753 [debug] [MainThread]: Command `dbt run` failed at 15:35:30.678753 after 4.79 seconds
[0m15:35:30.679751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F0F15FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F376B9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F3768730>]}
[0m15:35:30.679751 [debug] [MainThread]: Flushing usage events
[0m15:35:31.459476 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:37:18.218219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021703696080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217055BE9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217055BE800>]}


============================== 15:37:18.224685 | 158da5b1-ff21-459a-9dd7-977ef906f8cd ==============================
[0m15:37:18.224685 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:37:18.229001 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_customers', 'send_anonymous_usage_stats': 'True'}
[0m15:37:19.409183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '158da5b1-ff21-459a-9dd7-977ef906f8cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021701F69CC0>]}
[0m15:37:19.553817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '158da5b1-ff21-459a-9dd7-977ef906f8cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217050ADB10>]}
[0m15:37:19.557833 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:37:20.286755 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:37:20.822362 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:37:20.825347 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:37:20.980011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '158da5b1-ff21-459a-9dd7-977ef906f8cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217073FE140>]}
[0m15:37:21.292572 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m15:37:21.344735 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m15:37:21.442613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '158da5b1-ff21-459a-9dd7-977ef906f8cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170739ABC0>]}
[0m15:37:21.444652 [info ] [MainThread]: Found 6 models, 4 data tests, 2 sources, 474 macros
[0m15:37:21.446714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '158da5b1-ff21-459a-9dd7-977ef906f8cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170634CA60>]}
[0m15:37:21.446714 [info ] [MainThread]: 
[0m15:37:21.451469 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:37:21.454606 [info ] [MainThread]: 
[0m15:37:21.458279 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:37:21.461128 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m15:37:27.417031 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m15:37:27.418031 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m15:37:27.418031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:28.810806 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.399 seconds
[0m15:37:28.857538 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_RDL'
[0m15:37:28.903789 [debug] [ThreadPool]: Using snowflake connection "list_DEV_RDL"
[0m15:37:28.903789 [debug] [ThreadPool]: On list_DEV_RDL: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_RDL"} */
show objects in DEV.RDL limit 10000;
[0m15:37:28.903789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:30.031134 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.133 seconds
[0m15:37:30.046456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '158da5b1-ff21-459a-9dd7-977ef906f8cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170514A500>]}
[0m15:37:30.085427 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m15:37:30.085427 [info ] [Thread-1 (]: 1 of 1 START sql incremental model RDL.dim_customers ........................... [RUN]
[0m15:37:30.093638 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.dim_customers'
[0m15:37:30.094635 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m15:37:30.317956 [debug] [Thread-1 (]: Compilation Error in model dim_customers (models\dim_customers.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:37:30.331138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '158da5b1-ff21-459a-9dd7-977ef906f8cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170514A500>]}
[0m15:37:30.331138 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model RDL.dim_customers .................. [[31mERROR[0m in 0.23s]
[0m15:37:30.336642 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m15:37:30.337640 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.dim_customers' to be skipped because of status 'error'.  Reason: Compilation Error in model dim_customers (models\dim_customers.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m15:37:30.342283 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:30.343281 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m15:37:30.343281 [debug] [MainThread]: On list_DEV: Close
[0m15:37:30.473472 [debug] [MainThread]: Connection 'list_DEV_RDL' was left open.
[0m15:37:30.473472 [debug] [MainThread]: On list_DEV_RDL: Close
[0m15:37:30.685592 [debug] [MainThread]: Connection 'model.ManyPets.dim_customers' was properly closed.
[0m15:37:30.685592 [info ] [MainThread]: 
[0m15:37:30.695071 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 9.23 seconds (9.23s).
[0m15:37:30.699419 [debug] [MainThread]: Command end result
[0m15:37:30.874137 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m15:37:30.886575 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m15:37:30.925240 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m15:37:30.927685 [info ] [MainThread]: 
[0m15:37:30.930759 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:37:30.934458 [info ] [MainThread]: 
[0m15:37:30.938791 [error] [MainThread]:   Compilation Error in model dim_customers (models\dim_customers.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:37:30.942709 [info ] [MainThread]: 
[0m15:37:30.946086 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:37:30.951292 [debug] [MainThread]: Command `dbt run` failed at 15:37:30.951292 after 12.89 seconds
[0m15:37:30.955654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021703696080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021707398310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217039DE680>]}
[0m15:37:30.955654 [debug] [MainThread]: Flushing usage events
[0m15:37:31.676983 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:40:12.749911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280EE606020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280F052EB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280F052E9B0>]}


============================== 15:40:12.756544 | 89971229-87e0-4683-99d4-7efe601ea380 ==============================
[0m15:40:12.756544 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:40:12.762530 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_customers', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:40:14.298673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89971229-87e0-4683-99d4-7efe601ea380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280F04C7B80>]}
[0m15:40:14.481691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89971229-87e0-4683-99d4-7efe601ea380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280F0E8CC40>]}
[0m15:40:14.491433 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:40:15.418732 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:40:16.040340 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:40:16.040340 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:40:16.179816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89971229-87e0-4683-99d4-7efe601ea380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280F236E0E0>]}
[0m15:40:16.567004 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m15:40:16.576562 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m15:40:16.660928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89971229-87e0-4683-99d4-7efe601ea380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280F2328730>]}
[0m15:40:16.664987 [info ] [MainThread]: Found 6 models, 4 data tests, 2 sources, 474 macros
[0m15:40:16.667586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89971229-87e0-4683-99d4-7efe601ea380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280F128E1A0>]}
[0m15:40:16.668615 [info ] [MainThread]: 
[0m15:40:16.672779 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:40:16.675198 [info ] [MainThread]: 
[0m15:40:16.678779 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:40:16.683107 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m15:40:16.953228 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m15:40:16.953228 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m15:40:16.953228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:18.216662 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.254 seconds
[0m15:40:18.296090 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_RDL'
[0m15:40:18.362820 [debug] [ThreadPool]: Using snowflake connection "list_DEV_RDL"
[0m15:40:18.362820 [debug] [ThreadPool]: On list_DEV_RDL: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_RDL"} */
show objects in DEV.RDL limit 10000;
[0m15:40:18.362820 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:19.412311 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.036 seconds
[0m15:40:19.429630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89971229-87e0-4683-99d4-7efe601ea380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280F238F760>]}
[0m15:40:19.447068 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m15:40:19.447068 [info ] [Thread-1 (]: 1 of 1 START sql incremental model RDL.dim_customers ........................... [RUN]
[0m15:40:19.455430 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.dim_customers'
[0m15:40:19.456430 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m15:40:19.561238 [debug] [Thread-1 (]: Compilation Error in model dim_customers (models\dim_customers.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:40:19.569298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89971229-87e0-4683-99d4-7efe601ea380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280F23B0400>]}
[0m15:40:19.569298 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model RDL.dim_customers .................. [[31mERROR[0m in 0.11s]
[0m15:40:19.577534 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m15:40:19.580194 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.dim_customers' to be skipped because of status 'error'.  Reason: Compilation Error in model dim_customers (models\dim_customers.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m15:40:19.585376 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:40:19.585376 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m15:40:19.585376 [debug] [MainThread]: On list_DEV: Close
[0m15:40:19.699973 [debug] [MainThread]: Connection 'list_DEV_RDL' was left open.
[0m15:40:19.699973 [debug] [MainThread]: On list_DEV_RDL: Close
[0m15:40:19.844221 [debug] [MainThread]: Connection 'model.ManyPets.dim_customers' was properly closed.
[0m15:40:19.844221 [info ] [MainThread]: 
[0m15:40:19.853869 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.17 seconds (3.17s).
[0m15:40:19.859380 [debug] [MainThread]: Command end result
[0m15:40:20.027575 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m15:40:20.037966 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m15:40:20.076343 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m15:40:20.086445 [info ] [MainThread]: 
[0m15:40:20.090935 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:40:20.095975 [info ] [MainThread]: 
[0m15:40:20.097219 [error] [MainThread]:   Compilation Error in model dim_customers (models\dim_customers.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:40:20.102753 [info ] [MainThread]: 
[0m15:40:20.108456 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:40:20.114338 [debug] [MainThread]: Command `dbt run` failed at 15:40:20.114338 after 7.60 seconds
[0m15:40:20.114338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280EE606020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280F2328730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280F0F677F0>]}
[0m15:40:20.114338 [debug] [MainThread]: Flushing usage events
[0m15:40:20.943050 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:40:51.849229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D4625FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D657A830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D657A650>]}


============================== 15:40:51.855762 | 72d15b42-09d0-42c8-8c9c-4988637fc855 ==============================
[0m15:40:51.855762 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:40:51.860428 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:40:52.130384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72d15b42-09d0-42c8-8c9c-4988637fc855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D657A8F0>]}
[0m15:40:52.219072 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:40:52.225348 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:40:52.230868 [debug] [MainThread]: Command `dbt deps` succeeded at 15:40:52.230868 after 0.55 seconds
[0m15:40:52.232132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D4625FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D657A8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D657A950>]}
[0m15:40:52.233695 [debug] [MainThread]: Flushing usage events
[0m15:40:52.983401 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:41:04.450751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD8236080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBDA15E9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBDA15E800>]}


============================== 15:41:04.464091 | 37cf7247-6358-449b-9393-d152483537e4 ==============================
[0m15:41:04.464091 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:41:04.466365 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_customers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:41:05.607203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37cf7247-6358-449b-9393-d152483537e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD72B5CC0>]}
[0m15:41:05.739624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37cf7247-6358-449b-9393-d152483537e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD9C4DB10>]}
[0m15:41:05.744215 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:41:06.302873 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:41:06.807833 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:41:06.808837 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:41:06.945620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37cf7247-6358-449b-9393-d152483537e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBDBF9E140>]}
[0m15:41:07.312045 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m15:41:07.323136 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m15:41:07.589169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37cf7247-6358-449b-9393-d152483537e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBDBF52BC0>]}
[0m15:41:07.591411 [info ] [MainThread]: Found 6 models, 4 data tests, 2 sources, 474 macros
[0m15:41:07.594444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37cf7247-6358-449b-9393-d152483537e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBDAEC0A60>]}
[0m15:41:07.597512 [info ] [MainThread]: 
[0m15:41:07.609170 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:41:07.615407 [info ] [MainThread]: 
[0m15:41:07.619457 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:41:07.627755 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m15:41:07.873792 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m15:41:07.873792 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m15:41:07.873792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:08.959650 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.093 seconds
[0m15:41:09.007919 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_RDL'
[0m15:41:09.043777 [debug] [ThreadPool]: Using snowflake connection "list_DEV_RDL"
[0m15:41:09.043777 [debug] [ThreadPool]: On list_DEV_RDL: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_RDL"} */
show objects in DEV.RDL limit 10000;
[0m15:41:09.059516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:10.087012 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.036 seconds
[0m15:41:10.111447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37cf7247-6358-449b-9393-d152483537e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD9CEE500>]}
[0m15:41:10.127428 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m15:41:10.127428 [info ] [Thread-1 (]: 1 of 1 START sql incremental model RDL.dim_customers ........................... [RUN]
[0m15:41:10.137183 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.dim_customers'
[0m15:41:10.137183 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m15:41:10.231726 [debug] [Thread-1 (]: Compilation Error in model dim_customers (models\dim_customers.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:41:10.242480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37cf7247-6358-449b-9393-d152483537e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD9CEE500>]}
[0m15:41:10.247041 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model RDL.dim_customers .................. [[31mERROR[0m in 0.10s]
[0m15:41:10.250697 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m15:41:10.250697 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.dim_customers' to be skipped because of status 'error'.  Reason: Compilation Error in model dim_customers (models\dim_customers.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m15:41:10.262658 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:41:10.265755 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m15:41:10.265755 [debug] [MainThread]: On list_DEV: Close
[0m15:41:10.384719 [debug] [MainThread]: Connection 'list_DEV_RDL' was left open.
[0m15:41:10.400159 [debug] [MainThread]: On list_DEV_RDL: Close
[0m15:41:10.529620 [debug] [MainThread]: Connection 'model.ManyPets.dim_customers' was properly closed.
[0m15:41:10.546859 [info ] [MainThread]: 
[0m15:41:10.551197 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.93 seconds (2.93s).
[0m15:41:10.554985 [debug] [MainThread]: Command end result
[0m15:41:10.705756 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m15:41:10.710295 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m15:41:10.724949 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m15:41:10.727181 [info ] [MainThread]: 
[0m15:41:10.729941 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:41:10.731494 [info ] [MainThread]: 
[0m15:41:10.733080 [error] [MainThread]:   Compilation Error in model dim_customers (models\dim_customers.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:41:10.736724 [info ] [MainThread]: 
[0m15:41:10.739735 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:41:10.746057 [debug] [MainThread]: Command `dbt run` failed at 15:41:10.743878 after 6.51 seconds
[0m15:41:10.750672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD8236080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBDBF50310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD857E680>]}
[0m15:41:10.750672 [debug] [MainThread]: Flushing usage events
[0m15:41:11.512742 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:41:23.915475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019922B95FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019924AEA830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019924AEA650>]}


============================== 15:41:23.923608 | 2223502f-c0a0-4a8a-b58d-f11e26c472be ==============================
[0m15:41:23.923608 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:41:23.928275 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:41:24.265888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2223502f-c0a0-4a8a-b58d-f11e26c472be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019924AEA8F0>]}
[0m15:41:24.361362 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:41:24.366385 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:41:24.370028 [debug] [MainThread]: Command `dbt deps` succeeded at 15:41:24.369029 after 0.62 seconds
[0m15:41:24.371124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019922B95FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019924AEA8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019924AEA950>]}
[0m15:41:24.372130 [debug] [MainThread]: Flushing usage events
[0m15:41:25.117778 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:43:30.490363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDDF866050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDE17BAA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDE17BA890>]}


============================== 15:43:30.497597 | 5257676c-0416-4ea8-8544-39a02f142f59 ==============================
[0m15:43:30.497597 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:43:30.503194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:43:30.793450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5257676c-0416-4ea8-8544-39a02f142f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDE17BAB30>]}
[0m15:43:30.868846 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:43:30.875329 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:43:30.880425 [debug] [MainThread]: Command `dbt deps` succeeded at 15:43:30.879412 after 0.63 seconds
[0m15:43:30.881428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDDF866050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDE17BAB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDE17BAB90>]}
[0m15:43:30.881428 [debug] [MainThread]: Flushing usage events
[0m15:43:31.698575 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:44:29.506135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0DAC35F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0DCB8E7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0DCB8E5F0>]}


============================== 15:44:29.513244 | 9be6267e-19ae-49dc-a980-6c907af3f8ed ==============================
[0m15:44:29.513244 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:44:29.519337 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:44:29.923638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9be6267e-19ae-49dc-a980-6c907af3f8ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0D948F0A0>]}
[0m15:44:29.995997 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:44:30.001184 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:44:30.009953 [debug] [MainThread]: Command `dbt deps` succeeded at 15:44:30.009953 after 0.71 seconds
[0m15:44:30.014447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0DAC35F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0DCC70F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0DCC38D90>]}
[0m15:44:30.022858 [debug] [MainThread]: Flushing usage events
[0m15:44:30.743651 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:46:16.358214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F1B805FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F1D75A830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F1D75A680>]}


============================== 15:46:16.364304 | af5ef484-bdc7-47f3-8bdf-37c0d82a164e ==============================
[0m15:46:16.364304 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:46:16.368325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m15:46:16.689892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af5ef484-bdc7-47f3-8bdf-37c0d82a164e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F1D75A8F0>]}
[0m15:46:16.783080 [debug] [MainThread]: Set downloads directory='C:\Users\HP\AppData\Local\Temp\dbt-downloads-k03ypw5v'
[0m15:46:16.785085 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:46:16.927113 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:46:16.927113 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:46:17.023066 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:46:17.094421 [info ] [MainThread]: Updating lock file in file path: C:\Users\HP\Documents\manypets\ManyPets/package-lock.yml
[0m15:46:17.132298 [debug] [MainThread]: Set downloads directory='C:\Users\HP\AppData\Local\Temp\dbt-downloads-pwtja5pj'
[0m15:46:17.162759 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:46:18.078509 [info ] [MainThread]: Installed from version 1.3.0
[0m15:46:18.081118 [info ] [MainThread]: Up to date!
[0m15:46:18.083445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'af5ef484-bdc7-47f3-8bdf-37c0d82a164e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F1AD1A050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F1BB403A0>]}
[0m15:46:18.087512 [debug] [MainThread]: Command `dbt deps` succeeded at 15:46:18.086515 after 1.94 seconds
[0m15:46:18.087512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F1B805FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F1BB403A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F1AD1A050>]}
[0m15:46:18.087512 [debug] [MainThread]: Flushing usage events
[0m15:46:18.715014 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:46:47.024768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186E8C56080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186EAB7E9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186EAB7E830>]}


============================== 15:46:47.032004 | 9d91d9de-1d2b-4a79-bd4f-86f6f9f10476 ==============================
[0m15:46:47.032004 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:46:47.037834 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:46:48.384899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d91d9de-1d2b-4a79-bd4f-86f6f9f10476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186E74D9CC0>]}
[0m15:46:48.496168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d91d9de-1d2b-4a79-bd4f-86f6f9f10476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186EB499810>]}
[0m15:46:48.500173 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:46:49.167661 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:46:49.485488 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m15:46:49.493302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9d91d9de-1d2b-4a79-bd4f-86f6f9f10476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186EA697130>]}
[0m15:46:53.136427 [error] [MainThread]: Encountered an error:
Compilation Error in model dim_customers (models\dim_customers.sql)
  
  Warning: `dbt_utils.surrogate_key` has been replaced by `dbt_utils.generate_surrogate_key`. The new macro treats null values differently to empty strings. To restore the behaviour of the original macro, add a global variable in dbt_project.yml called `surrogate_key_treat_nulls_as_empty_strings` to your dbt_project.yml file with a value of True. The ManyPets.dim_customers model triggered this warning. 
  
  > in macro default__surrogate_key (macros\sql\surrogate_key.sql)
  > called by macro surrogate_key (macros\sql\surrogate_key.sql)
  > called by model dim_customers (models\dim_customers.sql)
[0m15:46:53.150262 [debug] [MainThread]: Command `dbt run` failed at 15:46:53.149263 after 6.31 seconds
[0m15:46:53.152749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186E8C56080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186EB92E260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186EBA73100>]}
[0m15:46:53.158386 [debug] [MainThread]: Flushing usage events
[0m15:46:53.947128 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:48:45.188141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E44A936080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E44C85E9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E44C85E830>]}


============================== 15:48:45.194687 | 353c12f8-1d07-4392-b694-b470e1d67d28 ==============================
[0m15:48:45.194687 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:48:45.199065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_customers', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:48:46.422272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '353c12f8-1d07-4392-b694-b470e1d67d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4491B5CC0>]}
[0m15:48:46.565584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '353c12f8-1d07-4392-b694-b470e1d67d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E44D179810>]}
[0m15:48:46.574413 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:48:47.303557 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:48:47.574246 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m15:48:47.580330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '353c12f8-1d07-4392-b694-b470e1d67d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E44C377130>]}
[0m15:48:51.439260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '353c12f8-1d07-4392-b694-b470e1d67d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E44E80FA30>]}
[0m15:48:51.710290 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m15:48:51.721412 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m15:48:51.805553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '353c12f8-1d07-4392-b694-b470e1d67d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E44E80EEF0>]}
[0m15:48:51.808332 [info ] [MainThread]: Found 6 models, 4 data tests, 2 sources, 590 macros
[0m15:48:51.810887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '353c12f8-1d07-4392-b694-b470e1d67d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E44D524040>]}
[0m15:48:51.810887 [info ] [MainThread]: 
[0m15:48:51.821780 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:48:51.824188 [info ] [MainThread]: 
[0m15:48:51.827801 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:48:51.834589 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m15:48:52.123965 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m15:48:52.123965 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m15:48:52.123965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:53.226364 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.102 seconds
[0m15:48:53.271684 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_RDL'
[0m15:48:53.309367 [debug] [ThreadPool]: Using snowflake connection "list_DEV_RDL"
[0m15:48:53.325044 [debug] [ThreadPool]: On list_DEV_RDL: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_RDL"} */
show objects in DEV.RDL limit 10000;
[0m15:48:53.325044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:53.996204 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.670 seconds
[0m15:48:54.012911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '353c12f8-1d07-4392-b694-b470e1d67d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E44E66A7D0>]}
[0m15:48:54.031594 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m15:48:54.031594 [info ] [Thread-1 (]: 1 of 1 START sql incremental model RDL.dim_customers ........................... [RUN]
[0m15:48:54.036998 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.dim_customers'
[0m15:48:54.036998 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m15:48:54.113056 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m15:48:54.121176 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m15:48:54.287798 [debug] [Thread-1 (]: Dropping relation DEV.RDL.dim_customers because it is a view and this model is a table.
[0m15:48:54.303468 [debug] [Thread-1 (]: Applying DROP to: "DEV"."RDL"."DIM_CUSTOMERS"
[0m15:48:54.319084 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m15:48:54.319084 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
drop view if exists "DEV"."RDL"."DIM_CUSTOMERS" cascade
[0m15:48:54.319084 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:48:54.984431 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.656 seconds
[0m15:48:55.050926 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_customers"
[0m15:48:55.068462 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m15:48:55.068462 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace transient table DEV.RDL.dim_customers
         as
        (

WITH cust_src AS (
    SELECT
        data:detail:customer:first_name::STRING      AS first_name,
        data:detail:customer:last_name::STRING       AS last_name,
        data:detail:customer:dob::DATE               AS dob,
        data:detail:customer:email::STRING           AS email,
        data:detail:customer:phone::STRING           AS phone,
        data:detail:customer:address:line1::STRING   AS address_line1,
        data:detail:customer:address:line2::STRING   AS address_line2,
        data:detail:customer:address:city::STRING    AS city,
        data:detail:customer:address:country::STRING AS country,
        data:detail:customer:address:postcode::STRING AS postcode,
        ingest_date
    FROM dev.rdl.orders

    
)

SELECT
    md5(cast(coalesce(cast(email as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS customer_sk,  -- Generate surrogate key
    email                                    AS customer_nk,  
    COALESCE(NULLIF(TRIM(COALESCE(first_name, '') || ' ' || COALESCE(last_name, '')), ''), 'unknown') AS name,
    dob                                      AS dob,
    email                                    AS email,
    COALESCE(NULLIF(phone, ''), 'unknown')   AS phone,
    address_line1 || ' ' || address_line2    AS address,
    city                                     AS city,
    country                                  AS country,
    postcode                                 AS postcode
FROM cust_src;
[0m15:48:55.499871 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0c90-0000-e3c5-0001-b3ce00016082
[0m15:48:55.499871 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 34 at position 13 unexpected ';'.
[0m15:48:55.499871 [debug] [Thread-1 (]: Database Error in model dim_customers (models\dim_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 34 at position 13 unexpected ';'.
  compiled code at target\run\ManyPets\models\dim_customers.sql
[0m15:48:55.520266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '353c12f8-1d07-4392-b694-b470e1d67d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E44A7A15D0>]}
[0m15:48:55.520266 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model RDL.dim_customers .................. [[31mERROR[0m in 1.46s]
[0m15:48:55.524617 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m15:48:55.524617 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.dim_customers' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers (models\dim_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 34 at position 13 unexpected ';'.
  compiled code at target\run\ManyPets\models\dim_customers.sql.
[0m15:48:55.532019 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:48:55.533610 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m15:48:55.534435 [debug] [MainThread]: On list_DEV: Close
[0m15:48:55.650293 [debug] [MainThread]: Connection 'list_DEV_RDL' was left open.
[0m15:48:55.650293 [debug] [MainThread]: On list_DEV_RDL: Close
[0m15:48:55.773441 [debug] [MainThread]: Connection 'model.ManyPets.dim_customers' was left open.
[0m15:48:55.773441 [debug] [MainThread]: On model.ManyPets.dim_customers: Close
[0m15:48:55.905144 [info ] [MainThread]: 
[0m15:48:55.909936 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.08 seconds (4.08s).
[0m15:48:55.914263 [debug] [MainThread]: Command end result
[0m15:48:56.064941 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m15:48:56.069854 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m15:48:56.090869 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m15:48:56.092361 [info ] [MainThread]: 
[0m15:48:56.096156 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:48:56.098703 [info ] [MainThread]: 
[0m15:48:56.100966 [error] [MainThread]:   Database Error in model dim_customers (models\dim_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 34 at position 13 unexpected ';'.
  compiled code at target\run\ManyPets\models\dim_customers.sql
[0m15:48:56.105038 [info ] [MainThread]: 
[0m15:48:56.107014 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:48:56.111270 [debug] [MainThread]: Command `dbt run` failed at 15:48:56.111270 after 11.12 seconds
[0m15:48:56.111270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E44A936080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E44AC7EA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E44E86B400>]}
[0m15:48:56.111270 [debug] [MainThread]: Flushing usage events
[0m15:48:56.711486 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:49:19.788053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F2C655F60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F2E57EAA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F2E57E8C0>]}


============================== 15:49:19.795010 | 4ba95dbf-dd8f-4f24-ab4d-2a90740e6a5c ==============================
[0m15:49:19.795010 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:49:19.798580 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:49:20.932070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ba95dbf-dd8f-4f24-ab4d-2a90740e6a5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F2E0CA5C0>]}
[0m15:49:21.075666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ba95dbf-dd8f-4f24-ab4d-2a90740e6a5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F2EEF2C80>]}
[0m15:49:21.080884 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:49:21.743581 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:49:22.256552 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:49:22.272211 [debug] [MainThread]: Partial parsing: updated file: ManyPets://models\dim_customers.sql
[0m15:49:23.063476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ba95dbf-dd8f-4f24-ab4d-2a90740e6a5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3053D420>]}
[0m15:49:23.341235 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m15:49:23.348252 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m15:49:23.414796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ba95dbf-dd8f-4f24-ab4d-2a90740e6a5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3053D540>]}
[0m15:49:23.415797 [info ] [MainThread]: Found 6 models, 4 data tests, 2 sources, 590 macros
[0m15:49:23.418504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ba95dbf-dd8f-4f24-ab4d-2a90740e6a5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3053F9D0>]}
[0m15:49:23.419507 [info ] [MainThread]: 
[0m15:49:23.423521 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:49:23.426317 [info ] [MainThread]: 
[0m15:49:23.429608 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:49:23.435103 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m15:49:23.678385 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m15:49:23.678385 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m15:49:23.678385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:24.675055 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.000 seconds
[0m15:49:24.715775 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_RDL'
[0m15:49:24.765659 [debug] [ThreadPool]: Using snowflake connection "list_DEV_RDL"
[0m15:49:24.767616 [debug] [ThreadPool]: On list_DEV_RDL: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_RDL"} */
show objects in DEV.RDL limit 10000;
[0m15:49:24.767616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:25.490913 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.724 seconds
[0m15:49:25.508359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ba95dbf-dd8f-4f24-ab4d-2a90740e6a5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3052E020>]}
[0m15:49:25.525211 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m15:49:25.526228 [info ] [Thread-1 (]: 1 of 1 START sql incremental model RDL.dim_customers ........................... [RUN]
[0m15:49:25.533771 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.dim_customers'
[0m15:49:25.533771 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m15:49:25.601027 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m15:49:25.613878 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m15:49:25.842066 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_customers"
[0m15:49:25.853038 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m15:49:25.853038 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace transient table DEV.RDL.dim_customers
         as
        (

WITH cust_src AS (
    SELECT
        data:detail:customer:first_name::STRING      AS first_name,
        data:detail:customer:last_name::STRING       AS last_name,
        data:detail:customer:dob::DATE               AS dob,
        data:detail:customer:email::STRING           AS email,
        data:detail:customer:phone::STRING           AS phone,
        data:detail:customer:address:line1::STRING   AS address_line1,
        data:detail:customer:address:line2::STRING   AS address_line2,
        data:detail:customer:address:city::STRING    AS city,
        data:detail:customer:address:country::STRING AS country,
        data:detail:customer:address:postcode::STRING AS postcode,
        ingest_date
    FROM dev.rdl.orders

    
)

SELECT
    md5(cast(coalesce(cast(email as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS customer_sk,  -- Generate surrogate key
    email                                    AS customer_nk,  
    COALESCE(NULLIF(TRIM(COALESCE(first_name, '') || ' ' || COALESCE(last_name, '')), ''), 'unknown') AS name,
    dob                                      AS dob,
    email                                    AS email,
    COALESCE(NULLIF(phone, ''), 'unknown')   AS phone,
    address_line1 || ' ' || address_line2    AS address,
    city                                     AS city,
    country                                  AS country,
    postcode                                 AS postcode
FROM cust_src
        );
[0m15:49:25.853038 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:49:28.666703 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.810 seconds
[0m15:49:28.703116 [debug] [Thread-1 (]: Applying DROP to: DEV.RDL.dim_customers__dbt_tmp
[0m15:49:28.724247 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m15:49:28.724247 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
drop view if exists DEV.RDL.dim_customers__dbt_tmp cascade
[0m15:49:28.813651 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.078 seconds
[0m15:49:28.917021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ba95dbf-dd8f-4f24-ab4d-2a90740e6a5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F2ACD0220>]}
[0m15:49:28.917021 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model RDL.dim_customers ...................... [[32mSUCCESS 1[0m in 3.38s]
[0m15:49:28.925547 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m15:49:28.930466 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:28.931465 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m15:49:28.931465 [debug] [MainThread]: On list_DEV: Close
[0m15:49:29.031812 [debug] [MainThread]: Connection 'list_DEV_RDL' was left open.
[0m15:49:29.031812 [debug] [MainThread]: On list_DEV_RDL: Close
[0m15:49:29.148066 [debug] [MainThread]: Connection 'model.ManyPets.dim_customers' was left open.
[0m15:49:29.148066 [debug] [MainThread]: On model.ManyPets.dim_customers: Close
[0m15:49:29.264311 [info ] [MainThread]: 
[0m15:49:29.270394 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.84 seconds (5.84s).
[0m15:49:29.273920 [debug] [MainThread]: Command end result
[0m15:49:29.437639 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m15:49:29.443757 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m15:49:29.472143 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m15:49:29.473595 [info ] [MainThread]: 
[0m15:49:29.476045 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:49:29.477665 [info ] [MainThread]: 
[0m15:49:29.481527 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:49:29.484474 [debug] [MainThread]: Command `dbt run` succeeded at 15:49:29.484474 after 9.86 seconds
[0m15:49:29.487749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F2C655F60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F2C95F580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F30D08B20>]}
[0m15:49:29.487749 [debug] [MainThread]: Flushing usage events
[0m15:49:30.211794 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:58:01.224295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023413156050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234150C29B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234150C27D0>]}


============================== 17:58:01.232538 | b0d68859-c7cb-429c-b42d-0f09593551e1 ==============================
[0m17:58:01.232538 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:58:01.237748 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_orders', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:58:03.678750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0d68859-c7cb-429c-b42d-0f09593551e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234119D5C90>]}
[0m17:58:03.835626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0d68859-c7cb-429c-b42d-0f09593551e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023414F228C0>]}
[0m17:58:03.840659 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:58:04.801917 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:58:05.107673 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:58:05.108429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b0d68859-c7cb-429c-b42d-0f09593551e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023414B97A90>]}
[0m17:58:09.504850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0d68859-c7cb-429c-b42d-0f09593551e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023417030B20>]}
[0m17:58:09.730053 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m17:58:09.771698 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m17:58:09.869193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0d68859-c7cb-429c-b42d-0f09593551e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023416FE0820>]}
[0m17:58:09.871027 [info ] [MainThread]: Found 6 models, 5 data tests, 2 sources, 590 macros
[0m17:58:09.872278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0d68859-c7cb-429c-b42d-0f09593551e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023416FE21A0>]}
[0m17:58:09.875278 [info ] [MainThread]: 
[0m17:58:09.878944 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:58:09.881197 [info ] [MainThread]: 
[0m17:58:09.883040 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:58:09.886746 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m17:58:11.941526 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m17:58:11.944349 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m17:58:11.944862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:12.862048 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.923 seconds
[0m17:58:12.898907 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_RDL'
[0m17:58:12.918477 [debug] [ThreadPool]: Using snowflake connection "list_DEV_RDL"
[0m17:58:12.918477 [debug] [ThreadPool]: On list_DEV_RDL: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_RDL"} */
show objects in DEV.RDL limit 10000;
[0m17:58:12.918477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:13.516412 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.596 seconds
[0m17:58:13.540379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0d68859-c7cb-429c-b42d-0f09593551e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023415CD2A10>]}
[0m17:58:13.568603 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m17:58:13.568603 [info ] [Thread-1 (]: 1 of 1 START sql incremental model RDL.stg_orders .............................. [RUN]
[0m17:58:13.577888 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_orders'
[0m17:58:13.577888 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m17:58:13.611845 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m17:58:13.614537 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m17:58:13.742887 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m17:58:13.748942 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m17:58:13.748942 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace transient table DEV.RDL.stg_orders
         as
        (

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS event_type,
        data:time::TIMESTAMP                            AS event_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
)
SELECT 
    order_id,
    email,
    pet_dob,
    pet_name,
    first_name,
    last_name,
    dob AS customer_dob,
    phone,
    address_line1,
    address_line2,
    city,
    country,
    postcode,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_date,
    cessation_date,
    affiliate_code,
    source,
    event_type,
    event_time,
    ingest_date
FROM source_data
        );
[0m17:58:13.748942 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:58:15.876423 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.125 seconds
[0m17:58:15.916679 [debug] [Thread-1 (]: Applying DROP to: DEV.RDL.stg_orders__dbt_tmp
[0m17:58:15.924105 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m17:58:15.924105 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
drop view if exists DEV.RDL.stg_orders__dbt_tmp cascade
[0m17:58:16.014353 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.085 seconds
[0m17:58:16.090848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0d68859-c7cb-429c-b42d-0f09593551e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023415998E50>]}
[0m17:58:16.090920 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model RDL.stg_orders ......................... [[32mSUCCESS 1[0m in 2.51s]
[0m17:58:16.093926 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m17:58:16.096169 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:16.097173 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m17:58:16.097173 [debug] [MainThread]: On list_DEV: Close
[0m17:58:16.208722 [debug] [MainThread]: Connection 'list_DEV_RDL' was left open.
[0m17:58:16.208722 [debug] [MainThread]: On list_DEV_RDL: Close
[0m17:58:16.330158 [debug] [MainThread]: Connection 'model.ManyPets.stg_orders' was left open.
[0m17:58:16.330158 [debug] [MainThread]: On model.ManyPets.stg_orders: Close
[0m17:58:16.442089 [info ] [MainThread]: 
[0m17:58:16.446177 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.56 seconds (6.56s).
[0m17:58:16.449654 [debug] [MainThread]: Command end result
[0m17:58:16.537013 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m17:58:16.542698 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m17:58:16.556755 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m17:58:16.557669 [info ] [MainThread]: 
[0m17:58:16.558551 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:58:16.560241 [info ] [MainThread]: 
[0m17:58:16.561580 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:58:16.563777 [debug] [MainThread]: Command `dbt run` succeeded at 17:58:16.563777 after 15.59 seconds
[0m17:58:16.564776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023413156050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023413451090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023417872050>]}
[0m17:58:16.564776 [debug] [MainThread]: Flushing usage events
[0m17:58:17.310533 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:00:45.141383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180E97A6080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180EB6CE9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180EB6CE800>]}


============================== 18:00:45.151274 | 91735985-b4ff-4401-84b4-ec273fe6243f ==============================
[0m18:00:45.151274 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:00:45.153893 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_orders', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:00:46.133604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91735985-b4ff-4401-84b4-ec273fe6243f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180EB1EA530>]}
[0m18:00:46.250285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91735985-b4ff-4401-84b4-ec273fe6243f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180EC02A1A0>]}
[0m18:00:46.252996 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:00:46.832922 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:00:47.067568 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:00:47.073242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '91735985-b4ff-4401-84b4-ec273fe6243f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180EB1EB130>]}
[0m18:00:50.496198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91735985-b4ff-4401-84b4-ec273fe6243f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180EB1BFA60>]}
[0m18:00:50.749842 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m18:00:50.757183 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m18:00:50.826261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91735985-b4ff-4401-84b4-ec273fe6243f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180ED4E63B0>]}
[0m18:00:50.827261 [info ] [MainThread]: Found 6 models, 5 data tests, 2 sources, 590 macros
[0m18:00:50.829588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91735985-b4ff-4401-84b4-ec273fe6243f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180ED4E6530>]}
[0m18:00:50.830589 [info ] [MainThread]: 
[0m18:00:50.833340 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:00:50.835923 [info ] [MainThread]: 
[0m18:00:50.836994 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:00:50.840662 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m18:00:51.037119 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m18:00:51.037119 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m18:00:51.037119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:51.849768 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.810 seconds
[0m18:00:51.854010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV, now create_DEV_RDL_staging)
[0m18:00:51.861040 [debug] [ThreadPool]: Creating schema "database: "DEV"
schema: "RDL_staging"
"
[0m18:00:51.869796 [debug] [ThreadPool]: Using snowflake connection "create_DEV_RDL_staging"
[0m18:00:51.869796 [debug] [ThreadPool]: On create_DEV_RDL_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "create_DEV_RDL_staging"} */
create schema if not exists DEV.RDL_staging
[0m18:00:52.046660 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.170 seconds
[0m18:00:52.075684 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_RDL'
[0m18:00:52.111369 [debug] [ThreadPool]: Using snowflake connection "list_DEV_RDL"
[0m18:00:52.111369 [debug] [ThreadPool]: On list_DEV_RDL: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_RDL"} */
show objects in DEV.RDL limit 10000;
[0m18:00:52.111369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:52.847202 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.731 seconds
[0m18:00:52.847202 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_RDL, now list_DEV_RDL_staging)
[0m18:00:52.860843 [debug] [ThreadPool]: Using snowflake connection "list_DEV_RDL_staging"
[0m18:00:52.869015 [debug] [ThreadPool]: On list_DEV_RDL_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_RDL_staging"} */
show objects in DEV.RDL_staging limit 10000;
[0m18:00:52.961450 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.091 seconds
[0m18:00:52.969798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91735985-b4ff-4401-84b4-ec273fe6243f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180ED4E71C0>]}
[0m18:00:52.987207 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m18:00:52.987207 [info ] [Thread-1 (]: 1 of 1 START sql incremental model RDL_staging.stg_orders ...................... [RUN]
[0m18:00:52.994582 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_orders'
[0m18:00:52.996194 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m18:00:53.028998 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m18:00:53.031172 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m18:00:53.135025 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m18:00:53.144148 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m18:00:53.144148 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace transient table DEV.RDL_staging.stg_orders
         as
        (

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS event_type,
        data:time::TIMESTAMP                            AS event_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
)
SELECT 
    order_id,
    email,
    pet_dob,
    pet_name,
    first_name,
    last_name,
    dob AS customer_dob,
    phone,
    address_line1,
    address_line2,
    city,
    country,
    postcode,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_date,
    cessation_date,
    affiliate_code,
    source,
    event_type,
    event_time,
    ingest_date
FROM source_data
        );
[0m18:00:53.144148 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:00:54.894810 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.747 seconds
[0m18:00:54.908958 [debug] [Thread-1 (]: Applying DROP to: DEV.RDL_staging.stg_orders__dbt_tmp
[0m18:00:54.926935 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m18:00:54.926935 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
drop view if exists DEV.RDL_staging.stg_orders__dbt_tmp cascade
[0m18:00:55.001012 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.074 seconds
[0m18:00:55.062880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91735985-b4ff-4401-84b4-ec273fe6243f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180ED5058A0>]}
[0m18:00:55.063884 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model RDL_staging.stg_orders ................. [[32mSUCCESS 1[0m in 2.07s]
[0m18:00:55.066300 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m18:00:55.068440 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:55.069440 [debug] [MainThread]: Connection 'create_DEV_RDL_staging' was left open.
[0m18:00:55.069440 [debug] [MainThread]: On create_DEV_RDL_staging: Close
[0m18:00:55.179029 [debug] [MainThread]: Connection 'list_DEV_RDL_staging' was left open.
[0m18:00:55.179029 [debug] [MainThread]: On list_DEV_RDL_staging: Close
[0m18:00:55.284250 [debug] [MainThread]: Connection 'model.ManyPets.stg_orders' was left open.
[0m18:00:55.292775 [debug] [MainThread]: On model.ManyPets.stg_orders: Close
[0m18:00:55.409579 [info ] [MainThread]: 
[0m18:00:55.412639 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.57 seconds (4.57s).
[0m18:00:55.418274 [debug] [MainThread]: Command end result
[0m18:00:55.504053 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m18:00:55.509877 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m18:00:55.522342 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m18:00:55.524493 [info ] [MainThread]: 
[0m18:00:55.526492 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:00:55.527492 [info ] [MainThread]: 
[0m18:00:55.528573 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:00:55.530951 [debug] [MainThread]: Command `dbt run` succeeded at 18:00:55.530951 after 10.61 seconds
[0m18:00:55.531976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180E97A6080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180EB6CEAA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180EB21B130>]}
[0m18:00:55.531976 [debug] [MainThread]: Flushing usage events
[0m18:00:56.039135 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:05:32.425219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028110366020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002811228EB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002811228E9B0>]}


============================== 18:05:32.432104 | 67c3a1e4-403e-4704-8b31-48cd46640916 ==============================
[0m18:05:32.432104 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:05:32.435166 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_orders', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:05:33.148744 [error] [MainThread]: Encountered an error:
Compilation Error
  Could not render {{ generate_schema_name('staging', node) }}: 'generate_schema_name' is undefined
[0m18:05:33.151751 [debug] [MainThread]: Command `dbt run` failed at 18:05:33.150788 after 0.87 seconds
[0m18:05:33.151751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028110366020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028112BED120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028112BECCD0>]}
[0m18:05:33.152754 [debug] [MainThread]: Flushing usage events
[0m18:05:33.860084 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:05:56.134509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214EA826020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214EC77A860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214EC77A680>]}


============================== 18:05:56.140576 | 28e1ea67-a281-449f-8dbd-5bd754d344c1 ==============================
[0m18:05:56.140576 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:05:56.144049 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m18:05:56.158076 [error] [MainThread]: Encountered an error:
Compilation Error
  Could not render {{ generate_schema_name('staging', node) }}: 'generate_schema_name' is undefined
[0m18:05:56.161610 [debug] [MainThread]: Command `dbt deps` failed at 18:05:56.161610 after 0.16 seconds
[0m18:05:56.161610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214EA826020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214EC759870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214EC75A5F0>]}
[0m18:05:56.165318 [debug] [MainThread]: Flushing usage events
[0m18:05:56.773617 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:10:26.953521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FF9135FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FFB05EB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FFB05E950>]}


============================== 18:10:26.959946 | d07125f6-f627-4d9e-8eeb-897d81e8ccdf ==============================
[0m18:10:26.959946 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:10:26.963471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_orders', 'send_anonymous_usage_stats': 'True'}
[0m18:10:27.927647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd07125f6-f627-4d9e-8eeb-897d81e8ccdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FFAB77790>]}
[0m18:10:28.037289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd07125f6-f627-4d9e-8eeb-897d81e8ccdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FFAECB2B0>]}
[0m18:10:28.046643 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:10:28.605545 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:10:29.035580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:10:29.035580 [debug] [MainThread]: Partial parsing: added file: ManyPets://macros\generate_schema_name.sql
[0m18:10:29.035580 [info ] [MainThread]: Unable to do partial parsing because change detected to override macro. Starting full parse.
[0m18:10:31.892120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd07125f6-f627-4d9e-8eeb-897d81e8ccdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FFD08BA00>]}
[0m18:10:32.081010 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m18:10:32.095926 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m18:10:32.182681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd07125f6-f627-4d9e-8eeb-897d81e8ccdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FFCEABC70>]}
[0m18:10:32.184679 [info ] [MainThread]: Found 6 models, 5 data tests, 2 sources, 591 macros
[0m18:10:32.186479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd07125f6-f627-4d9e-8eeb-897d81e8ccdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FFCEABD30>]}
[0m18:10:32.188597 [info ] [MainThread]: 
[0m18:10:32.191023 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:10:32.192364 [info ] [MainThread]: 
[0m18:10:32.195336 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:10:32.198512 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m18:10:32.398289 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m18:10:32.398289 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m18:10:32.398289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:33.557329 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.158 seconds
[0m18:10:33.567710 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV, now create_DEV_staging)
[0m18:10:33.572288 [debug] [ThreadPool]: Creating schema "database: "DEV"
schema: "staging"
"
[0m18:10:33.590541 [debug] [ThreadPool]: Using snowflake connection "create_DEV_staging"
[0m18:10:33.590541 [debug] [ThreadPool]: On create_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "create_DEV_staging"} */
create schema if not exists DEV.staging
[0m18:10:33.736525 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.152 seconds
[0m18:10:33.784976 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_RDL'
[0m18:10:33.821740 [debug] [ThreadPool]: Using snowflake connection "list_DEV_RDL"
[0m18:10:33.821740 [debug] [ThreadPool]: On list_DEV_RDL: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_RDL"} */
show objects in DEV.RDL limit 10000;
[0m18:10:33.821740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:34.409608 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.579 seconds
[0m18:10:34.409608 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_RDL, now list_DEV_staging)
[0m18:10:34.423926 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m18:10:34.423926 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m18:10:34.550838 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.117 seconds
[0m18:10:34.556794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd07125f6-f627-4d9e-8eeb-897d81e8ccdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FFCF52290>]}
[0m18:10:34.573422 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m18:10:34.574420 [info ] [Thread-1 (]: 1 of 1 START sql incremental model staging.stg_orders .......................... [RUN]
[0m18:10:34.576423 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_orders'
[0m18:10:34.577421 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m18:10:34.611185 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m18:10:34.613279 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m18:10:34.740268 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m18:10:34.745445 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m18:10:34.745445 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace transient table DEV.staging.stg_orders
         as
        (

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS event_type,
        data:time::TIMESTAMP                            AS event_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
)
SELECT 
    order_id,
    email,
    pet_dob,
    pet_name,
    first_name,
    last_name,
    dob AS customer_dob,
    phone,
    address_line1,
    address_line2,
    city,
    country,
    postcode,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_date,
    cessation_date,
    affiliate_code,
    source,
    event_type,
    event_time,
    ingest_date
FROM source_data
        );
[0m18:10:34.745445 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:10:35.990237 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.247 seconds
[0m18:10:36.005918 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_orders__dbt_tmp
[0m18:10:36.026028 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m18:10:36.026028 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
drop view if exists DEV.staging.stg_orders__dbt_tmp cascade
[0m18:10:36.084843 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.066 seconds
[0m18:10:36.156091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd07125f6-f627-4d9e-8eeb-897d81e8ccdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FF77B0280>]}
[0m18:10:36.157084 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model staging.stg_orders ..................... [[32mSUCCESS 1[0m in 1.57s]
[0m18:10:36.159430 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m18:10:36.161800 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:36.162803 [debug] [MainThread]: Connection 'create_DEV_staging' was left open.
[0m18:10:36.162803 [debug] [MainThread]: On create_DEV_staging: Close
[0m18:10:36.326560 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m18:10:36.326560 [debug] [MainThread]: On list_DEV_staging: Close
[0m18:10:36.444216 [debug] [MainThread]: Connection 'model.ManyPets.stg_orders' was left open.
[0m18:10:36.444216 [debug] [MainThread]: On model.ManyPets.stg_orders: Close
[0m18:10:36.545812 [info ] [MainThread]: 
[0m18:10:36.563841 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.35 seconds (4.35s).
[0m18:10:36.568879 [debug] [MainThread]: Command end result
[0m18:10:36.666565 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m18:10:36.671927 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m18:10:36.687205 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m18:10:36.688502 [info ] [MainThread]: 
[0m18:10:36.690594 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:10:36.691966 [info ] [MainThread]: 
[0m18:10:36.692971 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:10:36.695318 [debug] [MainThread]: Command `dbt run` succeeded at 18:10:36.695318 after 9.91 seconds
[0m18:10:36.695318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FF9135FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FFA45DA20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FFA4029E0>]}
[0m18:10:36.695318 [debug] [MainThread]: Flushing usage events
[0m18:10:37.529756 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:44:09.727618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018169E66020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001816BD8EB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001816BD8E9B0>]}


============================== 18:44:09.736370 | b6c7b655-c371-4843-b815-ec7dbb224d7f ==============================
[0m18:44:09.736370 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:44:09.739674 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_orders', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:44:10.784283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6c7b655-c371-4843-b815-ec7dbb224d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001816BD27B80>]}
[0m18:44:10.890380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6c7b655-c371-4843-b815-ec7dbb224d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001816BC31B70>]}
[0m18:44:10.892438 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:44:11.463422 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:44:12.200733 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:44:12.202734 [debug] [MainThread]: Partial parsing: updated file: ManyPets://models\staging\stg_orders.sql
[0m18:44:13.041035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6c7b655-c371-4843-b815-ec7dbb224d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001816DF120B0>]}
[0m18:44:13.248895 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m18:44:13.268662 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m18:44:13.341212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6c7b655-c371-4843-b815-ec7dbb224d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001816DE99240>]}
[0m18:44:13.343217 [info ] [MainThread]: Found 6 models, 5 data tests, 2 sources, 591 macros
[0m18:44:13.345434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6c7b655-c371-4843-b815-ec7dbb224d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001816DBC0640>]}
[0m18:44:13.347432 [info ] [MainThread]: 
[0m18:44:13.349639 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:44:13.352238 [info ] [MainThread]: 
[0m18:44:13.354231 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:44:13.357850 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m18:44:13.689550 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m18:44:13.691599 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m18:44:13.691599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:14.677996 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.987 seconds
[0m18:44:14.713132 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m18:44:14.731609 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m18:44:14.731609 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m18:44:14.731609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:15.084121 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.354 seconds
[0m18:44:15.084121 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_RDL)
[0m18:44:15.101038 [debug] [ThreadPool]: Using snowflake connection "list_DEV_RDL"
[0m18:44:15.101038 [debug] [ThreadPool]: On list_DEV_RDL: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_RDL"} */
show objects in DEV.RDL limit 10000;
[0m18:44:15.240879 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.128 seconds
[0m18:44:15.256595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6c7b655-c371-4843-b815-ec7dbb224d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001816C696680>]}
[0m18:44:15.277898 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m18:44:15.278897 [info ] [Thread-1 (]: 1 of 1 START sql incremental model staging.stg_orders .......................... [RUN]
[0m18:44:15.281072 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_orders'
[0m18:44:15.282093 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m18:44:15.306576 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m18:44:15.309589 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m18:44:15.414001 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m18:44:15.423259 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m18:44:15.423259 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace transient table DEV.staging.stg_orders
         as
        (

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS event_type,
        data:time::TIMESTAMP                            AS event_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
),
dedup AS
(
    SELECT
        *
        ,ROW_NUMBER() OVER(PARTITION BY order_id, email, pet_dob, pet_name,pet_breed  ORDER BY ingest_date) AS rnk
    FROM source_data
)
SELECT 
    order_id,
    email,
    pet_dob,
    pet_name,
    first_name,
    last_name,
    dob AS customer_dob,
    phone,
    address_line1,
    address_line2,
    city,
    country,
    postcode,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_date,
    cessation_date,
    affiliate_code,
    source,
    event_type,
    event_time,
    ingest_date
FROM source_data
WHERE 
    rnk =1
        );
[0m18:44:15.423259 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:44:16.636040 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0d3f-0000-e37b-0001-b3ce0001b09a
[0m18:44:16.636040 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 76 at position 4
invalid identifier 'RNK'
[0m18:44:16.674294 [debug] [Thread-1 (]: Database Error in model stg_orders (models\staging\stg_orders.sql)
  000904 (42000): SQL compilation error: error line 76 at position 4
  invalid identifier 'RNK'
  compiled code at target\run\ManyPets\models\staging\stg_orders.sql
[0m18:44:16.680960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6c7b655-c371-4843-b815-ec7dbb224d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001816E5693F0>]}
[0m18:44:16.680960 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model staging.stg_orders ................. [[31mERROR[0m in 1.40s]
[0m18:44:16.685930 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m18:44:16.685930 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models\staging\stg_orders.sql)
  000904 (42000): SQL compilation error: error line 76 at position 4
  invalid identifier 'RNK'
  compiled code at target\run\ManyPets\models\staging\stg_orders.sql.
[0m18:44:16.692806 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:44:16.694181 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m18:44:16.695111 [debug] [MainThread]: On list_DEV: Close
[0m18:44:16.806331 [debug] [MainThread]: Connection 'list_DEV_RDL' was left open.
[0m18:44:16.806331 [debug] [MainThread]: On list_DEV_RDL: Close
[0m18:44:16.922549 [debug] [MainThread]: Connection 'model.ManyPets.stg_orders' was left open.
[0m18:44:16.922549 [debug] [MainThread]: On model.ManyPets.stg_orders: Close
[0m18:44:17.065857 [info ] [MainThread]: 
[0m18:44:17.069794 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.71 seconds (3.71s).
[0m18:44:17.073662 [debug] [MainThread]: Command end result
[0m18:44:17.151536 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m18:44:17.156440 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m18:44:17.170829 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m18:44:17.171842 [info ] [MainThread]: 
[0m18:44:17.175048 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:44:17.176123 [info ] [MainThread]: 
[0m18:44:17.177540 [error] [MainThread]:   Database Error in model stg_orders (models\staging\stg_orders.sql)
  000904 (42000): SQL compilation error: error line 76 at position 4
  invalid identifier 'RNK'
  compiled code at target\run\ManyPets\models\staging\stg_orders.sql
[0m18:44:17.180792 [info ] [MainThread]: 
[0m18:44:17.182563 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:44:17.184839 [debug] [MainThread]: Command `dbt run` failed at 18:44:17.184839 after 7.68 seconds
[0m18:44:17.186487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018169E66020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001816BC31B70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001816DE995D0>]}
[0m18:44:17.188062 [debug] [MainThread]: Flushing usage events
[0m18:44:18.043237 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:44:50.904847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191EC916020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191EE83EB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191EE83E9B0>]}


============================== 18:44:50.910422 | d1f42e56-4fb0-4a34-9e04-751598bf38f0 ==============================
[0m18:44:50.910422 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:44:50.914462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_orders', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:44:51.918909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1f42e56-4fb0-4a34-9e04-751598bf38f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191EE7D7B80>]}
[0m18:44:52.039504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1f42e56-4fb0-4a34-9e04-751598bf38f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191EE6E1B70>]}
[0m18:44:52.049240 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:44:52.741749 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:44:53.240492 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:44:53.240492 [debug] [MainThread]: Partial parsing: updated file: ManyPets://models\staging\stg_orders.sql
[0m18:44:54.124799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1f42e56-4fb0-4a34-9e04-751598bf38f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191F09C20B0>]}
[0m18:44:54.341571 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m18:44:54.348773 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m18:44:54.419311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1f42e56-4fb0-4a34-9e04-751598bf38f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191F09A8880>]}
[0m18:44:54.421300 [info ] [MainThread]: Found 6 models, 5 data tests, 2 sources, 591 macros
[0m18:44:54.422723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1f42e56-4fb0-4a34-9e04-751598bf38f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191F0670490>]}
[0m18:44:54.423723 [info ] [MainThread]: 
[0m18:44:54.426613 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:44:54.427751 [info ] [MainThread]: 
[0m18:44:54.430701 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:44:54.433777 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m18:44:54.604850 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m18:44:54.604850 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m18:44:54.604850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:55.313242 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.695 seconds
[0m18:44:55.349235 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_RDL'
[0m18:44:55.376600 [debug] [ThreadPool]: Using snowflake connection "list_DEV_RDL"
[0m18:44:55.376600 [debug] [ThreadPool]: On list_DEV_RDL: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_RDL"} */
show objects in DEV.RDL limit 10000;
[0m18:44:55.376600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:56.035180 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.649 seconds
[0m18:44:56.035180 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_RDL, now list_DEV_staging)
[0m18:44:56.061313 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m18:44:56.061313 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m18:44:56.177515 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.107 seconds
[0m18:44:56.186999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1f42e56-4fb0-4a34-9e04-751598bf38f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191F09ABE20>]}
[0m18:44:56.206044 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m18:44:56.206044 [info ] [Thread-1 (]: 1 of 1 START sql incremental model staging.stg_orders .......................... [RUN]
[0m18:44:56.213272 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_orders'
[0m18:44:56.213272 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m18:44:56.252563 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m18:44:56.252563 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m18:44:56.354995 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m18:44:56.363057 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m18:44:56.363057 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace transient table DEV.staging.stg_orders
         as
        (

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS event_type,
        data:time::TIMESTAMP                            AS event_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
),
dedup AS
(
    SELECT
        *
        ,ROW_NUMBER() OVER(PARTITION BY order_id, email, pet_dob, pet_name,pet_breed  ORDER BY ingest_date) AS rnk
    FROM source_data
)
SELECT 
    order_id,
    email,
    pet_dob,
    pet_name,
    first_name,
    last_name,
    dob AS customer_dob,
    phone,
    address_line1,
    address_line2,
    city,
    country,
    postcode,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_date,
    cessation_date,
    affiliate_code,
    source,
    event_type,
    event_time,
    ingest_date
FROM dedup
WHERE 
    rnk =1
        );
[0m18:44:56.363057 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:44:58.584926 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.227 seconds
[0m18:44:58.616331 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_orders__dbt_tmp
[0m18:44:58.624402 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m18:44:58.624402 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
drop view if exists DEV.staging.stg_orders__dbt_tmp cascade
[0m18:44:58.699321 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.069 seconds
[0m18:44:58.742663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1f42e56-4fb0-4a34-9e04-751598bf38f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191F111FDC0>]}
[0m18:44:58.743668 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model staging.stg_orders ..................... [[32mSUCCESS 1[0m in 2.52s]
[0m18:44:58.746817 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m18:44:58.749429 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:44:58.750579 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m18:44:58.752232 [debug] [MainThread]: On list_DEV: Close
[0m18:44:58.850275 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m18:44:58.850275 [debug] [MainThread]: On list_DEV_staging: Close
[0m18:44:58.960879 [debug] [MainThread]: Connection 'model.ManyPets.stg_orders' was left open.
[0m18:44:58.960879 [debug] [MainThread]: On model.ManyPets.stg_orders: Close
[0m18:44:59.087032 [info ] [MainThread]: 
[0m18:44:59.094532 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.66 seconds (4.66s).
[0m18:44:59.098351 [debug] [MainThread]: Command end result
[0m18:44:59.214338 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m18:44:59.218067 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m18:44:59.233043 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m18:44:59.234454 [info ] [MainThread]: 
[0m18:44:59.235570 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:44:59.237689 [info ] [MainThread]: 
[0m18:44:59.239051 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:44:59.242083 [debug] [MainThread]: Command `dbt run` succeeded at 18:44:59.242083 after 8.51 seconds
[0m18:44:59.243900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191EC916020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191EE6E1B70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191ECC10F40>]}
[0m18:44:59.244909 [debug] [MainThread]: Flushing usage events
[0m18:45:00.032529 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:00:03.291050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F56866050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F5878EBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F5878EA10>]}


============================== 19:00:03.296894 | 860c18dc-d9bd-4342-9bc7-003b3b95aa7b ==============================
[0m19:00:03.296894 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:00:03.300225 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_order_complete', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:00:04.234862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '860c18dc-d9bd-4342-9bc7-003b3b95aa7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F58727CD0>]}
[0m19:00:04.356641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '860c18dc-d9bd-4342-9bc7-003b3b95aa7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F585FB250>]}
[0m19:00:04.360989 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:00:04.887215 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:00:05.374039 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:00:05.374039 [debug] [MainThread]: Partial parsing: updated file: ManyPets://models\staging\stg_orders.sql
[0m19:00:05.374039 [debug] [MainThread]: Partial parsing: updated file: ManyPets://models\staging\stg_order_complete.sql
[0m19:00:06.294088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '860c18dc-d9bd-4342-9bc7-003b3b95aa7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F5A925C00>]}
[0m19:00:06.500505 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m19:00:06.509548 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m19:00:06.579648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '860c18dc-d9bd-4342-9bc7-003b3b95aa7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F5A9116F0>]}
[0m19:00:06.581582 [info ] [MainThread]: Found 6 models, 5 data tests, 2 sources, 591 macros
[0m19:00:06.582788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '860c18dc-d9bd-4342-9bc7-003b3b95aa7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F5A9131F0>]}
[0m19:00:06.583793 [info ] [MainThread]: 
[0m19:00:06.587139 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:00:06.589822 [info ] [MainThread]: 
[0m19:00:06.591981 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:00:06.595355 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m19:00:06.787158 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m19:00:06.787158 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m19:00:06.787158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:07.696303 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.922 seconds
[0m19:00:07.744381 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_RDL'
[0m19:00:07.778812 [debug] [ThreadPool]: Using snowflake connection "list_DEV_RDL"
[0m19:00:07.778812 [debug] [ThreadPool]: On list_DEV_RDL: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_RDL"} */
show objects in DEV.RDL limit 10000;
[0m19:00:07.778812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:08.320730 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.542 seconds
[0m19:00:08.320730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_RDL, now list_DEV_staging)
[0m19:00:08.341745 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m19:00:08.358335 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m19:00:08.495679 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.137 seconds
[0m19:00:08.509229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '860c18dc-d9bd-4342-9bc7-003b3b95aa7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F590A26E0>]}
[0m19:00:08.527196 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_order_complete
[0m19:00:08.527196 [info ] [Thread-1 (]: 1 of 1 START sql incremental model staging.stg_order_complete .................. [RUN]
[0m19:00:08.534152 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_order_complete'
[0m19:00:08.534152 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_order_complete
[0m19:00:08.617357 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_order_complete"
[0m19:00:08.643477 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_order_complete
[0m19:00:08.820463 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_order_complete"
[0m19:00:08.826397 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m19:00:08.826397 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
create or replace transient table DEV.staging.stg_order_complete
         as
        (

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING AS order_id,
        data:detail:intent::STRING AS intent,
        data:detail:tenant::STRING AS tenant,
        data:detail:customer_id::STRING AS customer_id,
        pet.value AS pet_id,  
        data:time::TIMESTAMP AS event_time,
        data:source::STRING AS source,
        data:type::STRING AS event_type,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pet_ids) AS pet  

    
)
SELECT 
    order_id,
    customer_id,
    pet_id,
    intent,
    tenant,
    event_time,
    source,
    event_type,
    ingest_date
FROM source_data
        );
[0m19:00:08.826397 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:00:10.335305 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.515 seconds
[0m19:00:10.352900 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_order_complete__dbt_tmp
[0m19:00:10.375177 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m19:00:10.375177 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
drop view if exists DEV.staging.stg_order_complete__dbt_tmp cascade
[0m19:00:10.484865 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.111 seconds
[0m19:00:10.550993 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '860c18dc-d9bd-4342-9bc7-003b3b95aa7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F5B075C30>]}
[0m19:00:10.553002 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model staging.stg_order_complete ............. [[32mSUCCESS 1[0m in 2.00s]
[0m19:00:10.555284 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_order_complete
[0m19:00:10.557236 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:10.558236 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m19:00:10.558236 [debug] [MainThread]: On list_DEV: Close
[0m19:00:10.663128 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m19:00:10.663128 [debug] [MainThread]: On list_DEV_staging: Close
[0m19:00:10.774889 [debug] [MainThread]: Connection 'model.ManyPets.stg_order_complete' was left open.
[0m19:00:10.774889 [debug] [MainThread]: On model.ManyPets.stg_order_complete: Close
[0m19:00:10.886660 [info ] [MainThread]: 
[0m19:00:10.904438 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.30 seconds (4.30s).
[0m19:00:10.908923 [debug] [MainThread]: Command end result
[0m19:00:11.090093 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m19:00:11.094419 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m19:00:11.106959 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m19:00:11.107958 [info ] [MainThread]: 
[0m19:00:11.109540 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:00:11.111542 [info ] [MainThread]: 
[0m19:00:11.112544 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:00:11.115156 [debug] [MainThread]: Command `dbt run` succeeded at 19:00:11.115156 after 7.97 seconds
[0m19:00:11.115156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F56866050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F5B10C3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F5B10C400>]}
[0m19:00:11.115156 [debug] [MainThread]: Flushing usage events
[0m19:00:11.789609 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:14:02.118277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DB3C16050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DB5B3E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DB5B3E7D0>]}


============================== 19:14:02.123111 | 32c144a7-101e-495e-9bdb-27ef3bf28d06 ==============================
[0m19:14:02.123111 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:14:02.126127 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_orders', 'send_anonymous_usage_stats': 'True'}
[0m19:14:03.063193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32c144a7-101e-495e-9bdb-27ef3bf28d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DB56CA500>]}
[0m19:14:03.179774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32c144a7-101e-495e-9bdb-27ef3bf28d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DB59E28C0>]}
[0m19:14:03.182730 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:14:03.755227 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:14:03.972937 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:14:03.975891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '32c144a7-101e-495e-9bdb-27ef3bf28d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DB5657A90>]}
[0m19:14:07.237153 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named stg_orders. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for stg_orders in one of these files:
   - models\fact\schema.yml
  models\dim\schema.yml
[0m19:14:07.248060 [debug] [MainThread]: Command `dbt run` failed at 19:14:07.248060 after 5.27 seconds
[0m19:14:07.251055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DB3C16050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DB7B7D150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DB7AA51E0>]}
[0m19:14:07.251055 [debug] [MainThread]: Flushing usage events
[0m19:14:08.053939 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:20:11.363837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263830B5FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026384FDEB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026384FDE950>]}


============================== 20:20:11.372691 | 7e233efb-158a-46fe-b831-09874dedbb34 ==============================
[0m20:20:11.372691 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:20:11.374850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select dim_customers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:20:12.504910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e233efb-158a-46fe-b831-09874dedbb34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026384B29150>]}
[0m20:20:12.645057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e233efb-158a-46fe-b831-09874dedbb34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026384E4B2B0>]}
[0m20:20:12.652895 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:20:13.256227 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:20:13.507837 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:20:13.511935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7e233efb-158a-46fe-b831-09874dedbb34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026384AF6560>]}
[0m20:20:15.901651 [error] [MainThread]: Encountered an error:
Compilation Error in model dim_customers (models\dim\dim_customers.sql)
  
  Warning: `dbt_utils.surrogate_key` has been replaced by `dbt_utils.generate_surrogate_key`. The new macro treats null values differently to empty strings. To restore the behaviour of the original macro, add a global variable in dbt_project.yml called `surrogate_key_treat_nulls_as_empty_strings` to your dbt_project.yml file with a value of True. The ManyPets.dim_customers model triggered this warning. 
  
  > in macro default__surrogate_key (macros\sql\surrogate_key.sql)
  > called by macro surrogate_key (macros\sql\surrogate_key.sql)
  > called by model dim_customers (models\dim\dim_customers.sql)
[0m20:20:15.907993 [debug] [MainThread]: Command `dbt run` failed at 20:20:15.907000 after 4.72 seconds
[0m20:20:15.907993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263830B5FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026385DC7490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026386EC0B80>]}
[0m20:20:15.907993 [debug] [MainThread]: Flushing usage events
[0m20:20:16.658905 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:29:19.711099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150132C60B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150151EEC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150151EEA40>]}


============================== 20:29:19.717900 | 873fd7e6-6c7f-4d02-93e6-95876b1ea62a ==============================
[0m20:29:19.717900 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:29:19.720983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_customers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:29:20.715717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '873fd7e6-6c7f-4d02-93e6-95876b1ea62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015014D04B80>]}
[0m20:29:20.847513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '873fd7e6-6c7f-4d02-93e6-95876b1ea62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015015AA3490>]}
[0m20:29:20.851486 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:29:21.404908 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:29:21.644801 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:29:21.645921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '873fd7e6-6c7f-4d02-93e6-95876b1ea62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015014D04BB0>]}
[0m20:29:24.714066 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named stg_orders. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for stg_orders in one of these files:
   - models\fact\schema.yml
  models\dim\schema.yml
[0m20:29:24.722450 [debug] [MainThread]: Command `dbt run` failed at 20:29:24.721452 after 5.17 seconds
[0m20:29:24.722450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150132C60B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001501722D210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015017154730>]}
[0m20:29:24.722450 [debug] [MainThread]: Flushing usage events
[0m20:29:25.342767 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:31:44.284762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E1F766020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E2168EB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E2168E9B0>]}


============================== 20:31:44.291062 | 2ab16ea1-f72e-49cc-867f-ad3a641ebb76 ==============================
[0m20:31:44.291062 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:31:44.295657 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:31:45.527471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ab16ea1-f72e-49cc-867f-ad3a641ebb76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E1E7E9C60>]}
[0m20:31:45.635283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ab16ea1-f72e-49cc-867f-ad3a641ebb76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E21531B70>]}
[0m20:31:45.644376 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:31:46.253295 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:31:46.596704 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:31:46.597706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2ab16ea1-f72e-49cc-867f-ad3a641ebb76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E211A9540>]}
[0m20:31:49.604624 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_orders2' in the 'models' section of file 'models\dim\dim_schema.yml'
[0m20:31:49.864664 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_orders1' in the 'models' section of file 'models\fact\fact_schema.yml'
[0m20:31:49.924618 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.ManyPets.not_null_stg_orders2_order_id.d3438ce23d' (models\dim\dim_schema.yml) depends on a node named 'stg_orders2' in package '' which was not found
[0m20:31:49.932824 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.ManyPets.not_null_stg_orders2_email.64ae1bc586' (models\dim\dim_schema.yml) depends on a node named 'stg_orders2' in package '' which was not found
[0m20:31:49.935057 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.ManyPets.not_null_stg_orders2_pet_dob.1327620a96' (models\dim\dim_schema.yml) depends on a node named 'stg_orders2' in package '' which was not found
[0m20:31:49.935922 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.ManyPets.not_null_stg_orders2_pet_name.97bbdce016' (models\dim\dim_schema.yml) depends on a node named 'stg_orders2' in package '' which was not found
[0m20:31:49.939164 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.ManyPets.not_null_stg_orders2_ingest_date.6dba7bea1e' (models\dim\dim_schema.yml) depends on a node named 'stg_orders2' in package '' which was not found
[0m20:31:49.942193 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.ManyPets.not_null_stg_orders1_order_id.8dc0115892' (models\fact\fact_schema.yml) depends on a node named 'stg_orders1' in package '' which was not found
[0m20:31:49.945310 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.ManyPets.not_null_stg_orders1_email.19971998ca' (models\fact\fact_schema.yml) depends on a node named 'stg_orders1' in package '' which was not found
[0m20:31:49.948369 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.ManyPets.not_null_stg_orders1_pet_dob.39f63e4fb9' (models\fact\fact_schema.yml) depends on a node named 'stg_orders1' in package '' which was not found
[0m20:31:49.950403 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.ManyPets.not_null_stg_orders1_pet_name.d1f480a56d' (models\fact\fact_schema.yml) depends on a node named 'stg_orders1' in package '' which was not found
[0m20:31:49.960600 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.ManyPets.not_null_stg_orders1_ingest_date.89a4fe9129' (models\fact\fact_schema.yml) depends on a node named 'stg_orders1' in package '' which was not found
[0m20:31:50.180953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ab16ea1-f72e-49cc-867f-ad3a641ebb76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E236CF130>]}
[0m20:31:50.437489 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:31:50.449793 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:31:50.533711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ab16ea1-f72e-49cc-867f-ad3a641ebb76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E2365F1F0>]}
[0m20:31:50.535712 [info ] [MainThread]: Found 6 models, 5 data tests, 2 sources, 591 macros
[0m20:31:50.536563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ab16ea1-f72e-49cc-867f-ad3a641ebb76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E235F7430>]}
[0m20:31:50.540704 [info ] [MainThread]: 
[0m20:31:50.541596 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:31:50.543839 [info ] [MainThread]: 
[0m20:31:50.547493 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:31:50.552704 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m20:31:50.878170 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m20:31:50.878170 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m20:31:50.878170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:31:52.771643 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.893 seconds
[0m20:31:52.812748 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m20:31:52.845574 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m20:31:52.845574 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m20:31:52.845574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:31:53.681001 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.832 seconds
[0m20:31:53.687941 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m20:31:53.711899 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m20:31:53.711899 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m20:31:53.887372 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.172 seconds
[0m20:31:53.896405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ab16ea1-f72e-49cc-867f-ad3a641ebb76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E2372BFA0>]}
[0m20:31:53.923057 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m20:31:53.923057 [info ] [Thread-1 (]: 1 of 1 START sql incremental model odl.dim_customers ........................... [RUN]
[0m20:31:53.932648 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.dim_customers'
[0m20:31:53.937471 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m20:31:53.970549 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m20:31:53.973913 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m20:31:54.077870 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_customers"
[0m20:31:54.083154 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m20:31:54.085990 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace transient table DEV.odl.dim_customers
         as
        (
WITH source_data AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date  
    FROM DEV.staging.stg_orders
    
    
),
dedup AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date,
        ROW_NUMBER() OVER (PARTITION BY customer_email ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)

SELECT
    md5(cast(coalesce(cast(customer_email as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))              AS customer_sk,  
    customer_email                                                          AS customer_nk, 
    customer_name,
    customer_dob,
    customer_phone,
    customer_address,
    customer_city,
    customer_country,
    customer_postcode
FROM dedup
WHERE rnk = 1
        );
[0m20:31:54.085990 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:31:55.058869 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0dab-0000-e3b4-0000-0001b3ceb1b5
[0m20:31:55.058869 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 8
invalid identifier 'CUSTOMER_EMAIL'
[0m20:31:55.068209 [debug] [Thread-1 (]: Database Error in model dim_customers (models\dim\dim_customers.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier 'CUSTOMER_EMAIL'
  compiled code at target\run\ManyPets\models\dim\dim_customers.sql
[0m20:31:55.072440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ab16ea1-f72e-49cc-867f-ad3a641ebb76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E1F5D3B80>]}
[0m20:31:55.073445 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model odl.dim_customers .................. [[31mERROR[0m in 1.14s]
[0m20:31:55.077275 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m20:31:55.077275 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.dim_customers' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers (models\dim\dim_customers.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier 'CUSTOMER_EMAIL'
  compiled code at target\run\ManyPets\models\dim\dim_customers.sql.
[0m20:31:55.082914 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:31:55.085112 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m20:31:55.086045 [debug] [MainThread]: On list_DEV: Close
[0m20:31:55.305837 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m20:31:55.305837 [debug] [MainThread]: On list_DEV_odl: Close
[0m20:31:55.534540 [debug] [MainThread]: Connection 'model.ManyPets.dim_customers' was left open.
[0m20:31:55.535561 [debug] [MainThread]: On model.ManyPets.dim_customers: Close
[0m20:31:55.861928 [info ] [MainThread]: 
[0m20:31:55.866086 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.32 seconds (5.32s).
[0m20:31:55.873366 [debug] [MainThread]: Command end result
[0m20:31:55.968470 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:31:55.973073 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:31:55.988073 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m20:31:55.988762 [info ] [MainThread]: 
[0m20:31:55.990930 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:31:55.992442 [info ] [MainThread]: 
[0m20:31:55.993722 [error] [MainThread]:   Database Error in model dim_customers (models\dim\dim_customers.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier 'CUSTOMER_EMAIL'
  compiled code at target\run\ManyPets\models\dim\dim_customers.sql
[0m20:31:55.996625 [info ] [MainThread]: 
[0m20:31:55.997934 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:31:56.001572 [debug] [MainThread]: Command `dbt run` failed at 20:31:56.001572 after 11.88 seconds
[0m20:31:56.001572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E1F766020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E1DE5E710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E2237DFF0>]}
[0m20:31:56.005083 [debug] [MainThread]: Flushing usage events
[0m20:31:56.887134 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:33:27.646549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD4D5D6020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD4F4FEB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD4F4FE9B0>]}


============================== 20:33:27.653460 | 9c2c93bd-1f70-4bac-914b-8c4a7015698e ==============================
[0m20:33:27.653460 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:33:27.656523 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select dim_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:33:28.581903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c2c93bd-1f70-4bac-914b-8c4a7015698e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD4BE49C60>]}
[0m20:33:28.689269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c2c93bd-1f70-4bac-914b-8c4a7015698e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD4F3A1B70>]}
[0m20:33:28.692169 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:33:29.256607 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:33:29.713352 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 0 files changed.
[0m20:33:29.971340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c2c93bd-1f70-4bac-914b-8c4a7015698e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD4F3A2110>]}
[0m20:33:30.185109 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:33:30.192333 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:33:30.254364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c2c93bd-1f70-4bac-914b-8c4a7015698e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD4F511E40>]}
[0m20:33:30.255360 [info ] [MainThread]: Found 6 models, 5 data tests, 2 sources, 591 macros
[0m20:33:30.258171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c2c93bd-1f70-4bac-914b-8c4a7015698e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD5135ED10>]}
[0m20:33:30.260174 [info ] [MainThread]: 
[0m20:33:30.262920 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:33:30.264904 [info ] [MainThread]: 
[0m20:33:30.267202 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:33:30.270036 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m20:33:30.455608 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m20:33:30.455608 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m20:33:30.455608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:31.404572 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.943 seconds
[0m20:33:31.438146 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m20:33:31.458889 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m20:33:31.458889 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m20:33:31.461871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:32.028064 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.566 seconds
[0m20:33:32.028923 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m20:33:32.053603 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m20:33:32.053603 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m20:33:32.175425 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.118 seconds
[0m20:33:32.183398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c2c93bd-1f70-4bac-914b-8c4a7015698e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD519A9810>]}
[0m20:33:32.192241 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m20:33:32.194307 [info ] [Thread-1 (]: 1 of 1 START sql incremental model odl.dim_customers ........................... [RUN]
[0m20:33:32.196639 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.dim_customers'
[0m20:33:32.196639 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m20:33:32.246841 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m20:33:32.255858 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m20:33:32.361534 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_customers"
[0m20:33:32.366437 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m20:33:32.366437 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace transient table DEV.odl.dim_customers
         as
        (
WITH source_data AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date  
    FROM DEV.staging.stg_orders
    
    
),
dedup AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date,
        ROW_NUMBER() OVER (PARTITION BY customer_email ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)

SELECT
    md5(cast(coalesce(cast(customer_email as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))              AS customer_sk,  
    customer_email                                                          AS customer_nk, 
    customer_name,
    customer_dob,
    customer_phone,
    customer_address,
    customer_city,
    customer_country,
    customer_postcode
FROM dedup
WHERE rnk = 1
        );
[0m20:33:32.366437 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:33:33.049113 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0dac-0000-e39c-0001-b3ce0001c05a
[0m20:33:33.049113 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 8
invalid identifier 'CUSTOMER_EMAIL'
[0m20:33:33.049113 [debug] [Thread-1 (]: Database Error in model dim_customers (models\dim\dim_customers.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier 'CUSTOMER_EMAIL'
  compiled code at target\run\ManyPets\models\dim\dim_customers.sql
[0m20:33:33.057432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c2c93bd-1f70-4bac-914b-8c4a7015698e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD4D443B80>]}
[0m20:33:33.059950 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model odl.dim_customers .................. [[31mERROR[0m in 0.85s]
[0m20:33:33.062279 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m20:33:33.063286 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.dim_customers' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers (models\dim\dim_customers.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier 'CUSTOMER_EMAIL'
  compiled code at target\run\ManyPets\models\dim\dim_customers.sql.
[0m20:33:33.066247 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:33:33.067249 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m20:33:33.067249 [debug] [MainThread]: On list_DEV: Close
[0m20:33:33.167276 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m20:33:33.176718 [debug] [MainThread]: On list_DEV_staging: Close
[0m20:33:33.287626 [debug] [MainThread]: Connection 'model.ManyPets.dim_customers' was left open.
[0m20:33:33.294430 [debug] [MainThread]: On model.ManyPets.dim_customers: Close
[0m20:33:33.412076 [info ] [MainThread]: 
[0m20:33:33.420780 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.15 seconds (3.15s).
[0m20:33:33.427178 [debug] [MainThread]: Command end result
[0m20:33:33.519779 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:33:33.524053 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:33:33.538380 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m20:33:33.539381 [info ] [MainThread]: 
[0m20:33:33.542032 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:33:33.542990 [info ] [MainThread]: 
[0m20:33:33.544866 [error] [MainThread]:   Database Error in model dim_customers (models\dim\dim_customers.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier 'CUSTOMER_EMAIL'
  compiled code at target\run\ManyPets\models\dim\dim_customers.sql
[0m20:33:33.547367 [info ] [MainThread]: 
[0m20:33:33.549955 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:33:33.553218 [debug] [MainThread]: Command `dbt run` failed at 20:33:33.552349 after 6.06 seconds
[0m20:33:33.554214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD4D5D6020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD4F019150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD4D8D3A00>]}
[0m20:33:33.554214 [debug] [MainThread]: Flushing usage events
[0m20:33:34.339389 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:37:04.973370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E0B1A6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E0D0CE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E0D0CE7D0>]}


============================== 20:37:04.979672 | 13202ed4-d1ed-4fb5-b874-f08372236045 ==============================
[0m20:37:04.979672 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:37:04.983208 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_orders', 'send_anonymous_usage_stats': 'True'}
[0m20:37:05.864743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13202ed4-d1ed-4fb5-b874-f08372236045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E0CC5A500>]}
[0m20:37:05.994759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13202ed4-d1ed-4fb5-b874-f08372236045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E0CF728C0>]}
[0m20:37:05.999318 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:37:06.526855 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:37:06.994731 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:37:06.994731 [debug] [MainThread]: Partial parsing: updated file: ManyPets://models\staging\stg_orders.sql
[0m20:37:08.068498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13202ed4-d1ed-4fb5-b874-f08372236045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E0F25E170>]}
[0m20:37:08.321521 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:37:08.334634 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:37:08.400101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13202ed4-d1ed-4fb5-b874-f08372236045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E0EF01330>]}
[0m20:37:08.401127 [info ] [MainThread]: Found 6 models, 5 data tests, 2 sources, 591 macros
[0m20:37:08.403558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13202ed4-d1ed-4fb5-b874-f08372236045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E0EF012A0>]}
[0m20:37:08.407145 [info ] [MainThread]: 
[0m20:37:08.408566 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:37:08.411110 [info ] [MainThread]: 
[0m20:37:08.413925 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:37:08.417529 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m20:37:08.677674 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m20:37:08.677674 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m20:37:08.677674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:37:09.583616 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.892 seconds
[0m20:37:09.612884 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m20:37:09.664160 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m20:37:09.665385 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m20:37:09.667470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:37:10.413235 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.746 seconds
[0m20:37:10.418059 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m20:37:10.419062 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m20:37:10.419062 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m20:37:10.514648 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.090 seconds
[0m20:37:10.519799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13202ed4-d1ed-4fb5-b874-f08372236045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E0D9D4EE0>]}
[0m20:37:10.529390 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m20:37:10.530383 [info ] [Thread-1 (]: 1 of 1 START sql incremental model staging.stg_orders .......................... [RUN]
[0m20:37:10.533958 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_orders'
[0m20:37:10.536054 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m20:37:10.568106 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m20:37:10.569778 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m20:37:10.702749 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m20:37:10.723929 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m20:37:10.723929 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace transient table DEV.staging.stg_orders
         as
        (

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS event_type,
        data:time::TIMESTAMP                            AS event_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
),
dedup AS
(
    SELECT
        *
        ,ROW_NUMBER() OVER(PARTITION BY order_id, email, pet_dob, pet_name, pet_breed  ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)
SELECT 
    order_id ,
    customer_email,
    pet_dob,
    pet_name,
    COALESCE(NULLIF(TRIM(COALESCE(first_name, '') || ' ' || COALESCE(last_name, '')), ''), 'unknown') AS customer_name,
    dob                                         AS customer_dob,
    phone                                       AS customer_phone,
    address_line1 || ' ' || address_line2       AS customer_address
    city                                        AS customer_city,
    country                                     AS customer_country,
    postcode                                    AS customer_postcode,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_date,
    cessation_date,
    affiliate_code,
    source,
    event_type,
    event_time,
    ingest_date
FROM dedup
WHERE 
    rnk =1
        );
[0m20:37:10.723929 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:37:11.222268 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0db0-0000-e37b-0001-b3ce0001b0c2
[0m20:37:11.222268 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 55 at position 4 unexpected 'city'.
[0m20:37:11.222268 [debug] [Thread-1 (]: Database Error in model stg_orders (models\staging\stg_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 55 at position 4 unexpected 'city'.
  compiled code at target\run\ManyPets\models\staging\stg_orders.sql
[0m20:37:11.231138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13202ed4-d1ed-4fb5-b874-f08372236045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E0B011C30>]}
[0m20:37:11.232144 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model staging.stg_orders ................. [[31mERROR[0m in 0.69s]
[0m20:37:11.235596 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m20:37:11.235596 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models\staging\stg_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 55 at position 4 unexpected 'city'.
  compiled code at target\run\ManyPets\models\staging\stg_orders.sql.
[0m20:37:11.240221 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:37:11.241220 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m20:37:11.242812 [debug] [MainThread]: On list_DEV: Close
[0m20:37:11.343841 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m20:37:11.343841 [debug] [MainThread]: On list_DEV_odl: Close
[0m20:37:11.439410 [debug] [MainThread]: Connection 'model.ManyPets.stg_orders' was left open.
[0m20:37:11.439410 [debug] [MainThread]: On model.ManyPets.stg_orders: Close
[0m20:37:11.572269 [info ] [MainThread]: 
[0m20:37:11.574807 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.16 seconds (3.16s).
[0m20:37:11.577591 [debug] [MainThread]: Command end result
[0m20:37:11.664807 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:37:11.672643 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:37:11.689985 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m20:37:11.692302 [info ] [MainThread]: 
[0m20:37:11.695997 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:37:11.697369 [info ] [MainThread]: 
[0m20:37:11.699945 [error] [MainThread]:   Database Error in model stg_orders (models\staging\stg_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 55 at position 4 unexpected 'city'.
  compiled code at target\run\ManyPets\models\staging\stg_orders.sql
[0m20:37:11.705399 [info ] [MainThread]: 
[0m20:37:11.707618 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:37:11.716597 [debug] [MainThread]: Command `dbt run` failed at 20:37:11.716597 after 6.90 seconds
[0m20:37:11.717653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E0B1A6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E0CF728C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E0B4A2380>]}
[0m20:37:11.718654 [debug] [MainThread]: Flushing usage events
[0m20:37:12.554167 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:38:16.714409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C9DF66050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C9FE8E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C9FE8E7D0>]}


============================== 20:38:16.721342 | 1c532411-84ba-4a76-973e-f419073fe374 ==============================
[0m20:38:16.721342 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:38:16.724530 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_orders', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:38:17.601998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c532411-84ba-4a76-973e-f419073fe374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C9FA1A500>]}
[0m20:38:17.719000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c532411-84ba-4a76-973e-f419073fe374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C9FD328C0>]}
[0m20:38:17.727497 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:38:18.261702 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:38:18.785168 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:38:18.793753 [debug] [MainThread]: Partial parsing: updated file: ManyPets://models\staging\stg_orders.sql
[0m20:38:19.681217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c532411-84ba-4a76-973e-f419073fe374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA201E170>]}
[0m20:38:19.888099 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:38:19.896479 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:38:19.972886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c532411-84ba-4a76-973e-f419073fe374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA1CC9330>]}
[0m20:38:19.973890 [info ] [MainThread]: Found 6 models, 5 data tests, 2 sources, 591 macros
[0m20:38:19.976707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c532411-84ba-4a76-973e-f419073fe374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA1CC92A0>]}
[0m20:38:19.978712 [info ] [MainThread]: 
[0m20:38:19.981602 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:38:19.983611 [info ] [MainThread]: 
[0m20:38:19.986810 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:38:19.990104 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m20:38:20.161989 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m20:38:20.177636 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m20:38:20.177636 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:38:21.063439 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.895 seconds
[0m20:38:21.108296 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m20:38:21.140308 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m20:38:21.140308 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m20:38:21.140308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:38:21.649511 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.502 seconds
[0m20:38:21.649511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m20:38:21.666229 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m20:38:21.666229 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m20:38:21.783479 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.107 seconds
[0m20:38:21.801716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c532411-84ba-4a76-973e-f419073fe374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA07966B0>]}
[0m20:38:21.826449 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m20:38:21.827448 [info ] [Thread-1 (]: 1 of 1 START sql incremental model staging.stg_orders .......................... [RUN]
[0m20:38:21.833154 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_orders'
[0m20:38:21.833154 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m20:38:21.867938 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m20:38:21.878566 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m20:38:21.984226 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m20:38:21.990566 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m20:38:21.990566 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace transient table DEV.staging.stg_orders
         as
        (

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS event_type,
        data:time::TIMESTAMP                            AS event_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
),
dedup AS
(
    SELECT
        *
        ,ROW_NUMBER() OVER(PARTITION BY order_id, email, pet_dob, pet_name, pet_breed  ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)
SELECT 
    order_id ,
    customer_email,
    pet_dob,
    pet_name,
    COALESCE(NULLIF(TRIM(COALESCE(first_name, '') || ' ' || COALESCE(last_name, '')), ''), 'unknown') AS customer_name,
    dob                                         AS customer_dob,
    phone                                       AS customer_phone,
    address_line1 || ' ' || address_line2       AS customer_address,
    city                                        AS customer_city,
    country                                     AS customer_country,
    postcode                                    AS customer_postcode,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_date,
    cessation_date,
    affiliate_code,
    source,
    event_type,
    event_time,
    ingest_date
FROM dedup
WHERE 
    rnk =1
        );
[0m20:38:21.990566 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:38:22.559757 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0db1-0000-e37b-0001-b3ce0001b0c6
[0m20:38:22.559757 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 48 at position 4
invalid identifier 'CUSTOMER_EMAIL'
[0m20:38:22.569840 [debug] [Thread-1 (]: Database Error in model stg_orders (models\staging\stg_orders.sql)
  000904 (42000): SQL compilation error: error line 48 at position 4
  invalid identifier 'CUSTOMER_EMAIL'
  compiled code at target\run\ManyPets\models\staging\stg_orders.sql
[0m20:38:22.576773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c532411-84ba-4a76-973e-f419073fe374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C9DDD1C30>]}
[0m20:38:22.576773 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model staging.stg_orders ................. [[31mERROR[0m in 0.74s]
[0m20:38:22.580726 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m20:38:22.580726 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models\staging\stg_orders.sql)
  000904 (42000): SQL compilation error: error line 48 at position 4
  invalid identifier 'CUSTOMER_EMAIL'
  compiled code at target\run\ManyPets\models\staging\stg_orders.sql.
[0m20:38:22.586372 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:38:22.586372 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m20:38:22.587370 [debug] [MainThread]: On list_DEV: Close
[0m20:38:22.690432 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m20:38:22.690432 [debug] [MainThread]: On list_DEV_odl: Close
[0m20:38:22.789216 [debug] [MainThread]: Connection 'model.ManyPets.stg_orders' was left open.
[0m20:38:22.789216 [debug] [MainThread]: On model.ManyPets.stg_orders: Close
[0m20:38:22.925264 [info ] [MainThread]: 
[0m20:38:22.930382 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.94 seconds (2.94s).
[0m20:38:22.935006 [debug] [MainThread]: Command end result
[0m20:38:23.013335 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:38:23.017303 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:38:23.034331 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m20:38:23.035334 [info ] [MainThread]: 
[0m20:38:23.037999 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:38:23.039271 [info ] [MainThread]: 
[0m20:38:23.040676 [error] [MainThread]:   Database Error in model stg_orders (models\staging\stg_orders.sql)
  000904 (42000): SQL compilation error: error line 48 at position 4
  invalid identifier 'CUSTOMER_EMAIL'
  compiled code at target\run\ManyPets\models\staging\stg_orders.sql
[0m20:38:23.042763 [info ] [MainThread]: 
[0m20:38:23.044273 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:38:23.047535 [debug] [MainThread]: Command `dbt run` failed at 20:38:23.047535 after 6.51 seconds
[0m20:38:23.047535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C9DF66050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C9FD328C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C9E262380>]}
[0m20:38:23.049483 [debug] [MainThread]: Flushing usage events
[0m20:38:23.805403 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:39:19.134982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E112176020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E11409EB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E11409E9B0>]}


============================== 20:39:19.140357 | 4fd1cd19-e84b-4d9f-abcc-6c7f9ac8d9fa ==============================
[0m20:39:19.140357 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:39:19.143552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_orders --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:39:20.052499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fd1cd19-e84b-4d9f-abcc-6c7f9ac8d9fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1111F9C60>]}
[0m20:39:20.167133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fd1cd19-e84b-4d9f-abcc-6c7f9ac8d9fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E113F41B70>]}
[0m20:39:20.170097 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:39:20.769272 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:39:21.242891 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:39:21.242891 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:39:21.359451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fd1cd19-e84b-4d9f-abcc-6c7f9ac8d9fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E115F5EA10>]}
[0m20:39:21.674035 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:39:21.682757 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:39:21.748441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fd1cd19-e84b-4d9f-abcc-6c7f9ac8d9fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E115F65BA0>]}
[0m20:39:21.750996 [info ] [MainThread]: Found 6 models, 5 data tests, 2 sources, 591 macros
[0m20:39:21.753259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fd1cd19-e84b-4d9f-abcc-6c7f9ac8d9fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E115EF71F0>]}
[0m20:39:21.753259 [info ] [MainThread]: 
[0m20:39:21.756680 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:39:21.759611 [info ] [MainThread]: 
[0m20:39:21.760611 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:39:21.765310 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m20:39:21.983485 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m20:39:21.984087 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m20:39:21.984087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:22.720530 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.735 seconds
[0m20:39:22.741671 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m20:39:22.760062 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m20:39:22.760062 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m20:39:22.760062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:23.310384 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.549 seconds
[0m20:39:23.321986 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m20:39:23.333815 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m20:39:23.340357 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m20:39:23.450880 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.111 seconds
[0m20:39:23.461439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fd1cd19-e84b-4d9f-abcc-6c7f9ac8d9fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E114AD4730>]}
[0m20:39:23.479459 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m20:39:23.483552 [info ] [Thread-1 (]: 1 of 1 START sql incremental model staging.stg_orders .......................... [RUN]
[0m20:39:23.487500 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_orders'
[0m20:39:23.487500 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m20:39:23.520080 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m20:39:23.528307 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m20:39:23.644217 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m20:39:23.659682 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m20:39:23.660683 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace transient table DEV.staging.stg_orders
         as
        (

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS event_type,
        data:time::TIMESTAMP                            AS event_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
),
dedup AS
(
    SELECT
        *
        ,ROW_NUMBER() OVER(PARTITION BY order_id, email, pet_dob, pet_name, pet_breed  ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)
SELECT 
    order_id ,
    customer_email,
    pet_dob,
    pet_name,
    COALESCE(NULLIF(TRIM(COALESCE(first_name, '') || ' ' || COALESCE(last_name, '')), ''), 'unknown') AS customer_name,
    dob                                         AS customer_dob,
    phone                                       AS customer_phone,
    address_line1 || ' ' || address_line2       AS customer_address,
    city                                        AS customer_city,
    country                                     AS customer_country,
    postcode                                    AS customer_postcode,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_date,
    cessation_date,
    affiliate_code,
    source,
    event_type,
    event_time,
    ingest_date
FROM dedup
WHERE 
    rnk =1
        );
[0m20:39:23.662075 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:39:24.072119 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0db2-0000-e39c-0001-b3ce0001c07e
[0m20:39:24.072119 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 48 at position 4
invalid identifier 'CUSTOMER_EMAIL'
[0m20:39:24.072119 [debug] [Thread-1 (]: Database Error in model stg_orders (models\staging\stg_orders.sql)
  000904 (42000): SQL compilation error: error line 48 at position 4
  invalid identifier 'CUSTOMER_EMAIL'
  compiled code at target\run\ManyPets\models\staging\stg_orders.sql
[0m20:39:24.083436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fd1cd19-e84b-4d9f-abcc-6c7f9ac8d9fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E11406DF60>]}
[0m20:39:24.084437 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model staging.stg_orders ................. [[31mERROR[0m in 0.59s]
[0m20:39:24.086513 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m20:39:24.087512 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models\staging\stg_orders.sql)
  000904 (42000): SQL compilation error: error line 48 at position 4
  invalid identifier 'CUSTOMER_EMAIL'
  compiled code at target\run\ManyPets\models\staging\stg_orders.sql.
[0m20:39:24.090517 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:39:24.091515 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m20:39:24.093524 [debug] [MainThread]: On list_DEV: Close
[0m20:39:24.210305 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m20:39:24.210305 [debug] [MainThread]: On list_DEV_odl: Close
[0m20:39:24.323744 [debug] [MainThread]: Connection 'model.ManyPets.stg_orders' was left open.
[0m20:39:24.327374 [debug] [MainThread]: On model.ManyPets.stg_orders: Close
[0m20:39:24.444618 [info ] [MainThread]: 
[0m20:39:24.449673 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.68 seconds (2.68s).
[0m20:39:24.453412 [debug] [MainThread]: Command end result
[0m20:39:24.556024 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:39:24.560371 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:39:24.575003 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m20:39:24.576003 [info ] [MainThread]: 
[0m20:39:24.578092 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:39:24.579372 [info ] [MainThread]: 
[0m20:39:24.580833 [error] [MainThread]:   Database Error in model stg_orders (models\staging\stg_orders.sql)
  000904 (42000): SQL compilation error: error line 48 at position 4
  invalid identifier 'CUSTOMER_EMAIL'
  compiled code at target\run\ManyPets\models\staging\stg_orders.sql
[0m20:39:24.583544 [info ] [MainThread]: 
[0m20:39:24.585680 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:39:24.587998 [debug] [MainThread]: Command `dbt run` failed at 20:39:24.587998 after 5.59 seconds
[0m20:39:24.587998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E112176020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E114A01060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E114A03070>]}
[0m20:39:24.587998 [debug] [MainThread]: Flushing usage events
[0m20:39:25.257625 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:39:55.129956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9091A6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C90B0CE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C90B0CE7D0>]}


============================== 20:39:55.137911 | 7093a597-7d45-492b-ad06-1cd224bfc5e5 ==============================
[0m20:39:55.137911 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:39:55.139555 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_orders --full-refresh', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:39:56.160394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7093a597-7d45-492b-ad06-1cd224bfc5e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C90AC5A500>]}
[0m20:39:56.271787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7093a597-7d45-492b-ad06-1cd224bfc5e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C90AF728C0>]}
[0m20:39:56.279841 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:39:56.885117 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:39:57.359081 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:39:57.359081 [debug] [MainThread]: Partial parsing: updated file: ManyPets://models\staging\stg_orders.sql
[0m20:39:58.291717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7093a597-7d45-492b-ad06-1cd224bfc5e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C90D25E170>]}
[0m20:39:58.505832 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:39:58.512594 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:39:58.574902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7093a597-7d45-492b-ad06-1cd224bfc5e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C90CF01330>]}
[0m20:39:58.575906 [info ] [MainThread]: Found 6 models, 5 data tests, 2 sources, 591 macros
[0m20:39:58.577492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7093a597-7d45-492b-ad06-1cd224bfc5e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C90CF012A0>]}
[0m20:39:58.580806 [info ] [MainThread]: 
[0m20:39:58.583202 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:39:58.585346 [info ] [MainThread]: 
[0m20:39:58.587423 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:39:58.590242 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m20:39:58.807817 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m20:39:58.807817 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m20:39:58.807817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:59.573805 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.762 seconds
[0m20:39:59.593925 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m20:39:59.616875 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m20:39:59.616875 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m20:39:59.616875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:00.274774 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.655 seconds
[0m20:40:00.281213 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m20:40:00.292259 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m20:40:00.293357 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m20:40:00.381943 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.088 seconds
[0m20:40:00.387004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7093a597-7d45-492b-ad06-1cd224bfc5e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C90B9D4EE0>]}
[0m20:40:00.395125 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m20:40:00.397709 [info ] [Thread-1 (]: 1 of 1 START sql incremental model staging.stg_orders .......................... [RUN]
[0m20:40:00.399577 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_orders'
[0m20:40:00.400557 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m20:40:00.417370 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m20:40:00.421532 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m20:40:00.592428 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m20:40:00.609683 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m20:40:00.612117 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace transient table DEV.staging.stg_orders
         as
        (

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS event_type,
        data:time::TIMESTAMP                            AS event_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
),
dedup AS
(
    SELECT
        *
        ,ROW_NUMBER() OVER(PARTITION BY order_id, email, pet_dob, pet_name, pet_breed  ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)
SELECT 
    order_id ,
    email AS customer_email,
    pet_dob,
    pet_name,
    COALESCE(NULLIF(TRIM(COALESCE(first_name, '') || ' ' || COALESCE(last_name, '')), ''), 'unknown') AS customer_name,
    dob                                         AS customer_dob,
    phone                                       AS customer_phone,
    address_line1 || ' ' || address_line2       AS customer_address,
    city                                        AS customer_city,
    country                                     AS customer_country,
    postcode                                    AS customer_postcode,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_date,
    cessation_date,
    affiliate_code,
    source,
    event_type,
    event_time,
    ingest_date
FROM dedup
WHERE 
    rnk =1
        );
[0m20:40:00.614715 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:40:03.232567 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.620 seconds
[0m20:40:03.263421 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_orders__dbt_tmp
[0m20:40:03.271510 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m20:40:03.271510 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
drop view if exists DEV.staging.stg_orders__dbt_tmp cascade
[0m20:40:03.347667 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.072 seconds
[0m20:40:03.404287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7093a597-7d45-492b-ad06-1cd224bfc5e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C90D9A2980>]}
[0m20:40:03.405304 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model staging.stg_orders ..................... [[32mSUCCESS 1[0m in 3.00s]
[0m20:40:03.407990 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m20:40:03.411537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:40:03.412168 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m20:40:03.412168 [debug] [MainThread]: On list_DEV: Close
[0m20:40:03.514726 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m20:40:03.514726 [debug] [MainThread]: On list_DEV_odl: Close
[0m20:40:03.630012 [debug] [MainThread]: Connection 'model.ManyPets.stg_orders' was left open.
[0m20:40:03.638031 [debug] [MainThread]: On model.ManyPets.stg_orders: Close
[0m20:40:03.745972 [info ] [MainThread]: 
[0m20:40:03.750880 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.16 seconds (5.16s).
[0m20:40:03.754970 [debug] [MainThread]: Command end result
[0m20:40:03.845313 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:40:03.853666 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:40:03.868549 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m20:40:03.869546 [info ] [MainThread]: 
[0m20:40:03.871163 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:40:03.872656 [info ] [MainThread]: 
[0m20:40:03.874048 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:40:03.876861 [debug] [MainThread]: Command `dbt run` succeeded at 20:40:03.876861 after 8.89 seconds
[0m20:40:03.878291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9091A6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C90AF728C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9094A2380>]}
[0m20:40:03.879302 [debug] [MainThread]: Flushing usage events
[0m20:40:04.418251 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:40:19.853626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0AC706020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0AE62EB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0AE62E9B0>]}


============================== 20:40:19.858863 | a1c4764e-2283-40b2-bdb5-e3e60792e159 ==============================
[0m20:40:19.858863 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:40:19.863244 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select dim_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:40:20.787247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1c4764e-2283-40b2-bdb5-e3e60792e159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0AAF89C60>]}
[0m20:40:20.904817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1c4764e-2283-40b2-bdb5-e3e60792e159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0AE4D1B70>]}
[0m20:40:20.910655 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:40:21.478445 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:40:21.924941 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:40:21.924941 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:40:22.045100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1c4764e-2283-40b2-bdb5-e3e60792e159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0B04EEA10>]}
[0m20:40:22.344339 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:40:22.354854 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:40:22.422395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1c4764e-2283-40b2-bdb5-e3e60792e159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0B04F5BA0>]}
[0m20:40:22.424697 [info ] [MainThread]: Found 6 models, 5 data tests, 2 sources, 591 macros
[0m20:40:22.427130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1c4764e-2283-40b2-bdb5-e3e60792e159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0B04871F0>]}
[0m20:40:22.431233 [info ] [MainThread]: 
[0m20:40:22.432977 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:40:22.435844 [info ] [MainThread]: 
[0m20:40:22.437697 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:40:22.445262 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m20:40:22.660735 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m20:40:22.660735 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m20:40:22.660735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:23.353169 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.697 seconds
[0m20:40:23.386744 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m20:40:23.401435 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m20:40:23.401435 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m20:40:23.401435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:23.783278 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.377 seconds
[0m20:40:23.793838 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m20:40:23.805248 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m20:40:23.809575 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m20:40:23.931034 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.122 seconds
[0m20:40:23.946917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1c4764e-2283-40b2-bdb5-e3e60792e159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0B0A78340>]}
[0m20:40:23.966600 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m20:40:23.966600 [info ] [Thread-1 (]: 1 of 1 START sql incremental model odl.dim_customers ........................... [RUN]
[0m20:40:23.979645 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.dim_customers'
[0m20:40:23.979645 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m20:40:24.133442 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m20:40:24.138033 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m20:40:24.294074 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_customers"
[0m20:40:24.298312 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m20:40:24.301416 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace transient table DEV.odl.dim_customers
         as
        (
WITH source_data AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date  
    FROM DEV.staging.stg_orders
    
    
),
dedup AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date,
        ROW_NUMBER() OVER (PARTITION BY customer_email ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)

SELECT
    md5(cast(coalesce(cast(customer_email as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))              AS customer_sk,  
    customer_email                                                          AS customer_nk, 
    customer_name,
    customer_dob,
    customer_phone,
    customer_address,
    customer_city,
    customer_country,
    customer_postcode
FROM dedup
WHERE rnk = 1
        );
[0m20:40:24.302423 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:40:25.785650 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.486 seconds
[0m20:40:25.827460 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_customers__dbt_tmp
[0m20:40:25.841001 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m20:40:25.841001 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
drop view if exists DEV.odl.dim_customers__dbt_tmp cascade
[0m20:40:25.911603 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.073 seconds
[0m20:40:25.995781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1c4764e-2283-40b2-bdb5-e3e60792e159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0B0C26C20>]}
[0m20:40:25.996781 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model odl.dim_customers ...................... [[32mSUCCESS 1[0m in 2.01s]
[0m20:40:25.999658 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m20:40:26.001702 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:40:26.002706 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m20:40:26.002706 [debug] [MainThread]: On list_DEV: Close
[0m20:40:26.107933 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m20:40:26.108460 [debug] [MainThread]: On list_DEV_staging: Close
[0m20:40:26.224061 [debug] [MainThread]: Connection 'model.ManyPets.dim_customers' was left open.
[0m20:40:26.227641 [debug] [MainThread]: On model.ManyPets.dim_customers: Close
[0m20:40:26.329590 [info ] [MainThread]: 
[0m20:40:26.332127 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.89 seconds (3.89s).
[0m20:40:26.334957 [debug] [MainThread]: Command end result
[0m20:40:26.412928 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:40:26.417071 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:40:26.431229 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m20:40:26.433246 [info ] [MainThread]: 
[0m20:40:26.435052 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:40:26.436028 [info ] [MainThread]: 
[0m20:40:26.437031 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:40:26.440194 [debug] [MainThread]: Command `dbt run` succeeded at 20:40:26.439032 after 6.73 seconds
[0m20:40:26.440643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0AC706020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0B04B2DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0ACA03A00>]}
[0m20:40:26.440643 [debug] [MainThread]: Flushing usage events
[0m20:40:27.109768 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:47:02.233309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADEE4E6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADF040E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADF040E7D0>]}


============================== 20:47:02.239022 | 94367978-f907-4cf2-af18-6c06b249c118 ==============================
[0m20:47:02.239022 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:47:02.244344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select dim_customers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:47:03.665326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94367978-f907-4cf2-af18-6c06b249c118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADEFF9A500>]}
[0m20:47:03.807157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94367978-f907-4cf2-af18-6c06b249c118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADF02B28C0>]}
[0m20:47:03.810540 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:47:04.471583 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:47:04.945134 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:47:04.945134 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:47:05.042810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94367978-f907-4cf2-af18-6c06b249c118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADF22CAA40>]}
[0m20:47:05.415990 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:47:05.426596 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:47:05.515806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94367978-f907-4cf2-af18-6c06b249c118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADF22DD000>]}
[0m20:47:05.520796 [info ] [MainThread]: Found 6 models, 5 data tests, 2 sources, 591 macros
[0m20:47:05.521998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94367978-f907-4cf2-af18-6c06b249c118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADF22666E0>]}
[0m20:47:05.523000 [info ] [MainThread]: 
[0m20:47:05.523000 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:47:05.530404 [info ] [MainThread]: 
[0m20:47:05.576133 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:47:05.627976 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m20:47:05.979307 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m20:47:05.986374 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m20:47:05.986374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:06.994079 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.012 seconds
[0m20:47:07.037197 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m20:47:07.068584 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m20:47:07.084237 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m20:47:07.084237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:08.091003 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.009 seconds
[0m20:47:08.091003 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m20:47:08.113092 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m20:47:08.113092 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m20:47:08.244701 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.122 seconds
[0m20:47:08.256318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94367978-f907-4cf2-af18-6c06b249c118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADF0D298D0>]}
[0m20:47:08.276131 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m20:47:08.276131 [info ] [Thread-1 (]: 1 of 1 START sql incremental model odl.dim_customers ........................... [RUN]
[0m20:47:08.284882 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.dim_customers'
[0m20:47:08.285881 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m20:47:08.395146 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m20:47:08.411096 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m20:47:08.530149 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m20:47:08.545776 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace  temporary view DEV.odl.dim_customers__dbt_tmp
  
   as (
    
WITH source_data AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date  
    FROM DEV.staging.stg_orders
    
    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.dim_customers)
    
),
dedup AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date,
        ROW_NUMBER() OVER (PARTITION BY customer_email ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)

SELECT
    md5(cast(coalesce(cast(customer_email as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))              AS customer_sk,  
    customer_email                                                          AS customer_nk, 
    customer_name,
    customer_dob,
    customer_phone,
    customer_address,
    customer_city,
    customer_country,
    customer_postcode
FROM dedup
WHERE rnk = 1
  );
[0m20:47:08.545776 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:47:09.344301 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0dba-0000-e3c5-0001-b3ce0001614a
[0m20:47:09.348081 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002036 (42601): SQL compilation error:
Subquery containing correlated aggregate function [MAX(STG_ORDERS.INGEST_DATE)] can only appear in having or select clause
[0m20:47:09.357205 [debug] [Thread-1 (]: Database Error in model dim_customers (models\dim\dim_customers.sql)
  002036 (42601): SQL compilation error:
  Subquery containing correlated aggregate function [MAX(STG_ORDERS.INGEST_DATE)] can only appear in having or select clause
[0m20:47:09.368776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94367978-f907-4cf2-af18-6c06b249c118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADEE351C30>]}
[0m20:47:09.368776 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model odl.dim_customers .................. [[31mERROR[0m in 1.07s]
[0m20:47:09.377424 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m20:47:09.377424 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.dim_customers' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers (models\dim\dim_customers.sql)
  002036 (42601): SQL compilation error:
  Subquery containing correlated aggregate function [MAX(STG_ORDERS.INGEST_DATE)] can only appear in having or select clause.
[0m20:47:09.389778 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:47:09.389778 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m20:47:09.389778 [debug] [MainThread]: On list_DEV: Close
[0m20:47:09.507996 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m20:47:09.507996 [debug] [MainThread]: On list_DEV_odl: Close
[0m20:47:09.619381 [debug] [MainThread]: Connection 'model.ManyPets.dim_customers' was left open.
[0m20:47:09.619381 [debug] [MainThread]: On model.ManyPets.dim_customers: Close
[0m20:47:09.744934 [info ] [MainThread]: 
[0m20:47:09.750749 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.17 seconds (4.17s).
[0m20:47:09.754599 [debug] [MainThread]: Command end result
[0m20:47:09.936939 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:47:09.942521 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:47:09.961304 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m20:47:09.961304 [info ] [MainThread]: 
[0m20:47:09.965429 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:47:09.966300 [info ] [MainThread]: 
[0m20:47:09.970899 [error] [MainThread]:   Database Error in model dim_customers (models\dim\dim_customers.sql)
  002036 (42601): SQL compilation error:
  Subquery containing correlated aggregate function [MAX(STG_ORDERS.INGEST_DATE)] can only appear in having or select clause
[0m20:47:09.973367 [info ] [MainThread]: 
[0m20:47:09.977119 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:47:09.981633 [debug] [MainThread]: Command `dbt run` failed at 20:47:09.981633 after 7.90 seconds
[0m20:47:09.983984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADEE4E6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADF228EBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADF2993550>]}
[0m20:47:09.990079 [debug] [MainThread]: Flushing usage events
[0m20:47:10.651787 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:55:30.435241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D41DB6020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D43CDEB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D43CDE9B0>]}


============================== 20:55:30.447370 | d1c2fb8a-c122-495f-b90a-c042405a6cc2 ==============================
[0m20:55:30.447370 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:55:30.457588 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_customers', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:55:31.680417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1c2fb8a-c122-495f-b90a-c042405a6cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D40639C60>]}
[0m20:55:31.797930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1c2fb8a-c122-495f-b90a-c042405a6cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D43B81B70>]}
[0m20:55:31.814033 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:55:32.427300 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:55:32.988133 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:55:32.988133 [debug] [MainThread]: Partial parsing: updated file: ManyPets://models\dim\dim_customers.sql
[0m20:55:33.801822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1c2fb8a-c122-495f-b90a-c042405a6cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D45C95720>]}
[0m20:55:34.067512 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:55:34.078391 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:55:34.163141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1c2fb8a-c122-495f-b90a-c042405a6cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D45B173D0>]}
[0m20:55:34.165216 [info ] [MainThread]: Found 6 models, 5 data tests, 2 sources, 591 macros
[0m20:55:34.167897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1c2fb8a-c122-495f-b90a-c042405a6cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D45B16D40>]}
[0m20:55:34.168888 [info ] [MainThread]: 
[0m20:55:34.174246 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:55:34.176476 [info ] [MainThread]: 
[0m20:55:34.178883 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:55:34.183327 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m20:55:34.410752 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m20:55:34.410752 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m20:55:34.410752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:35.378102 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.960 seconds
[0m20:55:35.418782 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m20:55:35.459735 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m20:55:35.459735 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m20:55:35.459735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:36.188624 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.722 seconds
[0m20:55:36.188624 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m20:55:36.207900 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m20:55:36.207900 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m20:55:36.325404 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.106 seconds
[0m20:55:36.336354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1c2fb8a-c122-495f-b90a-c042405a6cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D404BC190>]}
[0m20:55:36.355346 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m20:55:36.355346 [info ] [Thread-1 (]: 1 of 1 START sql incremental model odl.dim_customers ........................... [RUN]
[0m20:55:36.362183 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.dim_customers'
[0m20:55:36.362183 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m20:55:36.428868 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m20:55:36.442808 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m20:55:36.606094 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_customers"
[0m20:55:36.616588 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m20:55:36.616588 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace transient table DEV.odl.dim_customers
         as
        (
WITH stg_data AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date  
    FROM DEV.staging.stg_orders
    
    
),
dedup AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date,
        ROW_NUMBER() OVER (PARTITION BY customer_email ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)

SELECT
    md5(cast(coalesce(cast(customer_email as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))              AS customer_sk,  
    customer_email                                                          AS customer_nk, 
    customer_name,
    customer_dob,
    customer_phone,
    customer_address,
    customer_city,
    customer_country,
    customer_postcode,
    ingest_date
FROM dedup
WHERE rnk = 1
        );
[0m20:55:36.616588 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:55:38.645201 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.030 seconds
[0m20:55:38.694288 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_customers__dbt_tmp
[0m20:55:38.711506 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m20:55:38.711506 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
drop view if exists DEV.odl.dim_customers__dbt_tmp cascade
[0m20:55:38.810371 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.088 seconds
[0m20:55:38.914783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1c2fb8a-c122-495f-b90a-c042405a6cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D4646A6E0>]}
[0m20:55:38.914783 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model odl.dim_customers ...................... [[32mSUCCESS 1[0m in 2.53s]
[0m20:55:38.921078 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m20:55:38.925519 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:55:38.925519 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m20:55:38.925519 [debug] [MainThread]: On list_DEV: Close
[0m20:55:39.043226 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m20:55:39.043226 [debug] [MainThread]: On list_DEV_odl: Close
[0m20:55:39.156412 [debug] [MainThread]: Connection 'model.ManyPets.dim_customers' was left open.
[0m20:55:39.173569 [debug] [MainThread]: On model.ManyPets.dim_customers: Close
[0m20:55:39.287561 [info ] [MainThread]: 
[0m20:55:39.296492 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.11 seconds (5.11s).
[0m20:55:39.300294 [debug] [MainThread]: Command end result
[0m20:55:39.486972 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:55:39.496581 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:55:39.523079 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m20:55:39.524848 [info ] [MainThread]: 
[0m20:55:39.527373 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:55:39.529571 [info ] [MainThread]: 
[0m20:55:39.532058 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:55:39.537003 [debug] [MainThread]: Command `dbt run` succeeded at 20:55:39.537003 after 9.30 seconds
[0m20:55:39.538011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D41DB6020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D45C9D2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D45B9B3A0>]}
[0m20:55:39.538011 [debug] [MainThread]: Flushing usage events
[0m20:55:40.139152 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:55:49.320607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001269C4C60B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001269E3EEC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001269E3EEA40>]}


============================== 20:55:49.328314 | 8544426b-6bc5-4b5a-8c2a-0b8268511a5a ==============================
[0m20:55:49.328314 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:55:49.334724 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select dim_customers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:55:50.545343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8544426b-6bc5-4b5a-8c2a-0b8268511a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001269DF04B80>]}
[0m20:55:50.667432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8544426b-6bc5-4b5a-8c2a-0b8268511a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001269ECA3490>]}
[0m20:55:50.670229 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:55:51.363283 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:55:51.881575 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:55:51.881575 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:55:51.990628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8544426b-6bc5-4b5a-8c2a-0b8268511a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000126A02B3EB0>]}
[0m20:55:52.329020 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:55:52.340256 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:55:52.434556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8544426b-6bc5-4b5a-8c2a-0b8268511a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000126A02452A0>]}
[0m20:55:52.434556 [info ] [MainThread]: Found 6 models, 5 data tests, 2 sources, 591 macros
[0m20:55:52.439489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8544426b-6bc5-4b5a-8c2a-0b8268511a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000126A02442B0>]}
[0m20:55:52.439489 [info ] [MainThread]: 
[0m20:55:52.446614 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:55:52.449128 [info ] [MainThread]: 
[0m20:55:52.451525 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:55:52.455596 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m20:55:52.697862 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m20:55:52.697862 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m20:55:52.697862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:53.549142 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.856 seconds
[0m20:55:53.594818 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m20:55:53.668426 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m20:55:53.670433 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m20:55:53.670433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:54.211352 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.542 seconds
[0m20:55:54.211352 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m20:55:54.230706 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m20:55:54.230706 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m20:55:54.359029 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.118 seconds
[0m20:55:54.371422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8544426b-6bc5-4b5a-8c2a-0b8268511a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000126A02AC070>]}
[0m20:55:54.398594 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m20:55:54.398594 [info ] [Thread-1 (]: 1 of 1 START sql incremental model odl.dim_customers ........................... [RUN]
[0m20:55:54.407027 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.dim_customers'
[0m20:55:54.408216 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m20:55:54.524062 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m20:55:54.540559 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m20:55:54.678107 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m20:55:54.678107 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace  temporary view DEV.odl.dim_customers__dbt_tmp
  
   as (
    
WITH stg_data AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date  
    FROM DEV.staging.stg_orders
    
    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.dim_customers)
    
),
dedup AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date,
        ROW_NUMBER() OVER (PARTITION BY customer_email ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)

SELECT
    md5(cast(coalesce(cast(customer_email as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))              AS customer_sk,  
    customer_email                                                          AS customer_nk, 
    customer_name,
    customer_dob,
    customer_phone,
    customer_address,
    customer_city,
    customer_country,
    customer_postcode,
    ingest_date
FROM dedup
WHERE rnk = 1
  );
[0m20:55:54.678107 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:55:55.726413 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.040 seconds
[0m20:55:55.766326 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m20:55:55.766326 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table DEV.odl.dim_customers__dbt_tmp
[0m20:55:55.856210 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.087 seconds
[0m20:55:55.867619 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m20:55:55.883327 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table DEV.odl.dim_customers
[0m20:55:55.966465 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.083 seconds
[0m20:55:55.997769 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m20:55:56.013393 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table "DEV"."ODL"."DIM_CUSTOMERS"
[0m20:55:56.135607 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.122 seconds
[0m20:55:56.267004 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_customers"
[0m20:55:56.289183 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m20:55:56.289183 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m20:55:56.402930 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.108 seconds
[0m20:55:56.402930 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m20:55:56.402930 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
merge into DEV.odl.dim_customers as DBT_INTERNAL_DEST
        using DEV.odl.dim_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.customer_email = DBT_INTERNAL_DEST.customer_email))

    
    when matched then update set
        "CUSTOMER_SK" = DBT_INTERNAL_SOURCE."CUSTOMER_SK","CUSTOMER_NK" = DBT_INTERNAL_SOURCE."CUSTOMER_NK","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("CUSTOMER_SK", "CUSTOMER_NK", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "INGEST_DATE")
    values
        ("CUSTOMER_SK", "CUSTOMER_NK", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "INGEST_DATE")

;
[0m20:55:56.546894 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0dc3-0000-e3bf-0001-b3ce00019136
[0m20:55:56.546894 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 3 at position 13
invalid identifier 'DBT_INTERNAL_SOURCE.CUSTOMER_EMAIL'
[0m20:55:56.546894 [debug] [Thread-1 (]: Database Error in model dim_customers (models\dim\dim_customers.sql)
  000904 (42000): SQL compilation error: error line 3 at position 13
  invalid identifier 'DBT_INTERNAL_SOURCE.CUSTOMER_EMAIL'
  compiled code at target\run\ManyPets\models\dim\dim_customers.sql
[0m20:55:56.570500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8544426b-6bc5-4b5a-8c2a-0b8268511a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000126A08E7E20>]}
[0m20:55:56.570500 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model odl.dim_customers .................. [[31mERROR[0m in 2.16s]
[0m20:55:56.578837 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m20:55:56.579841 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.dim_customers' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers (models\dim\dim_customers.sql)
  000904 (42000): SQL compilation error: error line 3 at position 13
  invalid identifier 'DBT_INTERNAL_SOURCE.CUSTOMER_EMAIL'
  compiled code at target\run\ManyPets\models\dim\dim_customers.sql.
[0m20:55:56.589170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:55:56.589170 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m20:55:56.589170 [debug] [MainThread]: On list_DEV: Close
[0m20:55:56.699809 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m20:55:56.708003 [debug] [MainThread]: On list_DEV_odl: Close
[0m20:55:56.812884 [debug] [MainThread]: Connection 'model.ManyPets.dim_customers' was left open.
[0m20:55:56.828226 [debug] [MainThread]: On model.ManyPets.dim_customers: Close
[0m20:55:56.952831 [info ] [MainThread]: 
[0m20:55:56.956181 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.50 seconds (4.50s).
[0m20:55:56.960644 [debug] [MainThread]: Command end result
[0m20:55:57.155171 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:55:57.167143 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:55:57.186748 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m20:55:57.188751 [info ] [MainThread]: 
[0m20:55:57.191295 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:55:57.193663 [info ] [MainThread]: 
[0m20:55:57.196626 [error] [MainThread]:   Database Error in model dim_customers (models\dim\dim_customers.sql)
  000904 (42000): SQL compilation error: error line 3 at position 13
  invalid identifier 'DBT_INTERNAL_SOURCE.CUSTOMER_EMAIL'
  compiled code at target\run\ManyPets\models\dim\dim_customers.sql
[0m20:55:57.198722 [info ] [MainThread]: 
[0m20:55:57.201739 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:55:57.203777 [debug] [MainThread]: Command `dbt run` failed at 20:55:57.203777 after 8.08 seconds
[0m20:55:57.208718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001269C4C60B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001269ECC1840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001269C80EE00>]}
[0m20:55:57.213452 [debug] [MainThread]: Flushing usage events
[0m20:55:58.001959 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:57:03.801000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C9C135FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C9E05E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C9E05E7A0>]}


============================== 20:57:03.807802 | 1817c387-6333-4a08-8518-ee822025a604 ==============================
[0m20:57:03.807802 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:57:03.812449 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select dim_customers', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:57:05.016800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1817c387-6333-4a08-8518-ee822025a604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C9C48DED0>]}
[0m20:57:05.138662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1817c387-6333-4a08-8518-ee822025a604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C9DECB2B0>]}
[0m20:57:05.142303 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:57:05.768430 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:57:06.320382 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:57:06.320382 [debug] [MainThread]: Partial parsing: updated file: ManyPets://models\dim\dim_customers.sql
[0m20:57:07.148516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1817c387-6333-4a08-8518-ee822025a604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CA001D6F0>]}
[0m20:57:07.690479 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:57:07.703510 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:57:07.776336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1817c387-6333-4a08-8518-ee822025a604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C9FEB6B90>]}
[0m20:57:07.778952 [info ] [MainThread]: Found 6 models, 5 data tests, 2 sources, 591 macros
[0m20:57:07.781745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1817c387-6333-4a08-8518-ee822025a604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C9FF134C0>]}
[0m20:57:07.783986 [info ] [MainThread]: 
[0m20:57:07.788923 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:57:07.791999 [info ] [MainThread]: 
[0m20:57:07.794445 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:57:07.808554 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m20:57:08.093362 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m20:57:08.093362 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m20:57:08.093362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:08.980127 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.877 seconds
[0m20:57:09.006873 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m20:57:09.027847 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m20:57:09.027847 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m20:57:09.027847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:09.801885 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.761 seconds
[0m20:57:09.806608 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m20:57:09.817760 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m20:57:09.817760 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m20:57:09.919313 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.099 seconds
[0m20:57:09.925530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1817c387-6333-4a08-8518-ee822025a604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CA0011120>]}
[0m20:57:09.937673 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m20:57:09.938671 [info ] [Thread-1 (]: 1 of 1 START sql incremental model odl.dim_customers ........................... [RUN]
[0m20:57:09.941157 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.dim_customers'
[0m20:57:09.942154 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m20:57:09.997999 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m20:57:10.000690 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m20:57:10.138878 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m20:57:10.139876 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace  temporary view DEV.odl.dim_customers__dbt_tmp
  
   as (
    
WITH stg_data AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date  
    FROM DEV.staging.stg_orders
    
    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.dim_customers)
    
),
dedup AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date,
        ROW_NUMBER() OVER (PARTITION BY customer_email ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)

SELECT
    md5(cast(coalesce(cast(customer_email as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))              AS customer_sk,  
    customer_email                                                          AS customer_nk, 
    customer_name,
    customer_dob,
    customer_phone,
    customer_address,
    customer_city,
    customer_country,
    customer_postcode,
    ingest_date
FROM dedup
WHERE rnk = 1
  );
[0m20:57:10.139876 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:57:10.941736 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.812 seconds
[0m20:57:10.990375 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m20:57:10.990375 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table DEV.odl.dim_customers__dbt_tmp
[0m20:57:11.088016 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.090 seconds
[0m20:57:11.109009 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m20:57:11.109009 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table DEV.odl.dim_customers
[0m20:57:11.185575 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.073 seconds
[0m20:57:11.236719 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m20:57:11.236719 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table "DEV"."ODL"."DIM_CUSTOMERS"
[0m20:57:11.330620 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.088 seconds
[0m20:57:11.445268 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_customers"
[0m20:57:11.453257 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m20:57:11.454259 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m20:57:11.580875 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.126 seconds
[0m20:57:11.580875 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m20:57:11.580875 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
merge into DEV.odl.dim_customers as DBT_INTERNAL_DEST
        using DEV.odl.dim_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.customer_nk = DBT_INTERNAL_DEST.customer_nk))

    
    when matched then update set
        "CUSTOMER_SK" = DBT_INTERNAL_SOURCE."CUSTOMER_SK","CUSTOMER_NK" = DBT_INTERNAL_SOURCE."CUSTOMER_NK","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("CUSTOMER_SK", "CUSTOMER_NK", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "INGEST_DATE")
    values
        ("CUSTOMER_SK", "CUSTOMER_NK", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "INGEST_DATE")

;
[0m20:57:12.852167 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.267 seconds
[0m20:57:12.852167 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m20:57:12.852167 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
COMMIT
[0m20:57:13.157783 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.298 seconds
[0m20:57:13.187194 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_customers__dbt_tmp
[0m20:57:13.223174 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m20:57:13.233758 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
drop view if exists DEV.odl.dim_customers__dbt_tmp cascade
[0m20:57:13.354979 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.122 seconds
[0m20:57:13.465717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1817c387-6333-4a08-8518-ee822025a604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CA07CE890>]}
[0m20:57:13.465717 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model odl.dim_customers ...................... [[32mSUCCESS 0[0m in 3.51s]
[0m20:57:13.469853 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m20:57:13.473832 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:57:13.475142 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m20:57:13.475929 [debug] [MainThread]: On list_DEV: Close
[0m20:57:13.587838 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m20:57:13.587838 [debug] [MainThread]: On list_DEV_odl: Close
[0m20:57:13.707076 [debug] [MainThread]: Connection 'model.ManyPets.dim_customers' was left open.
[0m20:57:13.707076 [debug] [MainThread]: On model.ManyPets.dim_customers: Close
[0m20:57:13.890531 [info ] [MainThread]: 
[0m20:57:13.898012 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.10 seconds (6.10s).
[0m20:57:13.902003 [debug] [MainThread]: Command end result
[0m20:57:14.075384 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:57:14.080395 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:57:14.089890 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m20:57:14.104400 [info ] [MainThread]: 
[0m20:57:14.107203 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:57:14.109436 [info ] [MainThread]: 
[0m20:57:14.112278 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:57:14.118321 [debug] [MainThread]: Command `dbt run` succeeded at 20:57:14.118321 after 10.53 seconds
[0m20:57:14.118321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C9C135FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C9C437A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CA0020190>]}
[0m20:57:14.118321 [debug] [MainThread]: Flushing usage events
[0m20:57:14.957230 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:01:56.104068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140D9195FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140DB0BE980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140DB0BE7A0>]}


============================== 21:01:56.111088 | 1c8638e3-ea7f-4a7d-99be-5f5c16da2167 ==============================
[0m21:01:56.111088 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:01:56.114259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select dim_customers', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:01:57.302201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c8638e3-ea7f-4a7d-99be-5f5c16da2167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140D94EDED0>]}
[0m21:01:57.440537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c8638e3-ea7f-4a7d-99be-5f5c16da2167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140DAF2B2B0>]}
[0m21:01:57.446029 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m21:01:58.100071 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m21:01:58.718992 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:01:58.718992 [debug] [MainThread]: Partial parsing: updated file: ManyPets://models\dim\dim_customers.sql
[0m21:01:59.459721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c8638e3-ea7f-4a7d-99be-5f5c16da2167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140DD0796F0>]}
[0m21:01:59.745773 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m21:01:59.753040 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m21:01:59.819821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c8638e3-ea7f-4a7d-99be-5f5c16da2167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140DCF16B90>]}
[0m21:01:59.819821 [info ] [MainThread]: Found 6 models, 5 data tests, 2 sources, 591 macros
[0m21:01:59.823602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c8638e3-ea7f-4a7d-99be-5f5c16da2167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140DCF734C0>]}
[0m21:01:59.824603 [info ] [MainThread]: 
[0m21:01:59.828552 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:01:59.831639 [info ] [MainThread]: 
[0m21:01:59.833007 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:01:59.836521 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m21:02:00.104197 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m21:02:00.104197 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m21:02:00.104197 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:02:01.008765 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.902 seconds
[0m21:02:01.043166 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m21:02:01.098467 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m21:02:01.102481 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m21:02:01.102481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:02:01.744365 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.652 seconds
[0m21:02:01.759701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m21:02:01.775346 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m21:02:01.775346 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m21:02:01.898845 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.117 seconds
[0m21:02:01.898845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c8638e3-ea7f-4a7d-99be-5f5c16da2167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140DD6F8130>]}
[0m21:02:01.927849 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m21:02:01.927849 [info ] [Thread-1 (]: 1 of 1 START sql incremental model odl.dim_customers ........................... [RUN]
[0m21:02:01.935201 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.dim_customers'
[0m21:02:01.935201 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m21:02:02.009184 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m21:02:02.016735 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m21:02:02.180663 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m21:02:02.180663 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace  temporary view DEV.odl.dim_customers__dbt_tmp
  
   as (
    
WITH stg_data AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date  
    FROM DEV.staging.stg_orders
    
    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.dim_customers)
    
),
dedup AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date,
        ROW_NUMBER() OVER (PARTITION BY customer_email ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    customer_email                                                          AS customer_nk, 
    md5(cast(coalesce(cast( as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                   AS customer_sk,
    customer_name,
    customer_dob,
    customer_phone,
    customer_address,
    customer_city,
    customer_country,
    customer_postcode,
    ingest_date
FROM dedup
WHERE rnk = 1
  );
[0m21:02:02.180663 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:02:02.789216 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0dc9-0000-e3b4-0000-0001b3ceb201
[0m21:02:02.789216 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 38 at position 28 unexpected 'as'.
[0m21:02:02.798945 [debug] [Thread-1 (]: Database Error in model dim_customers (models\dim\dim_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 38 at position 28 unexpected 'as'.
[0m21:02:02.810151 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c8638e3-ea7f-4a7d-99be-5f5c16da2167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140D9001240>]}
[0m21:02:02.810151 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model odl.dim_customers .................. [[31mERROR[0m in 0.86s]
[0m21:02:02.818351 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m21:02:02.821887 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.dim_customers' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers (models\dim\dim_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 38 at position 28 unexpected 'as'..
[0m21:02:02.828906 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:02:02.828906 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m21:02:02.828906 [debug] [MainThread]: On list_DEV: Close
[0m21:02:02.939742 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m21:02:02.939742 [debug] [MainThread]: On list_DEV_staging: Close
[0m21:02:03.064065 [debug] [MainThread]: Connection 'model.ManyPets.dim_customers' was left open.
[0m21:02:03.064065 [debug] [MainThread]: On model.ManyPets.dim_customers: Close
[0m21:02:03.213594 [info ] [MainThread]: 
[0m21:02:03.222065 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.38 seconds (3.38s).
[0m21:02:03.229605 [debug] [MainThread]: Command end result
[0m21:02:03.386174 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m21:02:03.397001 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m21:02:03.418262 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m21:02:03.419381 [info ] [MainThread]: 
[0m21:02:03.423892 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:02:03.425352 [info ] [MainThread]: 
[0m21:02:03.428142 [error] [MainThread]:   Database Error in model dim_customers (models\dim\dim_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 38 at position 28 unexpected 'as'.
[0m21:02:03.431525 [info ] [MainThread]: 
[0m21:02:03.434470 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:02:03.436526 [debug] [MainThread]: Command `dbt run` failed at 21:02:03.436526 after 7.48 seconds
[0m21:02:03.436526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140D9195FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140DAF2B2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000140DD07C190>]}
[0m21:02:03.440956 [debug] [MainThread]: Flushing usage events
[0m21:02:04.263378 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:02:43.013812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F142B95FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F144ABE980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F144ABE7A0>]}


============================== 21:02:43.021106 | fbde1b08-89d1-4aaa-b877-bdec7ff37f91 ==============================
[0m21:02:43.021106 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:02:43.024761 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_customers', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:02:44.208055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbde1b08-89d1-4aaa-b877-bdec7ff37f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F142EEDED0>]}
[0m21:02:44.319173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbde1b08-89d1-4aaa-b877-bdec7ff37f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F14492B2B0>]}
[0m21:02:44.321734 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m21:02:45.084176 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m21:02:45.770401 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:02:45.772433 [debug] [MainThread]: Partial parsing: updated file: ManyPets://models\dim\dim_customers.sql
[0m21:02:46.481603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbde1b08-89d1-4aaa-b877-bdec7ff37f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F146A756F0>]}
[0m21:02:46.686368 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m21:02:46.693550 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m21:02:46.759919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbde1b08-89d1-4aaa-b877-bdec7ff37f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F146916B90>]}
[0m21:02:46.760748 [info ] [MainThread]: Found 6 models, 5 data tests, 2 sources, 591 macros
[0m21:02:46.763233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbde1b08-89d1-4aaa-b877-bdec7ff37f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1469734C0>]}
[0m21:02:46.764231 [info ] [MainThread]: 
[0m21:02:46.768935 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:02:46.771393 [info ] [MainThread]: 
[0m21:02:46.774010 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:02:46.779686 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m21:02:47.038147 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m21:02:47.039489 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m21:02:47.040496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:02:48.019348 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.983 seconds
[0m21:02:48.056651 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m21:02:48.093516 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m21:02:48.093516 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m21:02:48.093516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:02:48.547807 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.451 seconds
[0m21:02:48.567742 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m21:02:48.570405 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m21:02:48.570405 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m21:02:48.700836 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.119 seconds
[0m21:02:48.716266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbde1b08-89d1-4aaa-b877-bdec7ff37f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1470F8130>]}
[0m21:02:48.735719 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m21:02:48.739523 [info ] [Thread-1 (]: 1 of 1 START sql incremental model odl.dim_customers ........................... [RUN]
[0m21:02:48.744361 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.dim_customers'
[0m21:02:48.744361 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m21:02:48.822293 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m21:02:48.822293 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m21:02:48.947257 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m21:02:48.947257 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace  temporary view DEV.odl.dim_customers__dbt_tmp
  
   as (
    
WITH stg_data AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date  
    FROM DEV.staging.stg_orders
    
    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.dim_customers)
    
),
dedup AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date,
        ROW_NUMBER() OVER (PARTITION BY customer_email ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    customer_email                                                          AS customer_nk, 
    md5(cast(coalesce(cast(customer_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                 AS customer_sk,
    customer_name,
    customer_dob,
    customer_phone,
    customer_address,
    customer_city,
    customer_country,
    customer_postcode,
    ingest_date
FROM dedup
WHERE rnk = 1
  );
[0m21:02:48.947257 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:02:49.537340 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.577 seconds
[0m21:02:49.570275 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m21:02:49.570275 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table DEV.odl.dim_customers__dbt_tmp
[0m21:02:49.694061 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.110 seconds
[0m21:02:49.709686 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m21:02:49.709686 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table DEV.odl.dim_customers
[0m21:02:49.802562 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.087 seconds
[0m21:02:49.837985 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m21:02:49.837985 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table "DEV"."ODL"."DIM_CUSTOMERS"
[0m21:02:49.922539 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.078 seconds
[0m21:02:50.038324 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_customers"
[0m21:02:50.047442 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m21:02:50.047442 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m21:02:50.187189 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.139 seconds
[0m21:02:50.187189 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m21:02:50.187189 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
merge into DEV.odl.dim_customers as DBT_INTERNAL_DEST
        using DEV.odl.dim_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.customer_nk = DBT_INTERNAL_DEST.customer_nk))

    
    when matched then update set
        "CUSTOMER_SK" = DBT_INTERNAL_SOURCE."CUSTOMER_SK","CUSTOMER_NK" = DBT_INTERNAL_SOURCE."CUSTOMER_NK","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("CUSTOMER_SK", "CUSTOMER_NK", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "INGEST_DATE")
    values
        ("CUSTOMER_SK", "CUSTOMER_NK", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "INGEST_DATE")

;
[0m21:02:51.581907 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.391 seconds
[0m21:02:51.581907 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m21:02:51.597634 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
COMMIT
[0m21:02:51.894226 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.294 seconds
[0m21:02:51.931679 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_customers__dbt_tmp
[0m21:02:51.947350 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m21:02:51.963000 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
drop view if exists DEV.odl.dim_customers__dbt_tmp cascade
[0m21:02:52.083651 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.120 seconds
[0m21:02:52.187141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbde1b08-89d1-4aaa-b877-bdec7ff37f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F14723A7D0>]}
[0m21:02:52.188141 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model odl.dim_customers ...................... [[32mSUCCESS 0[0m in 3.43s]
[0m21:02:52.192434 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m21:02:52.194656 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:02:52.195653 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m21:02:52.195653 [debug] [MainThread]: On list_DEV: Close
[0m21:02:52.284721 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m21:02:52.284721 [debug] [MainThread]: On list_DEV_staging: Close
[0m21:02:52.409583 [debug] [MainThread]: Connection 'model.ManyPets.dim_customers' was left open.
[0m21:02:52.409583 [debug] [MainThread]: On model.ManyPets.dim_customers: Close
[0m21:02:52.670620 [info ] [MainThread]: 
[0m21:02:52.677703 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.90 seconds (5.90s).
[0m21:02:52.681775 [debug] [MainThread]: Command end result
[0m21:02:52.864155 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m21:02:52.868765 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m21:02:52.893581 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m21:02:52.894583 [info ] [MainThread]: 
[0m21:02:52.898914 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:02:52.900498 [info ] [MainThread]: 
[0m21:02:52.904071 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:02:52.906780 [debug] [MainThread]: Command `dbt run` succeeded at 21:02:52.906780 after 10.04 seconds
[0m21:02:52.906780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F142B95FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F142E93A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F146A7C190>]}
[0m21:02:52.920635 [debug] [MainThread]: Flushing usage events
[0m21:02:53.530333 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:12:57.455630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C22DC16080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C22FB3E9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C22FB3E800>]}


============================== 21:12:57.462403 | 80232667-7c3c-4f7f-86ca-e4bad4be9ee6 ==============================
[0m21:12:57.462403 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:12:57.463403 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_pets', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:12:58.267632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80232667-7c3c-4f7f-86ca-e4bad4be9ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C22FAD7CD0>]}
[0m21:12:58.366363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80232667-7c3c-4f7f-86ca-e4bad4be9ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C22F62DB10>]}
[0m21:12:58.369367 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m21:12:58.910210 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m21:12:59.327183 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:12:59.328183 [debug] [MainThread]: Partial parsing: updated file: ManyPets://models\dim\dim_pets.sql
[0m21:12:59.936727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80232667-7c3c-4f7f-86ca-e4bad4be9ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C231AF97E0>]}
[0m21:13:00.167908 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m21:13:00.173922 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m21:13:00.227783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80232667-7c3c-4f7f-86ca-e4bad4be9ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C231996D10>]}
[0m21:13:00.228771 [info ] [MainThread]: Found 6 models, 5 data tests, 2 sources, 591 macros
[0m21:13:00.230767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80232667-7c3c-4f7f-86ca-e4bad4be9ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C231A5F7C0>]}
[0m21:13:00.232616 [info ] [MainThread]: 
[0m21:13:00.234603 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:13:00.239970 [info ] [MainThread]: 
[0m21:13:00.241970 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:13:00.244969 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m21:13:00.412077 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m21:13:00.414403 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m21:13:00.414598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:01.126367 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.711 seconds
[0m21:13:01.147088 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m21:13:01.165171 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m21:13:01.166155 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m21:13:01.166155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:01.503517 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.336 seconds
[0m21:13:01.508519 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m21:13:01.520227 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m21:13:01.521227 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m21:13:01.624147 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.102 seconds
[0m21:13:01.633097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80232667-7c3c-4f7f-86ca-e4bad4be9ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2304B70D0>]}
[0m21:13:01.648476 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_pets
[0m21:13:01.650478 [info ] [Thread-1 (]: 1 of 1 START sql incremental model odl.dim_pets ................................ [RUN]
[0m21:13:01.654484 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.dim_pets'
[0m21:13:01.656468 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_pets
[0m21:13:01.684749 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_pets"
[0m21:13:01.686744 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_pets
[0m21:13:01.783139 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_pets"
[0m21:13:01.787131 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m21:13:01.788134 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
create or replace transient table DEV.odl.dim_pets
         as
        (

WITH stg_data AS (
    SELECT
        email AS customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date
    FROM DEV.staging.stg_orders
    
    
),

dedup AS (
    SELECT
        customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date,
        ROW_NUMBER() OVER(PARTITION BY customer_email, pet_dob, pet_name, pet_breed ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    d.customer_email || '|' || d.pet_name || '|' || d.pet_dob || '|' || d.pet_breed AS pet_nk,  
    md5(cast(coalesce(cast(pet_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                              AS pet_sk,  
    c.customer_sk,  
    d.pet_name,
    d.pet_dob,
    d.pet_breed,
    d.pet_gender,
    d.pet_species,
    d.pedigree_type,
    d.spayed_neutered,
    d.pet_postcode,
    d.pet_value,
    d.ingest_date
    
FROM dedup AS d
INNER JOIN DEV.odl.dim_customers AS c ON (d.customer_email = c.customer_nk)
WHERE d.rnk = 1
        );
[0m21:13:01.789145 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:13:02.314494 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0dd4-0000-e39c-0001-b3ce0001c0da
[0m21:13:02.315502 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEV.ODL.DIM_CUSTOMERS' does not exist or not authorized.
[0m21:13:02.319499 [debug] [Thread-1 (]: Database Error in model dim_pets (models\dim\dim_pets.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEV.ODL.DIM_CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\ManyPets\models\dim\dim_pets.sql
[0m21:13:02.323961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80232667-7c3c-4f7f-86ca-e4bad4be9ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2321CFA60>]}
[0m21:13:02.324993 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model odl.dim_pets ....................... [[31mERROR[0m in 0.67s]
[0m21:13:02.327393 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_pets
[0m21:13:02.328393 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.dim_pets' to be skipped because of status 'error'.  Reason: Database Error in model dim_pets (models\dim\dim_pets.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEV.ODL.DIM_CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\ManyPets\models\dim\dim_pets.sql.
[0m21:13:02.331556 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:13:02.332563 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m21:13:02.332563 [debug] [MainThread]: On list_DEV: Close
[0m21:13:02.436470 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m21:13:02.437472 [debug] [MainThread]: On list_DEV_odl: Close
[0m21:13:02.521126 [debug] [MainThread]: Connection 'model.ManyPets.dim_pets' was left open.
[0m21:13:02.522128 [debug] [MainThread]: On model.ManyPets.dim_pets: Close
[0m21:13:02.630337 [info ] [MainThread]: 
[0m21:13:02.633772 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.39 seconds (2.39s).
[0m21:13:02.639070 [debug] [MainThread]: Command end result
[0m21:13:02.702923 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m21:13:02.706546 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m21:13:02.718561 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m21:13:02.720581 [info ] [MainThread]: 
[0m21:13:02.721564 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:13:02.722566 [info ] [MainThread]: 
[0m21:13:02.724559 [error] [MainThread]:   Database Error in model dim_pets (models\dim\dim_pets.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEV.ODL.DIM_CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\ManyPets\models\dim\dim_pets.sql
[0m21:13:02.725565 [info ] [MainThread]: 
[0m21:13:02.726566 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:13:02.729020 [debug] [MainThread]: Command `dbt run` failed at 21:13:02.729020 after 5.40 seconds
[0m21:13:02.731024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C22DC16080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C22F62DB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C22DF5E680>]}
[0m21:13:02.731024 [debug] [MainThread]: Flushing usage events
[0m21:13:08.757782 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:13:22.104826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211B6BB60B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211B8ADEC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211B8ADEA40>]}


============================== 21:13:22.112004 | 4c3bd3bc-84a9-48a5-b8e5-325b7681457e ==============================
[0m21:13:22.112004 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:13:22.114023 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_customers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:13:22.922249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c3bd3bc-84a9-48a5-b8e5-325b7681457e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211B85F4B80>]}
[0m21:13:23.032896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c3bd3bc-84a9-48a5-b8e5-325b7681457e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211B9393490>]}
[0m21:13:23.035347 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m21:13:23.535263 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m21:13:23.924289 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:13:23.924289 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:13:24.017337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c3bd3bc-84a9-48a5-b8e5-325b7681457e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211BA9A3F10>]}
[0m21:13:24.261079 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m21:13:24.267084 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m21:13:24.322012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c3bd3bc-84a9-48a5-b8e5-325b7681457e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211BA994580>]}
[0m21:13:24.324013 [info ] [MainThread]: Found 6 models, 5 data tests, 2 sources, 591 macros
[0m21:13:24.326545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c3bd3bc-84a9-48a5-b8e5-325b7681457e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211BA994550>]}
[0m21:13:24.328549 [info ] [MainThread]: 
[0m21:13:24.330545 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:13:24.331541 [info ] [MainThread]: 
[0m21:13:24.336540 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:13:24.339563 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m21:13:24.499000 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m21:13:24.500000 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m21:13:24.500000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:25.109079 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.608 seconds
[0m21:13:25.148568 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m21:13:25.183050 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m21:13:25.184050 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m21:13:25.184050 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:25.676519 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.491 seconds
[0m21:13:25.679527 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m21:13:25.684521 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m21:13:25.684521 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m21:13:25.793016 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.108 seconds
[0m21:13:25.798006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c3bd3bc-84a9-48a5-b8e5-325b7681457e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211BAF244F0>]}
[0m21:13:25.809030 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m21:13:25.810028 [info ] [Thread-1 (]: 1 of 1 START sql incremental model odl.dim_customers ........................... [RUN]
[0m21:13:25.812752 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.dim_customers'
[0m21:13:25.813744 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m21:13:25.860494 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m21:13:25.862500 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m21:13:25.957067 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_customers"
[0m21:13:25.960687 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m21:13:25.961665 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace transient table DEV.odl.dim_customers
         as
        (
WITH stg_data AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date  
    FROM DEV.staging.stg_orders
    
    
),
dedup AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date,
        ROW_NUMBER() OVER (PARTITION BY customer_email ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    customer_email                                                          AS customer_nk, 
    md5(cast(coalesce(cast(customer_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                 AS customer_sk,
    customer_name,
    customer_dob,
    customer_phone,
    customer_address,
    customer_city,
    customer_country,
    customer_postcode,
    ingest_date
FROM dedup
WHERE rnk = 1
        );
[0m21:13:25.961665 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:13:27.663013 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.701 seconds
[0m21:13:27.691467 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_customers__dbt_tmp
[0m21:13:27.701476 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m21:13:27.702492 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
drop view if exists DEV.odl.dim_customers__dbt_tmp cascade
[0m21:13:27.776997 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.074 seconds
[0m21:13:27.819878 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c3bd3bc-84a9-48a5-b8e5-325b7681457e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211BB0C6D10>]}
[0m21:13:27.820897 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model odl.dim_customers ...................... [[32mSUCCESS 1[0m in 2.01s]
[0m21:13:27.823452 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m21:13:27.825942 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:13:27.825942 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m21:13:27.826942 [debug] [MainThread]: On list_DEV: Close
[0m21:13:27.930465 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m21:13:27.931466 [debug] [MainThread]: On list_DEV_staging: Close
[0m21:13:28.026755 [debug] [MainThread]: Connection 'model.ManyPets.dim_customers' was left open.
[0m21:13:28.027757 [debug] [MainThread]: On model.ManyPets.dim_customers: Close
[0m21:13:28.140973 [info ] [MainThread]: 
[0m21:13:28.144141 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.80 seconds (3.80s).
[0m21:13:28.149141 [debug] [MainThread]: Command end result
[0m21:13:28.217282 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m21:13:28.222298 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m21:13:28.234145 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m21:13:28.235158 [info ] [MainThread]: 
[0m21:13:28.236159 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:13:28.238157 [info ] [MainThread]: 
[0m21:13:28.239172 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:13:28.242345 [debug] [MainThread]: Command `dbt run` succeeded at 21:13:28.241337 after 6.29 seconds
[0m21:13:28.242345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211B6BB60B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211B93AA260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211B6EFEE00>]}
[0m21:13:28.243353 [debug] [MainThread]: Flushing usage events
[0m21:13:28.702162 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:13:39.596779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB673960B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB692BEC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB692BEA40>]}


============================== 21:13:39.603527 | 493ee019-cc4d-4157-9439-ad4aa04bb1e6 ==============================
[0m21:13:39.603527 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:13:39.604527 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_pets', 'send_anonymous_usage_stats': 'True'}
[0m21:13:40.438286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '493ee019-cc4d-4157-9439-ad4aa04bb1e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB68DD0B80>]}
[0m21:13:40.560490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '493ee019-cc4d-4157-9439-ad4aa04bb1e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB69B73490>]}
[0m21:13:40.563494 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m21:13:41.151079 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m21:13:41.540315 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:13:41.541314 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:13:41.635158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '493ee019-cc4d-4157-9439-ad4aa04bb1e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB6B183F10>]}
[0m21:13:41.877976 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m21:13:41.885980 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m21:13:41.939781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '493ee019-cc4d-4157-9439-ad4aa04bb1e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB6B170580>]}
[0m21:13:41.941833 [info ] [MainThread]: Found 6 models, 5 data tests, 2 sources, 591 macros
[0m21:13:41.943556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '493ee019-cc4d-4157-9439-ad4aa04bb1e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB6B170550>]}
[0m21:13:41.947555 [info ] [MainThread]: 
[0m21:13:41.948554 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:13:41.950586 [info ] [MainThread]: 
[0m21:13:41.952556 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:13:41.955581 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m21:13:42.147276 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m21:13:42.149276 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m21:13:42.150265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:42.788488 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.638 seconds
[0m21:13:42.802491 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m21:13:42.819462 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m21:13:42.819462 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m21:13:42.820462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:43.194250 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.374 seconds
[0m21:13:43.203271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m21:13:43.212511 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m21:13:43.214193 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m21:13:43.331545 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.117 seconds
[0m21:13:43.342107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '493ee019-cc4d-4157-9439-ad4aa04bb1e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB6B7044F0>]}
[0m21:13:43.358086 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_pets
[0m21:13:43.359386 [info ] [Thread-1 (]: 1 of 1 START sql incremental model odl.dim_pets ................................ [RUN]
[0m21:13:43.362375 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.dim_pets'
[0m21:13:43.363373 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_pets
[0m21:13:43.411449 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_pets"
[0m21:13:43.413451 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_pets
[0m21:13:43.512770 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_pets"
[0m21:13:43.516768 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m21:13:43.517770 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
create or replace transient table DEV.odl.dim_pets
         as
        (

WITH stg_data AS (
    SELECT
        email AS customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date
    FROM DEV.staging.stg_orders
    
    
),

dedup AS (
    SELECT
        customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date,
        ROW_NUMBER() OVER(PARTITION BY customer_email, pet_dob, pet_name, pet_breed ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    d.customer_email || '|' || d.pet_name || '|' || d.pet_dob || '|' || d.pet_breed AS pet_nk,  
    md5(cast(coalesce(cast(pet_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                              AS pet_sk,  
    c.customer_sk,  
    d.pet_name,
    d.pet_dob,
    d.pet_breed,
    d.pet_gender,
    d.pet_species,
    d.pedigree_type,
    d.spayed_neutered,
    d.pet_postcode,
    d.pet_value,
    d.ingest_date
    
FROM dedup AS d
INNER JOIN DEV.odl.dim_customers AS c ON (d.customer_email = c.customer_nk)
WHERE d.rnk = 1
        );
[0m21:13:43.518773 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:13:44.049293 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0dd4-0000-e3c5-0001-b3ce00016196
[0m21:13:44.050297 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 8
invalid identifier 'EMAIL'
[0m21:13:44.055288 [debug] [Thread-1 (]: Database Error in model dim_pets (models\dim\dim_pets.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'EMAIL'
  compiled code at target\run\ManyPets\models\dim\dim_pets.sql
[0m21:13:44.060304 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '493ee019-cc4d-4157-9439-ad4aa04bb1e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB67202F50>]}
[0m21:13:44.061337 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model odl.dim_pets ....................... [[31mERROR[0m in 0.69s]
[0m21:13:44.063336 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_pets
[0m21:13:44.064342 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.dim_pets' to be skipped because of status 'error'.  Reason: Database Error in model dim_pets (models\dim\dim_pets.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'EMAIL'
  compiled code at target\run\ManyPets\models\dim\dim_pets.sql.
[0m21:13:44.067337 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:13:44.068340 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m21:13:44.068340 [debug] [MainThread]: On list_DEV: Close
[0m21:13:44.216096 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m21:13:44.217097 [debug] [MainThread]: On list_DEV_staging: Close
[0m21:13:44.329879 [debug] [MainThread]: Connection 'model.ManyPets.dim_pets' was left open.
[0m21:13:44.331879 [debug] [MainThread]: On model.ManyPets.dim_pets: Close
[0m21:13:44.439060 [info ] [MainThread]: 
[0m21:13:44.442027 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.49 seconds (2.49s).
[0m21:13:44.446022 [debug] [MainThread]: Command end result
[0m21:13:44.524610 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m21:13:44.528566 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m21:13:44.540576 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m21:13:44.541567 [info ] [MainThread]: 
[0m21:13:44.542562 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:13:44.544563 [info ] [MainThread]: 
[0m21:13:44.545452 [error] [MainThread]:   Database Error in model dim_pets (models\dim\dim_pets.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'EMAIL'
  compiled code at target\run\ManyPets\models\dim\dim_pets.sql
[0m21:13:44.547466 [info ] [MainThread]: 
[0m21:13:44.549465 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:13:44.551496 [debug] [MainThread]: Command `dbt run` failed at 21:13:44.551496 after 5.08 seconds
[0m21:13:44.552470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB673960B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB676DCBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB6B8CF880>]}
[0m21:13:44.553470 [debug] [MainThread]: Flushing usage events
[0m21:13:45.014000 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:14:08.977406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477A336020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477C25EB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477C25E9B0>]}


============================== 21:14:08.984839 | 4f0ed6f7-9d6e-4565-a206-0413fa928c17 ==============================
[0m21:14:08.984839 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:14:08.985852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_pets', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:14:09.785184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f0ed6f7-9d6e-4565-a206-0413fa928c17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024778BF5C60>]}
[0m21:14:09.885042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f0ed6f7-9d6e-4565-a206-0413fa928c17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477C101B70>]}
[0m21:14:09.887108 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m21:14:10.385578 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m21:14:10.772625 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:14:10.773626 [debug] [MainThread]: Partial parsing: updated file: ManyPets://models\dim\dim_pets.sql
[0m21:14:11.332709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f0ed6f7-9d6e-4565-a206-0413fa928c17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477E219780>]}
[0m21:14:11.518812 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m21:14:11.524807 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m21:14:11.576717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f0ed6f7-9d6e-4565-a206-0413fa928c17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477E0B6D10>]}
[0m21:14:11.577715 [info ] [MainThread]: Found 6 models, 5 data tests, 2 sources, 591 macros
[0m21:14:11.579718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f0ed6f7-9d6e-4565-a206-0413fa928c17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477E183790>]}
[0m21:14:11.581420 [info ] [MainThread]: 
[0m21:14:11.583439 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:14:11.584136 [info ] [MainThread]: 
[0m21:14:11.586149 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:14:11.589149 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m21:14:11.733520 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m21:14:11.734520 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m21:14:11.734520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:14:12.770700 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.036 seconds
[0m21:14:12.785291 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m21:14:12.802848 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m21:14:12.802848 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m21:14:12.803846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:14:13.299257 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.495 seconds
[0m21:14:13.305257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m21:14:13.318019 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m21:14:13.319018 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m21:14:13.422709 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.103 seconds
[0m21:14:13.435233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f0ed6f7-9d6e-4565-a206-0413fa928c17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477CBD2DA0>]}
[0m21:14:13.448780 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_pets
[0m21:14:13.449783 [info ] [Thread-1 (]: 1 of 1 START sql incremental model odl.dim_pets ................................ [RUN]
[0m21:14:13.451785 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.dim_pets'
[0m21:14:13.452797 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_pets
[0m21:14:13.475574 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_pets"
[0m21:14:13.477579 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_pets
[0m21:14:13.582768 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_pets"
[0m21:14:13.586767 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m21:14:13.586767 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
create or replace transient table DEV.odl.dim_pets
         as
        (

WITH stg_data AS (
    SELECT
        customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date
    FROM DEV.staging.stg_orders
    
    
),

dedup AS (
    SELECT
        customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date,
        ROW_NUMBER() OVER(PARTITION BY customer_email, pet_dob, pet_name, pet_breed ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    d.customer_email || '|' || d.pet_name || '|' || d.pet_dob || '|' || d.pet_breed AS pet_nk,  
    md5(cast(coalesce(cast(pet_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                              AS pet_sk,  
    c.customer_sk,  
    d.pet_name,
    d.pet_dob,
    d.pet_breed,
    d.pet_gender,
    d.pet_species,
    d.pedigree_type,
    d.spayed_neutered,
    d.pet_postcode,
    d.pet_value,
    d.ingest_date
    
FROM dedup AS d
INNER JOIN DEV.odl.dim_customers AS c ON (d.customer_email = c.customer_nk)
WHERE d.rnk = 1
        );
[0m21:14:13.587768 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:14:14.945832 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.358 seconds
[0m21:14:14.957836 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_pets__dbt_tmp
[0m21:14:14.967618 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m21:14:14.968620 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
drop view if exists DEV.odl.dim_pets__dbt_tmp cascade
[0m21:14:15.044376 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.076 seconds
[0m21:14:15.081383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f0ed6f7-9d6e-4565-a206-0413fa928c17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477E9BA920>]}
[0m21:14:15.082396 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model odl.dim_pets ........................... [[32mSUCCESS 1[0m in 1.63s]
[0m21:14:15.084389 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_pets
[0m21:14:15.086383 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:14:15.087383 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m21:14:15.087383 [debug] [MainThread]: On list_DEV: Close
[0m21:14:15.168072 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m21:14:15.169073 [debug] [MainThread]: On list_DEV_odl: Close
[0m21:14:15.300679 [debug] [MainThread]: Connection 'model.ManyPets.dim_pets' was left open.
[0m21:14:15.302680 [debug] [MainThread]: On model.ManyPets.dim_pets: Close
[0m21:14:15.406538 [info ] [MainThread]: 
[0m21:14:15.408548 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.82 seconds (3.82s).
[0m21:14:15.410750 [debug] [MainThread]: Command end result
[0m21:14:15.478942 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m21:14:15.482918 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m21:14:15.497919 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m21:14:15.497919 [info ] [MainThread]: 
[0m21:14:15.499918 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:14:15.500923 [info ] [MainThread]: 
[0m21:14:15.502307 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:14:15.504325 [debug] [MainThread]: Command `dbt run` succeeded at 21:14:15.504325 after 6.66 seconds
[0m21:14:15.505324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477A336020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477E29D960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477E21CFD0>]}
[0m21:14:15.506324 [debug] [MainThread]: Flushing usage events
[0m21:14:15.990347 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:07:15.981905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BA14E6020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BA340EB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BA340E9B0>]}


============================== 22:07:15.990724 | 1a4f0601-4a38-43f8-9f55-3164fde6fc0a ==============================
[0m22:07:15.990724 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:07:15.996585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select fact_orders', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:07:17.231174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a4f0601-4a38-43f8-9f55-3164fde6fc0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BA0569C60>]}
[0m22:07:17.369427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a4f0601-4a38-43f8-9f55-3164fde6fc0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BA32B1B70>]}
[0m22:07:17.380127 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:07:18.075928 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:07:18.783083 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m22:07:18.791189 [debug] [MainThread]: Partial parsing: updated file: ManyPets://models\staging\staging_schema.yml
[0m22:07:18.791189 [debug] [MainThread]: Partial parsing: updated file: ManyPets://models\staging\stg_orders.sql
[0m22:07:18.791189 [debug] [MainThread]: Partial parsing: updated file: ManyPets://models\fact\fact_orders.sql
[0m22:07:20.040780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a4f0601-4a38-43f8-9f55-3164fde6fc0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BA55C7E50>]}
[0m22:07:20.305895 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:07:20.321924 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:07:20.401780 [error] [MainThread]: Encountered an error:
Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_customers --> model.ManyPets.dim_pets
[0m22:07:20.528595 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\main.py", line 578, in run
    results = task.run()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 574, in run
    self._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\base.py", line 134, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 475, in compile
    linker.link_graph(manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 195, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_customers --> model.ManyPets.dim_pets

[0m22:07:20.541308 [debug] [MainThread]: Command `dbt run` failed at 22:07:20.541308 after 4.80 seconds
[0m22:07:20.541308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BA14E6020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BA55C4E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BA55C4C40>]}
[0m22:07:20.549348 [debug] [MainThread]: Flushing usage events
[0m22:07:21.210597 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:09:59.840771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029807E56050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029809D7E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029809D7E7D0>]}


============================== 22:09:59.847946 | b0c23d06-fa93-413d-8164-11bcd122c2ad ==============================
[0m22:09:59.847946 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:09:59.851958 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select fact_orders', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:10:01.119676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0c23d06-fa93-413d-8164-11bcd122c2ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002980990A500>]}
[0m22:10:01.244690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0c23d06-fa93-413d-8164-11bcd122c2ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029809C228C0>]}
[0m22:10:01.251216 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:10:02.044132 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:10:02.598380 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:10:02.598380 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:10:02.707970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0c23d06-fa93-413d-8164-11bcd122c2ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002980BC58130>]}
[0m22:10:03.018401 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:10:03.024975 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:10:03.100606 [error] [MainThread]: Encountered an error:
Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_customers --> model.ManyPets.dim_pets
[0m22:10:03.110044 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\main.py", line 578, in run
    results = task.run()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 574, in run
    self._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\base.py", line 134, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 475, in compile
    linker.link_graph(manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 195, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_customers --> model.ManyPets.dim_pets

[0m22:10:03.123182 [debug] [MainThread]: Command `dbt run` failed at 22:10:03.123182 after 3.44 seconds
[0m22:10:03.131201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029807E56050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002980A763AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002980A760CA0>]}
[0m22:10:03.131201 [debug] [MainThread]: Flushing usage events
[0m22:10:03.690902 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:19:30.708808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6A4715FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6A663E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6A663E7A0>]}


============================== 22:19:30.716503 | 16660e65-08a9-427d-8d13-5ee54847333d ==============================
[0m22:19:30.716503 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:19:30.722679 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select dim_pets', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:19:32.052278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16660e65-08a9-427d-8d13-5ee54847333d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6A4A6DED0>]}
[0m22:19:32.185307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16660e65-08a9-427d-8d13-5ee54847333d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6A64AB2B0>]}
[0m22:19:32.190170 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:19:32.928941 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:19:33.538855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:19:33.538855 [debug] [MainThread]: Partial parsing: updated file: ManyPets://models\dim\dim_pets.sql
[0m22:19:33.538855 [debug] [MainThread]: Partial parsing: updated file: ManyPets://models\fact\fact_orders.sql
[0m22:19:34.383733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16660e65-08a9-427d-8d13-5ee54847333d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6A8628130>]}
[0m22:19:34.667902 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:19:34.678248 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:19:34.741920 [error] [MainThread]: Encountered an error:
Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_customers
[0m22:19:34.749904 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\main.py", line 578, in run
    results = task.run()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 574, in run
    self._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\base.py", line 134, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 475, in compile
    linker.link_graph(manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 195, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_customers

[0m22:19:34.772060 [debug] [MainThread]: Command `dbt run` failed at 22:19:34.770708 after 4.29 seconds
[0m22:19:34.774150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6A4715FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6A86298D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6A8629F00>]}
[0m22:19:34.777500 [debug] [MainThread]: Flushing usage events
[0m22:19:36.606669 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:19:55.969294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEC8B6020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEE7DEB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEE7DE9B0>]}


============================== 22:19:55.978279 | 68e66852-7314-4b75-9255-9d4fad2b8594 ==============================
[0m22:19:55.978279 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:19:55.983743 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_pets', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:19:57.279205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68e66852-7314-4b75-9255-9d4fad2b8594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEB135C60>]}
[0m22:19:57.445811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68e66852-7314-4b75-9255-9d4fad2b8594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEE681B70>]}
[0m22:19:57.453798 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:19:58.193759 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:19:58.893803 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:19:58.893803 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:19:59.036238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68e66852-7314-4b75-9255-9d4fad2b8594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DF06A8130>]}
[0m22:19:59.450219 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:19:59.463471 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:19:59.542267 [error] [MainThread]: Encountered an error:
Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_customers
[0m22:19:59.552803 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\main.py", line 578, in run
    results = task.run()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 574, in run
    self._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\base.py", line 134, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 475, in compile
    linker.link_graph(manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 195, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_customers

[0m22:19:59.569371 [debug] [MainThread]: Command `dbt run` failed at 22:19:59.569371 after 3.81 seconds
[0m22:19:59.574486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEC8B6020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEF5D97E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEF5D95A0>]}
[0m22:19:59.575901 [debug] [MainThread]: Flushing usage events
[0m22:20:00.338139 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:20:20.125181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026346BF6080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026348B1E9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026348B1E800>]}


============================== 22:20:20.132427 | d6ac1614-fe7e-4f98-a0e6-b13eae5e57bd ==============================
[0m22:20:20.132427 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:20:20.137840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_customers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:20:21.423165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6ac1614-fe7e-4f98-a0e6-b13eae5e57bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026348AB7CD0>]}
[0m22:20:21.573551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6ac1614-fe7e-4f98-a0e6-b13eae5e57bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002634860DB10>]}
[0m22:20:21.581641 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:20:22.331825 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:20:22.869231 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:20:22.877205 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:20:23.013881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6ac1614-fe7e-4f98-a0e6-b13eae5e57bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002634A9E8130>]}
[0m22:20:23.352921 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:20:23.361703 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:20:23.424250 [error] [MainThread]: Encountered an error:
Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_customers
[0m22:20:23.434576 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\main.py", line 578, in run
    results = task.run()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 574, in run
    self._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\base.py", line 134, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 475, in compile
    linker.link_graph(manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 195, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_customers

[0m22:20:23.447857 [debug] [MainThread]: Command `dbt run` failed at 22:20:23.447857 after 3.57 seconds
[0m22:20:23.455886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026346BF6080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002634A9C51B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002634A9C5120>]}
[0m22:20:23.461535 [debug] [MainThread]: Flushing usage events
[0m22:20:29.630872 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:21:00.797866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2B78B60E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2B7BFE2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2B97F0160>]}


============================== 22:21:00.803911 | 874063b5-0e09-4e65-8b7d-8a0f887b5d4c ==============================
[0m22:21:00.803911 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:21:00.807986 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select fact_orders', 'send_anonymous_usage_stats': 'True'}
[0m22:21:02.067741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '874063b5-0e09-4e65-8b7d-8a0f887b5d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2B932BC40>]}
[0m22:21:02.202554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '874063b5-0e09-4e65-8b7d-8a0f887b5d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2B9682350>]}
[0m22:21:02.210777 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:21:02.875706 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:21:03.405727 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:21:03.405727 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:21:03.550671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '874063b5-0e09-4e65-8b7d-8a0f887b5d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2BB6AC130>]}
[0m22:21:03.862481 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:21:03.869182 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:21:03.932798 [error] [MainThread]: Encountered an error:
Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_customers
[0m22:21:03.947637 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\main.py", line 578, in run
    results = task.run()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 574, in run
    self._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\base.py", line 134, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 475, in compile
    linker.link_graph(manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 195, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_customers

[0m22:21:03.958268 [debug] [MainThread]: Command `dbt run` failed at 22:21:03.958268 after 3.33 seconds
[0m22:21:03.958268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2B78B60E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2BA5D9C60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2BA5D9B70>]}
[0m22:21:03.966300 [debug] [MainThread]: Flushing usage events
[0m22:21:06.243106 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:26:01.449003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207E38B6020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207E57DEB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207E57DE9B0>]}


============================== 22:26:01.455101 | 2f76ab61-e41e-47f7-a2e1-72c858e4e7e4 ==============================
[0m22:26:01.455101 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:26:01.459130 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select dim_pets', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:26:02.678848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f76ab61-e41e-47f7-a2e1-72c858e4e7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207E2139C60>]}
[0m22:26:02.796124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f76ab61-e41e-47f7-a2e1-72c858e4e7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207E5681B70>]}
[0m22:26:02.800605 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:26:03.486075 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:26:04.269393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:26:04.269393 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:26:04.390939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f76ab61-e41e-47f7-a2e1-72c858e4e7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207E76A8130>]}
[0m22:26:04.810728 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:26:04.827563 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:26:05.033307 [error] [MainThread]: Encountered an error:
Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_customers
[0m22:26:05.050746 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\main.py", line 578, in run
    results = task.run()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 574, in run
    self._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\base.py", line 134, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 475, in compile
    linker.link_graph(manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 195, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_customers

[0m22:26:05.119195 [debug] [MainThread]: Command `dbt run` failed at 22:26:05.118190 after 3.85 seconds
[0m22:26:05.121578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207E38B6020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207E65D97E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207E65D95A0>]}
[0m22:26:05.125353 [debug] [MainThread]: Flushing usage events
[0m22:26:06.027489 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:28:15.770552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1CE6B6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1D05DE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1D05DE7D0>]}


============================== 22:28:15.779025 | e75800f8-2a0d-4d2a-8bc0-e69b5d9ed64b ==============================
[0m22:28:15.779025 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:28:15.784417 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_customers', 'send_anonymous_usage_stats': 'True'}
[0m22:28:17.021345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e75800f8-2a0d-4d2a-8bc0-e69b5d9ed64b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1D016A500>]}
[0m22:28:17.172884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e75800f8-2a0d-4d2a-8bc0-e69b5d9ed64b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1D04828C0>]}
[0m22:28:17.175088 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:28:17.934940 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:28:18.446532 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:28:18.446532 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:28:18.547725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e75800f8-2a0d-4d2a-8bc0-e69b5d9ed64b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1D24B8130>]}
[0m22:28:18.896861 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:28:18.922389 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:28:18.999623 [error] [MainThread]: Encountered an error:
Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_customers
[0m22:28:19.012247 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\main.py", line 578, in run
    results = task.run()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 574, in run
    self._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\base.py", line 134, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 475, in compile
    linker.link_graph(manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 195, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_customers

[0m22:28:19.023227 [debug] [MainThread]: Command `dbt run` failed at 22:28:19.023227 after 3.45 seconds
[0m22:28:19.031161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1CE6B6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1CE9B0C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1D24991E0>]}
[0m22:28:19.035582 [debug] [MainThread]: Flushing usage events
[0m22:28:19.861874 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:28:33.381895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223085C6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002230A4EE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002230A4EE7D0>]}


============================== 22:28:33.388453 | 33986d8e-f68c-49bb-944c-a1452fd8144c ==============================
[0m22:28:33.388453 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:28:33.394209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:28:34.668768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33986d8e-f68c-49bb-944c-a1452fd8144c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022306E49C90>]}
[0m22:28:34.782462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33986d8e-f68c-49bb-944c-a1452fd8144c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002230A391B70>]}
[0m22:28:34.784767 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:28:35.409397 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:28:35.897404 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:28:35.897404 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:28:36.049933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33986d8e-f68c-49bb-944c-a1452fd8144c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002230C3B8130>]}
[0m22:28:36.399528 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:28:36.409966 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:28:36.488101 [error] [MainThread]: Encountered an error:
Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_customers
[0m22:28:36.500974 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\main.py", line 578, in run
    results = task.run()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 574, in run
    self._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\base.py", line 134, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 475, in compile
    linker.link_graph(manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 195, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_customers

[0m22:28:36.522951 [debug] [MainThread]: Command `dbt run` failed at 22:28:36.522951 after 3.29 seconds
[0m22:28:36.522951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223085C6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002230B161D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002230B161900>]}
[0m22:28:36.526296 [debug] [MainThread]: Flushing usage events
[0m22:28:37.370572 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:30:23.370623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017771C85FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017773BAEB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017773BAE950>]}


============================== 22:30:23.380116 | 5210b9d1-dab1-4806-8218-2ca04a972034 ==============================
[0m22:30:23.380116 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:30:23.383128 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_customers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:30:24.658789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5210b9d1-dab1-4806-8218-2ca04a972034', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177736F9150>]}
[0m22:30:24.824866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5210b9d1-dab1-4806-8218-2ca04a972034', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017773A1B2B0>]}
[0m22:30:24.831094 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:30:25.442151 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:30:25.982964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:30:25.982964 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:30:26.151293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5210b9d1-dab1-4806-8218-2ca04a972034', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017775A78130>]}
[0m22:30:26.585883 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:30:26.605376 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:30:26.700586 [error] [MainThread]: Encountered an error:
Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_customers
[0m22:30:26.711600 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\main.py", line 578, in run
    results = task.run()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 574, in run
    self._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\base.py", line 134, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 475, in compile
    linker.link_graph(manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 195, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_customers

[0m22:30:26.739214 [debug] [MainThread]: Command `dbt run` failed at 22:30:26.738210 after 3.55 seconds
[0m22:30:26.741786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017771C85FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177747DCD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177747DCB20>]}
[0m22:30:26.743923 [debug] [MainThread]: Flushing usage events
[0m22:30:27.465157 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:31:02.185533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B243BE6080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B245B0E9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B245B0E800>]}


============================== 22:31:02.192456 | d22c1fc2-a383-4b61-88fb-585a3c32c73b ==============================
[0m22:31:02.192456 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:31:02.198162 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_customers', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:31:03.507897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd22c1fc2-a383-4b61-88fb-585a3c32c73b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B245AA7CD0>]}
[0m22:31:03.665035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd22c1fc2-a383-4b61-88fb-585a3c32c73b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2455FDB10>]}
[0m22:31:03.674555 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:31:04.438922 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:31:04.953057 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:31:04.961054 [debug] [MainThread]: Partial parsing: updated file: ManyPets://models\dim\dim_customers.sql
[0m22:31:05.671273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd22c1fc2-a383-4b61-88fb-585a3c32c73b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B247B4C130>]}
[0m22:31:05.962835 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:31:05.972040 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:31:06.032377 [error] [MainThread]: Encountered an error:
Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_pets
[0m22:31:06.040582 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\main.py", line 578, in run
    results = task.run()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 574, in run
    self._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\base.py", line 134, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 475, in compile
    linker.link_graph(manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 195, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_pets

[0m22:31:06.054474 [debug] [MainThread]: Command `dbt run` failed at 22:31:06.054474 after 4.04 seconds
[0m22:31:06.054474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B243BE6080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2479547C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B247957B50>]}
[0m22:31:06.054474 [debug] [MainThread]: Flushing usage events
[0m22:31:06.530407 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:32:11.852047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDAC105FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDAE02E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDAE02E7A0>]}


============================== 22:32:11.861983 | 264c842a-aac3-45c3-aec1-45d12bbed99f ==============================
[0m22:32:11.861983 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:32:11.868462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_customers', 'send_anonymous_usage_stats': 'True'}
[0m22:32:13.138821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '264c842a-aac3-45c3-aec1-45d12bbed99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDAC45DED0>]}
[0m22:32:13.289390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '264c842a-aac3-45c3-aec1-45d12bbed99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDADE9B2B0>]}
[0m22:32:13.306345 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:32:14.023714 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:32:14.685486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:32:14.685486 [debug] [MainThread]: Partial parsing: updated file: ManyPets://models\dim\dim_customers.sql
[0m22:32:15.353789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '264c842a-aac3-45c3-aec1-45d12bbed99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDB0068130>]}
[0m22:32:15.616667 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:32:15.630084 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:32:15.694695 [error] [MainThread]: Encountered an error:
Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_pets
[0m22:32:15.702875 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\main.py", line 578, in run
    results = task.run()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 574, in run
    self._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\base.py", line 134, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 475, in compile
    linker.link_graph(manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 195, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_pets

[0m22:32:15.719004 [debug] [MainThread]: Command `dbt run` failed at 22:32:15.719004 after 4.09 seconds
[0m22:32:15.722327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDAC105FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDAFE897B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDAFE89600>]}
[0m22:32:15.723325 [debug] [MainThread]: Flushing usage events
[0m22:32:16.714626 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:32:59.930813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CC1865FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CC378EB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CC378E950>]}


============================== 22:32:59.937232 | 5c5d4a33-11c3-4e09-a0ee-0ea9a056b654 ==============================
[0m22:32:59.937232 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:32:59.942876 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select dim_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:33:01.386749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c5d4a33-11c3-4e09-a0ee-0ea9a056b654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CC32D9150>]}
[0m22:33:01.509354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c5d4a33-11c3-4e09-a0ee-0ea9a056b654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CC35FB2B0>]}
[0m22:33:01.520312 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:33:02.269136 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:33:02.896157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:33:02.896157 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:33:03.003165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c5d4a33-11c3-4e09-a0ee-0ea9a056b654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CC5658130>]}
[0m22:33:03.315918 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:33:03.323666 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:33:03.407961 [error] [MainThread]: Encountered an error:
Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_pets
[0m22:33:03.414756 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\main.py", line 578, in run
    results = task.run()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 574, in run
    self._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\base.py", line 134, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 475, in compile
    linker.link_graph(manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 195, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_pets

[0m22:33:03.428199 [debug] [MainThread]: Command `dbt run` failed at 22:33:03.428199 after 3.64 seconds
[0m22:33:03.428199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CC1865FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CBD422080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CC33E26B0>]}
[0m22:33:03.428199 [debug] [MainThread]: Flushing usage events
[0m22:33:04.116864 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:37:00.169790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C80B6F6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C80D61E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C80D61E7D0>]}


============================== 22:37:00.185398 | d4aa04f0-cebd-40c5-a6a0-5327eb32cc08 ==============================
[0m22:37:00.185398 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:37:00.185398 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_orders', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:37:00.942716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4aa04f0-cebd-40c5-a6a0-5327eb32cc08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C80D1AA500>]}
[0m22:37:01.028867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4aa04f0-cebd-40c5-a6a0-5327eb32cc08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C80D4BCF40>]}
[0m22:37:01.044468 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:37:01.516989 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:37:01.880882 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:37:01.880882 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:37:01.971830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4aa04f0-cebd-40c5-a6a0-5327eb32cc08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C80F4E8130>]}
[0m22:37:02.212426 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:37:02.214504 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:37:02.263852 [error] [MainThread]: Encountered an error:
Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_pets
[0m22:37:02.263852 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\main.py", line 578, in run
    results = task.run()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 574, in run
    self._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\base.py", line 134, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 475, in compile
    linker.link_graph(manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 195, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_pets

[0m22:37:02.282259 [debug] [MainThread]: Command `dbt run` failed at 22:37:02.282259 after 2.23 seconds
[0m22:37:02.283262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C80B6F6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C80B56A1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C80D5B3EB0>]}
[0m22:37:02.284258 [debug] [MainThread]: Flushing usage events
[0m22:37:02.812179 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:38:37.207515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFDCE9FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFFC428C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFFC426E0>]}


============================== 22:38:37.213517 | b6c83dc7-e128-424d-9284-cbfa903825f4 ==============================
[0m22:38:37.213517 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:38:37.214516 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m22:38:37.502889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6c83dc7-e128-424d-9284-cbfa903825f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFFC43010>]}
[0m22:38:37.562466 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m22:38:37.697351 [debug] [MainThread]: Set downloads directory='C:\Users\HP\AppData\Local\Temp\dbt-downloads-o4vffv_a'
[0m22:38:37.698351 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:38:37.921896 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:38:37.923030 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:38:37.991846 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:38:38.000839 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:38:38.680839 [info ] [MainThread]: Installed from version 1.3.0
[0m22:38:38.683706 [info ] [MainThread]: Up to date!
[0m22:38:38.685709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b6c83dc7-e128-424d-9284-cbfa903825f4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFE015270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFD06EC50>]}
[0m22:38:38.696990 [debug] [MainThread]: Command `cli deps` succeeded at 22:38:38.696990 after 1.64 seconds
[0m22:38:38.699069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFDCE9FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFDB52380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFFC43010>]}
[0m22:38:38.699069 [debug] [MainThread]: Flushing usage events
[0m22:38:39.214207 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:41:31.403103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AD5B96050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AD7ABE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AD7ABE7D0>]}


============================== 22:41:31.403103 | 1f3d8e00-5718-4ad7-845b-d9b035127cf5 ==============================
[0m22:41:31.403103 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:41:31.403103 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_customers', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:41:32.027202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f3d8e00-5718-4ad7-845b-d9b035127cf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AD764A500>]}
[0m22:41:32.136524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f3d8e00-5718-4ad7-845b-d9b035127cf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AD79628C0>]}
[0m22:41:32.136524 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:41:32.796863 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:41:33.178043 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:41:33.178043 [debug] [MainThread]: Partial parsing: updated file: ManyPets://models\dim\dim_pets.sql
[0m22:41:33.561756 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ManyPets.dim_pets' (models\dim\dim_pets.sql) depends on a node named 'stg_orders1' which was not found
[0m22:41:33.561756 [debug] [MainThread]: Command `dbt run` failed at 22:41:33.561756 after 2.28 seconds
[0m22:41:33.561756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AD5B96050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AD9978EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AD5EC2770>]}
[0m22:41:33.561756 [debug] [MainThread]: Flushing usage events
[0m22:41:34.080458 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:49:47.163000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265423E60E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002654272E2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026544320160>]}


============================== 22:49:47.169549 | 523a9f38-0a95-4eb6-a32b-1c93bc306e4d ==============================
[0m22:49:47.169549 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:49:47.170554 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_pets', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:49:47.843226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '523a9f38-0a95-4eb6-a32b-1c93bc306e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026543E5BC40>]}
[0m22:49:47.943948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '523a9f38-0a95-4eb6-a32b-1c93bc306e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265441AC9D0>]}
[0m22:49:47.945950 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:49:48.428871 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:49:48.816498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:49:48.816498 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:49:48.911856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '523a9f38-0a95-4eb6-a32b-1c93bc306e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265461D8130>]}
[0m22:49:49.158439 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:49:49.169213 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:49:49.203566 [error] [MainThread]: Encountered an error:
Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_pets
[0m22:49:49.210578 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\main.py", line 578, in run
    results = task.run()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 574, in run
    self._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\base.py", line 134, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 475, in compile
    linker.link_graph(manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 195, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_pets

[0m22:49:49.236175 [debug] [MainThread]: Command `dbt run` failed at 22:49:49.236175 after 2.22 seconds
[0m22:49:49.238153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265423E60E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265461A9900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265461AA650>]}
[0m22:49:49.239146 [debug] [MainThread]: Flushing usage events
[0m22:49:49.757862 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:49:58.693555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B09B596080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B09D4BE9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B09D4BE800>]}


============================== 22:49:58.698573 | f5094be3-d6d8-4c7b-b1ef-e14afb27189f ==============================
[0m22:49:58.698573 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:49:58.700557 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select fact_orders', 'send_anonymous_usage_stats': 'True'}
[0m22:49:59.357242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5094be3-d6d8-4c7b-b1ef-e14afb27189f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B09D457CD0>]}
[0m22:49:59.455515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5094be3-d6d8-4c7b-b1ef-e14afb27189f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B09CFADB10>]}
[0m22:49:59.457529 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:49:59.952694 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:50:00.483163 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:50:00.484166 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:50:00.589708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5094be3-d6d8-4c7b-b1ef-e14afb27189f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B09F388130>]}
[0m22:50:00.914157 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:50:00.925855 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:50:00.989442 [error] [MainThread]: Encountered an error:
Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_pets
[0m22:50:01.016700 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\main.py", line 578, in run
    results = task.run()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 574, in run
    self._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\base.py", line 134, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 475, in compile
    linker.link_graph(manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 195, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_pets

[0m22:50:01.029048 [debug] [MainThread]: Command `dbt run` failed at 22:50:01.028051 after 2.52 seconds
[0m22:50:01.030051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B09B596080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B09DF2D480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B09DF2CD60>]}
[0m22:50:01.032048 [debug] [MainThread]: Flushing usage events
[0m22:50:01.510685 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:51:00.786461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002000A766050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002000C68E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002000C68E7D0>]}


============================== 22:51:00.791460 | b8be4679-72ee-4e2c-b1f3-f36833037a72 ==============================
[0m22:51:00.791460 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:51:00.793480 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_orders', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:51:01.454714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8be4679-72ee-4e2c-b1f3-f36833037a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002000C21A500>]}
[0m22:51:01.557639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8be4679-72ee-4e2c-b1f3-f36833037a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002000C5328C0>]}
[0m22:51:01.559637 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:51:02.048144 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:51:02.450740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:51:02.451746 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:51:02.577304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8be4679-72ee-4e2c-b1f3-f36833037a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002000E55C130>]}
[0m22:51:02.833750 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:51:02.840758 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:51:02.870987 [error] [MainThread]: Encountered an error:
Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_pets
[0m22:51:02.873983 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\main.py", line 578, in run
    results = task.run()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 574, in run
    self._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\base.py", line 134, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 475, in compile
    linker.link_graph(manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 195, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_pets

[0m22:51:02.882810 [debug] [MainThread]: Command `dbt run` failed at 22:51:02.882810 after 2.22 seconds
[0m22:51:02.883807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002000A766050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002000E53D840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002000E53D570>]}
[0m22:51:02.883807 [debug] [MainThread]: Flushing usage events
[0m22:51:04.200228 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:05:43.114224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4D0BB5F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4D2ADA7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4D2ADA5F0>]}


============================== 23:05:43.119746 | 6dcf64a9-5241-4a01-abda-b39e585e2211 ==============================
[0m23:05:43.119746 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:05:43.122698 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt parse', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:05:43.837212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6dcf64a9-5241-4a01-abda-b39e585e2211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4D2A77D90>]}
[0m23:05:43.943275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6dcf64a9-5241-4a01-abda-b39e585e2211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4D29828C0>]}
[0m23:05:43.943275 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m23:05:44.498054 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:05:45.017315 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:05:45.017315 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:05:45.112991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6dcf64a9-5241-4a01-abda-b39e585e2211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4D49AC130>]}
[0m23:05:45.121758 [info ] [MainThread]: Performance info: C:\Users\HP\Documents\manypets\ManyPets\target\perf_info.json
[0m23:05:45.524920 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m23:05:45.533366 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m23:05:45.537114 [debug] [MainThread]: Command `dbt parse` succeeded at 23:05:45.536566 after 2.56 seconds
[0m23:05:45.538677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4D0BB5F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4D075A6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4D4927400>]}
[0m23:05:45.539680 [debug] [MainThread]: Flushing usage events
[0m23:05:46.243298 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:06:31.805174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C5436050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C735AA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C735A890>]}


============================== 23:06:31.810830 | 2a1e9cae-f3d3-45a3-849a-d200ec47eb3d ==============================
[0m23:06:31.810830 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:06:31.813181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt parse', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:06:32.583598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a1e9cae-f3d3-45a3-849a-d200ec47eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C578D660>]}
[0m23:06:32.697549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a1e9cae-f3d3-45a3-849a-d200ec47eb3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C7C132E0>]}
[0m23:06:32.706901 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m23:06:33.252891 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:06:33.684706 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m23:06:33.684706 [debug] [MainThread]: Partial parsing: deleted file: ManyPets://models\dim\dim_pets.sql
[0m23:06:34.503832 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ManyPets.fact_orders' (models\fact\fact_orders.sql) depends on a node named 'dim_pets' which was not found
[0m23:06:34.512593 [debug] [MainThread]: Command `dbt parse` failed at 23:06:34.512023 after 2.85 seconds
[0m23:06:34.512593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C93115D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C92B91E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C92BB1F0>]}
[0m23:06:34.513601 [debug] [MainThread]: Flushing usage events
[0m23:06:35.219553 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:12:57.679285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027474B25FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027476A4A830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027476A4A650>]}


============================== 23:12:57.680279 | 7402a53b-f6a9-48a8-82cc-b49b27b46fc7 ==============================
[0m23:12:57.680279 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:12:57.688403 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt parse', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:12:58.749168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7402a53b-f6a9-48a8-82cc-b49b27b46fc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002747653DA80>]}
[0m23:12:58.904808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7402a53b-f6a9-48a8-82cc-b49b27b46fc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274768BB2B0>]}
[0m23:12:58.904808 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m23:12:59.510912 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:12:59.927009 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:12:59.937341 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:13:00.060294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7402a53b-f6a9-48a8-82cc-b49b27b46fc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002747891C130>]}
[0m23:13:00.068907 [info ] [MainThread]: Performance info: C:\Users\HP\Documents\manypets\ManyPets\target\perf_info.json
[0m23:13:00.375868 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m23:13:00.383226 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m23:13:00.386039 [debug] [MainThread]: Command `dbt parse` succeeded at 23:13:00.385925 after 2.86 seconds
[0m23:13:00.386039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027474B25FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274788C25C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274788C11E0>]}
[0m23:13:00.387040 [debug] [MainThread]: Flushing usage events
[0m23:13:01.235385 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:14:02.732926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BB0056020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BB1F7A860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BB1F7A680>]}


============================== 23:14:02.733926 | a30b2cf4-dced-4574-816b-512414675f78 ==============================
[0m23:14:02.733926 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:14:02.740563 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt parse', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:14:03.439607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a30b2cf4-dced-4574-816b-512414675f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BB1F17B80>]}
[0m23:14:03.533664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a30b2cf4-dced-4574-816b-512414675f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BB2856470>]}
[0m23:14:03.533664 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m23:14:04.045414 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:14:04.479138 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m23:14:04.479138 [debug] [MainThread]: Partial parsing: deleted file: ManyPets://models\fact\fact_orders.sql
[0m23:14:04.756757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a30b2cf4-dced-4574-816b-512414675f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BB3E28B80>]}
[0m23:14:04.769498 [info ] [MainThread]: Performance info: C:\Users\HP\Documents\manypets\ManyPets\target\perf_info.json
[0m23:14:04.998987 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m23:14:05.005620 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m23:14:05.007617 [debug] [MainThread]: Command `dbt parse` succeeded at 23:14:05.007617 after 2.42 seconds
[0m23:14:05.008703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BB0056020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BB3E93BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BB3E93DC0>]}
[0m23:14:05.009784 [debug] [MainThread]: Flushing usage events
[0m23:14:17.511856 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:15:05.375661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8ACB86080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8AEAAAAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8AEAAA8F0>]}


============================== 23:15:05.380419 | fe6c0bd2-02d9-435f-95bd-4c91eff4ef49 ==============================
[0m23:15:05.380419 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:15:05.383386 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt parse', 'send_anonymous_usage_stats': 'True'}
[0m23:15:06.171478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe6c0bd2-02d9-435f-95bd-4c91eff4ef49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8AF3BBB50>]}
[0m23:15:06.295145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe6c0bd2-02d9-435f-95bd-4c91eff4ef49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8AF385D20>]}
[0m23:15:06.295145 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m23:15:06.828225 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:15:07.290089 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m23:15:07.290089 [debug] [MainThread]: Partial parsing: deleted file: ManyPets://models\dim\dim_pets.sql
[0m23:15:08.105665 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ManyPets.stg_orders' (models\staging\stg_orders.sql) depends on a node named 'dim_pets' which was not found
[0m23:15:08.110491 [debug] [MainThread]: Command `dbt parse` failed at 23:15:08.109474 after 2.87 seconds
[0m23:15:08.110491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8ACB86080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B0A92020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B0A91FF0>]}
[0m23:15:08.111477 [debug] [MainThread]: Flushing usage events
[0m23:15:08.928664 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:18:16.749601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020365346050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002036726AA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002036726A890>]}


============================== 23:18:16.756205 | c252ae31-d718-4ab0-9143-f54ec1df49e4 ==============================
[0m23:18:16.756205 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:18:16.757471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt parse', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:18:17.455149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c252ae31-d718-4ab0-9143-f54ec1df49e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002036569D660>]}
[0m23:18:17.583243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c252ae31-d718-4ab0-9143-f54ec1df49e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020367B232E0>]}
[0m23:18:17.586244 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m23:18:18.083686 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:18:18.490858 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m23:18:18.492859 [debug] [MainThread]: Partial parsing: deleted file: ManyPets://models\dim\dim_pets.sql
[0m23:18:19.215886 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ManyPets.stg_orders' (models\staging\stg_orders.sql) depends on a node named 'dim_pets' which was not found
[0m23:18:19.218893 [debug] [MainThread]: Command `dbt parse` failed at 23:18:19.218893 after 2.62 seconds
[0m23:18:19.220052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020365346050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020369255FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020369256020>]}
[0m23:18:19.220575 [debug] [MainThread]: Flushing usage events
[0m23:18:19.723448 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:22:35.864065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F39A85FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3B9DA9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3B9DA800>]}


============================== 23:22:35.869069 | 39c2be48-16c8-4850-a7d0-92e84b2cf32b ==============================
[0m23:22:35.869069 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:22:35.871071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m23:22:36.093754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39c2be48-16c8-4850-a7d0-92e84b2cf32b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F382DB7C0>]}
[0m23:22:36.144440 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:22:36.269806 [debug] [MainThread]: Set downloads directory='C:\Users\HP\AppData\Local\Temp\dbt-downloads-0lxkuacm'
[0m23:22:36.270813 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:22:36.441051 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:22:36.445052 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:22:36.546561 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:22:36.571726 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:22:37.206189 [info ] [MainThread]: Installed from version 1.3.0
[0m23:22:37.208192 [info ] [MainThread]: Up to date!
[0m23:22:37.210192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '39c2be48-16c8-4850-a7d0-92e84b2cf32b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F39DDCD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F38E879A0>]}
[0m23:22:37.213888 [debug] [MainThread]: Command `dbt deps` succeeded at 23:22:37.212883 after 1.48 seconds
[0m23:22:37.213888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F39A85FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3BA02B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F39DCCA00>]}
[0m23:22:37.214885 [debug] [MainThread]: Flushing usage events
[0m23:22:37.785674 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:23:01.793948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E59D6080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E78FAAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E78FA8F0>]}


============================== 23:23:01.799953 | 09991087-8ea7-4dcd-89ef-15780578b67b ==============================
[0m23:23:01.799953 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:23:01.800950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt parse', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:23:02.504396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09991087-8ea7-4dcd-89ef-15780578b67b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E8207B50>]}
[0m23:23:02.605328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09991087-8ea7-4dcd-89ef-15780578b67b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E81D1D20>]}
[0m23:23:02.607829 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m23:23:03.127871 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:23:03.656826 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m23:23:03.657841 [debug] [MainThread]: Partial parsing: deleted file: ManyPets://models\dim\dim_pets.sql
[0m23:23:04.368602 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ManyPets.stg_orders' (models\staging\stg_orders.sql) depends on a node named 'dim_pets' which was not found
[0m23:23:04.371797 [debug] [MainThread]: Command `dbt parse` failed at 23:23:04.371797 after 2.72 seconds
[0m23:23:04.372796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E59D6080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E98E2020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E98E1FF0>]}
[0m23:23:04.373795 [debug] [MainThread]: Flushing usage events
[0m23:23:04.839719 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:25:56.508872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1CD1F6020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1CF11A860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1CF11A680>]}


============================== 23:25:56.508872 | 0c5baa16-c076-4900-96e3-18bb1f59f4bb ==============================
[0m23:25:56.508872 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:25:56.508872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt parse', 'send_anonymous_usage_stats': 'True'}
[0m23:25:57.146479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c5baa16-c076-4900-96e3-18bb1f59f4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1CF0B7B80>]}
[0m23:25:57.239582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c5baa16-c076-4900-96e3-18bb1f59f4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1CF9FA470>]}
[0m23:25:57.239582 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m23:25:57.713022 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:25:58.066452 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m23:25:58.066452 [debug] [MainThread]: Partial parsing: deleted file: ManyPets://models\dim\dim_pets.sql
[0m23:25:58.808276 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ManyPets.stg_orders' (models\staging\stg_orders.sql) depends on a node named 'dim_pets' which was not found
[0m23:25:58.808276 [debug] [MainThread]: Command `dbt parse` failed at 23:25:58.808276 after 2.42 seconds
[0m23:25:58.808276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1CD1F6020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1CBAFF3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1D1111B40>]}
[0m23:25:58.816333 [debug] [MainThread]: Flushing usage events
[0m23:25:59.386120 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:26:10.463038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125BB905F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125BD85A7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125BD85A5F0>]}


============================== 23:26:10.463038 | aaba0ed2-dbcc-454f-b262-7cbae0dad85e ==============================
[0m23:26:10.463038 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:26:10.463038 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:26:10.672453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aaba0ed2-dbcc-454f-b262-7cbae0dad85e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125BD85A890>]}
[0m23:26:10.719348 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:26:10.829023 [debug] [MainThread]: Set downloads directory='C:\Users\HP\AppData\Local\Temp\dbt-downloads-2bqngx_t'
[0m23:26:10.844654 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:26:10.979761 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:26:10.982760 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:26:11.059086 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:26:11.072616 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:26:11.674652 [info ] [MainThread]: Installed from version 1.3.0
[0m23:26:11.674652 [info ] [MainThread]: Up to date!
[0m23:26:11.674652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'aaba0ed2-dbcc-454f-b262-7cbae0dad85e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125BBC431C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125BAD079A0>]}
[0m23:26:11.674652 [debug] [MainThread]: Command `dbt deps` succeeded at 23:26:11.674652 after 1.34 seconds
[0m23:26:11.674652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125BB905F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125BB77A440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125BD85A890>]}
[0m23:26:11.674652 [debug] [MainThread]: Flushing usage events
[0m23:26:12.181049 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:26:51.404301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CECA906050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CECC85EA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CECC85E890>]}


============================== 23:26:51.404301 | c8699258-f38d-4541-974e-b7bdfc6fc25b ==============================
[0m23:26:51.404301 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:26:51.404301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:26:51.626703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8699258-f38d-4541-974e-b7bdfc6fc25b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CECC85EB30>]}
[0m23:26:51.677292 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:26:51.792802 [debug] [MainThread]: Set downloads directory='C:\Users\HP\AppData\Local\Temp\dbt-downloads-_3g3cvec'
[0m23:26:51.792802 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:26:51.898244 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:26:51.898244 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:26:51.982630 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:26:51.998250 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:26:52.548180 [info ] [MainThread]: Installed from version 1.3.0
[0m23:26:52.550222 [info ] [MainThread]: Up to date!
[0m23:26:52.550222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c8699258-f38d-4541-974e-b7bdfc6fc25b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CECAC03EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CEC9D079A0>]}
[0m23:26:52.550222 [debug] [MainThread]: Command `dbt deps` succeeded at 23:26:52.550222 after 1.29 seconds
[0m23:26:52.558262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CECA906050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CECAC43FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CECC85EB00>]}
[0m23:26:52.558262 [debug] [MainThread]: Flushing usage events
[0m23:26:53.004833 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:26:57.870259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028317BB5FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028319ADA830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028319ADA650>]}


============================== 23:26:57.885897 | 16489143-beef-4c6d-8c6e-abaf273acd74 ==============================
[0m23:26:57.885897 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:26:57.885897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt parse', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:26:58.518565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16489143-beef-4c6d-8c6e-abaf273acd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283195CDA80>]}
[0m23:26:58.612481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16489143-beef-4c6d-8c6e-abaf273acd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002831994B2B0>]}
[0m23:26:58.619224 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m23:26:59.074544 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:26:59.506635 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:26:59.522261 [debug] [MainThread]: Partial parsing: added file: ManyPets://models\fact\fact_orders.sql
[0m23:27:00.050758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16489143-beef-4c6d-8c6e-abaf273acd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002831BB10130>]}
[0m23:27:00.060907 [info ] [MainThread]: Performance info: C:\Users\HP\Documents\manypets\ManyPets\target\perf_info.json
[0m23:27:00.249773 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m23:27:00.265404 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m23:27:00.265404 [debug] [MainThread]: Command `dbt parse` succeeded at 23:27:00.265404 after 2.50 seconds
[0m23:27:00.265404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028317BB5FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002831A405630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002831A3EA5F0>]}
[0m23:27:00.265404 [debug] [MainThread]: Flushing usage events
[0m23:27:00.739907 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:27:38.700822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011EC60E6020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011EC800EB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011EC800E9B0>]}


============================== 23:27:38.700822 | f5b3a38c-4ce7-4bec-a7b0-3bb9b54d922e ==============================
[0m23:27:38.700822 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:27:38.700822 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_orders', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:27:39.338759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5b3a38c-4ce7-4bec-a7b0-3bb9b54d922e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011EC4989C60>]}
[0m23:27:39.431023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5b3a38c-4ce7-4bec-a7b0-3bb9b54d922e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011EC7EB1B70>]}
[0m23:27:39.433024 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m23:27:39.917189 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:27:40.282364 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:27:40.290381 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:27:40.373201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5b3a38c-4ce7-4bec-a7b0-3bb9b54d922e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011EC9ED8130>]}
[0m23:27:40.605972 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m23:27:40.605972 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m23:27:40.655352 [error] [MainThread]: Encountered an error:
Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_customers
[0m23:27:40.655352 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\main.py", line 578, in run
    results = task.run()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 574, in run
    self._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\base.py", line 134, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 475, in compile
    linker.link_graph(manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 195, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_customers

[0m23:27:40.675017 [debug] [MainThread]: Command `dbt run` failed at 23:27:40.674018 after 2.10 seconds
[0m23:27:40.676891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011EC60E6020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011EC9EA42B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011EC9EA5900>]}
[0m23:27:40.679856 [debug] [MainThread]: Flushing usage events
[0m23:27:41.187095 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:28:06.924934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A59A796080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A59C6BEA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A59C6BE830>]}


============================== 23:28:06.924934 | e915ca45-c23d-435b-a570-7f14dce155e6 ==============================
[0m23:28:06.924934 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:28:06.924934 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:28:07.568716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e915ca45-c23d-435b-a570-7f14dce155e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A59C657CD0>]}
[0m23:28:07.653426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e915ca45-c23d-435b-a570-7f14dce155e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A59C5628F0>]}
[0m23:28:07.653426 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m23:28:08.132815 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:28:08.538813 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:28:08.538813 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:28:08.638879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e915ca45-c23d-435b-a570-7f14dce155e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A59E588130>]}
[0m23:28:08.873201 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m23:28:08.881237 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m23:28:08.906908 [error] [MainThread]: Encountered an error:
Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_customers
[0m23:28:08.906908 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\main.py", line 578, in run
    results = task.run()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 574, in run
    self._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\base.py", line 134, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 475, in compile
    linker.link_graph(manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 195, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.ManyPets.stg_orders --> model.ManyPets.dim_customers

[0m23:28:08.924326 [debug] [MainThread]: Command `dbt run` failed at 23:28:08.924326 after 2.12 seconds
[0m23:28:08.925502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A59A796080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A59E561BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A59E561B70>]}
[0m23:28:08.930865 [debug] [MainThread]: Flushing usage events
[0m23:28:09.408471 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:31:23.829218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F252D36020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F254C8E860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F254C8E680>]}


============================== 23:31:23.829218 | 6c4d6e67-cc68-486b-83c0-c9f0ffd75e2a ==============================
[0m23:31:23.829218 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:31:23.829218 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:31:24.045066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c4d6e67-cc68-486b-83c0-c9f0ffd75e2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F254C8E9B0>]}
[0m23:31:24.082818 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:31:24.218550 [debug] [MainThread]: Set downloads directory='C:\Users\HP\AppData\Local\Temp\dbt-downloads-8ycfv1up'
[0m23:31:24.218550 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:31:24.345674 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:31:24.345674 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:31:24.414794 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:31:24.430402 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:31:25.014385 [info ] [MainThread]: Installed from version 1.3.0
[0m23:31:25.015403 [info ] [MainThread]: Up to date!
[0m23:31:25.017386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6c4d6e67-cc68-486b-83c0-c9f0ffd75e2a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F253031690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2521379A0>]}
[0m23:31:25.019036 [debug] [MainThread]: Command `dbt deps` succeeded at 23:31:25.019036 after 1.31 seconds
[0m23:31:25.019036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F252D36020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2530736D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F253069900>]}
[0m23:31:25.019036 [debug] [MainThread]: Flushing usage events
[0m23:31:25.519756 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:31:33.511081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D87E406080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D80038AAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D80038A8F0>]}


============================== 23:31:33.526712 | f69f75b0-7071-41fc-9c22-5b584c9596d1 ==============================
[0m23:31:33.526712 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:31:33.526712 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt parse', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:31:34.200793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f69f75b0-7071-41fc-9c22-5b584c9596d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D800D97B50>]}
[0m23:31:34.292106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f69f75b0-7071-41fc-9c22-5b584c9596d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D800D59D20>]}
[0m23:31:34.292106 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m23:31:34.782652 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:31:35.212891 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:31:35.212891 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:31:35.297531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f69f75b0-7071-41fc-9c22-5b584c9596d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D80235C130>]}
[0m23:31:35.313178 [info ] [MainThread]: Performance info: C:\Users\HP\Documents\manypets\ManyPets\target\perf_info.json
[0m23:31:35.560425 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m23:31:35.560425 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m23:31:35.560425 [debug] [MainThread]: Command `dbt parse` succeeded at 23:31:35.560425 after 2.17 seconds
[0m23:31:35.560425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D87E406080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8022D7790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8022D7520>]}
[0m23:31:35.560425 [debug] [MainThread]: Flushing usage events
[0m23:31:36.030355 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:31:42.028905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029308E66020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002930AD8EB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002930AD8E980>]}


============================== 23:31:42.028905 | 04478927-a4f4-4aec-872a-b7dfdf095b19 ==============================
[0m23:31:42.028905 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:31:42.028905 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:31:42.661564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04478927-a4f4-4aec-872a-b7dfdf095b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002930AC32200>]}
[0m23:31:42.746219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04478927-a4f4-4aec-872a-b7dfdf095b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002930B702C80>]}
[0m23:31:42.746219 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m23:31:43.230696 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:31:43.600616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:31:43.600616 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:31:43.689317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04478927-a4f4-4aec-872a-b7dfdf095b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002930CC58130>]}
[0m23:31:43.937736 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m23:31:43.947851 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m23:31:43.986223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04478927-a4f4-4aec-872a-b7dfdf095b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002930CC25000>]}
[0m23:31:43.986223 [info ] [MainThread]: Found 6 models, 11 data tests, 2 sources, 591 macros
[0m23:31:43.988260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04478927-a4f4-4aec-872a-b7dfdf095b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002930CC22B30>]}
[0m23:31:43.988260 [info ] [MainThread]: 
[0m23:31:43.988260 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:31:43.988260 [info ] [MainThread]: 
[0m23:31:43.996474 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:31:44.011925 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m23:31:44.199472 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m23:31:44.199472 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m23:31:44.199472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:31:45.086625 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.884 seconds
[0m23:31:45.101841 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m23:31:45.101841 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m23:31:45.230135 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.120 seconds
[0m23:31:45.239669 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m23:31:45.270958 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m23:31:45.270958 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m23:31:45.270958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:31:45.758457 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.482 seconds
[0m23:31:45.758457 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m23:31:45.773790 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m23:31:45.773790 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m23:31:45.959504 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.186 seconds
[0m23:31:45.974772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04478927-a4f4-4aec-872a-b7dfdf095b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002930CC251B0>]}
[0m23:31:45.990367 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_order_complete
[0m23:31:45.990367 [info ] [Thread-1 (]: 1 of 5 START sql incremental model staging.stg_order_complete .................. [RUN]
[0m23:31:45.990367 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_order_complete'
[0m23:31:45.990367 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_order_complete
[0m23:31:46.019005 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_order_complete"
[0m23:31:46.019005 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_order_complete
[0m23:31:46.097268 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:31:46.097268 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
create or replace  temporary view DEV.staging.stg_order_complete__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING        AS order_id,
        data:detail:intent::STRING          AS intent,
        data:detail:tenant::STRING          AS tenant,
        data:detail:customer_id::STRING     AS customer_id,
        pet.value                           AS pet_id,  
        data:time::TIMESTAMP                AS event_time,
        data:source::STRING                 AS source,
        data:type::STRING                   AS event_type,
        ingest_date                         AS ingest_date
    FROM dev.rdl.order_complete o,
    LATERAL FLATTEN(input => o.data:detail:pet_ids) AS pet  

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_order_complete)
    
)
SELECT 
    order_id,
    customer_id,
    pet_id,
    intent,
    tenant,
    event_time,
    source,
    event_type,
    ingest_date
FROM source_data
  );
[0m23:31:46.097268 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:31:46.765395 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0e5f-0000-e3bf-0001-b3ce0001917e
[0m23:31:46.765395 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 8
invalid identifier 'DATA'
[0m23:31:46.765395 [debug] [Thread-1 (]: Database Error in model stg_order_complete (models\staging\stg_order_complete.sql)
  000904 (42000): SQL compilation error: error line 8 at position 8
  invalid identifier 'DATA'
[0m23:31:46.781019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04478927-a4f4-4aec-872a-b7dfdf095b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029308CD3B80>]}
[0m23:31:46.781019 [error] [Thread-1 (]: 1 of 5 ERROR creating sql incremental model staging.stg_order_complete ......... [[31mERROR[0m in 0.79s]
[0m23:31:46.781019 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_order_complete
[0m23:31:46.781019 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m23:31:46.781019 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.stg_order_complete' to be skipped because of status 'error'.  Reason: Database Error in model stg_order_complete (models\staging\stg_order_complete.sql)
  000904 (42000): SQL compilation error: error line 8 at position 8
  invalid identifier 'DATA'.
[0m23:31:46.781019 [info ] [Thread-1 (]: 2 of 5 START sql incremental model staging.stg_orders .......................... [RUN]
[0m23:31:46.781019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_order_complete, now model.ManyPets.stg_orders)
[0m23:31:46.781019 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m23:31:46.798976 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m23:31:46.801975 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m23:31:46.816265 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:31:46.816265 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace  temporary view DEV.staging.stg_orders__dbt_tmp
  
   as (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS event_type,
        data:time::TIMESTAMP                            AS event_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet
  );
[0m23:31:47.364014 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.543 seconds
[0m23:31:47.379634 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:31:47.379634 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders__dbt_tmp
[0m23:31:47.464998 [debug] [Thread-1 (]: SQL status: SUCCESS 27 in 0.092 seconds
[0m23:31:47.480255 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:31:47.480255 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders
[0m23:31:47.581378 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.095 seconds
[0m23:31:47.612243 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:31:47.612243 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table "DEV"."STAGING"."STG_ORDERS"
[0m23:31:47.697084 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.083 seconds
[0m23:31:47.727976 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m23:31:47.743583 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:31:47.743583 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m23:31:47.830546 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.089 seconds
[0m23:31:47.830546 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:31:47.830546 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
insert into DEV.staging.stg_orders ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")
        (
            select "ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE"
            from DEV.staging.stg_orders__dbt_tmp
        );
[0m23:31:47.944720 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0e5f-0000-e3c5-0001-b3ce000161da
[0m23:31:47.951258 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 3 at position 31
invalid identifier 'CUSTOMER_EMAIL'
[0m23:31:47.951258 [debug] [Thread-1 (]: Database Error in model stg_orders (models\staging\stg_orders.sql)
  000904 (42000): SQL compilation error: error line 3 at position 31
  invalid identifier 'CUSTOMER_EMAIL'
  compiled code at target\run\ManyPets\models\staging\stg_orders.sql
[0m23:31:47.951258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04478927-a4f4-4aec-872a-b7dfdf095b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002930D50DE10>]}
[0m23:31:47.951258 [error] [Thread-1 (]: 2 of 5 ERROR creating sql incremental model staging.stg_orders ................. [[31mERROR[0m in 1.17s]
[0m23:31:47.951258 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m23:31:47.966914 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models\staging\stg_orders.sql)
  000904 (42000): SQL compilation error: error line 3 at position 31
  invalid identifier 'CUSTOMER_EMAIL'
  compiled code at target\run\ManyPets\models\staging\stg_orders.sql.
[0m23:31:47.966914 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m23:31:47.966914 [info ] [Thread-1 (]: 3 of 5 SKIP relation odl.dim_customers ......................................... [[33mSKIP[0m]
[0m23:31:47.966914 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m23:31:47.974412 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_pets
[0m23:31:47.976406 [info ] [Thread-1 (]: 4 of 5 SKIP relation odl.dim_pets .............................................. [[33mSKIP[0m]
[0m23:31:47.979389 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_pets
[0m23:31:47.981006 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m23:31:47.982010 [info ] [Thread-1 (]: 5 of 5 SKIP relation odl.fact_orders ........................................... [[33mSKIP[0m]
[0m23:31:47.987442 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m23:31:47.990223 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:31:47.990223 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m23:31:47.991248 [debug] [MainThread]: On list_DEV: Close
[0m23:31:48.082274 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m23:31:48.082274 [debug] [MainThread]: On list_DEV_staging: Close
[0m23:31:48.183011 [debug] [MainThread]: Connection 'model.ManyPets.stg_orders' was left open.
[0m23:31:48.183011 [debug] [MainThread]: On model.ManyPets.stg_orders: Close
[0m23:31:48.299086 [info ] [MainThread]: 
[0m23:31:48.299086 [info ] [MainThread]: Finished running 5 incremental models in 0 hours 0 minutes and 4.30 seconds (4.30s).
[0m23:31:48.299086 [debug] [MainThread]: Command end result
[0m23:31:48.374250 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m23:31:48.377255 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m23:31:48.393848 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m23:31:48.394846 [info ] [MainThread]: 
[0m23:31:48.396848 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:31:48.397918 [info ] [MainThread]: 
[0m23:31:48.397918 [error] [MainThread]:   Database Error in model stg_order_complete (models\staging\stg_order_complete.sql)
  000904 (42000): SQL compilation error: error line 8 at position 8
  invalid identifier 'DATA'
[0m23:31:48.402858 [info ] [MainThread]: 
[0m23:31:48.405860 [error] [MainThread]:   Database Error in model stg_orders (models\staging\stg_orders.sql)
  000904 (42000): SQL compilation error: error line 3 at position 31
  invalid identifier 'CUSTOMER_EMAIL'
  compiled code at target\run\ManyPets\models\staging\stg_orders.sql
[0m23:31:48.419600 [info ] [MainThread]: 
[0m23:31:48.421605 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
[0m23:31:48.464473 [debug] [MainThread]: Command `dbt run` failed at 23:31:48.423754 after 6.55 seconds
[0m23:31:48.464473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029308E66020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002930CC0C790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002930D49BCD0>]}
[0m23:31:48.464473 [debug] [MainThread]: Flushing usage events
[0m23:31:48.966164 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:32:50.606257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0602E6080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D06220EA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D06220E830>]}


============================== 23:32:50.621885 | a896859e-6388-423a-898a-23ee9d0f333c ==============================
[0m23:32:50.621885 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:32:50.621885 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:32:51.255077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a896859e-6388-423a-898a-23ee9d0f333c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0621A7CD0>]}
[0m23:32:51.340797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a896859e-6388-423a-898a-23ee9d0f333c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0620B28F0>]}
[0m23:32:51.355108 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m23:32:51.828619 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:32:52.198336 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:32:52.198336 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:32:52.282994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a896859e-6388-423a-898a-23ee9d0f333c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0640D8130>]}
[0m23:32:52.512368 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m23:32:52.528022 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m23:32:52.559256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a896859e-6388-423a-898a-23ee9d0f333c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D062B27880>]}
[0m23:32:52.559256 [info ] [MainThread]: Found 6 models, 11 data tests, 2 sources, 591 macros
[0m23:32:52.559256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a896859e-6388-423a-898a-23ee9d0f333c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D062B10190>]}
[0m23:32:52.559256 [info ] [MainThread]: 
[0m23:32:52.559256 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:32:52.574682 [info ] [MainThread]: 
[0m23:32:52.576905 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:32:52.595376 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m23:32:52.775072 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m23:32:52.775072 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m23:32:52.775072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:53.392990 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.618 seconds
[0m23:32:53.392990 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m23:32:53.392990 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m23:32:53.502051 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.101 seconds
[0m23:32:53.515580 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m23:32:53.531237 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m23:32:53.531237 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m23:32:53.531237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:53.999709 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.456 seconds
[0m23:32:54.002938 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m23:32:54.002938 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m23:32:54.002938 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m23:32:54.111590 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.101 seconds
[0m23:32:54.118108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a896859e-6388-423a-898a-23ee9d0f333c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D06063D090>]}
[0m23:32:54.133759 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_order_complete
[0m23:32:54.133759 [info ] [Thread-1 (]: 1 of 5 START sql incremental model staging.stg_order_complete .................. [RUN]
[0m23:32:54.133759 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_order_complete'
[0m23:32:54.133759 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_order_complete
[0m23:32:54.174239 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_order_complete"
[0m23:32:54.174239 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_order_complete
[0m23:32:54.267687 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:32:54.267687 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
create or replace  temporary view DEV.staging.stg_order_complete__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING        AS order_id,
        data:detail:intent::STRING          AS intent,
        data:detail:tenant::STRING          AS tenant,
        data:detail:customer_id::STRING     AS customer_id,
        pet.value                           AS pet_id,  
        data:time::TIMESTAMP                AS event_time,
        data:source::STRING                 AS source,
        data:type::STRING                   AS event_type,
        ingest_date                         AS ingest_date
    FROM dev.rdl.order_complete o,
    LATERAL FLATTEN(input => o.data:detail:pet_ids) AS pet  

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_order_complete)
    
)
SELECT 
    order_id,
    customer_id,
    pet_id,
    intent,
    tenant,
    event_time,
    source,
    event_type,
    ingest_date
FROM source_data
  );
[0m23:32:54.267687 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:32:54.651237 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0e60-0000-e37b-0001-b3ce0001b14e
[0m23:32:54.651237 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 8
invalid identifier 'DATA'
[0m23:32:54.651237 [debug] [Thread-1 (]: Database Error in model stg_order_complete (models\staging\stg_order_complete.sql)
  000904 (42000): SQL compilation error: error line 8 at position 8
  invalid identifier 'DATA'
[0m23:32:54.666330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a896859e-6388-423a-898a-23ee9d0f333c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0601515D0>]}
[0m23:32:54.666330 [error] [Thread-1 (]: 1 of 5 ERROR creating sql incremental model staging.stg_order_complete ......... [[31mERROR[0m in 0.52s]
[0m23:32:54.666330 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_order_complete
[0m23:32:54.666330 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m23:32:54.666330 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.stg_order_complete' to be skipped because of status 'error'.  Reason: Database Error in model stg_order_complete (models\staging\stg_order_complete.sql)
  000904 (42000): SQL compilation error: error line 8 at position 8
  invalid identifier 'DATA'.
[0m23:32:54.666330 [info ] [Thread-1 (]: 2 of 5 START sql incremental model staging.stg_orders .......................... [RUN]
[0m23:32:54.666330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_order_complete, now model.ManyPets.stg_orders)
[0m23:32:54.666330 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m23:32:54.685373 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m23:32:54.687374 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m23:32:54.702753 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:32:54.702753 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace  temporary view DEV.staging.stg_orders__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS event_type,
        data:time::TIMESTAMP                            AS event_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_orders)
    
),
dedup AS
(
    SELECT
        *
        ,ROW_NUMBER() OVER(PARTITION BY order_id, email, pet_dob, pet_name, pet_breed  ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)
SELECT 
    order_id ,
    email AS customer_email,
    pet_dob,
    pet_name,
    COALESCE(NULLIF(TRIM(COALESCE(first_name, '') || ' ' || COALESCE(last_name, '')), ''), 'unknown') AS customer_name,
    dob                                         AS customer_dob,
    phone                                       AS customer_phone,
    address_line1 || ' ' || address_line2       AS customer_address,
    city                                        AS customer_city,
    country                                     AS customer_country,
    postcode                                    AS customer_postcode,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_date,
    cessation_date,
    affiliate_code,
    source,
    event_type,
    event_time,
    ingest_date
FROM dedup
WHERE 
    rnk =1
  );
[0m23:32:55.137503 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.440 seconds
[0m23:32:55.168283 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:32:55.168283 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders__dbt_tmp
[0m23:32:55.253931 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.083 seconds
[0m23:32:55.269075 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:32:55.269075 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders
[0m23:32:55.322863 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.062 seconds
[0m23:32:55.338513 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:32:55.338513 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table "DEV"."STAGING"."STG_ORDERS"
[0m23:32:55.439701 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.099 seconds
[0m23:32:55.501883 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m23:32:55.501883 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:32:55.501883 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m23:32:55.787051 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.276 seconds
[0m23:32:55.787051 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:32:55.787051 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
merge into DEV.staging.stg_orders as DBT_INTERNAL_DEST
        using DEV.staging.stg_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.email = DBT_INTERNAL_DEST.email
                ) and (
                    DBT_INTERNAL_SOURCE.pet_dob = DBT_INTERNAL_DEST.pet_dob
                ) and (
                    DBT_INTERNAL_SOURCE.pet_name = DBT_INTERNAL_DEST.pet_name
                ) and (
                    DBT_INTERNAL_SOURCE.pet_breed = DBT_INTERNAL_DEST.pet_breed
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_EMAIL" = DBT_INTERNAL_SOURCE."CUSTOMER_EMAIL","PET_DOB" = DBT_INTERNAL_SOURCE."PET_DOB","PET_NAME" = DBT_INTERNAL_SOURCE."PET_NAME","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","PET_BREED" = DBT_INTERNAL_SOURCE."PET_BREED","PET_GENDER" = DBT_INTERNAL_SOURCE."PET_GENDER","PET_SPECIES" = DBT_INTERNAL_SOURCE."PET_SPECIES","PEDIGREE_TYPE" = DBT_INTERNAL_SOURCE."PEDIGREE_TYPE","SPAYED_NEUTERED" = DBT_INTERNAL_SOURCE."SPAYED_NEUTERED","PET_POSTCODE" = DBT_INTERNAL_SOURCE."PET_POSTCODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","CESSATION_DATE" = DBT_INTERNAL_SOURCE."CESSATION_DATE","AFFILIATE_CODE" = DBT_INTERNAL_SOURCE."AFFILIATE_CODE","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","EVENT_TIME" = DBT_INTERNAL_SOURCE."EVENT_TIME","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")
    values
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")

;
[0m23:32:55.918375 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0e60-0000-e37b-0001-b3ce0001b156
[0m23:32:55.918375 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 20
invalid identifier 'DBT_INTERNAL_SOURCE.EMAIL'
[0m23:32:55.924906 [debug] [Thread-1 (]: Database Error in model stg_orders (models\staging\stg_orders.sql)
  000904 (42000): SQL compilation error: error line 6 at position 20
  invalid identifier 'DBT_INTERNAL_SOURCE.EMAIL'
  compiled code at target\run\ManyPets\models\staging\stg_orders.sql
[0m23:32:55.924906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a896859e-6388-423a-898a-23ee9d0f333c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D06471E1D0>]}
[0m23:32:55.924906 [error] [Thread-1 (]: 2 of 5 ERROR creating sql incremental model staging.stg_orders ................. [[31mERROR[0m in 1.26s]
[0m23:32:55.924906 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m23:32:55.924906 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models\staging\stg_orders.sql)
  000904 (42000): SQL compilation error: error line 6 at position 20
  invalid identifier 'DBT_INTERNAL_SOURCE.EMAIL'
  compiled code at target\run\ManyPets\models\staging\stg_orders.sql.
[0m23:32:55.940559 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m23:32:55.943473 [info ] [Thread-1 (]: 3 of 5 SKIP relation odl.dim_customers ......................................... [[33mSKIP[0m]
[0m23:32:55.945619 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m23:32:55.947614 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_pets
[0m23:32:55.948618 [info ] [Thread-1 (]: 4 of 5 SKIP relation odl.dim_pets .............................................. [[33mSKIP[0m]
[0m23:32:55.950614 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_pets
[0m23:32:55.951803 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m23:32:55.956071 [info ] [Thread-1 (]: 5 of 5 SKIP relation odl.fact_orders ........................................... [[33mSKIP[0m]
[0m23:32:55.958073 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m23:32:55.960067 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:32:55.960067 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m23:32:55.961161 [debug] [MainThread]: On list_DEV: Close
[0m23:32:56.063461 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m23:32:56.064453 [debug] [MainThread]: On list_DEV_staging: Close
[0m23:32:56.150396 [debug] [MainThread]: Connection 'model.ManyPets.stg_orders' was left open.
[0m23:32:56.150396 [debug] [MainThread]: On model.ManyPets.stg_orders: Close
[0m23:32:56.257518 [info ] [MainThread]: 
[0m23:32:56.257518 [info ] [MainThread]: Finished running 5 incremental models in 0 hours 0 minutes and 3.68 seconds (3.68s).
[0m23:32:56.273138 [debug] [MainThread]: Command end result
[0m23:32:56.344916 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m23:32:56.350682 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m23:32:56.362684 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m23:32:56.362684 [info ] [MainThread]: 
[0m23:32:56.364683 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:32:56.365655 [info ] [MainThread]: 
[0m23:32:56.367668 [error] [MainThread]:   Database Error in model stg_order_complete (models\staging\stg_order_complete.sql)
  000904 (42000): SQL compilation error: error line 8 at position 8
  invalid identifier 'DATA'
[0m23:32:56.368743 [info ] [MainThread]: 
[0m23:32:56.368743 [error] [MainThread]:   Database Error in model stg_orders (models\staging\stg_orders.sql)
  000904 (42000): SQL compilation error: error line 6 at position 20
  invalid identifier 'DBT_INTERNAL_SOURCE.EMAIL'
  compiled code at target\run\ManyPets\models\staging\stg_orders.sql
[0m23:32:56.373316 [info ] [MainThread]: 
[0m23:32:56.374551 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
[0m23:32:56.378559 [debug] [MainThread]: Command `dbt run` failed at 23:32:56.378559 after 5.90 seconds
[0m23:32:56.379562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0602E6080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0647B82E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0647BBC70>]}
[0m23:32:56.380559 [debug] [MainThread]: Flushing usage events
[0m23:32:56.889560 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:33:23.992879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E2E226080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E3017AAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E3017A8F0>]}


============================== 23:33:24.008517 | 7f8948f5-d51f-46cf-8581-c510cb568b7c ==============================
[0m23:33:24.008517 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:33:24.008517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:33:24.215635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f8948f5-d51f-46cf-8581-c510cb568b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E3017AB90>]}
[0m23:33:24.256189 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:33:24.387414 [debug] [MainThread]: Set downloads directory='C:\Users\HP\AppData\Local\Temp\dbt-downloads-_wlew8ux'
[0m23:33:24.387414 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:33:24.506182 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:33:24.506182 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:33:24.599984 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:33:24.606522 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:33:25.263229 [info ] [MainThread]: Installed from version 1.3.0
[0m23:33:25.267226 [info ] [MainThread]: Up to date!
[0m23:33:25.270231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7f8948f5-d51f-46cf-8581-c510cb568b7c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E2E56D420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E2D6279A0>]}
[0m23:33:25.277585 [debug] [MainThread]: Command `dbt deps` succeeded at 23:33:25.277585 after 1.40 seconds
[0m23:33:25.279593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E2E226080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E2E0996C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E2E578FD0>]}
[0m23:33:25.281583 [debug] [MainThread]: Flushing usage events
[0m23:33:25.759685 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:33:39.977593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002029AA76020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002029C99A860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002029C99A680>]}


============================== 23:33:39.977593 | ac348633-59bc-4f84-a282-09e4fcfdbc22 ==============================
[0m23:33:39.977593 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:33:39.993218 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt parse', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:33:40.732208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac348633-59bc-4f84-a282-09e4fcfdbc22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002029C937B80>]}
[0m23:33:40.843002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac348633-59bc-4f84-a282-09e4fcfdbc22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002029D276470>]}
[0m23:33:40.843002 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m23:33:41.346565 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:33:41.825346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:33:41.825346 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:33:41.941871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac348633-59bc-4f84-a282-09e4fcfdbc22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002029E86C130>]}
[0m23:33:41.941871 [info ] [MainThread]: Performance info: C:\Users\HP\Documents\manypets\ManyPets\target\perf_info.json
[0m23:33:42.328396 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m23:33:42.338514 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m23:33:42.346554 [debug] [MainThread]: Command `dbt parse` succeeded at 23:33:42.346554 after 2.48 seconds
[0m23:33:42.348593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002029AA76020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002029E7E7850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002029E7E74C0>]}
[0m23:33:42.348593 [debug] [MainThread]: Flushing usage events
[0m23:33:42.942846 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:37:11.098580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AFF6F5FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A8165E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A8165E740>]}


============================== 23:37:11.098580 | 71e744af-ecf8-48d4-9ccd-47675eb8c8c4 ==============================
[0m23:37:11.098580 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:37:11.098580 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:37:11.822100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71e744af-ecf8-48d4-9ccd-47675eb8c8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AFFA49ED0>]}
[0m23:37:11.922377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71e744af-ecf8-48d4-9ccd-47675eb8c8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A814CB2B0>]}
[0m23:37:11.922377 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m23:37:12.423396 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:37:12.889853 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:37:12.889853 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:37:13.002761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71e744af-ecf8-48d4-9ccd-47675eb8c8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A83628130>]}
[0m23:37:13.241094 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m23:37:13.256723 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m23:37:13.287973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71e744af-ecf8-48d4-9ccd-47675eb8c8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A835F5B40>]}
[0m23:37:13.303598 [info ] [MainThread]: Found 6 models, 11 data tests, 2 sources, 591 macros
[0m23:37:13.303598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71e744af-ecf8-48d4-9ccd-47675eb8c8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A835F3910>]}
[0m23:37:13.303598 [info ] [MainThread]: 
[0m23:37:13.315269 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:37:13.316642 [info ] [MainThread]: 
[0m23:37:13.318642 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:37:13.346173 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m23:37:13.526194 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m23:37:13.526194 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m23:37:13.526194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:14.227973 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.701 seconds
[0m23:37:14.227973 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m23:37:14.243616 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m23:37:14.328260 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.098 seconds
[0m23:37:14.343897 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m23:37:14.359522 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m23:37:14.359522 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m23:37:14.359522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:14.807469 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.447 seconds
[0m23:37:14.807469 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m23:37:14.823083 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m23:37:14.823083 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m23:37:14.907746 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.095 seconds
[0m23:37:14.927415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71e744af-ecf8-48d4-9ccd-47675eb8c8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A82539990>]}
[0m23:37:14.935393 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_order_complete
[0m23:37:14.937396 [info ] [Thread-1 (]: 1 of 5 START sql incremental model staging.stg_order_complete .................. [RUN]
[0m23:37:14.938391 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_order_complete'
[0m23:37:14.939395 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_order_complete
[0m23:37:14.967108 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_order_complete"
[0m23:37:14.967108 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_order_complete
[0m23:37:15.061617 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:37:15.061617 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
create or replace  temporary view DEV.staging.stg_order_complete__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING        AS order_id,
        data:detail:intent::STRING          AS intent,
        data:detail:tenant::STRING          AS tenant,
        data:detail:customer_id::STRING     AS customer_id,
        pet.value                           AS pet_id,  
        data:time::TIMESTAMP                AS event_time,
        data:source::STRING                 AS source,
        data:type::STRING                   AS event_type,
        ingest_date                         AS ingest_date
    FROM dev.rdl.order_complete o,
    LATERAL FLATTEN(input => o.data:detail:pet_ids) AS pet  

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_order_complete)
    
)
SELECT 
    order_id,
    customer_id,
    pet_id,
    intent,
    tenant,
    event_time,
    source,
    event_type,
    ingest_date
FROM source_data
  );
[0m23:37:15.061617 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:37:15.431539 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0e64-0000-e3b4-0000-0001b3ceb265
[0m23:37:15.431539 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 8
invalid identifier 'DATA'
[0m23:37:15.431539 [debug] [Thread-1 (]: Database Error in model stg_order_complete (models\staging\stg_order_complete.sql)
  000904 (42000): SQL compilation error: error line 8 at position 8
  invalid identifier 'DATA'
[0m23:37:15.431539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71e744af-ecf8-48d4-9ccd-47675eb8c8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AFF561240>]}
[0m23:37:15.448235 [error] [Thread-1 (]: 1 of 5 ERROR creating sql incremental model staging.stg_order_complete ......... [[31mERROR[0m in 0.49s]
[0m23:37:15.448235 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_order_complete
[0m23:37:15.448235 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m23:37:15.448235 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.stg_order_complete' to be skipped because of status 'error'.  Reason: Database Error in model stg_order_complete (models\staging\stg_order_complete.sql)
  000904 (42000): SQL compilation error: error line 8 at position 8
  invalid identifier 'DATA'.
[0m23:37:15.448235 [info ] [Thread-1 (]: 2 of 5 START sql incremental model staging.stg_orders .......................... [RUN]
[0m23:37:15.458340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_order_complete, now model.ManyPets.stg_orders)
[0m23:37:15.459358 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m23:37:15.475693 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m23:37:15.477713 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m23:37:15.494102 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:37:15.494102 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace  temporary view DEV.staging.stg_orders__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS event_type,
        data:time::TIMESTAMP                            AS event_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_orders)
    
),
dedup AS
(
    SELECT
        *
        ,ROW_NUMBER() OVER(PARTITION BY order_id, email, pet_dob, pet_name, pet_breed  ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)
SELECT 
    order_id ,
    email AS customer_email,
    pet_dob,
    pet_name,
    COALESCE(NULLIF(TRIM(COALESCE(first_name, '') || ' ' || COALESCE(last_name, '')), ''), 'unknown') AS customer_name,
    dob                                         AS customer_dob,
    phone                                       AS customer_phone,
    address_line1 || ' ' || address_line2       AS customer_address,
    city                                        AS customer_city,
    country                                     AS customer_country,
    postcode                                    AS customer_postcode,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_date,
    cessation_date,
    affiliate_code,
    source,
    event_type,
    event_time,
    ingest_date
FROM dedup
WHERE 
    rnk =1
  );
[0m23:37:15.964781 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.475 seconds
[0m23:37:15.996133 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:37:15.997134 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders__dbt_tmp
[0m23:37:17.014618 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 1.018 seconds
[0m23:37:17.014618 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:37:17.014618 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders
[0m23:37:17.108409 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.082 seconds
[0m23:37:17.136548 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:37:17.136548 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table "DEV"."STAGING"."STG_ORDERS"
[0m23:37:17.199063 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.072 seconds
[0m23:37:17.252495 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m23:37:17.268118 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:37:17.268118 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m23:37:17.439550 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.173 seconds
[0m23:37:17.439550 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:37:17.447655 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
merge into DEV.staging.stg_orders as DBT_INTERNAL_DEST
        using DEV.staging.stg_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.email = DBT_INTERNAL_DEST.email
                ) and (
                    DBT_INTERNAL_SOURCE.pet_dob = DBT_INTERNAL_DEST.pet_dob
                ) and (
                    DBT_INTERNAL_SOURCE.pet_name = DBT_INTERNAL_DEST.pet_name
                ) and (
                    DBT_INTERNAL_SOURCE.pet_breed = DBT_INTERNAL_DEST.pet_breed
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_EMAIL" = DBT_INTERNAL_SOURCE."CUSTOMER_EMAIL","PET_DOB" = DBT_INTERNAL_SOURCE."PET_DOB","PET_NAME" = DBT_INTERNAL_SOURCE."PET_NAME","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","PET_BREED" = DBT_INTERNAL_SOURCE."PET_BREED","PET_GENDER" = DBT_INTERNAL_SOURCE."PET_GENDER","PET_SPECIES" = DBT_INTERNAL_SOURCE."PET_SPECIES","PEDIGREE_TYPE" = DBT_INTERNAL_SOURCE."PEDIGREE_TYPE","SPAYED_NEUTERED" = DBT_INTERNAL_SOURCE."SPAYED_NEUTERED","PET_POSTCODE" = DBT_INTERNAL_SOURCE."PET_POSTCODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","CESSATION_DATE" = DBT_INTERNAL_SOURCE."CESSATION_DATE","AFFILIATE_CODE" = DBT_INTERNAL_SOURCE."AFFILIATE_CODE","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","EVENT_TIME" = DBT_INTERNAL_SOURCE."EVENT_TIME","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")
    values
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")

;
[0m23:37:17.580420 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0e64-0000-e37b-0001-b3ce0001b162
[0m23:37:17.581421 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 20
invalid identifier 'DBT_INTERNAL_SOURCE.EMAIL'
[0m23:37:17.584420 [debug] [Thread-1 (]: Database Error in model stg_orders (models\staging\stg_orders.sql)
  000904 (42000): SQL compilation error: error line 6 at position 20
  invalid identifier 'DBT_INTERNAL_SOURCE.EMAIL'
  compiled code at target\run\ManyPets\models\staging\stg_orders.sql
[0m23:37:17.585420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71e744af-ecf8-48d4-9ccd-47675eb8c8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A83C12800>]}
[0m23:37:17.586422 [error] [Thread-1 (]: 2 of 5 ERROR creating sql incremental model staging.stg_orders ................. [[31mERROR[0m in 2.13s]
[0m23:37:17.588423 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m23:37:17.589423 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models\staging\stg_orders.sql)
  000904 (42000): SQL compilation error: error line 6 at position 20
  invalid identifier 'DBT_INTERNAL_SOURCE.EMAIL'
  compiled code at target\run\ManyPets\models\staging\stg_orders.sql.
[0m23:37:17.590461 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m23:37:17.590461 [info ] [Thread-1 (]: 3 of 5 SKIP relation odl.dim_customers ......................................... [[33mSKIP[0m]
[0m23:37:17.590461 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m23:37:17.596593 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_pets
[0m23:37:17.597591 [info ] [Thread-1 (]: 4 of 5 SKIP relation odl.dim_pets .............................................. [[33mSKIP[0m]
[0m23:37:17.598588 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_pets
[0m23:37:17.600585 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m23:37:17.601662 [info ] [Thread-1 (]: 5 of 5 SKIP relation odl.fact_orders ........................................... [[33mSKIP[0m]
[0m23:37:17.601662 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m23:37:17.607983 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:37:17.609990 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m23:37:17.610989 [debug] [MainThread]: On list_DEV: Close
[0m23:37:17.691224 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m23:37:17.691224 [debug] [MainThread]: On list_DEV_odl: Close
[0m23:37:17.795010 [debug] [MainThread]: Connection 'model.ManyPets.stg_orders' was left open.
[0m23:37:17.795010 [debug] [MainThread]: On model.ManyPets.stg_orders: Close
[0m23:37:17.895312 [info ] [MainThread]: 
[0m23:37:17.895312 [info ] [MainThread]: Finished running 5 incremental models in 0 hours 0 minutes and 4.58 seconds (4.58s).
[0m23:37:17.910927 [debug] [MainThread]: Command end result
[0m23:37:17.979841 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m23:37:17.979841 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m23:37:18.011189 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m23:37:18.012161 [info ] [MainThread]: 
[0m23:37:18.014170 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:37:18.015159 [info ] [MainThread]: 
[0m23:37:18.017163 [error] [MainThread]:   Database Error in model stg_order_complete (models\staging\stg_order_complete.sql)
  000904 (42000): SQL compilation error: error line 8 at position 8
  invalid identifier 'DATA'
[0m23:37:18.019603 [info ] [MainThread]: 
[0m23:37:18.022617 [error] [MainThread]:   Database Error in model stg_orders (models\staging\stg_orders.sql)
  000904 (42000): SQL compilation error: error line 6 at position 20
  invalid identifier 'DBT_INTERNAL_SOURCE.EMAIL'
  compiled code at target\run\ManyPets\models\staging\stg_orders.sql
[0m23:37:18.026535 [info ] [MainThread]: 
[0m23:37:18.029537 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
[0m23:37:18.031649 [debug] [MainThread]: Command `dbt run` failed at 23:37:18.031649 after 7.11 seconds
[0m23:37:18.031649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AFF6F5FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AFFA4A980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AFFA49A50>]}
[0m23:37:18.031649 [debug] [MainThread]: Flushing usage events
[0m23:37:18.559324 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:38:00.981812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F309085FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F30AFAEB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F30AFAE980>]}


============================== 23:38:00.981812 | 09252e37-3929-46c5-bf9f-f8752b694a18 ==============================
[0m23:38:00.981812 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:38:00.997432 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_order_complete', 'send_anonymous_usage_stats': 'True'}
[0m23:38:01.614697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09252e37-3929-46c5-bf9f-f8752b694a18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F30AFC1030>]}
[0m23:38:01.718709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09252e37-3929-46c5-bf9f-f8752b694a18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F30AFAEC80>]}
[0m23:38:01.720740 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m23:38:02.226568 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:38:02.599585 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:38:02.599585 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:38:02.699899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09252e37-3929-46c5-bf9f-f8752b694a18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F30CE7C130>]}
[0m23:38:02.931813 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m23:38:02.933847 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m23:38:02.967539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09252e37-3929-46c5-bf9f-f8752b694a18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F30BA1EAD0>]}
[0m23:38:02.967539 [info ] [MainThread]: Found 6 models, 11 data tests, 2 sources, 591 macros
[0m23:38:02.967539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09252e37-3929-46c5-bf9f-f8752b694a18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F30CE46A40>]}
[0m23:38:02.967539 [info ] [MainThread]: 
[0m23:38:02.967539 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:38:02.967539 [info ] [MainThread]: 
[0m23:38:02.983359 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:38:02.986361 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m23:38:03.214606 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m23:38:03.214606 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m23:38:03.214606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:38:03.885703 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.670 seconds
[0m23:38:03.916962 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m23:38:03.932579 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m23:38:03.932579 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m23:38:03.932579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:38:04.388052 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.456 seconds
[0m23:38:04.403335 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m23:38:04.403335 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m23:38:04.403335 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m23:38:04.504040 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.105 seconds
[0m23:38:04.519314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09252e37-3929-46c5-bf9f-f8752b694a18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F30B981C90>]}
[0m23:38:04.519314 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_order_complete
[0m23:38:04.519314 [info ] [Thread-1 (]: 1 of 1 START sql incremental model staging.stg_order_complete .................. [RUN]
[0m23:38:04.519314 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_order_complete'
[0m23:38:04.519314 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_order_complete
[0m23:38:04.564636 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_order_complete"
[0m23:38:04.564636 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_order_complete
[0m23:38:04.645518 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:38:04.645518 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
create or replace  temporary view DEV.staging.stg_order_complete__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING        AS order_id,
        data:detail:intent::STRING          AS intent,
        data:detail:tenant::STRING          AS tenant,
        data:detail:customer_id::STRING     AS customer_id,
        pet.value                           AS pet_id,  
        data:time::TIMESTAMP                AS event_time,
        data:source::STRING                 AS source,
        data:type::STRING                   AS event_type,
        ingest_date                         AS ingest_date
    FROM dev.rdl.order_complete o,
    LATERAL FLATTEN(input => o.data:detail:pet_ids) AS pet  

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_order_complete)
    
)
SELECT 
    order_id,
    customer_id,
    pet_id,
    intent,
    tenant,
    event_time,
    source,
    event_type,
    ingest_date
FROM source_data
  );
[0m23:38:04.645518 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:38:04.989702 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0e65-0000-e3b4-0000-0001b3ceb271
[0m23:38:04.989702 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 8
invalid identifier 'DATA'
[0m23:38:04.989702 [debug] [Thread-1 (]: Database Error in model stg_order_complete (models\staging\stg_order_complete.sql)
  000904 (42000): SQL compilation error: error line 8 at position 8
  invalid identifier 'DATA'
[0m23:38:04.989702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09252e37-3929-46c5-bf9f-f8752b694a18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F308EF3AF0>]}
[0m23:38:04.989702 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model staging.stg_order_complete ......... [[31mERROR[0m in 0.47s]
[0m23:38:04.989702 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_order_complete
[0m23:38:04.989702 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.stg_order_complete' to be skipped because of status 'error'.  Reason: Database Error in model stg_order_complete (models\staging\stg_order_complete.sql)
  000904 (42000): SQL compilation error: error line 8 at position 8
  invalid identifier 'DATA'.
[0m23:38:05.005323 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:38:05.005323 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m23:38:05.005323 [debug] [MainThread]: On list_DEV: Close
[0m23:38:05.095799 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m23:38:05.095799 [debug] [MainThread]: On list_DEV_staging: Close
[0m23:38:05.189976 [debug] [MainThread]: Connection 'model.ManyPets.stg_order_complete' was left open.
[0m23:38:05.205208 [debug] [MainThread]: On model.ManyPets.stg_order_complete: Close
[0m23:38:05.306050 [info ] [MainThread]: 
[0m23:38:05.306050 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.32 seconds (2.32s).
[0m23:38:05.321217 [debug] [MainThread]: Command end result
[0m23:38:05.397245 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m23:38:05.401353 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m23:38:05.414128 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m23:38:05.415146 [info ] [MainThread]: 
[0m23:38:05.416158 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:38:05.417547 [info ] [MainThread]: 
[0m23:38:05.419564 [error] [MainThread]:   Database Error in model stg_order_complete (models\staging\stg_order_complete.sql)
  000904 (42000): SQL compilation error: error line 8 at position 8
  invalid identifier 'DATA'
[0m23:38:05.421490 [info ] [MainThread]: 
[0m23:38:05.422496 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:38:05.424497 [debug] [MainThread]: Command `dbt run` failed at 23:38:05.424497 after 4.57 seconds
[0m23:38:05.425496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F309085FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F30859AA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F30D41F790>]}
[0m23:38:05.426498 [debug] [MainThread]: Flushing usage events
[0m23:38:05.891303 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:42:52.663332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D4BE760B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D4DD6D2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D4DD6F670>]}


============================== 23:42:52.678962 | 98dd7c32-74f1-4331-8591-73b0437f552b ==============================
[0m23:42:52.678962 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:42:52.678962 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_order_complete', 'send_anonymous_usage_stats': 'True'}
[0m23:42:53.308186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98dd7c32-74f1-4331-8591-73b0437f552b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D4DDB3250>]}
[0m23:42:53.411494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98dd7c32-74f1-4331-8591-73b0437f552b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D4DDB0F40>]}
[0m23:42:53.411494 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m23:42:53.881290 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:42:54.239637 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:42:54.239637 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:42:54.332458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98dd7c32-74f1-4331-8591-73b0437f552b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D4FC68130>]}
[0m23:42:54.565802 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m23:42:54.565802 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m23:42:54.612669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98dd7c32-74f1-4331-8591-73b0437f552b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D4AFB6170>]}
[0m23:42:54.612669 [info ] [MainThread]: Found 6 models, 11 data tests, 2 sources, 591 macros
[0m23:42:54.612669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98dd7c32-74f1-4331-8591-73b0437f552b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D4B9F9540>]}
[0m23:42:54.612669 [info ] [MainThread]: 
[0m23:42:54.612669 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:42:54.612669 [info ] [MainThread]: 
[0m23:42:54.624830 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:42:54.627830 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m23:42:54.781678 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m23:42:54.797317 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m23:42:54.797317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:42:55.500038 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.712 seconds
[0m23:42:55.515321 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m23:42:55.530941 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m23:42:55.530941 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m23:42:55.530941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:42:55.870273 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.338 seconds
[0m23:42:55.870273 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m23:42:55.885704 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m23:42:55.885704 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m23:42:55.986584 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.097 seconds
[0m23:42:55.986584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98dd7c32-74f1-4331-8591-73b0437f552b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D4FB5F910>]}
[0m23:42:55.986584 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_order_complete
[0m23:42:55.986584 [info ] [Thread-1 (]: 1 of 1 START sql incremental model staging.stg_order_complete .................. [RUN]
[0m23:42:56.002195 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_order_complete'
[0m23:42:56.002195 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_order_complete
[0m23:42:56.040777 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_order_complete"
[0m23:42:56.040777 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_order_complete
[0m23:42:56.106397 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:42:56.106397 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
create or replace  temporary view DEV.staging.stg_order_complete__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING        AS order_id,
        data:detail:intent::STRING          AS intent,
        data:detail:tenant::STRING          AS tenant,
        data:detail:customer_id::STRING     AS customer_id,
        pet.value                           AS pet_id,  
        data:time::TIMESTAMP                AS event_time,
        data:source::STRING                 AS source,
        data:type::STRING                   AS event_type,
        ingest_date                         AS ingest_date
    FROM dev.rdl.order_complete o,
    LATERAL FLATTEN(input => o.data:detail:pet_ids) AS pet  

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_order_complete)
    
)
SELECT 
    order_id,
    customer_id,
    pet_id,
    intent,
    tenant,
    event_time,
    source,
    event_type,
    ingest_date
FROM source_data
  );
[0m23:42:56.121975 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:42:56.750934 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.631 seconds
[0m23:42:56.773103 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:42:56.773103 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table DEV.staging.stg_order_complete__dbt_tmp
[0m23:42:56.874333 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.097 seconds
[0m23:42:56.874333 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:42:56.874333 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table DEV.staging.stg_order_complete
[0m23:42:56.952081 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.065 seconds
[0m23:42:56.958629 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:42:56.958629 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table "DEV"."STAGING"."STG_ORDER_COMPLETE"
[0m23:42:57.037941 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.081 seconds
[0m23:42:57.105686 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_order_complete"
[0m23:42:57.105686 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:42:57.105686 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
-- back compat for old kwarg name
  
  begin;
[0m23:42:57.206385 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.096 seconds
[0m23:42:57.206385 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:42:57.206385 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
merge into DEV.staging.stg_order_complete as DBT_INTERNAL_DEST
        using DEV.staging.stg_order_complete__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
                ) and (
                    DBT_INTERNAL_SOURCE.pet_id = DBT_INTERNAL_DEST.pet_id
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PET_ID" = DBT_INTERNAL_SOURCE."PET_ID","INTENT" = DBT_INTERNAL_SOURCE."INTENT","TENANT" = DBT_INTERNAL_SOURCE."TENANT","EVENT_TIME" = DBT_INTERNAL_SOURCE."EVENT_TIME","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PET_ID", "INTENT", "TENANT", "EVENT_TIME", "SOURCE", "EVENT_TYPE", "INGEST_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PET_ID", "INTENT", "TENANT", "EVENT_TIME", "SOURCE", "EVENT_TYPE", "INGEST_DATE")

;
[0m23:42:57.978463 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.766 seconds
[0m23:42:57.978463 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:42:57.978463 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
COMMIT
[0m23:42:58.119096 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.134 seconds
[0m23:42:58.134699 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_order_complete__dbt_tmp
[0m23:42:58.150317 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:42:58.150317 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
drop view if exists DEV.staging.stg_order_complete__dbt_tmp cascade
[0m23:42:58.279215 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.126 seconds
[0m23:42:58.325667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98dd7c32-74f1-4331-8591-73b0437f552b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D503D72E0>]}
[0m23:42:58.325667 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model staging.stg_order_complete ............. [[32mSUCCESS 0[0m in 2.34s]
[0m23:42:58.325667 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_order_complete
[0m23:42:58.325667 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:42:58.325667 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m23:42:58.325667 [debug] [MainThread]: On list_DEV: Close
[0m23:42:58.437444 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m23:42:58.437444 [debug] [MainThread]: On list_DEV_odl: Close
[0m23:42:58.542556 [debug] [MainThread]: Connection 'model.ManyPets.stg_order_complete' was left open.
[0m23:42:58.542556 [debug] [MainThread]: On model.ManyPets.stg_order_complete: Close
[0m23:42:58.636076 [info ] [MainThread]: 
[0m23:42:58.651709 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.01 seconds (4.01s).
[0m23:42:58.651709 [debug] [MainThread]: Command end result
[0m23:42:58.721774 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m23:42:58.721774 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m23:42:58.738218 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m23:42:58.738218 [info ] [MainThread]: 
[0m23:42:58.738218 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:42:58.738218 [info ] [MainThread]: 
[0m23:42:58.738218 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:42:58.755090 [debug] [MainThread]: Command `dbt run` succeeded at 23:42:58.754087 after 6.21 seconds
[0m23:42:58.757091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D4BE760B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D4AFB6170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D4C1BCBB0>]}
[0m23:42:58.758090 [debug] [MainThread]: Flushing usage events
[0m23:42:59.259498 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:43:07.736068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D982E96050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D984DBE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D984DBE7D0>]}


============================== 23:43:07.736068 | cb6938ed-2afa-4ab9-a171-634b58df637d ==============================
[0m23:43:07.736068 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:43:07.736068 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:43:08.368044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb6938ed-2afa-4ab9-a171-634b58df637d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D981769C90>]}
[0m23:43:08.466754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb6938ed-2afa-4ab9-a171-634b58df637d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D984C61B70>]}
[0m23:43:08.468781 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m23:43:08.919147 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:43:09.273625 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:43:09.273625 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:43:09.363278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb6938ed-2afa-4ab9-a171-634b58df637d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D986C88130>]}
[0m23:43:09.601670 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m23:43:09.617331 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m23:43:09.648566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb6938ed-2afa-4ab9-a171-634b58df637d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D985B943D0>]}
[0m23:43:09.648566 [info ] [MainThread]: Found 6 models, 11 data tests, 2 sources, 591 macros
[0m23:43:09.648566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb6938ed-2afa-4ab9-a171-634b58df637d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D986BEE1A0>]}
[0m23:43:09.648566 [info ] [MainThread]: 
[0m23:43:09.648566 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:43:09.648566 [info ] [MainThread]: 
[0m23:43:09.667007 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:43:09.686474 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m23:43:09.849099 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m23:43:09.849099 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m23:43:09.849099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:10.504396 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.656 seconds
[0m23:43:10.520049 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m23:43:10.520049 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m23:43:10.683492 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.169 seconds
[0m23:43:10.698646 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m23:43:10.705157 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m23:43:10.705157 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m23:43:10.705157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:11.154296 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.451 seconds
[0m23:43:11.169592 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m23:43:11.185190 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m23:43:11.185190 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m23:43:11.270785 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.082 seconds
[0m23:43:11.270785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb6938ed-2afa-4ab9-a171-634b58df637d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D985BAB730>]}
[0m23:43:11.287671 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_order_complete
[0m23:43:11.287671 [info ] [Thread-1 (]: 1 of 5 START sql incremental model staging.stg_order_complete .................. [RUN]
[0m23:43:11.293601 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_order_complete'
[0m23:43:11.294598 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_order_complete
[0m23:43:11.326618 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_order_complete"
[0m23:43:11.326618 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_order_complete
[0m23:43:11.391981 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:43:11.391981 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
create or replace  temporary view DEV.staging.stg_order_complete__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING        AS order_id,
        data:detail:intent::STRING          AS intent,
        data:detail:tenant::STRING          AS tenant,
        data:detail:customer_id::STRING     AS customer_id,
        pet.value                           AS pet_id,  
        data:time::TIMESTAMP                AS event_time,
        data:source::STRING                 AS source,
        data:type::STRING                   AS event_type,
        ingest_date                         AS ingest_date
    FROM dev.rdl.order_complete o,
    LATERAL FLATTEN(input => o.data:detail:pet_ids) AS pet  

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_order_complete)
    
)
SELECT 
    order_id,
    customer_id,
    pet_id,
    intent,
    tenant,
    event_time,
    source,
    event_type,
    ingest_date
FROM source_data
  );
[0m23:43:11.391981 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:43:11.925889 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.521 seconds
[0m23:43:11.925889 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:43:11.925889 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table DEV.staging.stg_order_complete__dbt_tmp
[0m23:43:12.026670 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.089 seconds
[0m23:43:12.041998 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:43:12.041998 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table DEV.staging.stg_order_complete
[0m23:43:12.110977 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.079 seconds
[0m23:43:12.126619 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:43:12.126619 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table "DEV"."STAGING"."STG_ORDER_COMPLETE"
[0m23:43:12.211705 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.075 seconds
[0m23:43:12.258604 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_order_complete"
[0m23:43:12.258604 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:43:12.258604 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
-- back compat for old kwarg name
  
  begin;
[0m23:43:12.365708 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.095 seconds
[0m23:43:12.367707 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:43:12.368706 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
merge into DEV.staging.stg_order_complete as DBT_INTERNAL_DEST
        using DEV.staging.stg_order_complete__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
                ) and (
                    DBT_INTERNAL_SOURCE.pet_id = DBT_INTERNAL_DEST.pet_id
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PET_ID" = DBT_INTERNAL_SOURCE."PET_ID","INTENT" = DBT_INTERNAL_SOURCE."INTENT","TENANT" = DBT_INTERNAL_SOURCE."TENANT","EVENT_TIME" = DBT_INTERNAL_SOURCE."EVENT_TIME","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PET_ID", "INTENT", "TENANT", "EVENT_TIME", "SOURCE", "EVENT_TYPE", "INGEST_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PET_ID", "INTENT", "TENANT", "EVENT_TIME", "SOURCE", "EVENT_TYPE", "INGEST_DATE")

;
[0m23:43:12.613707 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.249 seconds
[0m23:43:12.613707 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:43:12.613707 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
COMMIT
[0m23:43:12.745665 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.137 seconds
[0m23:43:12.776738 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_order_complete__dbt_tmp
[0m23:43:12.792358 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:43:12.792358 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
drop view if exists DEV.staging.stg_order_complete__dbt_tmp cascade
[0m23:43:12.914686 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.118 seconds
[0m23:43:12.945974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb6938ed-2afa-4ab9-a171-634b58df637d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D987435F90>]}
[0m23:43:12.945974 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model staging.stg_order_complete ............. [[32mSUCCESS 0[0m in 1.65s]
[0m23:43:12.945974 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_order_complete
[0m23:43:12.945974 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m23:43:12.945974 [info ] [Thread-1 (]: 2 of 5 START sql incremental model staging.stg_orders .......................... [RUN]
[0m23:43:12.945974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_order_complete, now model.ManyPets.stg_orders)
[0m23:43:12.945974 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m23:43:12.966816 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m23:43:12.970477 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m23:43:12.981739 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:43:12.981739 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace  temporary view DEV.staging.stg_orders__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS event_type,
        data:time::TIMESTAMP                            AS event_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_orders)
    
),
dedup AS
(
    SELECT
        *
        ,ROW_NUMBER() OVER(PARTITION BY order_id, email, pet_dob, pet_name, pet_breed  ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)
SELECT 
    order_id ,
    email AS customer_email,
    pet_dob,
    pet_name,
    COALESCE(NULLIF(TRIM(COALESCE(first_name, '') || ' ' || COALESCE(last_name, '')), ''), 'unknown') AS customer_name,
    dob                                         AS customer_dob,
    phone                                       AS customer_phone,
    address_line1 || ' ' || address_line2       AS customer_address,
    city                                        AS customer_city,
    country                                     AS customer_country,
    postcode                                    AS customer_postcode,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_date,
    cessation_date,
    affiliate_code,
    source,
    event_type,
    event_time,
    ingest_date
FROM dedup
WHERE 
    rnk =1
  );
[0m23:43:13.440049 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.452 seconds
[0m23:43:13.440878 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:43:13.440878 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders__dbt_tmp
[0m23:43:14.049432 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.605 seconds
[0m23:43:14.049432 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:43:14.049432 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders
[0m23:43:14.118374 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.056 seconds
[0m23:43:14.118374 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:43:14.118374 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table "DEV"."STAGING"."STG_ORDERS"
[0m23:43:14.181405 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.061 seconds
[0m23:43:14.196526 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m23:43:14.196526 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:43:14.196526 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m23:43:14.297324 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.096 seconds
[0m23:43:14.297324 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:43:14.297324 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
merge into DEV.staging.stg_orders as DBT_INTERNAL_DEST
        using DEV.staging.stg_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.email = DBT_INTERNAL_DEST.email
                ) and (
                    DBT_INTERNAL_SOURCE.pet_dob = DBT_INTERNAL_DEST.pet_dob
                ) and (
                    DBT_INTERNAL_SOURCE.pet_name = DBT_INTERNAL_DEST.pet_name
                ) and (
                    DBT_INTERNAL_SOURCE.pet_breed = DBT_INTERNAL_DEST.pet_breed
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_EMAIL" = DBT_INTERNAL_SOURCE."CUSTOMER_EMAIL","PET_DOB" = DBT_INTERNAL_SOURCE."PET_DOB","PET_NAME" = DBT_INTERNAL_SOURCE."PET_NAME","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","PET_BREED" = DBT_INTERNAL_SOURCE."PET_BREED","PET_GENDER" = DBT_INTERNAL_SOURCE."PET_GENDER","PET_SPECIES" = DBT_INTERNAL_SOURCE."PET_SPECIES","PEDIGREE_TYPE" = DBT_INTERNAL_SOURCE."PEDIGREE_TYPE","SPAYED_NEUTERED" = DBT_INTERNAL_SOURCE."SPAYED_NEUTERED","PET_POSTCODE" = DBT_INTERNAL_SOURCE."PET_POSTCODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","CESSATION_DATE" = DBT_INTERNAL_SOURCE."CESSATION_DATE","AFFILIATE_CODE" = DBT_INTERNAL_SOURCE."AFFILIATE_CODE","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","EVENT_TIME" = DBT_INTERNAL_SOURCE."EVENT_TIME","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")
    values
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")

;
[0m23:43:14.450750 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0e6a-0000-e39c-0001-b3ce0001c15a
[0m23:43:14.450750 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 20
invalid identifier 'DBT_INTERNAL_SOURCE.EMAIL'
[0m23:43:14.450750 [debug] [Thread-1 (]: Database Error in model stg_orders (models\staging\stg_orders.sql)
  000904 (42000): SQL compilation error: error line 6 at position 20
  invalid identifier 'DBT_INTERNAL_SOURCE.EMAIL'
  compiled code at target\run\ManyPets\models\staging\stg_orders.sql
[0m23:43:14.450750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb6938ed-2afa-4ab9-a171-634b58df637d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9874E9330>]}
[0m23:43:14.450750 [error] [Thread-1 (]: 2 of 5 ERROR creating sql incremental model staging.stg_orders ................. [[31mERROR[0m in 1.50s]
[0m23:43:14.450750 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m23:43:14.450750 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models\staging\stg_orders.sql)
  000904 (42000): SQL compilation error: error line 6 at position 20
  invalid identifier 'DBT_INTERNAL_SOURCE.EMAIL'
  compiled code at target\run\ManyPets\models\staging\stg_orders.sql.
[0m23:43:14.450750 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m23:43:14.450750 [info ] [Thread-1 (]: 3 of 5 SKIP relation odl.dim_customers ......................................... [[33mSKIP[0m]
[0m23:43:14.464905 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m23:43:14.466015 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_pets
[0m23:43:14.467025 [info ] [Thread-1 (]: 4 of 5 SKIP relation odl.dim_pets .............................................. [[33mSKIP[0m]
[0m23:43:14.469020 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_pets
[0m23:43:14.470020 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m23:43:14.471566 [info ] [Thread-1 (]: 5 of 5 SKIP relation odl.fact_orders ........................................... [[33mSKIP[0m]
[0m23:43:14.475924 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m23:43:14.479287 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:43:14.480288 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m23:43:14.480288 [debug] [MainThread]: On list_DEV: Close
[0m23:43:14.573667 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m23:43:14.573667 [debug] [MainThread]: On list_DEV_odl: Close
[0m23:43:14.682924 [debug] [MainThread]: Connection 'model.ManyPets.stg_orders' was left open.
[0m23:43:14.682924 [debug] [MainThread]: On model.ManyPets.stg_orders: Close
[0m23:43:14.767968 [info ] [MainThread]: 
[0m23:43:14.783475 [info ] [MainThread]: Finished running 5 incremental models in 0 hours 0 minutes and 5.10 seconds (5.10s).
[0m23:43:14.783475 [debug] [MainThread]: Command end result
[0m23:43:14.859779 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m23:43:14.863777 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m23:43:14.876696 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m23:43:14.877718 [info ] [MainThread]: 
[0m23:43:14.879701 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:43:14.880699 [info ] [MainThread]: 
[0m23:43:14.881698 [error] [MainThread]:   Database Error in model stg_orders (models\staging\stg_orders.sql)
  000904 (42000): SQL compilation error: error line 6 at position 20
  invalid identifier 'DBT_INTERNAL_SOURCE.EMAIL'
  compiled code at target\run\ManyPets\models\staging\stg_orders.sql
[0m23:43:14.883855 [info ] [MainThread]: 
[0m23:43:14.885548 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=3 TOTAL=5
[0m23:43:14.887554 [debug] [MainThread]: Command `dbt run` failed at 23:43:14.887554 after 7.28 seconds
[0m23:43:14.888552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D982E96050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D986C64A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D986C618A0>]}
[0m23:43:14.889553 [debug] [MainThread]: Flushing usage events
[0m23:43:15.339530 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:46:03.838564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9B7736050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9B965E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9B965E7D0>]}


============================== 23:46:03.838564 | 0d3757ef-225e-46b6-bff4-6787b3abeffd ==============================
[0m23:46:03.838564 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:46:03.838564 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:46:04.503002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d3757ef-225e-46b6-bff4-6787b3abeffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9B5FB9C90>]}
[0m23:46:04.587673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d3757ef-225e-46b6-bff4-6787b3abeffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9B9501B70>]}
[0m23:46:04.603322 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m23:46:05.081922 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:46:05.450652 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:46:05.450652 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:46:05.550951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d3757ef-225e-46b6-bff4-6787b3abeffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9BB528130>]}
[0m23:46:05.799709 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m23:46:05.807768 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m23:46:05.833419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d3757ef-225e-46b6-bff4-6787b3abeffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9BB4083D0>]}
[0m23:46:05.833419 [info ] [MainThread]: Found 6 models, 11 data tests, 2 sources, 591 macros
[0m23:46:05.833419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d3757ef-225e-46b6-bff4-6787b3abeffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9BB48E1A0>]}
[0m23:46:05.850000 [info ] [MainThread]: 
[0m23:46:05.850000 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:46:05.854452 [info ] [MainThread]: 
[0m23:46:05.855454 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:46:05.866142 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m23:46:06.018615 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m23:46:06.018615 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m23:46:06.018615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:06.820574 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.810 seconds
[0m23:46:06.836213 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m23:46:06.836213 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m23:46:06.928842 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.091 seconds
[0m23:46:06.928842 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m23:46:06.944476 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m23:46:06.944476 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m23:46:06.944476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:07.321810 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.368 seconds
[0m23:46:07.321810 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m23:46:07.321810 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m23:46:07.321810 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m23:46:07.449683 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.115 seconds
[0m23:46:07.453682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d3757ef-225e-46b6-bff4-6787b3abeffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9BB41B730>]}
[0m23:46:07.461102 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_order_complete
[0m23:46:07.461102 [info ] [Thread-1 (]: 1 of 5 START sql incremental model staging.stg_order_complete .................. [RUN]
[0m23:46:07.461102 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_order_complete'
[0m23:46:07.461102 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_order_complete
[0m23:46:07.496630 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_order_complete"
[0m23:46:07.496630 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_order_complete
[0m23:46:07.576544 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:46:07.576544 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
create or replace  temporary view DEV.staging.stg_order_complete__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING        AS order_id,
        data:detail:intent::STRING          AS intent,
        data:detail:tenant::STRING          AS tenant,
        data:detail:customer_id::STRING     AS customer_id,
        pet.value                           AS pet_id,  
        data:time::TIMESTAMP                AS event_time,
        data:source::STRING                 AS source,
        data:type::STRING                   AS event_type,
        ingest_date                         AS ingest_date
    FROM dev.rdl.order_complete o,
    LATERAL FLATTEN(input => o.data:detail:pet_ids) AS pet  

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_order_complete)
    
)
SELECT 
    order_id,
    customer_id,
    pet_id,
    intent,
    tenant,
    event_time,
    source,
    event_type,
    ingest_date
FROM source_data
  );
[0m23:46:07.576544 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:46:08.287067 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.708 seconds
[0m23:46:08.302318 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:46:08.302318 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table DEV.staging.stg_order_complete__dbt_tmp
[0m23:46:08.371687 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.075 seconds
[0m23:46:08.386853 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:46:08.386853 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table DEV.staging.stg_order_complete
[0m23:46:08.445764 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.058 seconds
[0m23:46:08.461438 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:46:08.461438 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table "DEV"."STAGING"."STG_ORDER_COMPLETE"
[0m23:46:08.526960 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.059 seconds
[0m23:46:08.574783 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_order_complete"
[0m23:46:08.574783 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:46:08.574783 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
-- back compat for old kwarg name
  
  begin;
[0m23:46:08.672286 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.094 seconds
[0m23:46:08.672286 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:46:08.672286 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
merge into DEV.staging.stg_order_complete as DBT_INTERNAL_DEST
        using DEV.staging.stg_order_complete__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
                ) and (
                    DBT_INTERNAL_SOURCE.pet_id = DBT_INTERNAL_DEST.pet_id
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PET_ID" = DBT_INTERNAL_SOURCE."PET_ID","INTENT" = DBT_INTERNAL_SOURCE."INTENT","TENANT" = DBT_INTERNAL_SOURCE."TENANT","EVENT_TIME" = DBT_INTERNAL_SOURCE."EVENT_TIME","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PET_ID", "INTENT", "TENANT", "EVENT_TIME", "SOURCE", "EVENT_TYPE", "INGEST_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PET_ID", "INTENT", "TENANT", "EVENT_TIME", "SOURCE", "EVENT_TYPE", "INGEST_DATE")

;
[0m23:46:09.106570 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.441 seconds
[0m23:46:09.121771 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:46:09.121771 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
COMMIT
[0m23:46:09.252152 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.133 seconds
[0m23:46:09.267792 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_order_complete__dbt_tmp
[0m23:46:09.267792 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:46:09.267792 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
drop view if exists DEV.staging.stg_order_complete__dbt_tmp cascade
[0m23:46:09.428274 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.146 seconds
[0m23:46:09.459573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d3757ef-225e-46b6-bff4-6787b3abeffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9BBC35E70>]}
[0m23:46:09.459573 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model staging.stg_order_complete ............. [[32mSUCCESS 0[0m in 1.98s]
[0m23:46:09.459573 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_order_complete
[0m23:46:09.459573 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m23:46:09.459573 [info ] [Thread-1 (]: 2 of 5 START sql incremental model staging.stg_orders .......................... [RUN]
[0m23:46:09.459573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_order_complete, now model.ManyPets.stg_orders)
[0m23:46:09.459573 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m23:46:09.475183 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m23:46:09.477490 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m23:46:09.494520 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:46:09.496503 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace  temporary view DEV.staging.stg_orders__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS event_type,
        data:time::TIMESTAMP                            AS event_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_orders)
    
),
dedup AS
(
    SELECT
        *
        ,ROW_NUMBER() OVER(PARTITION BY order_id, email, pet_dob, pet_name, pet_breed  ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)
SELECT 
    order_id ,
    email AS customer_email,
    pet_dob,
    pet_name,
    COALESCE(NULLIF(TRIM(COALESCE(first_name, '') || ' ' || COALESCE(last_name, '')), ''), 'unknown') AS customer_name,
    dob                                         AS customer_dob,
    phone                                       AS customer_phone,
    address_line1 || ' ' || address_line2       AS customer_address,
    city                                        AS customer_city,
    country                                     AS customer_country,
    postcode                                    AS customer_postcode,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_date,
    cessation_date,
    affiliate_code,
    source,
    event_type,
    event_time,
    ingest_date
FROM dedup
WHERE 
    rnk =1
  );
[0m23:46:09.923433 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.426 seconds
[0m23:46:09.929982 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:46:09.929982 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders__dbt_tmp
[0m23:46:10.030512 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.098 seconds
[0m23:46:10.061794 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:46:10.061794 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders
[0m23:46:10.124724 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.061 seconds
[0m23:46:10.130740 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:46:10.130740 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table "DEV"."STAGING"."STG_ORDERS"
[0m23:46:10.246989 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.120 seconds
[0m23:46:10.262177 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m23:46:10.262177 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:46:10.262177 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m23:46:10.347046 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.078 seconds
[0m23:46:10.347046 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:46:10.347046 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
merge into DEV.staging.stg_orders as DBT_INTERNAL_DEST
        using DEV.staging.stg_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.email = DBT_INTERNAL_DEST.email
                ) and (
                    DBT_INTERNAL_SOURCE.pet_dob = DBT_INTERNAL_DEST.pet_dob
                ) and (
                    DBT_INTERNAL_SOURCE.pet_name = DBT_INTERNAL_DEST.pet_name
                ) and (
                    DBT_INTERNAL_SOURCE.pet_breed = DBT_INTERNAL_DEST.pet_breed
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_EMAIL" = DBT_INTERNAL_SOURCE."CUSTOMER_EMAIL","PET_DOB" = DBT_INTERNAL_SOURCE."PET_DOB","PET_NAME" = DBT_INTERNAL_SOURCE."PET_NAME","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","PET_BREED" = DBT_INTERNAL_SOURCE."PET_BREED","PET_GENDER" = DBT_INTERNAL_SOURCE."PET_GENDER","PET_SPECIES" = DBT_INTERNAL_SOURCE."PET_SPECIES","PEDIGREE_TYPE" = DBT_INTERNAL_SOURCE."PEDIGREE_TYPE","SPAYED_NEUTERED" = DBT_INTERNAL_SOURCE."SPAYED_NEUTERED","PET_POSTCODE" = DBT_INTERNAL_SOURCE."PET_POSTCODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","CESSATION_DATE" = DBT_INTERNAL_SOURCE."CESSATION_DATE","AFFILIATE_CODE" = DBT_INTERNAL_SOURCE."AFFILIATE_CODE","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","EVENT_TIME" = DBT_INTERNAL_SOURCE."EVENT_TIME","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")
    values
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")

;
[0m23:46:10.494118 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0e6d-0000-e3bf-0001-b3ce00019202
[0m23:46:10.494118 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 20
invalid identifier 'DBT_INTERNAL_SOURCE.EMAIL'
[0m23:46:10.494118 [debug] [Thread-1 (]: Database Error in model stg_orders (models\staging\stg_orders.sql)
  000904 (42000): SQL compilation error: error line 6 at position 20
  invalid identifier 'DBT_INTERNAL_SOURCE.EMAIL'
  compiled code at target\run\ManyPets\models\staging\stg_orders.sql
[0m23:46:10.494118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d3757ef-225e-46b6-bff4-6787b3abeffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9BBCF8250>]}
[0m23:46:10.494118 [error] [Thread-1 (]: 2 of 5 ERROR creating sql incremental model staging.stg_orders ................. [[31mERROR[0m in 1.03s]
[0m23:46:10.494118 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m23:46:10.494118 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models\staging\stg_orders.sql)
  000904 (42000): SQL compilation error: error line 6 at position 20
  invalid identifier 'DBT_INTERNAL_SOURCE.EMAIL'
  compiled code at target\run\ManyPets\models\staging\stg_orders.sql.
[0m23:46:10.494118 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m23:46:10.494118 [info ] [Thread-1 (]: 3 of 5 SKIP relation odl.dim_customers ......................................... [[33mSKIP[0m]
[0m23:46:10.511121 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m23:46:10.511989 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_pets
[0m23:46:10.513997 [info ] [Thread-1 (]: 4 of 5 SKIP relation odl.dim_pets .............................................. [[33mSKIP[0m]
[0m23:46:10.514993 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_pets
[0m23:46:10.517316 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m23:46:10.517316 [info ] [Thread-1 (]: 5 of 5 SKIP relation odl.fact_orders ........................................... [[33mSKIP[0m]
[0m23:46:10.522728 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m23:46:10.524878 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:46:10.526909 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m23:46:10.527876 [debug] [MainThread]: On list_DEV: Close
[0m23:46:10.614138 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m23:46:10.615139 [debug] [MainThread]: On list_DEV_odl: Close
[0m23:46:10.689274 [debug] [MainThread]: Connection 'model.ManyPets.stg_orders' was left open.
[0m23:46:10.689274 [debug] [MainThread]: On model.ManyPets.stg_orders: Close
[0m23:46:10.780300 [info ] [MainThread]: 
[0m23:46:10.795397 [info ] [MainThread]: Finished running 5 incremental models in 0 hours 0 minutes and 4.92 seconds (4.92s).
[0m23:46:10.795397 [debug] [MainThread]: Command end result
[0m23:46:10.869983 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m23:46:10.873987 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m23:46:10.886012 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m23:46:10.887016 [info ] [MainThread]: 
[0m23:46:10.888368 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:46:10.889416 [info ] [MainThread]: 
[0m23:46:10.891401 [error] [MainThread]:   Database Error in model stg_orders (models\staging\stg_orders.sql)
  000904 (42000): SQL compilation error: error line 6 at position 20
  invalid identifier 'DBT_INTERNAL_SOURCE.EMAIL'
  compiled code at target\run\ManyPets\models\staging\stg_orders.sql
[0m23:46:10.892491 [info ] [MainThread]: 
[0m23:46:10.892491 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=3 TOTAL=5
[0m23:46:10.897351 [debug] [MainThread]: Command `dbt run` failed at 23:46:10.897351 after 7.18 seconds
[0m23:46:10.898526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9B7736050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9BB500A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9BB4F4E80>]}
[0m23:46:10.900585 [debug] [MainThread]: Flushing usage events
[0m23:46:11.380735 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:50:26.941370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021631F05FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021633E2E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021633E2E740>]}


============================== 23:50:26.941370 | 33d94d73-2603-438c-be61-b316d595ddaa ==============================
[0m23:50:26.941370 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:50:26.941370 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:50:27.586142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33d94d73-2603-438c-be61-b316d595ddaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002163225DED0>]}
[0m23:50:27.684803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33d94d73-2603-438c-be61-b316d595ddaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021633C9B2B0>]}
[0m23:50:27.686315 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m23:50:28.134226 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:50:28.494732 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:50:28.502841 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:50:28.586208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33d94d73-2603-438c-be61-b316d595ddaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021635D08130>]}
[0m23:50:28.840347 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m23:50:28.848421 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m23:50:28.889700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33d94d73-2603-438c-be61-b316d595ddaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021635CD5B40>]}
[0m23:50:28.889700 [info ] [MainThread]: Found 6 models, 11 data tests, 2 sources, 591 macros
[0m23:50:28.889700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33d94d73-2603-438c-be61-b316d595ddaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021635CD3910>]}
[0m23:50:28.889700 [info ] [MainThread]: 
[0m23:50:28.902650 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:50:28.906138 [info ] [MainThread]: 
[0m23:50:28.909139 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:50:28.943570 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m23:50:29.159002 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m23:50:29.159002 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m23:50:29.159002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:50:29.976558 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.815 seconds
[0m23:50:29.976558 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m23:50:29.976558 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m23:50:30.061079 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.087 seconds
[0m23:50:30.076732 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m23:50:30.092342 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m23:50:30.092342 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m23:50:30.092342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:50:30.578774 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.485 seconds
[0m23:50:30.578774 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m23:50:30.578774 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m23:50:30.578774 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m23:50:30.695129 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.108 seconds
[0m23:50:30.710762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33d94d73-2603-438c-be61-b316d595ddaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021634742620>]}
[0m23:50:30.726377 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_order_complete
[0m23:50:30.726377 [info ] [Thread-1 (]: 1 of 5 START sql incremental model staging.stg_order_complete .................. [RUN]
[0m23:50:30.726377 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_order_complete'
[0m23:50:30.726377 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_order_complete
[0m23:50:30.750610 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_order_complete"
[0m23:50:30.750610 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_order_complete
[0m23:50:30.858165 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:50:30.859180 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
create or replace  temporary view DEV.staging.stg_order_complete__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING        AS order_id,
        data:detail:intent::STRING          AS intent,
        data:detail:tenant::STRING          AS tenant,
        data:detail:customer_id::STRING     AS customer_id,
        pet.value                           AS pet_id,  
        data:time::TIMESTAMP                AS event_time,
        data:source::STRING                 AS source,
        data:type::STRING                   AS event_type,
        ingest_date                         AS ingest_date
    FROM dev.rdl.order_complete o,
    LATERAL FLATTEN(input => o.data:detail:pet_ids) AS pet  

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_order_complete)
    
)
SELECT 
    order_id,
    customer_id,
    pet_id,
    intent,
    tenant,
    event_time,
    source,
    event_type,
    ingest_date
FROM source_data
  );
[0m23:50:30.860166 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:50:31.545236 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.693 seconds
[0m23:50:31.560579 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:50:31.567088 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table DEV.staging.stg_order_complete__dbt_tmp
[0m23:50:31.683268 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.118 seconds
[0m23:50:31.698920 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:50:31.698920 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table DEV.staging.stg_order_complete
[0m23:50:31.783987 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.076 seconds
[0m23:50:31.799614 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:50:31.799614 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table "DEV"."STAGING"."STG_ORDER_COMPLETE"
[0m23:50:31.869033 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.070 seconds
[0m23:50:31.917304 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_order_complete"
[0m23:50:31.917304 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:50:31.917304 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
-- back compat for old kwarg name
  
  begin;
[0m23:50:32.032262 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.112 seconds
[0m23:50:32.032262 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:50:32.032262 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
merge into DEV.staging.stg_order_complete as DBT_INTERNAL_DEST
        using DEV.staging.stg_order_complete__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
                ) and (
                    DBT_INTERNAL_SOURCE.pet_id = DBT_INTERNAL_DEST.pet_id
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PET_ID" = DBT_INTERNAL_SOURCE."PET_ID","INTENT" = DBT_INTERNAL_SOURCE."INTENT","TENANT" = DBT_INTERNAL_SOURCE."TENANT","EVENT_TIME" = DBT_INTERNAL_SOURCE."EVENT_TIME","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PET_ID", "INTENT", "TENANT", "EVENT_TIME", "SOURCE", "EVENT_TYPE", "INGEST_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PET_ID", "INTENT", "TENANT", "EVENT_TIME", "SOURCE", "EVENT_TYPE", "INGEST_DATE")

;
[0m23:50:32.302585 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.271 seconds
[0m23:50:32.317482 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:50:32.317482 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
COMMIT
[0m23:50:32.455494 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.137 seconds
[0m23:50:32.487062 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_order_complete__dbt_tmp
[0m23:50:32.487062 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:50:32.502678 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
drop view if exists DEV.staging.stg_order_complete__dbt_tmp cascade
[0m23:50:32.851382 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.352 seconds
[0m23:50:32.873241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33d94d73-2603-438c-be61-b316d595ddaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021636425660>]}
[0m23:50:32.888885 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model staging.stg_order_complete ............. [[32mSUCCESS 0[0m in 2.15s]
[0m23:50:32.888885 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_order_complete
[0m23:50:32.888885 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m23:50:32.888885 [info ] [Thread-1 (]: 2 of 5 START sql incremental model staging.stg_orders .......................... [RUN]
[0m23:50:32.888885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_order_complete, now model.ManyPets.stg_orders)
[0m23:50:32.888885 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m23:50:32.888885 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m23:50:32.904515 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m23:50:32.920586 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:50:32.920586 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace  temporary view DEV.staging.stg_orders__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS event_type,
        data:time::TIMESTAMP                            AS event_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_orders)
    
),
dedup AS
(
    SELECT
        *
        ,ROW_NUMBER() OVER(PARTITION BY order_id, email, pet_dob, pet_name, pet_breed  ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)
SELECT 
    order_id ,
    email AS customer_email,
    pet_dob,
    pet_name,
    COALESCE(NULLIF(TRIM(COALESCE(first_name, '') || ' ' || COALESCE(last_name, '')), ''), 'unknown') AS customer_name,
    dob                                         AS customer_dob,
    phone                                       AS customer_phone,
    address_line1 || ' ' || address_line2       AS customer_address,
    city                                        AS customer_city,
    country                                     AS customer_country,
    postcode                                    AS customer_postcode,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_date,
    cessation_date,
    affiliate_code,
    source,
    event_type,
    event_time,
    ingest_date
FROM dedup
WHERE 
    rnk =1
  );
[0m23:50:33.374597 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.452 seconds
[0m23:50:33.390255 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:50:33.390255 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders__dbt_tmp
[0m23:50:33.490639 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.108 seconds
[0m23:50:33.507034 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:50:33.512610 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders
[0m23:50:33.575384 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.075 seconds
[0m23:50:33.591032 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:50:33.591032 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table "DEV"."STAGING"."STG_ORDERS"
[0m23:50:33.669150 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.070 seconds
[0m23:50:33.675661 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m23:50:33.675661 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:50:33.675661 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m23:50:33.775948 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.100 seconds
[0m23:50:33.775948 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:50:33.791587 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
merge into DEV.staging.stg_orders as DBT_INTERNAL_DEST
        using DEV.staging.stg_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.email = DBT_INTERNAL_DEST.email
                ) and (
                    DBT_INTERNAL_SOURCE.pet_dob = DBT_INTERNAL_DEST.pet_dob
                ) and (
                    DBT_INTERNAL_SOURCE.pet_name = DBT_INTERNAL_DEST.pet_name
                ) and (
                    DBT_INTERNAL_SOURCE.pet_breed = DBT_INTERNAL_DEST.pet_breed
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_EMAIL" = DBT_INTERNAL_SOURCE."CUSTOMER_EMAIL","PET_DOB" = DBT_INTERNAL_SOURCE."PET_DOB","PET_NAME" = DBT_INTERNAL_SOURCE."PET_NAME","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","PET_BREED" = DBT_INTERNAL_SOURCE."PET_BREED","PET_GENDER" = DBT_INTERNAL_SOURCE."PET_GENDER","PET_SPECIES" = DBT_INTERNAL_SOURCE."PET_SPECIES","PEDIGREE_TYPE" = DBT_INTERNAL_SOURCE."PEDIGREE_TYPE","SPAYED_NEUTERED" = DBT_INTERNAL_SOURCE."SPAYED_NEUTERED","PET_POSTCODE" = DBT_INTERNAL_SOURCE."PET_POSTCODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","CESSATION_DATE" = DBT_INTERNAL_SOURCE."CESSATION_DATE","AFFILIATE_CODE" = DBT_INTERNAL_SOURCE."AFFILIATE_CODE","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","EVENT_TIME" = DBT_INTERNAL_SOURCE."EVENT_TIME","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")
    values
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")

;
[0m23:50:33.907558 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0e71-0000-e3b4-0000-0001b3ceb2ed
[0m23:50:33.907558 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 20
invalid identifier 'DBT_INTERNAL_SOURCE.EMAIL'
[0m23:50:33.923172 [debug] [Thread-1 (]: Database Error in model stg_orders (models\staging\stg_orders.sql)
  000904 (42000): SQL compilation error: error line 6 at position 20
  invalid identifier 'DBT_INTERNAL_SOURCE.EMAIL'
  compiled code at target\run\ManyPets\models\staging\stg_orders.sql
[0m23:50:33.923172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33d94d73-2603-438c-be61-b316d595ddaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216364D1390>]}
[0m23:50:33.923172 [error] [Thread-1 (]: 2 of 5 ERROR creating sql incremental model staging.stg_orders ................. [[31mERROR[0m in 1.03s]
[0m23:50:33.923172 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m23:50:33.923172 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models\staging\stg_orders.sql)
  000904 (42000): SQL compilation error: error line 6 at position 20
  invalid identifier 'DBT_INTERNAL_SOURCE.EMAIL'
  compiled code at target\run\ManyPets\models\staging\stg_orders.sql.
[0m23:50:33.923172 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m23:50:33.923172 [info ] [Thread-1 (]: 3 of 5 SKIP relation odl.dim_customers ......................................... [[33mSKIP[0m]
[0m23:50:33.923172 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m23:50:33.936180 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_pets
[0m23:50:33.937187 [info ] [Thread-1 (]: 4 of 5 SKIP relation odl.dim_pets .............................................. [[33mSKIP[0m]
[0m23:50:33.939182 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_pets
[0m23:50:33.941597 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m23:50:33.943361 [info ] [Thread-1 (]: 5 of 5 SKIP relation odl.fact_orders ........................................... [[33mSKIP[0m]
[0m23:50:33.946362 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m23:50:33.949364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:50:33.950363 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m23:50:33.950363 [debug] [MainThread]: On list_DEV: Close
[0m23:50:34.056567 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m23:50:34.058565 [debug] [MainThread]: On list_DEV_staging: Close
[0m23:50:34.176826 [debug] [MainThread]: Connection 'model.ManyPets.stg_orders' was left open.
[0m23:50:34.176826 [debug] [MainThread]: On model.ManyPets.stg_orders: Close
[0m23:50:34.277139 [info ] [MainThread]: 
[0m23:50:34.277139 [info ] [MainThread]: Finished running 5 incremental models in 0 hours 0 minutes and 5.37 seconds (5.37s).
[0m23:50:34.292784 [debug] [MainThread]: Command end result
[0m23:50:34.348247 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m23:50:34.348247 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m23:50:34.363988 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m23:50:34.363988 [info ] [MainThread]: 
[0m23:50:34.363988 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:50:34.363988 [info ] [MainThread]: 
[0m23:50:34.363988 [error] [MainThread]:   Database Error in model stg_orders (models\staging\stg_orders.sql)
  000904 (42000): SQL compilation error: error line 6 at position 20
  invalid identifier 'DBT_INTERNAL_SOURCE.EMAIL'
  compiled code at target\run\ManyPets\models\staging\stg_orders.sql
[0m23:50:34.379183 [info ] [MainThread]: 
[0m23:50:34.381192 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=3 TOTAL=5
[0m23:50:34.385770 [debug] [MainThread]: Command `dbt run` failed at 23:50:34.384768 after 7.58 seconds
[0m23:50:34.385891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021631F05FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021635C6E1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021634C1AE60>]}
[0m23:50:34.385891 [debug] [MainThread]: Flushing usage events
[0m23:50:34.856527 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:54:25.590076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F92F060B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F94E2EBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F94E2EA10>]}


============================== 23:54:25.595718 | e2e691aa-2990-4a37-8c5c-1a0ad490295f ==============================
[0m23:54:25.595718 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:54:25.595718 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:54:26.210142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2e691aa-2990-4a37-8c5c-1a0ad490295f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F9578C100>]}
[0m23:54:26.301431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2e691aa-2990-4a37-8c5c-1a0ad490295f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F9325ECE0>]}
[0m23:54:26.303517 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m23:54:26.777410 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:54:27.140383 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:54:27.142478 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:54:27.224410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2e691aa-2990-4a37-8c5c-1a0ad490295f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F96CF8130>]}
[0m23:54:27.464739 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m23:54:27.472767 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m23:54:27.503088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2e691aa-2990-4a37-8c5c-1a0ad490295f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F96CD0A00>]}
[0m23:54:27.503088 [info ] [MainThread]: Found 6 models, 11 data tests, 2 sources, 591 macros
[0m23:54:27.513100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2e691aa-2990-4a37-8c5c-1a0ad490295f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F96BC0BB0>]}
[0m23:54:27.513100 [info ] [MainThread]: 
[0m23:54:27.513100 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:54:27.513100 [info ] [MainThread]: 
[0m23:54:27.522354 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:54:27.533707 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m23:54:27.720362 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m23:54:27.721369 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m23:54:27.721369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:28.494313 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.778 seconds
[0m23:54:28.516420 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m23:54:28.516420 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m23:54:28.616793 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.106 seconds
[0m23:54:28.632445 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m23:54:28.663684 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m23:54:28.663684 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m23:54:28.663684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:29.135057 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.474 seconds
[0m23:54:29.150508 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m23:54:29.150508 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m23:54:29.166126 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m23:54:29.320359 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.158 seconds
[0m23:54:29.320359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2e691aa-2990-4a37-8c5c-1a0ad490295f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F96BEB700>]}
[0m23:54:29.336014 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_order_complete
[0m23:54:29.336014 [info ] [Thread-1 (]: 1 of 5 START sql incremental model staging.stg_order_complete .................. [RUN]
[0m23:54:29.336014 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_order_complete'
[0m23:54:29.336014 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_order_complete
[0m23:54:29.362705 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_order_complete"
[0m23:54:29.362705 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_order_complete
[0m23:54:29.441950 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:54:29.441950 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
create or replace  temporary view DEV.staging.stg_order_complete__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING        AS order_id,
        data:detail:intent::STRING          AS intent,
        data:detail:tenant::STRING          AS tenant,
        data:detail:customer_id::STRING     AS customer_id,
        pet.value                           AS pet_id,  
        data:time::TIMESTAMP                AS event_time,
        data:source::STRING                 AS source,
        data:type::STRING                   AS event_type,
        ingest_date                         AS ingest_date
    FROM dev.rdl.order_complete o,
    LATERAL FLATTEN(input => o.data:detail:pet_ids) AS pet  

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_order_complete)
    
)
SELECT 
    order_id,
    customer_id,
    pet_id,
    intent,
    tenant,
    event_time,
    source,
    event_type,
    ingest_date
FROM source_data
  );
[0m23:54:29.457585 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:54:30.084392 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.631 seconds
[0m23:54:30.099647 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:54:30.099647 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table DEV.staging.stg_order_complete__dbt_tmp
[0m23:54:30.238339 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.126 seconds
[0m23:54:30.253959 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:54:30.253959 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table DEV.staging.stg_order_complete
[0m23:54:30.323265 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.067 seconds
[0m23:54:30.347336 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:54:30.348333 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table "DEV"."STAGING"."STG_ORDER_COMPLETE"
[0m23:54:30.423343 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.075 seconds
[0m23:54:30.470242 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_order_complete"
[0m23:54:30.485868 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:54:30.485868 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
-- back compat for old kwarg name
  
  begin;
[0m23:54:30.586798 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.103 seconds
[0m23:54:30.586798 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:54:30.586798 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
merge into DEV.staging.stg_order_complete as DBT_INTERNAL_DEST
        using DEV.staging.stg_order_complete__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
                ) and (
                    DBT_INTERNAL_SOURCE.pet_id = DBT_INTERNAL_DEST.pet_id
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PET_ID" = DBT_INTERNAL_SOURCE."PET_ID","INTENT" = DBT_INTERNAL_SOURCE."INTENT","TENANT" = DBT_INTERNAL_SOURCE."TENANT","EVENT_TIME" = DBT_INTERNAL_SOURCE."EVENT_TIME","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PET_ID", "INTENT", "TENANT", "EVENT_TIME", "SOURCE", "EVENT_TYPE", "INGEST_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PET_ID", "INTENT", "TENANT", "EVENT_TIME", "SOURCE", "EVENT_TYPE", "INGEST_DATE")

;
[0m23:54:31.019319 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.425 seconds
[0m23:54:31.019319 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:54:31.019319 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
COMMIT
[0m23:54:31.158536 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.147 seconds
[0m23:54:31.173777 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_order_complete__dbt_tmp
[0m23:54:31.220650 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:54:31.220650 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
drop view if exists DEV.staging.stg_order_complete__dbt_tmp cascade
[0m23:54:31.358688 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.139 seconds
[0m23:54:31.389931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2e691aa-2990-4a37-8c5c-1a0ad490295f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F973A5D50>]}
[0m23:54:31.389931 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model staging.stg_order_complete ............. [[32mSUCCESS 0[0m in 2.05s]
[0m23:54:31.389931 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_order_complete
[0m23:54:31.389931 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m23:54:31.389931 [info ] [Thread-1 (]: 2 of 5 START sql incremental model staging.stg_orders .......................... [RUN]
[0m23:54:31.389931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_order_complete, now model.ManyPets.stg_orders)
[0m23:54:31.389931 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m23:54:31.406918 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m23:54:31.406918 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m23:54:31.427577 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:54:31.427577 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace  temporary view DEV.staging.stg_orders__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS event_type,
        data:time::TIMESTAMP                            AS event_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_orders)
    
),
dedup AS
(
    SELECT
        *
        ,ROW_NUMBER() OVER(PARTITION BY order_id, email, pet_dob, pet_name, pet_breed  ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)
SELECT 
    order_id ,
    email AS customer_email,
    pet_dob,
    pet_name,
    COALESCE(NULLIF(TRIM(COALESCE(first_name, '') || ' ' || COALESCE(last_name, '')), ''), 'unknown') AS customer_name,
    dob                                         AS customer_dob,
    phone                                       AS customer_phone,
    address_line1 || ' ' || address_line2       AS customer_address,
    city                                        AS customer_city,
    country                                     AS customer_country,
    postcode                                    AS customer_postcode,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_date,
    cessation_date,
    affiliate_code,
    source,
    event_type,
    event_time,
    ingest_date
FROM dedup
WHERE 
    rnk =1
  );
[0m23:54:31.957043 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.537 seconds
[0m23:54:31.972690 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:54:31.972690 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders__dbt_tmp
[0m23:54:32.077355 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.097 seconds
[0m23:54:32.092541 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:54:32.092541 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders
[0m23:54:32.161788 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.066 seconds
[0m23:54:32.177397 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:54:32.177397 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table "DEV"."STAGING"."STG_ORDERS"
[0m23:54:32.293735 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.119 seconds
[0m23:54:32.293735 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m23:54:32.308997 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:54:32.308997 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m23:54:32.394488 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.093 seconds
[0m23:54:32.394488 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:54:32.394488 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
merge into DEV.staging.stg_orders as DBT_INTERNAL_DEST
        using DEV.staging.stg_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.customer_email = DBT_INTERNAL_DEST.customer_email
                ) and (
                    DBT_INTERNAL_SOURCE.pet_dob = DBT_INTERNAL_DEST.pet_dob
                ) and (
                    DBT_INTERNAL_SOURCE.pet_name = DBT_INTERNAL_DEST.pet_name
                ) and (
                    DBT_INTERNAL_SOURCE.pet_breed = DBT_INTERNAL_DEST.pet_breed
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_EMAIL" = DBT_INTERNAL_SOURCE."CUSTOMER_EMAIL","PET_DOB" = DBT_INTERNAL_SOURCE."PET_DOB","PET_NAME" = DBT_INTERNAL_SOURCE."PET_NAME","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","PET_BREED" = DBT_INTERNAL_SOURCE."PET_BREED","PET_GENDER" = DBT_INTERNAL_SOURCE."PET_GENDER","PET_SPECIES" = DBT_INTERNAL_SOURCE."PET_SPECIES","PEDIGREE_TYPE" = DBT_INTERNAL_SOURCE."PEDIGREE_TYPE","SPAYED_NEUTERED" = DBT_INTERNAL_SOURCE."SPAYED_NEUTERED","PET_POSTCODE" = DBT_INTERNAL_SOURCE."PET_POSTCODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","CESSATION_DATE" = DBT_INTERNAL_SOURCE."CESSATION_DATE","AFFILIATE_CODE" = DBT_INTERNAL_SOURCE."AFFILIATE_CODE","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","EVENT_TIME" = DBT_INTERNAL_SOURCE."EVENT_TIME","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")
    values
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")

;
[0m23:54:34.086195 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.680 seconds
[0m23:54:34.086195 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:54:34.086195 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
COMMIT
[0m23:54:34.302254 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.220 seconds
[0m23:54:34.317754 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_orders__dbt_tmp
[0m23:54:34.317754 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:54:34.333372 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
drop view if exists DEV.staging.stg_orders__dbt_tmp cascade
[0m23:54:34.540766 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.205 seconds
[0m23:54:34.540766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2e691aa-2990-4a37-8c5c-1a0ad490295f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F97485030>]}
[0m23:54:34.540766 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model staging.stg_orders ..................... [[32mSUCCESS 0[0m in 3.15s]
[0m23:54:34.540766 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m23:54:34.540766 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m23:54:34.540766 [info ] [Thread-1 (]: 3 of 5 START sql incremental model odl.dim_customers ........................... [RUN]
[0m23:54:34.540766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_orders, now model.ManyPets.dim_customers)
[0m23:54:34.540766 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m23:54:34.578207 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m23:54:34.589242 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m23:54:34.615925 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_customers"
[0m23:54:34.619924 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m23:54:34.621853 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace transient table DEV.odl.dim_customers
         as
        (
WITH stg_data AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date  
    FROM DEV.staging.stg_orders
    
    
),
dedup AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date,
        ROW_NUMBER() OVER (PARTITION BY customer_email ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    customer_email                                                          AS customer_nk, 
    md5(cast(coalesce(cast(customer_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                 AS customer_sk,
    customer_name,
    customer_dob,
    customer_phone,
    customer_address,
    customer_city,
    customer_country,
    customer_postcode,
    ingest_date
FROM dedup
WHERE rnk = 1
        );
[0m23:54:35.669377 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.061 seconds
[0m23:54:35.684706 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_customers__dbt_tmp
[0m23:54:35.684706 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m23:54:35.684706 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
drop view if exists DEV.odl.dim_customers__dbt_tmp cascade
[0m23:54:35.761295 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.070 seconds
[0m23:54:35.761295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2e691aa-2990-4a37-8c5c-1a0ad490295f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F97527D00>]}
[0m23:54:35.776576 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model odl.dim_customers ...................... [[32mSUCCESS 1[0m in 1.22s]
[0m23:54:35.776576 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m23:54:35.776576 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_pets
[0m23:54:35.776576 [info ] [Thread-1 (]: 4 of 5 START sql incremental model odl.dim_pets ................................ [RUN]
[0m23:54:35.776576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_customers, now model.ManyPets.dim_pets)
[0m23:54:35.790359 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_pets
[0m23:54:35.811524 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_pets"
[0m23:54:35.821502 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_pets
[0m23:54:35.821916 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_pets"
[0m23:54:35.821916 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m23:54:35.821916 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
create or replace transient table DEV.odl.dim_pets
         as
        (

WITH stg_data AS (
    SELECT
        customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date
    FROM DEV.staging.stg_orders
    
    
),

dedup AS (
    SELECT
        customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date,
        ROW_NUMBER() OVER(PARTITION BY customer_email, pet_dob, pet_name, pet_breed ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    d.customer_email ||'|'||d.pet_name || '|' || d.pet_dob || '|' || d.pet_breed      AS pet_nk,  
    md5(cast(coalesce(cast(pet_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                                AS pet_sk,  
    d.pet_name,
    d.pet_dob,
    d.pet_breed,
    d.pet_gender,
    d.pet_species,
    d.pedigree_type,
    d.spayed_neutered,
    d.pet_postcode,
    d.pet_value,
    d.ingest_date,
    c.customer_sk
FROM dedup AS d
    INNER JOIN DEV.odl.dim_customers AS c ON (d.customer_nk=d.customer_email)
WHERE d.rnk = 1
        );
[0m23:54:35.961866 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0e75-0000-e3b4-0000-0001b3ceb305
[0m23:54:35.961866 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 54 at position 46
invalid identifier 'D.CUSTOMER_NK'
[0m23:54:35.961866 [debug] [Thread-1 (]: Database Error in model dim_pets (models\dim\dim_pets.sql)
  000904 (42000): SQL compilation error: error line 54 at position 46
  invalid identifier 'D.CUSTOMER_NK'
  compiled code at target\run\ManyPets\models\dim\dim_pets.sql
[0m23:54:35.977492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2e691aa-2990-4a37-8c5c-1a0ad490295f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F973A64A0>]}
[0m23:54:35.977492 [error] [Thread-1 (]: 4 of 5 ERROR creating sql incremental model odl.dim_pets ....................... [[31mERROR[0m in 0.20s]
[0m23:54:35.977492 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_pets
[0m23:54:35.977492 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.dim_pets' to be skipped because of status 'error'.  Reason: Database Error in model dim_pets (models\dim\dim_pets.sql)
  000904 (42000): SQL compilation error: error line 54 at position 46
  invalid identifier 'D.CUSTOMER_NK'
  compiled code at target\run\ManyPets\models\dim\dim_pets.sql.
[0m23:54:35.977492 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m23:54:35.977492 [info ] [Thread-1 (]: 5 of 5 SKIP relation odl.fact_orders ........................................... [[33mSKIP[0m]
[0m23:54:35.977492 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m23:54:35.992280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:54:35.994318 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m23:54:35.994462 [debug] [MainThread]: On list_DEV: Close
[0m23:54:36.103057 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m23:54:36.103057 [debug] [MainThread]: On list_DEV_staging: Close
[0m23:54:36.218052 [debug] [MainThread]: Connection 'model.ManyPets.dim_pets' was left open.
[0m23:54:36.218052 [debug] [MainThread]: On model.ManyPets.dim_pets: Close
[0m23:54:36.310515 [info ] [MainThread]: 
[0m23:54:36.310515 [info ] [MainThread]: Finished running 5 incremental models in 0 hours 0 minutes and 8.79 seconds (8.79s).
[0m23:54:36.336356 [debug] [MainThread]: Command end result
[0m23:54:36.404233 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m23:54:36.407247 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m23:54:36.420162 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m23:54:36.421161 [info ] [MainThread]: 
[0m23:54:36.422269 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:54:36.423726 [info ] [MainThread]: 
[0m23:54:36.425002 [error] [MainThread]:   Database Error in model dim_pets (models\dim\dim_pets.sql)
  000904 (42000): SQL compilation error: error line 54 at position 46
  invalid identifier 'D.CUSTOMER_NK'
  compiled code at target\run\ManyPets\models\dim\dim_pets.sql
[0m23:54:36.427020 [info ] [MainThread]: 
[0m23:54:36.428023 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m23:54:36.430698 [debug] [MainThread]: Command `dbt run` failed at 23:54:36.430698 after 10.96 seconds
[0m23:54:36.431703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F92F060B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F95898C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F95899CF0>]}
[0m23:54:36.431703 [debug] [MainThread]: Flushing usage events
[0m23:54:36.928147 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:55:31.032318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174E2316050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174E423E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174E423E7D0>]}


============================== 23:55:31.032318 | 8a397b9c-2082-4a5e-ad0e-5af90018428e ==============================
[0m23:55:31.032318 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:55:31.032318 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:55:31.687631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a397b9c-2082-4a5e-ad0e-5af90018428e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174E1395C90>]}
[0m23:55:31.787898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a397b9c-2082-4a5e-ad0e-5af90018428e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174E40E1B70>]}
[0m23:55:31.787898 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m23:55:32.243289 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:55:32.598217 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:55:32.598217 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:55:32.699307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a397b9c-2082-4a5e-ad0e-5af90018428e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174E6118130>]}
[0m23:55:32.930532 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m23:55:32.932572 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m23:55:32.972803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a397b9c-2082-4a5e-ad0e-5af90018428e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174E5FF42E0>]}
[0m23:55:32.972803 [info ] [MainThread]: Found 6 models, 11 data tests, 2 sources, 591 macros
[0m23:55:32.972803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a397b9c-2082-4a5e-ad0e-5af90018428e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174E607E1A0>]}
[0m23:55:32.972803 [info ] [MainThread]: 
[0m23:55:32.980702 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:55:32.982774 [info ] [MainThread]: 
[0m23:55:32.984554 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:55:33.004233 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m23:55:33.153321 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m23:55:33.153321 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m23:55:33.153321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:33.893238 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.746 seconds
[0m23:55:33.908881 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m23:55:33.908881 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m23:55:33.993636 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.094 seconds
[0m23:55:34.009301 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m23:55:34.048451 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m23:55:34.048451 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m23:55:34.048451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:34.560160 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.503 seconds
[0m23:55:34.571974 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m23:55:34.581351 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m23:55:34.581351 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m23:55:34.688781 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.103 seconds
[0m23:55:34.688781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a397b9c-2082-4a5e-ad0e-5af90018428e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174E600B8E0>]}
[0m23:55:34.695301 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_order_complete
[0m23:55:34.695301 [info ] [Thread-1 (]: 1 of 5 START sql incremental model staging.stg_order_complete .................. [RUN]
[0m23:55:34.695301 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_order_complete'
[0m23:55:34.695301 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_order_complete
[0m23:55:34.731753 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_order_complete"
[0m23:55:34.731753 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_order_complete
[0m23:55:34.810993 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:55:34.810993 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
create or replace  temporary view DEV.staging.stg_order_complete__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING        AS order_id,
        data:detail:intent::STRING          AS intent,
        data:detail:tenant::STRING          AS tenant,
        data:detail:customer_id::STRING     AS customer_id,
        pet.value                           AS pet_id,  
        data:time::TIMESTAMP                AS event_time,
        data:source::STRING                 AS source,
        data:type::STRING                   AS event_type,
        ingest_date                         AS ingest_date
    FROM dev.rdl.order_complete o,
    LATERAL FLATTEN(input => o.data:detail:pet_ids) AS pet  

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_order_complete)
    
)
SELECT 
    order_id,
    customer_id,
    pet_id,
    intent,
    tenant,
    event_time,
    source,
    event_type,
    ingest_date
FROM source_data
  );
[0m23:55:34.810993 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:55:35.397957 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.588 seconds
[0m23:55:35.413597 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:55:35.413597 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table DEV.staging.stg_order_complete__dbt_tmp
[0m23:55:35.529777 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.110 seconds
[0m23:55:35.545355 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:55:35.545355 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table DEV.staging.stg_order_complete
[0m23:55:35.616167 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.080 seconds
[0m23:55:35.646968 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:55:35.646968 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table "DEV"."STAGING"."STG_ORDER_COMPLETE"
[0m23:55:35.715511 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.075 seconds
[0m23:55:35.777419 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_order_complete"
[0m23:55:35.777419 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:55:35.777419 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
-- back compat for old kwarg name
  
  begin;
[0m23:55:35.878155 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.096 seconds
[0m23:55:35.878155 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:55:35.878155 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
merge into DEV.staging.stg_order_complete as DBT_INTERNAL_DEST
        using DEV.staging.stg_order_complete__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
                ) and (
                    DBT_INTERNAL_SOURCE.pet_id = DBT_INTERNAL_DEST.pet_id
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PET_ID" = DBT_INTERNAL_SOURCE."PET_ID","INTENT" = DBT_INTERNAL_SOURCE."INTENT","TENANT" = DBT_INTERNAL_SOURCE."TENANT","EVENT_TIME" = DBT_INTERNAL_SOURCE."EVENT_TIME","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PET_ID", "INTENT", "TENANT", "EVENT_TIME", "SOURCE", "EVENT_TYPE", "INGEST_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PET_ID", "INTENT", "TENANT", "EVENT_TIME", "SOURCE", "EVENT_TYPE", "INGEST_DATE")

;
[0m23:55:36.334018 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.454 seconds
[0m23:55:36.334018 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:55:36.334018 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
COMMIT
[0m23:55:36.503625 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.178 seconds
[0m23:55:36.519280 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_order_complete__dbt_tmp
[0m23:55:36.534893 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:55:36.534893 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
drop view if exists DEV.staging.stg_order_complete__dbt_tmp cascade
[0m23:55:36.650826 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.112 seconds
[0m23:55:36.703053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a397b9c-2082-4a5e-ad0e-5af90018428e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174E6835150>]}
[0m23:55:36.704047 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model staging.stg_order_complete ............. [[32mSUCCESS 0[0m in 2.00s]
[0m23:55:36.706048 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_order_complete
[0m23:55:36.707047 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m23:55:36.708049 [info ] [Thread-1 (]: 2 of 5 START sql incremental model staging.stg_orders .......................... [RUN]
[0m23:55:36.710269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_order_complete, now model.ManyPets.stg_orders)
[0m23:55:36.711240 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m23:55:36.717220 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m23:55:36.717220 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m23:55:36.737592 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:55:36.737592 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace  temporary view DEV.staging.stg_orders__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS event_type,
        data:time::TIMESTAMP                            AS event_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_orders)
    
),
dedup AS
(
    SELECT
        *
        ,ROW_NUMBER() OVER(PARTITION BY order_id, email, pet_dob, pet_name, pet_breed  ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)
SELECT 
    order_id ,
    email AS customer_email,
    pet_dob,
    pet_name,
    COALESCE(NULLIF(TRIM(COALESCE(first_name, '') || ' ' || COALESCE(last_name, '')), ''), 'unknown') AS customer_name,
    dob                                         AS customer_dob,
    phone                                       AS customer_phone,
    address_line1 || ' ' || address_line2       AS customer_address,
    city                                        AS customer_city,
    country                                     AS customer_country,
    postcode                                    AS customer_postcode,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_date,
    cessation_date,
    affiliate_code,
    source,
    event_type,
    event_time,
    ingest_date
FROM dedup
WHERE 
    rnk =1
  );
[0m23:55:37.276598 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.542 seconds
[0m23:55:37.292224 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:55:37.292224 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders__dbt_tmp
[0m23:55:37.383388 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.097 seconds
[0m23:55:37.405535 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:55:37.405535 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders
[0m23:55:37.483684 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.080 seconds
[0m23:55:37.483684 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:55:37.483684 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table "DEV"."STAGING"."STG_ORDERS"
[0m23:55:37.552867 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.067 seconds
[0m23:55:37.584019 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m23:55:37.584019 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:55:37.584019 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m23:55:37.706666 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.121 seconds
[0m23:55:37.706666 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:55:37.706666 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
merge into DEV.staging.stg_orders as DBT_INTERNAL_DEST
        using DEV.staging.stg_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.customer_email = DBT_INTERNAL_DEST.customer_email
                ) and (
                    DBT_INTERNAL_SOURCE.pet_dob = DBT_INTERNAL_DEST.pet_dob
                ) and (
                    DBT_INTERNAL_SOURCE.pet_name = DBT_INTERNAL_DEST.pet_name
                ) and (
                    DBT_INTERNAL_SOURCE.pet_breed = DBT_INTERNAL_DEST.pet_breed
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_EMAIL" = DBT_INTERNAL_SOURCE."CUSTOMER_EMAIL","PET_DOB" = DBT_INTERNAL_SOURCE."PET_DOB","PET_NAME" = DBT_INTERNAL_SOURCE."PET_NAME","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","PET_BREED" = DBT_INTERNAL_SOURCE."PET_BREED","PET_GENDER" = DBT_INTERNAL_SOURCE."PET_GENDER","PET_SPECIES" = DBT_INTERNAL_SOURCE."PET_SPECIES","PEDIGREE_TYPE" = DBT_INTERNAL_SOURCE."PEDIGREE_TYPE","SPAYED_NEUTERED" = DBT_INTERNAL_SOURCE."SPAYED_NEUTERED","PET_POSTCODE" = DBT_INTERNAL_SOURCE."PET_POSTCODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","CESSATION_DATE" = DBT_INTERNAL_SOURCE."CESSATION_DATE","AFFILIATE_CODE" = DBT_INTERNAL_SOURCE."AFFILIATE_CODE","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","EVENT_TIME" = DBT_INTERNAL_SOURCE."EVENT_TIME","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")
    values
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")

;
[0m23:55:38.928455 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.215 seconds
[0m23:55:38.928455 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:55:38.928455 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
COMMIT
[0m23:55:39.160262 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.233 seconds
[0m23:55:39.175696 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_orders__dbt_tmp
[0m23:55:39.175696 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:55:39.175696 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
drop view if exists DEV.staging.stg_orders__dbt_tmp cascade
[0m23:55:39.307844 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.129 seconds
[0m23:55:39.314363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a397b9c-2082-4a5e-ad0e-5af90018428e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174E6914F70>]}
[0m23:55:39.314363 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model staging.stg_orders ..................... [[32mSUCCESS 0[0m in 2.61s]
[0m23:55:39.314363 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m23:55:39.314363 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m23:55:39.314363 [info ] [Thread-1 (]: 3 of 5 START sql incremental model odl.dim_customers ........................... [RUN]
[0m23:55:39.314363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_orders, now model.ManyPets.dim_customers)
[0m23:55:39.314363 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m23:55:39.348992 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m23:55:39.352734 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m23:55:39.364029 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m23:55:39.365040 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace  temporary view DEV.odl.dim_customers__dbt_tmp
  
   as (
    
WITH stg_data AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date  
    FROM DEV.staging.stg_orders
    
    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.dim_customers)
    
),
dedup AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date,
        ROW_NUMBER() OVER (PARTITION BY customer_email ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    customer_email                                                          AS customer_nk, 
    md5(cast(coalesce(cast(customer_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                 AS customer_sk,
    customer_name,
    customer_dob,
    customer_phone,
    customer_address,
    customer_city,
    customer_country,
    customer_postcode,
    ingest_date
FROM dedup
WHERE rnk = 1
  );
[0m23:55:39.647637 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.294 seconds
[0m23:55:39.662759 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m23:55:39.662759 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table DEV.odl.dim_customers__dbt_tmp
[0m23:55:39.763504 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.095 seconds
[0m23:55:39.779167 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m23:55:39.779167 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table DEV.odl.dim_customers
[0m23:55:39.865679 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.082 seconds
[0m23:55:39.865679 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m23:55:39.865679 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table "DEV"."ODL"."DIM_CUSTOMERS"
[0m23:55:39.949375 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.084 seconds
[0m23:55:39.980586 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_customers"
[0m23:55:39.980586 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m23:55:39.980586 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m23:55:40.081523 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.093 seconds
[0m23:55:40.081523 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m23:55:40.081523 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
merge into DEV.odl.dim_customers as DBT_INTERNAL_DEST
        using DEV.odl.dim_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.customer_nk = DBT_INTERNAL_DEST.customer_nk))

    
    when matched then update set
        "CUSTOMER_NK" = DBT_INTERNAL_SOURCE."CUSTOMER_NK","CUSTOMER_SK" = DBT_INTERNAL_SOURCE."CUSTOMER_SK","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("CUSTOMER_NK", "CUSTOMER_SK", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "INGEST_DATE")
    values
        ("CUSTOMER_NK", "CUSTOMER_SK", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "INGEST_DATE")

;
[0m23:55:40.973710 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.887 seconds
[0m23:55:40.973710 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m23:55:40.973710 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
COMMIT
[0m23:55:41.340271 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.365 seconds
[0m23:55:41.340271 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_customers__dbt_tmp
[0m23:55:41.340271 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m23:55:41.340271 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
drop view if exists DEV.odl.dim_customers__dbt_tmp cascade
[0m23:55:41.468405 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.117 seconds
[0m23:55:41.475578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a397b9c-2082-4a5e-ad0e-5af90018428e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174E69C2800>]}
[0m23:55:41.475578 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model odl.dim_customers ...................... [[32mSUCCESS 0[0m in 2.16s]
[0m23:55:41.475578 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m23:55:41.475578 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_pets
[0m23:55:41.475578 [info ] [Thread-1 (]: 4 of 5 START sql incremental model odl.dim_pets ................................ [RUN]
[0m23:55:41.475578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_customers, now model.ManyPets.dim_pets)
[0m23:55:41.491505 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_pets
[0m23:55:41.506489 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_pets"
[0m23:55:41.509005 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_pets
[0m23:55:41.543585 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_pets"
[0m23:55:41.547583 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m23:55:41.548584 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
create or replace transient table DEV.odl.dim_pets
         as
        (

WITH stg_data AS (
    SELECT
        customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date
    FROM DEV.staging.stg_orders
    
    
),

dedup AS (
    SELECT
        customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date,
        ROW_NUMBER() OVER(PARTITION BY customer_email, pet_dob, pet_name, pet_breed ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    d.customer_email ||'|'||d.pet_name || '|' || d.pet_dob || '|' || d.pet_breed      AS pet_nk,  
    md5(cast(coalesce(cast(pet_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                                AS pet_sk,  
    d.pet_name,
    d.pet_dob,
    d.pet_breed,
    d.pet_gender,
    d.pet_species,
    d.pedigree_type,
    d.spayed_neutered,
    d.pet_postcode,
    d.pet_value,
    d.ingest_date,
    c.customer_sk
FROM dedup AS d
    INNER JOIN DEV.odl.dim_customers AS c ON (c.customer_nk=d.customer_email)
WHERE d.rnk = 1
        );
[0m23:55:42.557163 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.014 seconds
[0m23:55:42.557163 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_pets__dbt_tmp
[0m23:55:42.557163 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m23:55:42.557163 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
drop view if exists DEV.odl.dim_pets__dbt_tmp cascade
[0m23:55:42.645568 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.079 seconds
[0m23:55:42.645568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a397b9c-2082-4a5e-ad0e-5af90018428e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174E69A4D90>]}
[0m23:55:42.645568 [info ] [Thread-1 (]: 4 of 5 OK created sql incremental model odl.dim_pets ........................... [[32mSUCCESS 1[0m in 1.17s]
[0m23:55:42.660917 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_pets
[0m23:55:42.660917 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m23:55:42.660917 [info ] [Thread-1 (]: 5 of 5 START sql incremental model odl.fact_orders ............................. [RUN]
[0m23:55:42.667687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_pets, now model.ManyPets.fact_orders)
[0m23:55:42.670078 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_orders
[0m23:55:42.684093 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_orders"
[0m23:55:42.684093 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_orders
[0m23:55:42.693421 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.fact_orders"
[0m23:55:42.706924 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m23:55:42.709186 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
create or replace transient table DEV.odl.fact_orders
         as
        ( 
WITH fact_data AS (
    SELECT 
        f.order_id,
        f.order_date,
        f.cessation_date,
        f.affiliate_code,
        f.pet_value,
        f.source,
        f.type,
        f.event_time,
        f.envelope_version,
        f.detail_version,
        f.intent,
        f.tenant,
        f.experiments,
        c.customer_sk,
        p.pet_sk
    FROM DEV.staging.stg_orders f
    LEFT JOIN DEV.odl.dim_customers c 
        ON f.customer_email = c.customer_email
    LEFT JOIN DEV.odl.dim_pets p 
        ON f.pet_name = p.pet_name 
        AND f.pet_dob = p.pet_dob
        AND f.pet_breed = p.pet_breed
    
)

, dedup AS (
    SELECT 
        f.*,
        ROW_NUMBER() OVER(PARTITION BY f.order_id, f.customer_sk, f.pet_sk ORDER BY f.ingest_date DESC) AS rnk
    FROM fact_data f
)

SELECT 
    f.order_id || '|' || f.customer_sk || '|'|| f.pet_sk    AS order_nk,
    md5(cast(coalesce(cast(order_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))    AS order_sk,
    customer_sk                                             AS customer_sk,
    pet_sk                                                  AS pet_sk,
    order_date                                              AS order_date,
    cessation_date                                          AS cessation_date,
    COALESCE(affiliate_code, 'unknown')                     AS affiliate_code,
    pet_value                                               AS pet_value,
    source                                                  AS order_source,
    type                                                    AS order_type
/*
    event_time,
    envelope_version,
    detail_version,
    intent,
    tenant,
    experiments,
    ingest_date
*/
FROM dedup
WHERE rnk = 1
        );
[0m23:55:42.820974 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0e76-0000-e3b4-0000-0001b3ceb325
[0m23:55:42.820974 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 8
invalid identifier 'F.TYPE'
[0m23:55:42.830007 [debug] [Thread-1 (]: Database Error in model fact_orders (models\fact\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 12 at position 8
  invalid identifier 'F.TYPE'
  compiled code at target\run\ManyPets\models\fact\fact_orders.sql
[0m23:55:42.830007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a397b9c-2082-4a5e-ad0e-5af90018428e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174E69F7AC0>]}
[0m23:55:42.830007 [error] [Thread-1 (]: 5 of 5 ERROR creating sql incremental model odl.fact_orders .................... [[31mERROR[0m in 0.17s]
[0m23:55:42.830007 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m23:55:42.830007 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_orders (models\fact\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 12 at position 8
  invalid identifier 'F.TYPE'
  compiled code at target\run\ManyPets\models\fact\fact_orders.sql.
[0m23:55:42.830007 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:55:42.830007 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m23:55:42.830007 [debug] [MainThread]: On list_DEV: Close
[0m23:55:42.946458 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m23:55:42.946458 [debug] [MainThread]: On list_DEV_staging: Close
[0m23:55:43.049762 [debug] [MainThread]: Connection 'model.ManyPets.fact_orders' was left open.
[0m23:55:43.049762 [debug] [MainThread]: On model.ManyPets.fact_orders: Close
[0m23:55:43.131968 [info ] [MainThread]: 
[0m23:55:43.131968 [info ] [MainThread]: Finished running 5 incremental models in 0 hours 0 minutes and 10.15 seconds (10.15s).
[0m23:55:43.131968 [debug] [MainThread]: Command end result
[0m23:55:43.211488 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m23:55:43.215487 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m23:55:43.228431 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m23:55:43.229425 [info ] [MainThread]: 
[0m23:55:43.230433 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:55:43.231428 [info ] [MainThread]: 
[0m23:55:43.232944 [error] [MainThread]:   Database Error in model fact_orders (models\fact\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 12 at position 8
  invalid identifier 'F.TYPE'
  compiled code at target\run\ManyPets\models\fact\fact_orders.sql
[0m23:55:43.234974 [info ] [MainThread]: 
[0m23:55:43.235882 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:55:43.239029 [debug] [MainThread]: Command `dbt run` failed at 23:55:43.238030 after 12.32 seconds
[0m23:55:43.239029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174E2316050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174E60F0A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174E60E4E80>]}
[0m23:55:43.241218 [debug] [MainThread]: Flushing usage events
[0m23:55:43.866378 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:57:59.081855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B06CDC5FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B06ECEE920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B06ECEE740>]}


============================== 23:57:59.097499 | 0b25ec5b-2bdb-4e00-afd7-459594b0a287 ==============================
[0m23:57:59.097499 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:57:59.097499 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:57:59.715205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b25ec5b-2bdb-4e00-afd7-459594b0a287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B06D119ED0>]}
[0m23:57:59.837124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b25ec5b-2bdb-4e00-afd7-459594b0a287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B06EB5B2B0>]}
[0m23:57:59.837124 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m23:58:00.351316 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:58:00.705330 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:58:00.705330 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:58:00.793516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b25ec5b-2bdb-4e00-afd7-459594b0a287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B070BB8130>]}
[0m23:58:01.029178 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m23:58:01.029178 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m23:58:01.069640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b25ec5b-2bdb-4e00-afd7-459594b0a287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B070B85B40>]}
[0m23:58:01.069640 [info ] [MainThread]: Found 6 models, 11 data tests, 2 sources, 591 macros
[0m23:58:01.069640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b25ec5b-2bdb-4e00-afd7-459594b0a287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B070B83910>]}
[0m23:58:01.077686 [info ] [MainThread]: 
[0m23:58:01.077686 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:58:01.077686 [info ] [MainThread]: 
[0m23:58:01.082833 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:58:01.110900 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m23:58:01.260783 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m23:58:01.260783 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m23:58:01.260783 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:58:01.905850 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.643 seconds
[0m23:58:01.921094 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m23:58:01.921094 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m23:58:02.006377 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.089 seconds
[0m23:58:02.021747 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m23:58:02.052998 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m23:58:02.052998 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m23:58:02.052998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:58:02.524756 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.475 seconds
[0m23:58:02.524756 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m23:58:02.540088 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m23:58:02.540088 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m23:58:02.671917 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.124 seconds
[0m23:58:02.687541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b25ec5b-2bdb-4e00-afd7-459594b0a287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B06F5F6620>]}
[0m23:58:02.694075 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_order_complete
[0m23:58:02.694075 [info ] [Thread-1 (]: 1 of 5 START sql incremental model staging.stg_order_complete .................. [RUN]
[0m23:58:02.694075 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_order_complete'
[0m23:58:02.694075 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_order_complete
[0m23:58:02.728728 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_order_complete"
[0m23:58:02.728728 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_order_complete
[0m23:58:02.809624 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:58:02.809624 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
create or replace  temporary view DEV.staging.stg_order_complete__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING        AS order_id,
        data:detail:intent::STRING          AS intent,
        data:detail:tenant::STRING          AS tenant,
        data:detail:customer_id::STRING     AS customer_id,
        pet.value                           AS pet_id,  
        data:time::TIMESTAMP                AS event_time,
        data:source::STRING                 AS source,
        data:type::STRING                   AS event_type,
        ingest_date                         AS ingest_date
    FROM dev.rdl.order_complete o,
    LATERAL FLATTEN(input => o.data:detail:pet_ids) AS pet  

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_order_complete)
    
)
SELECT 
    order_id,
    customer_id,
    pet_id,
    intent,
    tenant,
    event_time,
    source,
    event_type,
    ingest_date
FROM source_data
  );
[0m23:58:02.809624 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:58:03.443018 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.639 seconds
[0m23:58:03.458522 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:58:03.458522 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table DEV.staging.stg_order_complete__dbt_tmp
[0m23:58:03.760704 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.302 seconds
[0m23:58:03.776056 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:58:03.791661 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table DEV.staging.stg_order_complete
[0m23:58:03.861122 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.076 seconds
[0m23:58:03.892789 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:58:03.893516 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table "DEV"."STAGING"."STG_ORDER_COMPLETE"
[0m23:58:03.958920 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.071 seconds
[0m23:58:03.998732 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_order_complete"
[0m23:58:04.014373 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:58:04.014373 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
-- back compat for old kwarg name
  
  begin;
[0m23:58:04.130736 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.113 seconds
[0m23:58:04.130736 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:58:04.130736 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
merge into DEV.staging.stg_order_complete as DBT_INTERNAL_DEST
        using DEV.staging.stg_order_complete__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
                ) and (
                    DBT_INTERNAL_SOURCE.pet_id = DBT_INTERNAL_DEST.pet_id
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PET_ID" = DBT_INTERNAL_SOURCE."PET_ID","INTENT" = DBT_INTERNAL_SOURCE."INTENT","TENANT" = DBT_INTERNAL_SOURCE."TENANT","EVENT_TIME" = DBT_INTERNAL_SOURCE."EVENT_TIME","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PET_ID", "INTENT", "TENANT", "EVENT_TIME", "SOURCE", "EVENT_TYPE", "INGEST_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PET_ID", "INTENT", "TENANT", "EVENT_TIME", "SOURCE", "EVENT_TYPE", "INGEST_DATE")

;
[0m23:58:04.600210 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.466 seconds
[0m23:58:04.600210 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:58:04.600210 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
COMMIT
[0m23:58:04.763479 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.162 seconds
[0m23:58:04.794400 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_order_complete__dbt_tmp
[0m23:58:04.800912 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:58:04.800912 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
drop view if exists DEV.staging.stg_order_complete__dbt_tmp cascade
[0m23:58:04.960939 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.149 seconds
[0m23:58:05.001385 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b25ec5b-2bdb-4e00-afd7-459594b0a287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B07133C700>]}
[0m23:58:05.001385 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model staging.stg_order_complete ............. [[32mSUCCESS 0[0m in 2.31s]
[0m23:58:05.001385 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_order_complete
[0m23:58:05.001385 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m23:58:05.001385 [info ] [Thread-1 (]: 2 of 5 START sql incremental model staging.stg_orders .......................... [RUN]
[0m23:58:05.001385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_order_complete, now model.ManyPets.stg_orders)
[0m23:58:05.001385 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m23:58:05.028223 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m23:58:05.030170 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m23:58:05.041261 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:58:05.041261 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace  temporary view DEV.staging.stg_orders__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS event_type,
        data:time::TIMESTAMP                            AS event_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_orders)
    
),
dedup AS
(
    SELECT
        *
        ,ROW_NUMBER() OVER(PARTITION BY order_id, email, pet_dob, pet_name, pet_breed  ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)
SELECT 
    order_id ,
    email AS customer_email,
    pet_dob,
    pet_name,
    COALESCE(NULLIF(TRIM(COALESCE(first_name, '') || ' ' || COALESCE(last_name, '')), ''), 'unknown') AS customer_name,
    dob                                         AS customer_dob,
    phone                                       AS customer_phone,
    address_line1 || ' ' || address_line2       AS customer_address,
    city                                        AS customer_city,
    country                                     AS customer_country,
    postcode                                    AS customer_postcode,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_date,
    cessation_date,
    affiliate_code,
    source,
    event_type,
    event_time,
    ingest_date
FROM dedup
WHERE 
    rnk =1
  );
[0m23:58:05.619001 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.580 seconds
[0m23:58:05.634236 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:58:05.634236 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders__dbt_tmp
[0m23:58:05.734820 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.094 seconds
[0m23:58:05.734820 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:58:05.734820 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders
[0m23:58:05.819858 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.075 seconds
[0m23:58:05.819858 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:58:05.819858 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table "DEV"."STAGING"."STG_ORDERS"
[0m23:58:05.882790 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.061 seconds
[0m23:58:05.897966 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m23:58:05.904491 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:58:05.904491 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m23:58:06.055209 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.156 seconds
[0m23:58:06.055209 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:58:06.055209 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
merge into DEV.staging.stg_orders as DBT_INTERNAL_DEST
        using DEV.staging.stg_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.customer_email = DBT_INTERNAL_DEST.customer_email
                ) and (
                    DBT_INTERNAL_SOURCE.pet_dob = DBT_INTERNAL_DEST.pet_dob
                ) and (
                    DBT_INTERNAL_SOURCE.pet_name = DBT_INTERNAL_DEST.pet_name
                ) and (
                    DBT_INTERNAL_SOURCE.pet_breed = DBT_INTERNAL_DEST.pet_breed
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_EMAIL" = DBT_INTERNAL_SOURCE."CUSTOMER_EMAIL","PET_DOB" = DBT_INTERNAL_SOURCE."PET_DOB","PET_NAME" = DBT_INTERNAL_SOURCE."PET_NAME","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","PET_BREED" = DBT_INTERNAL_SOURCE."PET_BREED","PET_GENDER" = DBT_INTERNAL_SOURCE."PET_GENDER","PET_SPECIES" = DBT_INTERNAL_SOURCE."PET_SPECIES","PEDIGREE_TYPE" = DBT_INTERNAL_SOURCE."PEDIGREE_TYPE","SPAYED_NEUTERED" = DBT_INTERNAL_SOURCE."SPAYED_NEUTERED","PET_POSTCODE" = DBT_INTERNAL_SOURCE."PET_POSTCODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","CESSATION_DATE" = DBT_INTERNAL_SOURCE."CESSATION_DATE","AFFILIATE_CODE" = DBT_INTERNAL_SOURCE."AFFILIATE_CODE","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","EVENT_TIME" = DBT_INTERNAL_SOURCE."EVENT_TIME","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")
    values
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")

;
[0m23:58:07.108697 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.044 seconds
[0m23:58:07.108697 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:58:07.108697 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
COMMIT
[0m23:58:07.356422 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.242 seconds
[0m23:58:07.356422 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_orders__dbt_tmp
[0m23:58:07.356422 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:58:07.371555 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
drop view if exists DEV.staging.stg_orders__dbt_tmp cascade
[0m23:58:07.487585 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.120 seconds
[0m23:58:07.487585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b25ec5b-2bdb-4e00-afd7-459594b0a287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B071424FD0>]}
[0m23:58:07.487585 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model staging.stg_orders ..................... [[32mSUCCESS 0[0m in 2.49s]
[0m23:58:07.502673 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m23:58:07.502673 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m23:58:07.509201 [info ] [Thread-1 (]: 3 of 5 START sql incremental model odl.dim_customers ........................... [RUN]
[0m23:58:07.512446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_orders, now model.ManyPets.dim_customers)
[0m23:58:07.514567 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m23:58:07.540432 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m23:58:07.540432 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m23:58:07.562553 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m23:58:07.563557 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace  temporary view DEV.odl.dim_customers__dbt_tmp
  
   as (
    
WITH stg_data AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date  
    FROM DEV.staging.stg_orders
    
    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.dim_customers)
    
),
dedup AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date,
        ROW_NUMBER() OVER (PARTITION BY customer_email ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    customer_email                                                          AS customer_nk, 
    md5(cast(coalesce(cast(customer_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                 AS customer_sk,
    customer_name,
    customer_dob,
    customer_phone,
    customer_address,
    customer_city,
    customer_country,
    customer_postcode,
    ingest_date
FROM dedup
WHERE rnk = 1
  );
[0m23:58:07.957895 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.404 seconds
[0m23:58:07.972978 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m23:58:07.972978 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table DEV.odl.dim_customers__dbt_tmp
[0m23:58:08.058627 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.085 seconds
[0m23:58:08.058627 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m23:58:08.058627 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table DEV.odl.dim_customers
[0m23:58:08.139083 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.069 seconds
[0m23:58:08.153078 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m23:58:08.154495 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table "DEV"."ODL"."DIM_CUSTOMERS"
[0m23:58:08.243443 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.089 seconds
[0m23:58:08.259067 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_customers"
[0m23:58:08.259067 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m23:58:08.259067 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m23:58:08.375632 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.111 seconds
[0m23:58:08.375632 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m23:58:08.375632 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
merge into DEV.odl.dim_customers as DBT_INTERNAL_DEST
        using DEV.odl.dim_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.customer_nk = DBT_INTERNAL_DEST.customer_nk))

    
    when matched then update set
        "CUSTOMER_NK" = DBT_INTERNAL_SOURCE."CUSTOMER_NK","CUSTOMER_SK" = DBT_INTERNAL_SOURCE."CUSTOMER_SK","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("CUSTOMER_NK", "CUSTOMER_SK", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "INGEST_DATE")
    values
        ("CUSTOMER_NK", "CUSTOMER_SK", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "INGEST_DATE")

;
[0m23:58:09.147775 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.760 seconds
[0m23:58:09.147775 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m23:58:09.147775 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
COMMIT
[0m23:58:09.442940 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.292 seconds
[0m23:58:09.442940 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_customers__dbt_tmp
[0m23:58:09.442940 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m23:58:09.442940 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
drop view if exists DEV.odl.dim_customers__dbt_tmp cascade
[0m23:58:09.565744 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.111 seconds
[0m23:58:09.565744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b25ec5b-2bdb-4e00-afd7-459594b0a287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0714D2950>]}
[0m23:58:09.565744 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model odl.dim_customers ...................... [[32mSUCCESS 0[0m in 2.05s]
[0m23:58:09.581373 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m23:58:09.581373 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_pets
[0m23:58:09.581373 [info ] [Thread-1 (]: 4 of 5 START sql incremental model odl.dim_pets ................................ [RUN]
[0m23:58:09.581373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_customers, now model.ManyPets.dim_pets)
[0m23:58:09.589604 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_pets
[0m23:58:09.606067 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_pets"
[0m23:58:09.606832 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_pets
[0m23:58:09.606832 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m23:58:09.619652 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
create or replace  temporary view DEV.odl.dim_pets__dbt_tmp
  
   as (
    

WITH stg_data AS (
    SELECT
        customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date
    FROM DEV.staging.stg_orders
    
    
        WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.dim_pets)
    
),

dedup AS (
    SELECT
        customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date,
        ROW_NUMBER() OVER(PARTITION BY customer_email, pet_dob, pet_name, pet_breed ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    d.customer_email ||'|'||d.pet_name || '|' || d.pet_dob || '|' || d.pet_breed      AS pet_nk,  
    md5(cast(coalesce(cast(pet_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                                AS pet_sk,  
    d.pet_name,
    d.pet_dob,
    d.pet_breed,
    d.pet_gender,
    d.pet_species,
    d.pedigree_type,
    d.spayed_neutered,
    d.pet_postcode,
    d.pet_value,
    d.ingest_date,
    c.customer_sk
FROM dedup AS d
    INNER JOIN DEV.odl.dim_customers AS c ON (c.customer_nk=d.customer_email)
WHERE d.rnk = 1
  );
[0m23:58:10.198501 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.579 seconds
[0m23:58:10.214127 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m23:58:10.214127 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
describe table DEV.odl.dim_pets__dbt_tmp
[0m23:58:10.301966 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.087 seconds
[0m23:58:10.317256 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m23:58:10.317256 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
describe table DEV.odl.dim_pets
[0m23:58:10.431550 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.112 seconds
[0m23:58:10.437558 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m23:58:10.437558 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
describe table "DEV"."ODL"."DIM_PETS"
[0m23:58:10.500079 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.066 seconds
[0m23:58:10.515695 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_pets"
[0m23:58:10.515695 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m23:58:10.515695 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
-- back compat for old kwarg name
  
  begin;
[0m23:58:10.638310 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.126 seconds
[0m23:58:10.638310 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m23:58:10.638310 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
merge into DEV.odl.dim_pets as DBT_INTERNAL_DEST
        using DEV.odl.dim_pets__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.pet_nk = DBT_INTERNAL_DEST.pet_nk))

    
    when matched then update set
        "PET_NK" = DBT_INTERNAL_SOURCE."PET_NK","PET_SK" = DBT_INTERNAL_SOURCE."PET_SK","PET_NAME" = DBT_INTERNAL_SOURCE."PET_NAME","PET_DOB" = DBT_INTERNAL_SOURCE."PET_DOB","PET_BREED" = DBT_INTERNAL_SOURCE."PET_BREED","PET_GENDER" = DBT_INTERNAL_SOURCE."PET_GENDER","PET_SPECIES" = DBT_INTERNAL_SOURCE."PET_SPECIES","PEDIGREE_TYPE" = DBT_INTERNAL_SOURCE."PEDIGREE_TYPE","SPAYED_NEUTERED" = DBT_INTERNAL_SOURCE."SPAYED_NEUTERED","PET_POSTCODE" = DBT_INTERNAL_SOURCE."PET_POSTCODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE","CUSTOMER_SK" = DBT_INTERNAL_SOURCE."CUSTOMER_SK"
    

    when not matched then insert
        ("PET_NK", "PET_SK", "PET_NAME", "PET_DOB", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "INGEST_DATE", "CUSTOMER_SK")
    values
        ("PET_NK", "PET_SK", "PET_NAME", "PET_DOB", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "INGEST_DATE", "CUSTOMER_SK")

;
[0m23:58:11.605240 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.966 seconds
[0m23:58:11.620148 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m23:58:11.620148 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
COMMIT
[0m23:58:11.899589 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.290 seconds
[0m23:58:11.914991 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_pets__dbt_tmp
[0m23:58:11.914991 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m23:58:11.914991 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
drop view if exists DEV.odl.dim_pets__dbt_tmp cascade
[0m23:58:12.044370 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.128 seconds
[0m23:58:12.044370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b25ec5b-2bdb-4e00-afd7-459594b0a287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B071532CB0>]}
[0m23:58:12.060025 [info ] [Thread-1 (]: 4 of 5 OK created sql incremental model odl.dim_pets ........................... [[32mSUCCESS 0[0m in 2.46s]
[0m23:58:12.060025 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_pets
[0m23:58:12.060025 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m23:58:12.060025 [info ] [Thread-1 (]: 5 of 5 START sql incremental model odl.fact_orders ............................. [RUN]
[0m23:58:12.060025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_pets, now model.ManyPets.fact_orders)
[0m23:58:12.072445 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_orders
[0m23:58:12.085012 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_orders"
[0m23:58:12.088566 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_orders
[0m23:58:12.118467 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.fact_orders"
[0m23:58:12.120041 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m23:58:12.120041 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
create or replace transient table DEV.odl.fact_orders
         as
        ( 
WITH fact_data AS (
    SELECT 
        f.order_id,
        f.order_date,
        f.cessation_date,
        f.affiliate_code,
        f.pet_value,
        f.source,
        f.event_type,
        f.event_time,
        f.envelope_version,
        f.detail_version,
        f.intent,
        f.tenant,
        f.experiments,
        c.customer_sk,
        p.pet_sk
    FROM DEV.staging.stg_orders f
    LEFT JOIN DEV.odl.dim_customers c 
        ON f.customer_email = c.customer_email
    LEFT JOIN DEV.odl.dim_pets p 
        ON f.pet_name = p.pet_name 
        AND f.pet_dob = p.pet_dob
        AND f.pet_breed = p.pet_breed
    
)

, dedup AS (
    SELECT 
        f.*,
        ROW_NUMBER() OVER(PARTITION BY f.order_id, f.customer_sk, f.pet_sk ORDER BY f.ingest_date DESC) AS rnk
    FROM fact_data f
)

SELECT 
    f.order_id || '|' || f.customer_sk || '|'|| f.pet_sk    AS order_nk,
    md5(cast(coalesce(cast(order_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))    AS order_sk,
    customer_sk                                             AS customer_sk,
    pet_sk                                                  AS pet_sk,
    order_date                                              AS order_date,
    cessation_date                                          AS cessation_date,
    COALESCE(affiliate_code, 'unknown')                     AS affiliate_code,
    pet_value                                               AS pet_value,
    source                                                  AS order_source,
    type                                                    AS order_type
/*
    event_time,
    envelope_version,
    detail_version,
    intent,
    tenant,
    experiments,
    ingest_date
*/
FROM dedup
WHERE rnk = 1
        );
[0m23:58:12.244858 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0e79-0000-e3c5-0001-b3ce000162ae
[0m23:58:12.244858 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 14 at position 8
invalid identifier 'F.ENVELOPE_VERSION'
[0m23:58:12.260523 [debug] [Thread-1 (]: Database Error in model fact_orders (models\fact\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 14 at position 8
  invalid identifier 'F.ENVELOPE_VERSION'
  compiled code at target\run\ManyPets\models\fact\fact_orders.sql
[0m23:58:12.260523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b25ec5b-2bdb-4e00-afd7-459594b0a287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B071424760>]}
[0m23:58:12.260523 [error] [Thread-1 (]: 5 of 5 ERROR creating sql incremental model odl.fact_orders .................... [[31mERROR[0m in 0.20s]
[0m23:58:12.260523 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m23:58:12.260523 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_orders (models\fact\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 14 at position 8
  invalid identifier 'F.ENVELOPE_VERSION'
  compiled code at target\run\ManyPets\models\fact\fact_orders.sql.
[0m23:58:12.260523 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:58:12.260523 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m23:58:12.260523 [debug] [MainThread]: On list_DEV: Close
[0m23:58:12.345272 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m23:58:12.345272 [debug] [MainThread]: On list_DEV_staging: Close
[0m23:58:12.461707 [debug] [MainThread]: Connection 'model.ManyPets.fact_orders' was left open.
[0m23:58:12.461707 [debug] [MainThread]: On model.ManyPets.fact_orders: Close
[0m23:58:12.593394 [info ] [MainThread]: 
[0m23:58:12.593394 [info ] [MainThread]: Finished running 5 incremental models in 0 hours 0 minutes and 11.51 seconds (11.51s).
[0m23:58:12.593394 [debug] [MainThread]: Command end result
[0m23:58:12.747155 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m23:58:12.747155 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m23:58:12.762805 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m23:58:12.762805 [info ] [MainThread]: 
[0m23:58:12.762805 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:58:12.762805 [info ] [MainThread]: 
[0m23:58:12.762805 [error] [MainThread]:   Database Error in model fact_orders (models\fact\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 14 at position 8
  invalid identifier 'F.ENVELOPE_VERSION'
  compiled code at target\run\ManyPets\models\fact\fact_orders.sql
[0m23:58:12.779584 [info ] [MainThread]: 
[0m23:58:12.781166 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:58:12.787664 [debug] [MainThread]: Command `dbt run` failed at 23:58:12.787664 after 13.81 seconds
[0m23:58:12.788672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B06CDC5FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B06D0C3A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B070B35450>]}
[0m23:58:12.789657 [debug] [MainThread]: Flushing usage events
[0m23:58:13.365737 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:00:44.262784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F542B60B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F561DEBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F561DEA10>]}


============================== 00:00:44.262784 | 17cfd038-a162-42aa-8674-4424e2a12ae0 ==============================
[0m00:00:44.262784 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:00:44.262784 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:00:45.025167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17cfd038-a162-42aa-8674-4424e2a12ae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F56B3C100>]}
[0m00:00:45.126773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17cfd038-a162-42aa-8674-4424e2a12ae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F5460ECE0>]}
[0m00:00:45.126773 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m00:00:45.584389 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:00:45.958448 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:00:45.958448 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:00:46.049319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17cfd038-a162-42aa-8674-4424e2a12ae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F580A8130>]}
[0m00:00:46.271296 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m00:00:46.286934 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m00:00:46.325213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17cfd038-a162-42aa-8674-4424e2a12ae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F580850C0>]}
[0m00:00:46.325213 [info ] [MainThread]: Found 6 models, 11 data tests, 2 sources, 591 macros
[0m00:00:46.325213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17cfd038-a162-42aa-8674-4424e2a12ae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F57F70940>]}
[0m00:00:46.325213 [info ] [MainThread]: 
[0m00:00:46.325213 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:00:46.325213 [info ] [MainThread]: 
[0m00:00:46.337502 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:00:46.357166 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m00:00:46.556527 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m00:00:46.556527 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m00:00:46.556527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:47.288352 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.737 seconds
[0m00:00:47.303963 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m00:00:47.303963 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m00:00:47.412389 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.104 seconds
[0m00:00:47.412389 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m00:00:47.443660 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m00:00:47.443660 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m00:00:47.443660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:47.931853 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.493 seconds
[0m00:00:47.947056 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m00:00:47.947056 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m00:00:47.947056 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m00:00:48.079236 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.135 seconds
[0m00:00:48.094542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17cfd038-a162-42aa-8674-4424e2a12ae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F57F9B8B0>]}
[0m00:00:48.116664 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_order_complete
[0m00:00:48.116664 [info ] [Thread-1 (]: 1 of 5 START sql incremental model staging.stg_order_complete .................. [RUN]
[0m00:00:48.116664 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_order_complete'
[0m00:00:48.116664 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_order_complete
[0m00:00:48.155699 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_order_complete"
[0m00:00:48.155699 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_order_complete
[0m00:00:48.237764 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:00:48.237764 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
create or replace  temporary view DEV.staging.stg_order_complete__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING        AS order_id,
        data:detail:intent::STRING          AS intent,
        data:detail:tenant::STRING          AS tenant,
        data:detail:customer_id::STRING     AS customer_id,
        pet.value                           AS pet_id,  
        data:time::TIMESTAMP                AS event_time,
        data:source::STRING                 AS source,
        data:type::STRING                   AS event_type,
        ingest_date                         AS ingest_date
    FROM dev.rdl.order_complete o,
    LATERAL FLATTEN(input => o.data:detail:pet_ids) AS pet  

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_order_complete)
    
)
SELECT 
    order_id,
    customer_id,
    pet_id,
    intent,
    tenant,
    event_time,
    source,
    event_type,
    ingest_date
FROM source_data
  );
[0m00:00:48.237764 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:00:48.845540 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m00:00:48.854177 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:00:48.854177 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table DEV.staging.stg_order_complete__dbt_tmp
[0m00:00:48.936263 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.087 seconds
[0m00:00:48.951348 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:00:48.951348 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table DEV.staging.stg_order_complete
[0m00:00:49.020627 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.079 seconds
[0m00:00:49.051893 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:00:49.051893 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table "DEV"."STAGING"."STG_ORDER_COMPLETE"
[0m00:00:49.114389 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.058 seconds
[0m00:00:49.152188 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_order_complete"
[0m00:00:49.152188 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:00:49.152188 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
-- back compat for old kwarg name
  
  begin;
[0m00:00:49.253049 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.100 seconds
[0m00:00:49.253049 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:00:49.253049 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
merge into DEV.staging.stg_order_complete as DBT_INTERNAL_DEST
        using DEV.staging.stg_order_complete__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
                ) and (
                    DBT_INTERNAL_SOURCE.pet_id = DBT_INTERNAL_DEST.pet_id
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PET_ID" = DBT_INTERNAL_SOURCE."PET_ID","INTENT" = DBT_INTERNAL_SOURCE."INTENT","TENANT" = DBT_INTERNAL_SOURCE."TENANT","EVENT_TIME" = DBT_INTERNAL_SOURCE."EVENT_TIME","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PET_ID", "INTENT", "TENANT", "EVENT_TIME", "SOURCE", "EVENT_TYPE", "INGEST_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PET_ID", "INTENT", "TENANT", "EVENT_TIME", "SOURCE", "EVENT_TYPE", "INGEST_DATE")

;
[0m00:00:49.538902 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.280 seconds
[0m00:00:49.538902 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:00:49.538902 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
COMMIT
[0m00:00:49.685969 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.148 seconds
[0m00:00:49.723547 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_order_complete__dbt_tmp
[0m00:00:49.723547 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:00:49.739187 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
drop view if exists DEV.staging.stg_order_complete__dbt_tmp cascade
[0m00:00:49.840059 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.104 seconds
[0m00:00:49.870901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17cfd038-a162-42aa-8674-4424e2a12ae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F587EDC00>]}
[0m00:00:49.870901 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model staging.stg_order_complete ............. [[32mSUCCESS 0[0m in 1.75s]
[0m00:00:49.886529 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_order_complete
[0m00:00:49.886529 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m00:00:49.886529 [info ] [Thread-1 (]: 2 of 5 START sql incremental model staging.stg_orders .......................... [RUN]
[0m00:00:49.886529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_order_complete, now model.ManyPets.stg_orders)
[0m00:00:49.893578 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m00:00:49.914766 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m00:00:49.914766 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m00:00:49.930337 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:00:49.930337 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace  temporary view DEV.staging.stg_orders__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS event_type,
        data:time::TIMESTAMP                            AS event_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_orders)
    
),
dedup AS
(
    SELECT
        *
        ,ROW_NUMBER() OVER(PARTITION BY order_id, email, pet_dob, pet_name, pet_breed  ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)
SELECT 
    order_id ,
    email AS customer_email,
    pet_dob,
    pet_name,
    COALESCE(NULLIF(TRIM(COALESCE(first_name, '') || ' ' || COALESCE(last_name, '')), ''), 'unknown') AS customer_name,
    dob                                         AS customer_dob,
    phone                                       AS customer_phone,
    address_line1 || ' ' || address_line2       AS customer_address,
    city                                        AS customer_city,
    country                                     AS customer_country,
    postcode                                    AS customer_postcode,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_date,
    cessation_date,
    affiliate_code,
    source,
    event_type,
    event_time,
    ingest_date
FROM dedup
WHERE 
    rnk =1
  );
[0m00:00:50.357310 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.430 seconds
[0m00:00:50.372651 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:00:50.372651 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders__dbt_tmp
[0m00:00:50.470310 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.105 seconds
[0m00:00:50.485938 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:00:50.485938 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders
[0m00:00:50.558595 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.074 seconds
[0m00:00:50.558595 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:00:50.573653 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table "DEV"."STAGING"."STG_ORDERS"
[0m00:00:50.626927 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.062 seconds
[0m00:00:50.642566 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m00:00:50.642566 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:00:50.658189 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m00:00:50.759586 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.111 seconds
[0m00:00:50.759586 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:00:50.759586 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
merge into DEV.staging.stg_orders as DBT_INTERNAL_DEST
        using DEV.staging.stg_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.customer_email = DBT_INTERNAL_DEST.customer_email
                ) and (
                    DBT_INTERNAL_SOURCE.pet_dob = DBT_INTERNAL_DEST.pet_dob
                ) and (
                    DBT_INTERNAL_SOURCE.pet_name = DBT_INTERNAL_DEST.pet_name
                ) and (
                    DBT_INTERNAL_SOURCE.pet_breed = DBT_INTERNAL_DEST.pet_breed
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_EMAIL" = DBT_INTERNAL_SOURCE."CUSTOMER_EMAIL","PET_DOB" = DBT_INTERNAL_SOURCE."PET_DOB","PET_NAME" = DBT_INTERNAL_SOURCE."PET_NAME","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","PET_BREED" = DBT_INTERNAL_SOURCE."PET_BREED","PET_GENDER" = DBT_INTERNAL_SOURCE."PET_GENDER","PET_SPECIES" = DBT_INTERNAL_SOURCE."PET_SPECIES","PEDIGREE_TYPE" = DBT_INTERNAL_SOURCE."PEDIGREE_TYPE","SPAYED_NEUTERED" = DBT_INTERNAL_SOURCE."SPAYED_NEUTERED","PET_POSTCODE" = DBT_INTERNAL_SOURCE."PET_POSTCODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","CESSATION_DATE" = DBT_INTERNAL_SOURCE."CESSATION_DATE","AFFILIATE_CODE" = DBT_INTERNAL_SOURCE."AFFILIATE_CODE","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","EVENT_TIME" = DBT_INTERNAL_SOURCE."EVENT_TIME","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")
    values
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")

;
[0m00:00:51.931846 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.161 seconds
[0m00:00:51.931846 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:00:51.931846 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
COMMIT
[0m00:00:52.163879 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.229 seconds
[0m00:00:52.179502 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_orders__dbt_tmp
[0m00:00:52.179502 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:00:52.179502 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
drop view if exists DEV.staging.stg_orders__dbt_tmp cascade
[0m00:00:52.295543 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.113 seconds
[0m00:00:52.295543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17cfd038-a162-42aa-8674-4424e2a12ae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F588D4FD0>]}
[0m00:00:52.311190 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model staging.stg_orders ..................... [[32mSUCCESS 0[0m in 2.41s]
[0m00:00:52.311190 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m00:00:52.311190 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m00:00:52.311190 [info ] [Thread-1 (]: 3 of 5 START sql incremental model odl.dim_customers ........................... [RUN]
[0m00:00:52.311190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_orders, now model.ManyPets.dim_customers)
[0m00:00:52.325371 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m00:00:52.352523 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m00:00:52.352523 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m00:00:52.374128 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:00:52.375131 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace  temporary view DEV.odl.dim_customers__dbt_tmp
  
   as (
    
WITH stg_data AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date  
    FROM DEV.staging.stg_orders
    
    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.dim_customers)
    
),
dedup AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date,
        ROW_NUMBER() OVER (PARTITION BY customer_email ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    customer_email                                                          AS customer_nk, 
    md5(cast(coalesce(cast(customer_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                 AS customer_sk,
    customer_name,
    customer_dob,
    customer_phone,
    customer_address,
    customer_city,
    customer_country,
    customer_postcode,
    ingest_date
FROM dedup
WHERE rnk = 1
  );
[0m00:00:52.649655 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.282 seconds
[0m00:00:52.664915 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:00:52.664915 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table DEV.odl.dim_customers__dbt_tmp
[0m00:00:52.765518 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.095 seconds
[0m00:00:52.781138 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:00:52.781138 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table DEV.odl.dim_customers
[0m00:00:52.851396 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.071 seconds
[0m00:00:52.866441 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:00:52.866441 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table "DEV"."ODL"."DIM_CUSTOMERS"
[0m00:00:52.928997 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.057 seconds
[0m00:00:52.935523 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_customers"
[0m00:00:52.935523 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:00:52.935523 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m00:00:53.035929 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.097 seconds
[0m00:00:53.035929 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:00:53.051576 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
merge into DEV.odl.dim_customers as DBT_INTERNAL_DEST
        using DEV.odl.dim_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.customer_nk = DBT_INTERNAL_DEST.customer_nk))

    
    when matched then update set
        "CUSTOMER_NK" = DBT_INTERNAL_SOURCE."CUSTOMER_NK","CUSTOMER_SK" = DBT_INTERNAL_SOURCE."CUSTOMER_SK","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("CUSTOMER_NK", "CUSTOMER_SK", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "INGEST_DATE")
    values
        ("CUSTOMER_NK", "CUSTOMER_SK", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "INGEST_DATE")

;
[0m00:00:53.801782 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.757 seconds
[0m00:00:53.801782 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:00:53.801782 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
COMMIT
[0m00:00:54.139917 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.330 seconds
[0m00:00:54.139917 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_customers__dbt_tmp
[0m00:00:54.150388 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:00:54.150388 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
drop view if exists DEV.odl.dim_customers__dbt_tmp cascade
[0m00:00:54.256560 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.110 seconds
[0m00:00:54.256560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17cfd038-a162-42aa-8674-4424e2a12ae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F58986A10>]}
[0m00:00:54.256560 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model odl.dim_customers ...................... [[32mSUCCESS 0[0m in 1.95s]
[0m00:00:54.256560 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m00:00:54.256560 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_pets
[0m00:00:54.256560 [info ] [Thread-1 (]: 4 of 5 START sql incremental model odl.dim_pets ................................ [RUN]
[0m00:00:54.271641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_customers, now model.ManyPets.dim_pets)
[0m00:00:54.271641 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_pets
[0m00:00:54.271641 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_pets"
[0m00:00:54.271641 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_pets
[0m00:00:54.294360 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:00:54.297614 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
create or replace  temporary view DEV.odl.dim_pets__dbt_tmp
  
   as (
    

WITH stg_data AS (
    SELECT
        customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date
    FROM DEV.staging.stg_orders
    
    
        WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.dim_pets)
    
),

dedup AS (
    SELECT
        customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date,
        ROW_NUMBER() OVER(PARTITION BY customer_email, pet_dob, pet_name, pet_breed ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    d.customer_email ||'|'||d.pet_name || '|' || d.pet_dob || '|' || d.pet_breed      AS pet_nk,  
    md5(cast(coalesce(cast(pet_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                                AS pet_sk,  
    d.pet_name,
    d.pet_dob,
    d.pet_breed,
    d.pet_gender,
    d.pet_species,
    d.pedigree_type,
    d.spayed_neutered,
    d.pet_postcode,
    d.pet_value,
    d.ingest_date,
    c.customer_sk
FROM dedup AS d
    INNER JOIN DEV.odl.dim_customers AS c ON (c.customer_nk=d.customer_email)
WHERE d.rnk = 1
  );
[0m00:00:54.715323 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.425 seconds
[0m00:00:54.730632 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:00:54.730632 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
describe table DEV.odl.dim_pets__dbt_tmp
[0m00:00:54.805353 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.082 seconds
[0m00:00:54.820638 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:00:54.820638 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
describe table DEV.odl.dim_pets
[0m00:00:54.890365 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.072 seconds
[0m00:00:54.905534 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:00:54.905534 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
describe table "DEV"."ODL"."DIM_PETS"
[0m00:00:54.975211 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.069 seconds
[0m00:00:54.990343 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_pets"
[0m00:00:55.005967 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:00:55.005967 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
-- back compat for old kwarg name
  
  begin;
[0m00:00:55.106239 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.098 seconds
[0m00:00:55.106239 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:00:55.106239 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
merge into DEV.odl.dim_pets as DBT_INTERNAL_DEST
        using DEV.odl.dim_pets__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.pet_nk = DBT_INTERNAL_DEST.pet_nk))

    
    when matched then update set
        "PET_NK" = DBT_INTERNAL_SOURCE."PET_NK","PET_SK" = DBT_INTERNAL_SOURCE."PET_SK","PET_NAME" = DBT_INTERNAL_SOURCE."PET_NAME","PET_DOB" = DBT_INTERNAL_SOURCE."PET_DOB","PET_BREED" = DBT_INTERNAL_SOURCE."PET_BREED","PET_GENDER" = DBT_INTERNAL_SOURCE."PET_GENDER","PET_SPECIES" = DBT_INTERNAL_SOURCE."PET_SPECIES","PEDIGREE_TYPE" = DBT_INTERNAL_SOURCE."PEDIGREE_TYPE","SPAYED_NEUTERED" = DBT_INTERNAL_SOURCE."SPAYED_NEUTERED","PET_POSTCODE" = DBT_INTERNAL_SOURCE."PET_POSTCODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE","CUSTOMER_SK" = DBT_INTERNAL_SOURCE."CUSTOMER_SK"
    

    when not matched then insert
        ("PET_NK", "PET_SK", "PET_NAME", "PET_DOB", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "INGEST_DATE", "CUSTOMER_SK")
    values
        ("PET_NK", "PET_SK", "PET_NAME", "PET_DOB", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "INGEST_DATE", "CUSTOMER_SK")

;
[0m00:00:55.994762 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.896 seconds
[0m00:00:55.994762 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:00:55.994762 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
COMMIT
[0m00:00:56.248500 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.242 seconds
[0m00:00:56.248500 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_pets__dbt_tmp
[0m00:00:56.248500 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:00:56.264146 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
drop view if exists DEV.odl.dim_pets__dbt_tmp cascade
[0m00:00:56.380481 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.119 seconds
[0m00:00:56.380481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17cfd038-a162-42aa-8674-4424e2a12ae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F589E2D70>]}
[0m00:00:56.395843 [info ] [Thread-1 (]: 4 of 5 OK created sql incremental model odl.dim_pets ........................... [[32mSUCCESS 0[0m in 2.11s]
[0m00:00:56.395843 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_pets
[0m00:00:56.395843 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m00:00:56.395843 [info ] [Thread-1 (]: 5 of 5 START sql incremental model odl.fact_orders ............................. [RUN]
[0m00:00:56.395843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_pets, now model.ManyPets.fact_orders)
[0m00:00:56.411610 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_orders
[0m00:00:56.424419 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_orders"
[0m00:00:56.424419 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_orders
[0m00:00:56.449154 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.fact_orders"
[0m00:00:56.449154 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:00:56.465003 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
create or replace transient table DEV.odl.fact_orders
         as
        ( 
WITH fact_data AS (
    SELECT 
        f.order_id,
        f.order_date,
        f.cessation_date,
        f.affiliate_code,
        f.pet_value,
        f.source,
        f.event_type,
       -- f.event_time,
      --  f.envelope_version,
       -- f.detail_version,
       -- f.intent,
       -- f.tenant,
      --  f.experiments,
        c.customer_sk,
        p.pet_sk
    FROM DEV.staging.stg_orders f
    LEFT JOIN DEV.odl.dim_customers c 
        ON f.customer_email = c.customer_email
    LEFT JOIN DEV.odl.dim_pets p 
        ON f.pet_name = p.pet_name 
        AND f.pet_dob = p.pet_dob
        AND f.pet_breed = p.pet_breed
    
)

, dedup AS (
    SELECT 
        f.*,
        ROW_NUMBER() OVER(PARTITION BY f.order_id, f.customer_sk, f.pet_sk ORDER BY f.ingest_date DESC) AS rnk
    FROM fact_data f
)

SELECT 
    f.order_id || '|' || f.customer_sk || '|'|| f.pet_sk    AS order_nk,
    md5(cast(coalesce(cast(order_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))    AS order_sk,
    customer_sk                                             AS customer_sk,
    pet_sk                                                  AS pet_sk,
    order_date                                              AS order_date,
    cessation_date                                          AS cessation_date,
    COALESCE(affiliate_code, 'unknown')                     AS affiliate_code,
    pet_value                                               AS pet_value,
    source                                                  AS order_source,
    event_type                                              AS order_type,
/*
    event_time,
    envelope_version,
    detail_version,
    intent,
    tenant,
    experiments,
*/
    ingest_date
FROM dedup
WHERE rnk = 1
        );
[0m00:00:56.580744 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0e7c-0000-e3c5-0001-b3ce000162d6
[0m00:00:56.580744 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 23 at position 30
invalid identifier 'C.CUSTOMER_EMAIL'
[0m00:00:56.580744 [debug] [Thread-1 (]: Database Error in model fact_orders (models\fact\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 23 at position 30
  invalid identifier 'C.CUSTOMER_EMAIL'
  compiled code at target\run\ManyPets\models\fact\fact_orders.sql
[0m00:00:56.580744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17cfd038-a162-42aa-8674-4424e2a12ae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F588D4AC0>]}
[0m00:00:56.596363 [error] [Thread-1 (]: 5 of 5 ERROR creating sql incremental model odl.fact_orders .................... [[31mERROR[0m in 0.18s]
[0m00:00:56.596363 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m00:00:56.596363 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_orders (models\fact\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 23 at position 30
  invalid identifier 'C.CUSTOMER_EMAIL'
  compiled code at target\run\ManyPets\models\fact\fact_orders.sql.
[0m00:00:56.596363 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:56.596363 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m00:00:56.596363 [debug] [MainThread]: On list_DEV: Close
[0m00:00:56.680571 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m00:00:56.680571 [debug] [MainThread]: On list_DEV_odl: Close
[0m00:00:56.765522 [debug] [MainThread]: Connection 'model.ManyPets.fact_orders' was left open.
[0m00:00:56.765522 [debug] [MainThread]: On model.ManyPets.fact_orders: Close
[0m00:00:56.881578 [info ] [MainThread]: 
[0m00:00:56.881578 [info ] [MainThread]: Finished running 5 incremental models in 0 hours 0 minutes and 10.55 seconds (10.55s).
[0m00:00:56.896894 [debug] [MainThread]: Command end result
[0m00:00:57.028666 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m00:00:57.028666 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m00:00:57.050797 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m00:00:57.050797 [info ] [MainThread]: 
[0m00:00:57.050797 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:00:57.050797 [info ] [MainThread]: 
[0m00:00:57.050797 [error] [MainThread]:   Database Error in model fact_orders (models\fact\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 23 at position 30
  invalid identifier 'C.CUSTOMER_EMAIL'
  compiled code at target\run\ManyPets\models\fact\fact_orders.sql
[0m00:00:57.050797 [info ] [MainThread]: 
[0m00:00:57.059793 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m00:00:57.065169 [debug] [MainThread]: Command `dbt run` failed at 00:00:57.064187 after 12.92 seconds
[0m00:00:57.065788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F542B60B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F53E5A770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F57F70940>]}
[0m00:00:57.065788 [debug] [MainThread]: Flushing usage events
[0m00:00:57.684648 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:02:27.497673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC84A95FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC869BE920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC869BE740>]}


============================== 00:02:27.505975 | 5190a5f2-e6eb-4a42-8c46-a0d1f40dafbc ==============================
[0m00:02:27.505975 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:02:27.505975 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:02:28.144901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5190a5f2-e6eb-4a42-8c46-a0d1f40dafbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC84DEDED0>]}
[0m00:02:28.245211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5190a5f2-e6eb-4a42-8c46-a0d1f40dafbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC8682B2B0>]}
[0m00:02:28.245211 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m00:02:28.724316 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:02:29.078658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:02:29.078658 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:02:29.169825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5190a5f2-e6eb-4a42-8c46-a0d1f40dafbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC88888130>]}
[0m00:02:29.402169 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m00:02:29.412188 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m00:02:29.443459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5190a5f2-e6eb-4a42-8c46-a0d1f40dafbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC88855B40>]}
[0m00:02:29.443459 [info ] [MainThread]: Found 6 models, 11 data tests, 2 sources, 591 macros
[0m00:02:29.443459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5190a5f2-e6eb-4a42-8c46-a0d1f40dafbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC88853910>]}
[0m00:02:29.443459 [info ] [MainThread]: 
[0m00:02:29.443459 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:02:29.443459 [info ] [MainThread]: 
[0m00:02:29.457688 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:02:29.474506 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m00:02:29.643544 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m00:02:29.643544 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m00:02:29.643544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:02:30.362349 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.716 seconds
[0m00:02:30.377978 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m00:02:30.377978 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m00:02:30.491227 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.109 seconds
[0m00:02:30.506830 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m00:02:30.532022 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m00:02:30.532022 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m00:02:30.532022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:02:31.019280 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.491 seconds
[0m00:02:31.034955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m00:02:31.034955 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m00:02:31.034955 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m00:02:31.235755 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.186 seconds
[0m00:02:31.235755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5190a5f2-e6eb-4a42-8c46-a0d1f40dafbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC88769990>]}
[0m00:02:31.235755 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_order_complete
[0m00:02:31.235755 [info ] [Thread-1 (]: 1 of 5 START sql incremental model staging.stg_order_complete .................. [RUN]
[0m00:02:31.251358 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_order_complete'
[0m00:02:31.251358 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_order_complete
[0m00:02:31.278038 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_order_complete"
[0m00:02:31.278038 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_order_complete
[0m00:02:31.358210 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:02:31.358210 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
create or replace  temporary view DEV.staging.stg_order_complete__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING        AS order_id,
        data:detail:intent::STRING          AS intent,
        data:detail:tenant::STRING          AS tenant,
        data:detail:customer_id::STRING     AS customer_id,
        pet.value                           AS pet_id,  
        data:time::TIMESTAMP                AS event_time,
        data:source::STRING                 AS source,
        data:type::STRING                   AS event_type,
        ingest_date                         AS ingest_date
    FROM dev.rdl.order_complete o,
    LATERAL FLATTEN(input => o.data:detail:pet_ids) AS pet  

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_order_complete)
    
)
SELECT 
    order_id,
    customer_id,
    pet_id,
    intent,
    tenant,
    event_time,
    source,
    event_type,
    ingest_date
FROM source_data
  );
[0m00:02:31.373825 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:02:31.854570 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.492 seconds
[0m00:02:31.869584 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:02:31.869584 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table DEV.staging.stg_order_complete__dbt_tmp
[0m00:02:31.970182 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.098 seconds
[0m00:02:31.985410 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:02:31.985410 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table DEV.staging.stg_order_complete
[0m00:02:32.057885 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.068 seconds
[0m00:02:32.072904 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:02:32.072904 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table "DEV"."STAGING"."STG_ORDER_COMPLETE"
[0m00:02:32.155685 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.080 seconds
[0m00:02:32.202096 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_order_complete"
[0m00:02:32.202096 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:02:32.202096 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
-- back compat for old kwarg name
  
  begin;
[0m00:02:32.324819 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.111 seconds
[0m00:02:32.324819 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:02:32.324819 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
merge into DEV.staging.stg_order_complete as DBT_INTERNAL_DEST
        using DEV.staging.stg_order_complete__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
                ) and (
                    DBT_INTERNAL_SOURCE.pet_id = DBT_INTERNAL_DEST.pet_id
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PET_ID" = DBT_INTERNAL_SOURCE."PET_ID","INTENT" = DBT_INTERNAL_SOURCE."INTENT","TENANT" = DBT_INTERNAL_SOURCE."TENANT","EVENT_TIME" = DBT_INTERNAL_SOURCE."EVENT_TIME","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PET_ID", "INTENT", "TENANT", "EVENT_TIME", "SOURCE", "EVENT_TYPE", "INGEST_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PET_ID", "INTENT", "TENANT", "EVENT_TIME", "SOURCE", "EVENT_TYPE", "INGEST_DATE")

;
[0m00:02:32.605225 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.276 seconds
[0m00:02:32.605225 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:02:32.605225 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
COMMIT
[0m00:02:32.742605 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.141 seconds
[0m00:02:32.773454 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_order_complete__dbt_tmp
[0m00:02:32.789090 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:02:32.789090 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
drop view if exists DEV.staging.stg_order_complete__dbt_tmp cascade
[0m00:02:32.905216 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.121 seconds
[0m00:02:32.942599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5190a5f2-e6eb-4a42-8c46-a0d1f40dafbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC88FA43A0>]}
[0m00:02:32.942599 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model staging.stg_order_complete ............. [[32mSUCCESS 0[0m in 1.69s]
[0m00:02:32.942599 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_order_complete
[0m00:02:32.942599 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m00:02:32.942599 [info ] [Thread-1 (]: 2 of 5 START sql incremental model staging.stg_orders .......................... [RUN]
[0m00:02:32.942599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_order_complete, now model.ManyPets.stg_orders)
[0m00:02:32.942599 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m00:02:32.965073 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m00:02:32.969322 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m00:02:32.980293 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:02:32.980293 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace  temporary view DEV.staging.stg_orders__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS event_type,
        data:time::TIMESTAMP                            AS event_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_orders)
    
),
dedup AS
(
    SELECT
        *
        ,ROW_NUMBER() OVER(PARTITION BY order_id, email, pet_dob, pet_name, pet_breed  ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)
SELECT 
    order_id ,
    email AS customer_email,
    pet_dob,
    pet_name,
    COALESCE(NULLIF(TRIM(COALESCE(first_name, '') || ' ' || COALESCE(last_name, '')), ''), 'unknown') AS customer_name,
    dob                                         AS customer_dob,
    phone                                       AS customer_phone,
    address_line1 || ' ' || address_line2       AS customer_address,
    city                                        AS customer_city,
    country                                     AS customer_country,
    postcode                                    AS customer_postcode,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_date,
    cessation_date,
    affiliate_code,
    source,
    event_type,
    event_time,
    ingest_date
FROM dedup
WHERE 
    rnk =1
  );
[0m00:02:33.391717 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.412 seconds
[0m00:02:33.391717 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:02:33.391717 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders__dbt_tmp
[0m00:02:33.491381 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.090 seconds
[0m00:02:33.507009 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:02:33.507009 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders
[0m00:02:33.576764 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.070 seconds
[0m00:02:33.591946 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:02:33.591946 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table "DEV"."STAGING"."STG_ORDERS"
[0m00:02:33.672699 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.081 seconds
[0m00:02:33.672699 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m00:02:33.687664 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:02:33.687664 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m00:02:33.793230 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.106 seconds
[0m00:02:33.793230 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:02:33.793230 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
merge into DEV.staging.stg_orders as DBT_INTERNAL_DEST
        using DEV.staging.stg_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.customer_email = DBT_INTERNAL_DEST.customer_email
                ) and (
                    DBT_INTERNAL_SOURCE.pet_dob = DBT_INTERNAL_DEST.pet_dob
                ) and (
                    DBT_INTERNAL_SOURCE.pet_name = DBT_INTERNAL_DEST.pet_name
                ) and (
                    DBT_INTERNAL_SOURCE.pet_breed = DBT_INTERNAL_DEST.pet_breed
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_EMAIL" = DBT_INTERNAL_SOURCE."CUSTOMER_EMAIL","PET_DOB" = DBT_INTERNAL_SOURCE."PET_DOB","PET_NAME" = DBT_INTERNAL_SOURCE."PET_NAME","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","PET_BREED" = DBT_INTERNAL_SOURCE."PET_BREED","PET_GENDER" = DBT_INTERNAL_SOURCE."PET_GENDER","PET_SPECIES" = DBT_INTERNAL_SOURCE."PET_SPECIES","PEDIGREE_TYPE" = DBT_INTERNAL_SOURCE."PEDIGREE_TYPE","SPAYED_NEUTERED" = DBT_INTERNAL_SOURCE."SPAYED_NEUTERED","PET_POSTCODE" = DBT_INTERNAL_SOURCE."PET_POSTCODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","CESSATION_DATE" = DBT_INTERNAL_SOURCE."CESSATION_DATE","AFFILIATE_CODE" = DBT_INTERNAL_SOURCE."AFFILIATE_CODE","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","EVENT_TIME" = DBT_INTERNAL_SOURCE."EVENT_TIME","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")
    values
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")

;
[0m00:02:35.036360 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.243 seconds
[0m00:02:35.036360 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:02:35.036360 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
COMMIT
[0m00:02:35.269308 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.222 seconds
[0m00:02:35.269308 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_orders__dbt_tmp
[0m00:02:35.269308 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:02:35.269308 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
drop view if exists DEV.staging.stg_orders__dbt_tmp cascade
[0m00:02:35.400929 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.124 seconds
[0m00:02:35.400929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5190a5f2-e6eb-4a42-8c46-a0d1f40dafbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC89084FD0>]}
[0m00:02:35.400929 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model staging.stg_orders ..................... [[32mSUCCESS 0[0m in 2.46s]
[0m00:02:35.400929 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m00:02:35.400929 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m00:02:35.400929 [info ] [Thread-1 (]: 3 of 5 START sql incremental model odl.dim_customers ........................... [RUN]
[0m00:02:35.416547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_orders, now model.ManyPets.dim_customers)
[0m00:02:35.416547 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m00:02:35.446579 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m00:02:35.448639 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m00:02:35.455499 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:02:35.455499 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace  temporary view DEV.odl.dim_customers__dbt_tmp
  
   as (
    
WITH stg_data AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date  
    FROM DEV.staging.stg_orders
    
    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.dim_customers)
    
),
dedup AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date,
        ROW_NUMBER() OVER (PARTITION BY customer_email ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    customer_email                                                          AS customer_nk, 
    md5(cast(coalesce(cast(customer_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                 AS customer_sk,
    customer_name,
    customer_dob,
    customer_phone,
    customer_address,
    customer_city,
    customer_country,
    customer_postcode,
    ingest_date
FROM dedup
WHERE rnk = 1
  );
[0m00:02:35.717788 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.265 seconds
[0m00:02:35.717788 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:02:35.717788 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table DEV.odl.dim_customers__dbt_tmp
[0m00:02:35.839821 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.119 seconds
[0m00:02:35.871105 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:02:35.871105 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table DEV.odl.dim_customers
[0m00:02:35.940162 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.066 seconds
[0m00:02:35.940162 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:02:35.940162 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table "DEV"."ODL"."DIM_CUSTOMERS"
[0m00:02:36.003191 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.057 seconds
[0m00:02:36.003191 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_customers"
[0m00:02:36.018308 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:02:36.018308 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m00:02:36.103037 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.095 seconds
[0m00:02:36.103037 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:02:36.118508 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
merge into DEV.odl.dim_customers as DBT_INTERNAL_DEST
        using DEV.odl.dim_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.customer_nk = DBT_INTERNAL_DEST.customer_nk))

    
    when matched then update set
        "CUSTOMER_NK" = DBT_INTERNAL_SOURCE."CUSTOMER_NK","CUSTOMER_SK" = DBT_INTERNAL_SOURCE."CUSTOMER_SK","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("CUSTOMER_NK", "CUSTOMER_SK", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "INGEST_DATE")
    values
        ("CUSTOMER_NK", "CUSTOMER_SK", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "INGEST_DATE")

;
[0m00:02:36.991458 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.876 seconds
[0m00:02:36.991458 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:02:36.991458 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
COMMIT
[0m00:02:37.192575 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.204 seconds
[0m00:02:37.207984 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_customers__dbt_tmp
[0m00:02:37.207984 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:02:37.223600 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
drop view if exists DEV.odl.dim_customers__dbt_tmp cascade
[0m00:02:37.346207 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.134 seconds
[0m00:02:37.361862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5190a5f2-e6eb-4a42-8c46-a0d1f40dafbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC89132950>]}
[0m00:02:37.361862 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model odl.dim_customers ...................... [[32mSUCCESS 0[0m in 1.95s]
[0m00:02:37.361862 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m00:02:37.377492 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_pets
[0m00:02:37.377492 [info ] [Thread-1 (]: 4 of 5 START sql incremental model odl.dim_pets ................................ [RUN]
[0m00:02:37.383109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_customers, now model.ManyPets.dim_pets)
[0m00:02:37.384246 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_pets
[0m00:02:37.397060 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_pets"
[0m00:02:37.400032 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_pets
[0m00:02:37.403313 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:02:37.403313 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
create or replace  temporary view DEV.odl.dim_pets__dbt_tmp
  
   as (
    

WITH stg_data AS (
    SELECT
        customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date
    FROM DEV.staging.stg_orders
    
    
        WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.dim_pets)
    
),

dedup AS (
    SELECT
        customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date,
        ROW_NUMBER() OVER(PARTITION BY customer_email, pet_dob, pet_name, pet_breed ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    d.customer_email ||'|'||d.pet_name || '|' || d.pet_dob || '|' || d.pet_breed      AS pet_nk,  
    md5(cast(coalesce(cast(pet_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                                AS pet_sk,  
    d.pet_name,
    d.pet_dob,
    d.pet_breed,
    d.pet_gender,
    d.pet_species,
    d.pedigree_type,
    d.spayed_neutered,
    d.pet_postcode,
    d.pet_value,
    d.ingest_date,
    c.customer_sk
FROM dedup AS d
    INNER JOIN DEV.odl.dim_customers AS c ON (c.customer_nk=d.customer_email)
WHERE d.rnk = 1
  );
[0m00:02:37.694009 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.296 seconds
[0m00:02:37.709634 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:02:37.709634 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
describe table DEV.odl.dim_pets__dbt_tmp
[0m00:02:37.779514 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.077 seconds
[0m00:02:37.794747 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:02:37.794747 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
describe table DEV.odl.dim_pets
[0m00:02:37.862058 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.059 seconds
[0m00:02:37.870297 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:02:37.870297 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
describe table "DEV"."ODL"."DIM_PETS"
[0m00:02:37.933051 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.064 seconds
[0m00:02:37.948578 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_pets"
[0m00:02:37.948578 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:02:37.948578 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
-- back compat for old kwarg name
  
  begin;
[0m00:02:38.048984 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.096 seconds
[0m00:02:38.048984 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:02:38.048984 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
merge into DEV.odl.dim_pets as DBT_INTERNAL_DEST
        using DEV.odl.dim_pets__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.pet_nk = DBT_INTERNAL_DEST.pet_nk))

    
    when matched then update set
        "PET_NK" = DBT_INTERNAL_SOURCE."PET_NK","PET_SK" = DBT_INTERNAL_SOURCE."PET_SK","PET_NAME" = DBT_INTERNAL_SOURCE."PET_NAME","PET_DOB" = DBT_INTERNAL_SOURCE."PET_DOB","PET_BREED" = DBT_INTERNAL_SOURCE."PET_BREED","PET_GENDER" = DBT_INTERNAL_SOURCE."PET_GENDER","PET_SPECIES" = DBT_INTERNAL_SOURCE."PET_SPECIES","PEDIGREE_TYPE" = DBT_INTERNAL_SOURCE."PEDIGREE_TYPE","SPAYED_NEUTERED" = DBT_INTERNAL_SOURCE."SPAYED_NEUTERED","PET_POSTCODE" = DBT_INTERNAL_SOURCE."PET_POSTCODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE","CUSTOMER_SK" = DBT_INTERNAL_SOURCE."CUSTOMER_SK"
    

    when not matched then insert
        ("PET_NK", "PET_SK", "PET_NAME", "PET_DOB", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "INGEST_DATE", "CUSTOMER_SK")
    values
        ("PET_NK", "PET_SK", "PET_NAME", "PET_DOB", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "INGEST_DATE", "CUSTOMER_SK")

;
[0m00:02:39.010062 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.956 seconds
[0m00:02:39.010062 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:02:39.010062 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
COMMIT
[0m00:02:39.241976 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.220 seconds
[0m00:02:39.241976 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_pets__dbt_tmp
[0m00:02:39.241976 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:02:39.241976 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
drop view if exists DEV.odl.dim_pets__dbt_tmp cascade
[0m00:02:39.364709 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.116 seconds
[0m00:02:39.364709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5190a5f2-e6eb-4a42-8c46-a0d1f40dafbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC89192CB0>]}
[0m00:02:39.364709 [info ] [Thread-1 (]: 4 of 5 OK created sql incremental model odl.dim_pets ........................... [[32mSUCCESS 0[0m in 1.99s]
[0m00:02:39.364709 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_pets
[0m00:02:39.364709 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m00:02:39.364709 [info ] [Thread-1 (]: 5 of 5 START sql incremental model odl.fact_orders ............................. [RUN]
[0m00:02:39.364709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_pets, now model.ManyPets.fact_orders)
[0m00:02:39.364709 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_orders
[0m00:02:39.386862 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_orders"
[0m00:02:39.386862 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_orders
[0m00:02:39.419332 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.fact_orders"
[0m00:02:39.419332 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:02:39.419332 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
create or replace transient table DEV.odl.fact_orders
         as
        ( 
WITH fact_data AS (
    SELECT 
        f.order_id,
        f.order_date,
        f.cessation_date,
        f.affiliate_code,
        f.pet_value,
        f.source,
        f.event_type,
       -- f.event_time,
      --  f.envelope_version,
       -- f.detail_version,
       -- f.intent,
       -- f.tenant,
      --  f.experiments,
        c.customer_sk,
        p.pet_sk
    FROM DEV.staging.stg_orders f
    LEFT JOIN DEV.odl.dim_customers c 
        ON f.customer_email = c.customer_nk
    LEFT JOIN DEV.odl.dim_pets p 
        ON f.pet_name = p.pet_name 
        AND f.pet_dob = p.pet_dob
        AND f.pet_breed = p.pet_breed
    
)

, dedup AS (
    SELECT 
        f.*,
        ROW_NUMBER() OVER(PARTITION BY f.order_id, f.customer_sk, f.pet_sk ORDER BY f.ingest_date DESC) AS rnk
    FROM fact_data f
)

SELECT 
    f.order_id || '|' || f.customer_sk || '|'|| f.pet_sk    AS order_nk,
    md5(cast(coalesce(cast(order_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))    AS order_sk,
    customer_sk                                             AS customer_sk,
    pet_sk                                                  AS pet_sk,
    order_date                                              AS order_date,
    cessation_date                                          AS cessation_date,
    COALESCE(affiliate_code, 'unknown')                     AS affiliate_code,
    pet_value                                               AS pet_value,
    source                                                  AS order_source,
    event_type                                              AS order_type,
/*
    event_time,
    envelope_version,
    detail_version,
    intent,
    tenant,
    experiments,
*/
    ingest_date
FROM dedup
WHERE rnk = 1
        );
[0m00:02:39.547524 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0e7d-0000-e37b-0001-b3ce0001b286
[0m00:02:39.547524 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 34 at position 84
invalid identifier 'F.INGEST_DATE'
[0m00:02:39.547524 [debug] [Thread-1 (]: Database Error in model fact_orders (models\fact\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 34 at position 84
  invalid identifier 'F.INGEST_DATE'
  compiled code at target\run\ManyPets\models\fact\fact_orders.sql
[0m00:02:39.547524 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5190a5f2-e6eb-4a42-8c46-a0d1f40dafbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC89084550>]}
[0m00:02:39.563162 [error] [Thread-1 (]: 5 of 5 ERROR creating sql incremental model odl.fact_orders .................... [[31mERROR[0m in 0.18s]
[0m00:02:39.565177 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m00:02:39.565177 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_orders (models\fact\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 34 at position 84
  invalid identifier 'F.INGEST_DATE'
  compiled code at target\run\ManyPets\models\fact\fact_orders.sql.
[0m00:02:39.565177 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:02:39.565177 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m00:02:39.565177 [debug] [MainThread]: On list_DEV: Close
[0m00:02:39.651442 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m00:02:39.651442 [debug] [MainThread]: On list_DEV_odl: Close
[0m00:02:39.744066 [debug] [MainThread]: Connection 'model.ManyPets.fact_orders' was left open.
[0m00:02:39.744066 [debug] [MainThread]: On model.ManyPets.fact_orders: Close
[0m00:02:39.844565 [info ] [MainThread]: 
[0m00:02:39.844565 [info ] [MainThread]: Finished running 5 incremental models in 0 hours 0 minutes and 10.39 seconds (10.39s).
[0m00:02:39.844565 [debug] [MainThread]: Command end result
[0m00:02:39.967780 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m00:02:39.986781 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m00:02:40.000290 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m00:02:40.000290 [info ] [MainThread]: 
[0m00:02:40.000290 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:02:40.000290 [info ] [MainThread]: 
[0m00:02:40.000290 [error] [MainThread]:   Database Error in model fact_orders (models\fact\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 34 at position 84
  invalid identifier 'F.INGEST_DATE'
  compiled code at target\run\ManyPets\models\fact\fact_orders.sql
[0m00:02:40.000290 [info ] [MainThread]: 
[0m00:02:40.008559 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m00:02:40.010556 [debug] [MainThread]: Command `dbt run` failed at 00:02:40.009557 after 12.67 seconds
[0m00:02:40.010556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC84A95FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC84D93A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC88805450>]}
[0m00:02:40.011555 [debug] [MainThread]: Flushing usage events
[0m00:02:40.615140 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:07:45.648654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C59A9E5FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C59C90E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C59C90E740>]}


============================== 00:07:45.664292 | 819d0485-8780-40bb-a3be-1b6c84554106 ==============================
[0m00:07:45.664292 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:07:45.664292 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:07:46.285780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '819d0485-8780-40bb-a3be-1b6c84554106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C59BD09ED0>]}
[0m00:07:46.376741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '819d0485-8780-40bb-a3be-1b6c84554106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C59C77B2B0>]}
[0m00:07:46.376741 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m00:07:46.825700 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:07:47.190224 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:07:47.190224 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:07:47.281206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '819d0485-8780-40bb-a3be-1b6c84554106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C59E7D8130>]}
[0m00:07:47.512431 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m00:07:47.520480 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m00:07:47.552728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '819d0485-8780-40bb-a3be-1b6c84554106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C59E7B2500>]}
[0m00:07:47.552728 [info ] [MainThread]: Found 6 models, 11 data tests, 2 sources, 591 macros
[0m00:07:47.552728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '819d0485-8780-40bb-a3be-1b6c84554106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C59E7A7910>]}
[0m00:07:47.560830 [info ] [MainThread]: 
[0m00:07:47.560830 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:07:47.560830 [info ] [MainThread]: 
[0m00:07:47.565634 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:07:47.586331 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m00:07:47.764325 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m00:07:47.770839 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m00:07:47.770839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:48.551021 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.783 seconds
[0m00:07:48.551021 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m00:07:48.566618 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m00:07:48.673355 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.106 seconds
[0m00:07:48.673355 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m00:07:48.689008 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m00:07:48.689008 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m00:07:48.689008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:49.276457 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.591 seconds
[0m00:07:49.276457 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m00:07:49.292099 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m00:07:49.292099 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m00:07:49.393184 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.107 seconds
[0m00:07:49.410827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '819d0485-8780-40bb-a3be-1b6c84554106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C59E6B5B40>]}
[0m00:07:49.426451 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_order_complete
[0m00:07:49.428029 [info ] [Thread-1 (]: 1 of 5 START sql incremental model staging.stg_order_complete .................. [RUN]
[0m00:07:49.430032 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_order_complete'
[0m00:07:49.430032 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_order_complete
[0m00:07:49.449119 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_order_complete"
[0m00:07:49.449119 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_order_complete
[0m00:07:49.527608 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:07:49.527608 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
create or replace  temporary view DEV.staging.stg_order_complete__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING        AS order_id,
        data:detail:intent::STRING          AS intent,
        data:detail:tenant::STRING          AS tenant,
        data:detail:customer_id::STRING     AS customer_id,
        pet.value                           AS pet_id,  
        data:time::TIMESTAMP                AS event_time,
        data:source::STRING                 AS source,
        data:type::STRING                   AS event_type,
        ingest_date                         AS ingest_date
    FROM dev.rdl.order_complete o,
    LATERAL FLATTEN(input => o.data:detail:pet_ids) AS pet  

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_order_complete)
    
)
SELECT 
    order_id,
    customer_id,
    pet_id,
    intent,
    tenant,
    event_time,
    source,
    event_type,
    ingest_date
FROM source_data
  );
[0m00:07:49.527608 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:07:50.080002 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.548 seconds
[0m00:07:50.095639 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:07:50.095639 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table DEV.staging.stg_order_complete__dbt_tmp
[0m00:07:50.195943 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.097 seconds
[0m00:07:50.211614 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:07:50.211614 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table DEV.staging.stg_order_complete
[0m00:07:50.280529 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.070 seconds
[0m00:07:50.311816 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:07:50.311816 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table "DEV"."STAGING"."STG_ORDER_COMPLETE"
[0m00:07:50.412351 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.102 seconds
[0m00:07:50.443346 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_order_complete"
[0m00:07:50.458952 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:07:50.458952 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
-- back compat for old kwarg name
  
  begin;
[0m00:07:50.572033 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.109 seconds
[0m00:07:50.572033 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:07:50.572033 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
merge into DEV.staging.stg_order_complete as DBT_INTERNAL_DEST
        using DEV.staging.stg_order_complete__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
                ) and (
                    DBT_INTERNAL_SOURCE.pet_id = DBT_INTERNAL_DEST.pet_id
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PET_ID" = DBT_INTERNAL_SOURCE."PET_ID","INTENT" = DBT_INTERNAL_SOURCE."INTENT","TENANT" = DBT_INTERNAL_SOURCE."TENANT","EVENT_TIME" = DBT_INTERNAL_SOURCE."EVENT_TIME","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PET_ID", "INTENT", "TENANT", "EVENT_TIME", "SOURCE", "EVENT_TYPE", "INGEST_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PET_ID", "INTENT", "TENANT", "EVENT_TIME", "SOURCE", "EVENT_TYPE", "INGEST_DATE")

;
[0m00:07:50.861055 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.290 seconds
[0m00:07:50.861055 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:07:50.861055 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
COMMIT
[0m00:07:51.016062 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.147 seconds
[0m00:07:51.026510 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_order_complete__dbt_tmp
[0m00:07:51.026510 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:07:51.026510 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
drop view if exists DEV.staging.stg_order_complete__dbt_tmp cascade
[0m00:07:51.178718 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.140 seconds
[0m00:07:51.216550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '819d0485-8780-40bb-a3be-1b6c84554106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C59EEC7E80>]}
[0m00:07:51.216550 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model staging.stg_order_complete ............. [[32mSUCCESS 0[0m in 1.79s]
[0m00:07:51.232159 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_order_complete
[0m00:07:51.232159 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m00:07:51.232159 [info ] [Thread-1 (]: 2 of 5 START sql incremental model staging.stg_orders .......................... [RUN]
[0m00:07:51.232159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_order_complete, now model.ManyPets.stg_orders)
[0m00:07:51.232159 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m00:07:51.232159 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m00:07:51.232159 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m00:07:51.263686 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:07:51.265677 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace  temporary view DEV.staging.stg_orders__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS event_type,
        data:time::TIMESTAMP                            AS event_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_orders)
    
),
dedup AS
(
    SELECT
        *
        ,ROW_NUMBER() OVER(PARTITION BY order_id, email, pet_dob, pet_name, pet_breed  ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)
SELECT 
    order_id ,
    email AS customer_email,
    pet_dob,
    pet_name,
    COALESCE(NULLIF(TRIM(COALESCE(first_name, '') || ' ' || COALESCE(last_name, '')), ''), 'unknown') AS customer_name,
    dob                                         AS customer_dob,
    phone                                       AS customer_phone,
    address_line1 || ' ' || address_line2       AS customer_address,
    city                                        AS customer_city,
    country                                     AS customer_country,
    postcode                                    AS customer_postcode,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_date,
    cessation_date,
    affiliate_code,
    source,
    event_type,
    event_time,
    ingest_date
FROM dedup
WHERE 
    rnk =1
  );
[0m00:07:51.687133 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.421 seconds
[0m00:07:51.687133 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:07:51.687133 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders__dbt_tmp
[0m00:07:51.787408 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.096 seconds
[0m00:07:51.818674 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:07:51.818674 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders
[0m00:07:51.881171 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.059 seconds
[0m00:07:51.887689 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:07:51.887689 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table "DEV"."STAGING"."STG_ORDERS"
[0m00:07:51.950308 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.067 seconds
[0m00:07:51.981483 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m00:07:51.988044 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:07:51.988044 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m00:07:52.108120 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.109 seconds
[0m00:07:52.108120 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:07:52.108120 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
merge into DEV.staging.stg_orders as DBT_INTERNAL_DEST
        using DEV.staging.stg_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.customer_email = DBT_INTERNAL_DEST.customer_email
                ) and (
                    DBT_INTERNAL_SOURCE.pet_dob = DBT_INTERNAL_DEST.pet_dob
                ) and (
                    DBT_INTERNAL_SOURCE.pet_name = DBT_INTERNAL_DEST.pet_name
                ) and (
                    DBT_INTERNAL_SOURCE.pet_breed = DBT_INTERNAL_DEST.pet_breed
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_EMAIL" = DBT_INTERNAL_SOURCE."CUSTOMER_EMAIL","PET_DOB" = DBT_INTERNAL_SOURCE."PET_DOB","PET_NAME" = DBT_INTERNAL_SOURCE."PET_NAME","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","PET_BREED" = DBT_INTERNAL_SOURCE."PET_BREED","PET_GENDER" = DBT_INTERNAL_SOURCE."PET_GENDER","PET_SPECIES" = DBT_INTERNAL_SOURCE."PET_SPECIES","PEDIGREE_TYPE" = DBT_INTERNAL_SOURCE."PEDIGREE_TYPE","SPAYED_NEUTERED" = DBT_INTERNAL_SOURCE."SPAYED_NEUTERED","PET_POSTCODE" = DBT_INTERNAL_SOURCE."PET_POSTCODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","CESSATION_DATE" = DBT_INTERNAL_SOURCE."CESSATION_DATE","AFFILIATE_CODE" = DBT_INTERNAL_SOURCE."AFFILIATE_CODE","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","EVENT_TIME" = DBT_INTERNAL_SOURCE."EVENT_TIME","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")
    values
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")

;
[0m00:07:53.225511 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.120 seconds
[0m00:07:53.225511 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:07:53.240587 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
COMMIT
[0m00:07:53.465259 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.228 seconds
[0m00:07:53.472111 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_orders__dbt_tmp
[0m00:07:53.472111 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:07:53.472111 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
drop view if exists DEV.staging.stg_orders__dbt_tmp cascade
[0m00:07:53.611149 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.137 seconds
[0m00:07:53.611149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '819d0485-8780-40bb-a3be-1b6c84554106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C59EFA4D60>]}
[0m00:07:53.611149 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model staging.stg_orders ..................... [[32mSUCCESS 0[0m in 2.38s]
[0m00:07:53.611149 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m00:07:53.611149 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m00:07:53.611149 [info ] [Thread-1 (]: 3 of 5 START sql incremental model odl.dim_customers ........................... [RUN]
[0m00:07:53.626323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_orders, now model.ManyPets.dim_customers)
[0m00:07:53.628547 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m00:07:53.663265 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m00:07:53.665176 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m00:07:53.676593 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:07:53.676593 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace  temporary view DEV.odl.dim_customers__dbt_tmp
  
   as (
    
WITH stg_data AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date  
    FROM DEV.staging.stg_orders
    
    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.dim_customers)
    
),
dedup AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date,
        ROW_NUMBER() OVER (PARTITION BY customer_email ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    customer_email                                                          AS customer_nk, 
    md5(cast(coalesce(cast(customer_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                 AS customer_sk,
    customer_name,
    customer_dob,
    customer_phone,
    customer_address,
    customer_city,
    customer_country,
    customer_postcode,
    ingest_date
FROM dedup
WHERE rnk = 1
  );
[0m00:07:53.958954 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.288 seconds
[0m00:07:53.974083 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:07:53.974083 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table DEV.odl.dim_customers__dbt_tmp
[0m00:07:54.074943 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.102 seconds
[0m00:07:54.096931 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:07:54.096931 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table DEV.odl.dim_customers
[0m00:07:54.175098 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.066 seconds
[0m00:07:54.175098 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:07:54.175098 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table "DEV"."ODL"."DIM_CUSTOMERS"
[0m00:07:54.255510 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.071 seconds
[0m00:07:54.270745 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_customers"
[0m00:07:54.270745 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:07:54.270745 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m00:07:54.376163 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.109 seconds
[0m00:07:54.391596 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:07:54.391596 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
merge into DEV.odl.dim_customers as DBT_INTERNAL_DEST
        using DEV.odl.dim_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.customer_nk = DBT_INTERNAL_DEST.customer_nk))

    
    when matched then update set
        "CUSTOMER_NK" = DBT_INTERNAL_SOURCE."CUSTOMER_NK","CUSTOMER_SK" = DBT_INTERNAL_SOURCE."CUSTOMER_SK","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("CUSTOMER_NK", "CUSTOMER_SK", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "INGEST_DATE")
    values
        ("CUSTOMER_NK", "CUSTOMER_SK", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "INGEST_DATE")

;
[0m00:07:55.133219 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.752 seconds
[0m00:07:55.133219 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:07:55.133219 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
COMMIT
[0m00:07:55.365592 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.219 seconds
[0m00:07:55.381213 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_customers__dbt_tmp
[0m00:07:55.381213 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:07:55.381213 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
drop view if exists DEV.odl.dim_customers__dbt_tmp cascade
[0m00:07:55.519903 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.133 seconds
[0m00:07:55.519903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '819d0485-8780-40bb-a3be-1b6c84554106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C59F052950>]}
[0m00:07:55.519903 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model odl.dim_customers ...................... [[32mSUCCESS 0[0m in 1.91s]
[0m00:07:55.519903 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m00:07:55.519903 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_pets
[0m00:07:55.519903 [info ] [Thread-1 (]: 4 of 5 START sql incremental model odl.dim_pets ................................ [RUN]
[0m00:07:55.519903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_customers, now model.ManyPets.dim_pets)
[0m00:07:55.519903 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_pets
[0m00:07:55.547838 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_pets"
[0m00:07:55.549841 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_pets
[0m00:07:55.556326 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:07:55.556326 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
create or replace  temporary view DEV.odl.dim_pets__dbt_tmp
  
   as (
    

WITH stg_data AS (
    SELECT
        customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date
    FROM DEV.staging.stg_orders
    
    
        WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.dim_pets)
    
),

dedup AS (
    SELECT
        customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date,
        ROW_NUMBER() OVER(PARTITION BY customer_email, pet_dob, pet_name, pet_breed ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    d.customer_email ||'|'||d.pet_name || '|' || d.pet_dob || '|' || d.pet_breed      AS pet_nk,  
    md5(cast(coalesce(cast(pet_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                                AS pet_sk,  
    d.pet_name,
    d.pet_dob,
    d.pet_breed,
    d.pet_gender,
    d.pet_species,
    d.pedigree_type,
    d.spayed_neutered,
    d.pet_postcode,
    d.pet_value,
    d.ingest_date,
    c.customer_sk
FROM dedup AS d
    INNER JOIN DEV.odl.dim_customers AS c ON (c.customer_nk=d.customer_email)
WHERE d.rnk = 1
  );
[0m00:07:55.898935 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.337 seconds
[0m00:07:55.905447 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:07:55.905447 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
describe table DEV.odl.dim_pets__dbt_tmp
[0m00:07:55.983887 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.085 seconds
[0m00:07:55.999230 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:07:55.999230 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
describe table DEV.odl.dim_pets
[0m00:07:56.068292 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.067 seconds
[0m00:07:56.068292 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:07:56.068292 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
describe table "DEV"."ODL"."DIM_PETS"
[0m00:07:56.153626 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.082 seconds
[0m00:07:56.168937 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_pets"
[0m00:07:56.168937 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:07:56.168937 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
-- back compat for old kwarg name
  
  begin;
[0m00:07:56.285770 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.108 seconds
[0m00:07:56.285770 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:07:56.285770 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
merge into DEV.odl.dim_pets as DBT_INTERNAL_DEST
        using DEV.odl.dim_pets__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.pet_nk = DBT_INTERNAL_DEST.pet_nk))

    
    when matched then update set
        "PET_NK" = DBT_INTERNAL_SOURCE."PET_NK","PET_SK" = DBT_INTERNAL_SOURCE."PET_SK","PET_NAME" = DBT_INTERNAL_SOURCE."PET_NAME","PET_DOB" = DBT_INTERNAL_SOURCE."PET_DOB","PET_BREED" = DBT_INTERNAL_SOURCE."PET_BREED","PET_GENDER" = DBT_INTERNAL_SOURCE."PET_GENDER","PET_SPECIES" = DBT_INTERNAL_SOURCE."PET_SPECIES","PEDIGREE_TYPE" = DBT_INTERNAL_SOURCE."PEDIGREE_TYPE","SPAYED_NEUTERED" = DBT_INTERNAL_SOURCE."SPAYED_NEUTERED","PET_POSTCODE" = DBT_INTERNAL_SOURCE."PET_POSTCODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE","CUSTOMER_SK" = DBT_INTERNAL_SOURCE."CUSTOMER_SK"
    

    when not matched then insert
        ("PET_NK", "PET_SK", "PET_NAME", "PET_DOB", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "INGEST_DATE", "CUSTOMER_SK")
    values
        ("PET_NK", "PET_SK", "PET_NAME", "PET_DOB", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "INGEST_DATE", "CUSTOMER_SK")

;
[0m00:07:57.289509 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.006 seconds
[0m00:07:57.289509 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:07:57.305012 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
COMMIT
[0m00:07:57.558987 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.267 seconds
[0m00:07:57.574612 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_pets__dbt_tmp
[0m00:07:57.574612 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:07:57.574612 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
drop view if exists DEV.odl.dim_pets__dbt_tmp cascade
[0m00:07:57.712459 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.131 seconds
[0m00:07:57.712459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '819d0485-8780-40bb-a3be-1b6c84554106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C59F0B2CB0>]}
[0m00:07:57.712459 [info ] [Thread-1 (]: 4 of 5 OK created sql incremental model odl.dim_pets ........................... [[32mSUCCESS 0[0m in 2.19s]
[0m00:07:57.712459 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_pets
[0m00:07:57.728097 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m00:07:57.728097 [info ] [Thread-1 (]: 5 of 5 START sql incremental model odl.fact_orders ............................. [RUN]
[0m00:07:57.728097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_pets, now model.ManyPets.fact_orders)
[0m00:07:57.731633 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_orders
[0m00:07:57.738830 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_orders"
[0m00:07:57.738830 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_orders
[0m00:07:57.772092 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.fact_orders"
[0m00:07:57.772092 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:07:57.772092 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
create or replace transient table DEV.odl.fact_orders
         as
        ( 
WITH fact_data AS (
    SELECT 
        f.order_id,
        f.order_date,
        f.cessation_date,
        f.affiliate_code,
        f.pet_value,
        f.source,
        f.event_type,
        /*f.event_time,
        f.envelope_version,
        f.detail_version,
        f.intent,
        f.tenant,
        f.experiments,*/
        c.customer_sk,
        p.pet_sk,
        f.ingest_date
    FROM DEV.staging.stg_orders f
    LEFT JOIN DEV.odl.dim_customers c 
        ON f.customer_email = c.customer_nk
    LEFT JOIN DEV.odl.dim_pets p 
        ON f.pet_name = p.pet_name 
        AND f.pet_dob = p.pet_dob
        AND f.pet_breed = p.pet_breed
    
)

, dedup AS (
    SELECT 
        f.*,
        ROW_NUMBER() OVER(PARTITION BY f.order_id, f.customer_sk, f.pet_sk ORDER BY f.ingest_date DESC) AS rnk
    FROM fact_data f
)

SELECT 
    f.order_id || '|' || f.customer_sk || '|'|| f.pet_sk    AS order_nk,
    md5(cast(coalesce(cast(order_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))    AS order_sk,
    customer_sk                                             AS customer_sk,
    pet_sk                                                  AS pet_sk,
    order_date                                              AS order_date,
    cessation_date                                          AS cessation_date,
    COALESCE(affiliate_code, 'unknown')                     AS affiliate_code,
    pet_value                                               AS pet_value,
    source                                                  AS order_source,
    event_type                                              AS order_type,
/*
    event_time,
    envelope_version,
    detail_version,
    intent,
    tenant,
    experiments,
*/
    ingest_date
FROM dedup
WHERE rnk = 1
        );
[0m00:07:57.915516 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0e83-0000-e37b-0001-b3ce0001b2ae
[0m00:07:57.916517 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 40 at position 4
invalid identifier 'F.ORDER_ID'
[0m00:07:57.920084 [debug] [Thread-1 (]: Database Error in model fact_orders (models\fact\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 40 at position 4
  invalid identifier 'F.ORDER_ID'
  compiled code at target\run\ManyPets\models\fact\fact_orders.sql
[0m00:07:57.920084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '819d0485-8780-40bb-a3be-1b6c84554106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C59EFA78E0>]}
[0m00:07:57.920084 [error] [Thread-1 (]: 5 of 5 ERROR creating sql incremental model odl.fact_orders .................... [[31mERROR[0m in 0.19s]
[0m00:07:57.920084 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m00:07:57.920084 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_orders (models\fact\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 40 at position 4
  invalid identifier 'F.ORDER_ID'
  compiled code at target\run\ManyPets\models\fact\fact_orders.sql.
[0m00:07:57.920084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:07:57.920084 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m00:07:57.920084 [debug] [MainThread]: On list_DEV: Close
[0m00:07:58.092171 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m00:07:58.107641 [debug] [MainThread]: On list_DEV_staging: Close
[0m00:07:58.214841 [debug] [MainThread]: Connection 'model.ManyPets.fact_orders' was left open.
[0m00:07:58.214841 [debug] [MainThread]: On model.ManyPets.fact_orders: Close
[0m00:07:58.331049 [info ] [MainThread]: 
[0m00:07:58.331049 [info ] [MainThread]: Finished running 5 incremental models in 0 hours 0 minutes and 10.77 seconds (10.77s).
[0m00:07:58.346484 [debug] [MainThread]: Command end result
[0m00:07:58.468462 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m00:07:58.468462 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m00:07:58.484100 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m00:07:58.484100 [info ] [MainThread]: 
[0m00:07:58.484100 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:07:58.484100 [info ] [MainThread]: 
[0m00:07:58.484100 [error] [MainThread]:   Database Error in model fact_orders (models\fact\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 40 at position 4
  invalid identifier 'F.ORDER_ID'
  compiled code at target\run\ManyPets\models\fact\fact_orders.sql
[0m00:07:58.484100 [info ] [MainThread]: 
[0m00:07:58.499711 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m00:07:58.503180 [debug] [MainThread]: Command `dbt run` failed at 00:07:58.503180 after 13.00 seconds
[0m00:07:58.506442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C59A9E5FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5990B04C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C59BD09ED0>]}
[0m00:07:58.506442 [debug] [MainThread]: Flushing usage events
[0m00:07:59.095665 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:09:00.930918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283488D5FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002834A7FE8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002834A7FE710>]}


============================== 00:09:00.946572 | 12cbef7f-dda3-4479-a605-a80ead0d2974 ==============================
[0m00:09:00.946572 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:09:00.946572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:09:01.559429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12cbef7f-dda3-4479-a605-a80ead0d2974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002834A31B790>]}
[0m00:09:01.664912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12cbef7f-dda3-4479-a605-a80ead0d2974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002834B0D3910>]}
[0m00:09:01.664912 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m00:09:02.103884 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:09:02.482899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:09:02.482899 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:09:02.567870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12cbef7f-dda3-4479-a605-a80ead0d2974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002834C6C8130>]}
[0m00:09:02.800403 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m00:09:02.808474 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m00:09:02.834134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12cbef7f-dda3-4479-a605-a80ead0d2974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002834B268BE0>]}
[0m00:09:02.834134 [info ] [MainThread]: Found 6 models, 11 data tests, 2 sources, 591 macros
[0m00:09:02.834134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12cbef7f-dda3-4479-a605-a80ead0d2974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002834C6A0A90>]}
[0m00:09:02.849773 [info ] [MainThread]: 
[0m00:09:02.849773 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:09:02.855663 [info ] [MainThread]: 
[0m00:09:02.858037 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:09:02.871157 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m00:09:03.018761 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m00:09:03.018761 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m00:09:03.018761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:09:03.690439 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.669 seconds
[0m00:09:03.690439 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m00:09:03.690439 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m00:09:03.783525 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.084 seconds
[0m00:09:03.783525 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m00:09:03.814759 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m00:09:03.814759 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m00:09:03.814759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:09:04.323383 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.508 seconds
[0m00:09:04.323383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m00:09:04.323383 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m00:09:04.323383 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m00:09:04.455198 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.123 seconds
[0m00:09:04.455198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12cbef7f-dda3-4479-a605-a80ead0d2974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028346FCD6F0>]}
[0m00:09:04.470813 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_order_complete
[0m00:09:04.470813 [info ] [Thread-1 (]: 1 of 5 START sql incremental model staging.stg_order_complete .................. [RUN]
[0m00:09:04.470813 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_order_complete'
[0m00:09:04.470813 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_order_complete
[0m00:09:04.493917 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_order_complete"
[0m00:09:04.493917 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_order_complete
[0m00:09:04.574101 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:09:04.574101 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
create or replace  temporary view DEV.staging.stg_order_complete__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING        AS order_id,
        data:detail:intent::STRING          AS intent,
        data:detail:tenant::STRING          AS tenant,
        data:detail:customer_id::STRING     AS customer_id,
        pet.value                           AS pet_id,  
        data:time::TIMESTAMP                AS event_time,
        data:source::STRING                 AS source,
        data:type::STRING                   AS event_type,
        ingest_date                         AS ingest_date
    FROM dev.rdl.order_complete o,
    LATERAL FLATTEN(input => o.data:detail:pet_ids) AS pet  

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_order_complete)
    
)
SELECT 
    order_id,
    customer_id,
    pet_id,
    intent,
    tenant,
    event_time,
    source,
    event_type,
    ingest_date
FROM source_data
  );
[0m00:09:04.574101 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:09:05.226949 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.652 seconds
[0m00:09:05.249437 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:09:05.249437 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table DEV.staging.stg_order_complete__dbt_tmp
[0m00:09:05.342896 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.098 seconds
[0m00:09:05.358075 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:09:05.358075 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table DEV.staging.stg_order_complete
[0m00:09:05.443243 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.087 seconds
[0m00:09:05.474119 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:09:05.474119 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table "DEV"."STAGING"."STG_ORDER_COMPLETE"
[0m00:09:05.543913 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.079 seconds
[0m00:09:05.590410 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_order_complete"
[0m00:09:05.606038 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:09:05.606038 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
-- back compat for old kwarg name
  
  begin;
[0m00:09:05.706747 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.108 seconds
[0m00:09:05.706747 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:09:05.706747 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
merge into DEV.staging.stg_order_complete as DBT_INTERNAL_DEST
        using DEV.staging.stg_order_complete__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
                ) and (
                    DBT_INTERNAL_SOURCE.pet_id = DBT_INTERNAL_DEST.pet_id
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PET_ID" = DBT_INTERNAL_SOURCE."PET_ID","INTENT" = DBT_INTERNAL_SOURCE."INTENT","TENANT" = DBT_INTERNAL_SOURCE."TENANT","EVENT_TIME" = DBT_INTERNAL_SOURCE."EVENT_TIME","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PET_ID", "INTENT", "TENANT", "EVENT_TIME", "SOURCE", "EVENT_TYPE", "INGEST_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PET_ID", "INTENT", "TENANT", "EVENT_TIME", "SOURCE", "EVENT_TYPE", "INGEST_DATE")

;
[0m00:09:06.045430 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.323 seconds
[0m00:09:06.045430 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:09:06.045430 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
COMMIT
[0m00:09:06.193112 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.153 seconds
[0m00:09:06.208398 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_order_complete__dbt_tmp
[0m00:09:06.224025 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:09:06.224025 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
drop view if exists DEV.staging.stg_order_complete__dbt_tmp cascade
[0m00:09:06.347719 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.132 seconds
[0m00:09:06.378539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12cbef7f-dda3-4479-a605-a80ead0d2974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002834CE67EB0>]}
[0m00:09:06.378539 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model staging.stg_order_complete ............. [[32mSUCCESS 0[0m in 1.91s]
[0m00:09:06.394150 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_order_complete
[0m00:09:06.394150 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m00:09:06.394150 [info ] [Thread-1 (]: 2 of 5 START sql incremental model staging.stg_orders .......................... [RUN]
[0m00:09:06.394150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_order_complete, now model.ManyPets.stg_orders)
[0m00:09:06.394150 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m00:09:06.394150 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m00:09:06.394150 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m00:09:06.431512 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:09:06.431512 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace  temporary view DEV.staging.stg_orders__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS event_type,
        data:time::TIMESTAMP                            AS event_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_orders)
    
),
dedup AS
(
    SELECT
        *
        ,ROW_NUMBER() OVER(PARTITION BY order_id, email, pet_dob, pet_name, pet_breed  ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)
SELECT 
    order_id ,
    email AS customer_email,
    pet_dob,
    pet_name,
    COALESCE(NULLIF(TRIM(COALESCE(first_name, '') || ' ' || COALESCE(last_name, '')), ''), 'unknown') AS customer_name,
    dob                                         AS customer_dob,
    phone                                       AS customer_phone,
    address_line1 || ' ' || address_line2       AS customer_address,
    city                                        AS customer_city,
    country                                     AS customer_country,
    postcode                                    AS customer_postcode,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_date,
    cessation_date,
    affiliate_code,
    source,
    event_type,
    event_time,
    ingest_date
FROM dedup
WHERE 
    rnk =1
  );
[0m00:09:06.834641 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.399 seconds
[0m00:09:06.840075 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:09:06.855707 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders__dbt_tmp
[0m00:09:06.949196 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.096 seconds
[0m00:09:06.949196 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:09:06.964667 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders
[0m00:09:07.033998 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.079 seconds
[0m00:09:07.049682 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:09:07.065279 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table "DEV"."STAGING"."STG_ORDERS"
[0m00:09:07.134561 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.077 seconds
[0m00:09:07.150224 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m00:09:07.165834 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:09:07.165834 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m00:09:07.265958 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.095 seconds
[0m00:09:07.265958 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:09:07.265958 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
merge into DEV.staging.stg_orders as DBT_INTERNAL_DEST
        using DEV.staging.stg_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.customer_email = DBT_INTERNAL_DEST.customer_email
                ) and (
                    DBT_INTERNAL_SOURCE.pet_dob = DBT_INTERNAL_DEST.pet_dob
                ) and (
                    DBT_INTERNAL_SOURCE.pet_name = DBT_INTERNAL_DEST.pet_name
                ) and (
                    DBT_INTERNAL_SOURCE.pet_breed = DBT_INTERNAL_DEST.pet_breed
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_EMAIL" = DBT_INTERNAL_SOURCE."CUSTOMER_EMAIL","PET_DOB" = DBT_INTERNAL_SOURCE."PET_DOB","PET_NAME" = DBT_INTERNAL_SOURCE."PET_NAME","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","PET_BREED" = DBT_INTERNAL_SOURCE."PET_BREED","PET_GENDER" = DBT_INTERNAL_SOURCE."PET_GENDER","PET_SPECIES" = DBT_INTERNAL_SOURCE."PET_SPECIES","PEDIGREE_TYPE" = DBT_INTERNAL_SOURCE."PEDIGREE_TYPE","SPAYED_NEUTERED" = DBT_INTERNAL_SOURCE."SPAYED_NEUTERED","PET_POSTCODE" = DBT_INTERNAL_SOURCE."PET_POSTCODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","CESSATION_DATE" = DBT_INTERNAL_SOURCE."CESSATION_DATE","AFFILIATE_CODE" = DBT_INTERNAL_SOURCE."AFFILIATE_CODE","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","EVENT_TIME" = DBT_INTERNAL_SOURCE."EVENT_TIME","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")
    values
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")

;
[0m00:09:08.712461 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.442 seconds
[0m00:09:08.712461 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:09:08.712461 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
COMMIT
[0m00:09:09.067886 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.364 seconds
[0m00:09:09.083107 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_orders__dbt_tmp
[0m00:09:09.083107 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:09:09.083107 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
drop view if exists DEV.staging.stg_orders__dbt_tmp cascade
[0m00:09:09.215081 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.140 seconds
[0m00:09:09.230250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12cbef7f-dda3-4479-a605-a80ead0d2974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002834CF40F70>]}
[0m00:09:09.230250 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model staging.stg_orders ..................... [[32mSUCCESS 0[0m in 2.84s]
[0m00:09:09.230250 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m00:09:09.245878 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m00:09:09.245878 [info ] [Thread-1 (]: 3 of 5 START sql incremental model odl.dim_customers ........................... [RUN]
[0m00:09:09.252403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_orders, now model.ManyPets.dim_customers)
[0m00:09:09.254480 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m00:09:09.287542 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m00:09:09.287542 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m00:09:09.287542 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:09:09.287542 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace  temporary view DEV.odl.dim_customers__dbt_tmp
  
   as (
    
WITH stg_data AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date  
    FROM DEV.staging.stg_orders
    
    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.dim_customers)
    
),
dedup AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date,
        ROW_NUMBER() OVER (PARTITION BY customer_email ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    customer_email                                                          AS customer_nk, 
    md5(cast(coalesce(cast(customer_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                 AS customer_sk,
    customer_name,
    customer_dob,
    customer_phone,
    customer_address,
    customer_city,
    customer_country,
    customer_postcode,
    ingest_date
FROM dedup
WHERE rnk = 1
  );
[0m00:09:09.632900 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.339 seconds
[0m00:09:09.648057 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:09:09.648057 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table DEV.odl.dim_customers__dbt_tmp
[0m00:09:09.748452 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.097 seconds
[0m00:09:09.754486 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:09:09.754486 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table DEV.odl.dim_customers
[0m00:09:09.833098 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.078 seconds
[0m00:09:09.854831 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:09:09.854831 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table "DEV"."ODL"."DIM_CUSTOMERS"
[0m00:09:09.933008 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.075 seconds
[0m00:09:09.948629 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_customers"
[0m00:09:09.955146 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:09:09.955146 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m00:09:10.037123 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.086 seconds
[0m00:09:10.037123 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:09:10.037123 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
merge into DEV.odl.dim_customers as DBT_INTERNAL_DEST
        using DEV.odl.dim_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.customer_nk = DBT_INTERNAL_DEST.customer_nk))

    
    when matched then update set
        "CUSTOMER_NK" = DBT_INTERNAL_SOURCE."CUSTOMER_NK","CUSTOMER_SK" = DBT_INTERNAL_SOURCE."CUSTOMER_SK","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("CUSTOMER_NK", "CUSTOMER_SK", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "INGEST_DATE")
    values
        ("CUSTOMER_NK", "CUSTOMER_SK", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "INGEST_DATE")

;
[0m00:09:10.900795 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.870 seconds
[0m00:09:10.915995 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:09:10.915995 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
COMMIT
[0m00:09:11.201705 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.283 seconds
[0m00:09:11.201705 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_customers__dbt_tmp
[0m00:09:11.201705 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:09:11.201705 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
drop view if exists DEV.odl.dim_customers__dbt_tmp cascade
[0m00:09:11.334258 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.132 seconds
[0m00:09:11.349441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12cbef7f-dda3-4479-a605-a80ead0d2974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002834CFF6920>]}
[0m00:09:11.349441 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model odl.dim_customers ...................... [[32mSUCCESS 0[0m in 2.10s]
[0m00:09:11.349441 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m00:09:11.349441 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_pets
[0m00:09:11.349441 [info ] [Thread-1 (]: 4 of 5 START sql incremental model odl.dim_pets ................................ [RUN]
[0m00:09:11.349441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_customers, now model.ManyPets.dim_pets)
[0m00:09:11.349441 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_pets
[0m00:09:11.349441 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_pets"
[0m00:09:11.366356 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_pets
[0m00:09:11.381821 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:09:11.381821 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
create or replace  temporary view DEV.odl.dim_pets__dbt_tmp
  
   as (
    

WITH stg_data AS (
    SELECT
        customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date
    FROM DEV.staging.stg_orders
    
    
        WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.dim_pets)
    
),

dedup AS (
    SELECT
        customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date,
        ROW_NUMBER() OVER(PARTITION BY customer_email, pet_dob, pet_name, pet_breed ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    d.customer_email ||'|'||d.pet_name || '|' || d.pet_dob || '|' || d.pet_breed      AS pet_nk,  
    md5(cast(coalesce(cast(pet_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                                AS pet_sk,  
    d.pet_name,
    d.pet_dob,
    d.pet_breed,
    d.pet_gender,
    d.pet_species,
    d.pedigree_type,
    d.spayed_neutered,
    d.pet_postcode,
    d.pet_value,
    d.ingest_date,
    c.customer_sk
FROM dedup AS d
    INNER JOIN DEV.odl.dim_customers AS c ON (c.customer_nk=d.customer_email)
WHERE d.rnk = 1
  );
[0m00:09:11.672731 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.293 seconds
[0m00:09:11.672731 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:09:11.672731 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
describe table DEV.odl.dim_pets__dbt_tmp
[0m00:09:11.765645 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.085 seconds
[0m00:09:11.772912 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:09:11.772912 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
describe table DEV.odl.dim_pets
[0m00:09:11.851502 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.082 seconds
[0m00:09:11.873263 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:09:11.873263 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
describe table "DEV"."ODL"."DIM_PETS"
[0m00:09:11.951902 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.079 seconds
[0m00:09:11.967062 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_pets"
[0m00:09:11.973580 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:09:11.973580 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
-- back compat for old kwarg name
  
  begin;
[0m00:09:12.073906 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.097 seconds
[0m00:09:12.073906 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:09:12.073906 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
merge into DEV.odl.dim_pets as DBT_INTERNAL_DEST
        using DEV.odl.dim_pets__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.pet_nk = DBT_INTERNAL_DEST.pet_nk))

    
    when matched then update set
        "PET_NK" = DBT_INTERNAL_SOURCE."PET_NK","PET_SK" = DBT_INTERNAL_SOURCE."PET_SK","PET_NAME" = DBT_INTERNAL_SOURCE."PET_NAME","PET_DOB" = DBT_INTERNAL_SOURCE."PET_DOB","PET_BREED" = DBT_INTERNAL_SOURCE."PET_BREED","PET_GENDER" = DBT_INTERNAL_SOURCE."PET_GENDER","PET_SPECIES" = DBT_INTERNAL_SOURCE."PET_SPECIES","PEDIGREE_TYPE" = DBT_INTERNAL_SOURCE."PEDIGREE_TYPE","SPAYED_NEUTERED" = DBT_INTERNAL_SOURCE."SPAYED_NEUTERED","PET_POSTCODE" = DBT_INTERNAL_SOURCE."PET_POSTCODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE","CUSTOMER_SK" = DBT_INTERNAL_SOURCE."CUSTOMER_SK"
    

    when not matched then insert
        ("PET_NK", "PET_SK", "PET_NAME", "PET_DOB", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "INGEST_DATE", "CUSTOMER_SK")
    values
        ("PET_NK", "PET_SK", "PET_NAME", "PET_DOB", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "INGEST_DATE", "CUSTOMER_SK")

;
[0m00:09:13.108222 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.041 seconds
[0m00:09:13.108222 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:09:13.108222 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
COMMIT
[0m00:09:13.347416 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.235 seconds
[0m00:09:13.362741 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_pets__dbt_tmp
[0m00:09:13.362741 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:09:13.362741 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
drop view if exists DEV.odl.dim_pets__dbt_tmp cascade
[0m00:09:13.495170 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.130 seconds
[0m00:09:13.495170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12cbef7f-dda3-4479-a605-a80ead0d2974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002834D052C80>]}
[0m00:09:13.495170 [info ] [Thread-1 (]: 4 of 5 OK created sql incremental model odl.dim_pets ........................... [[32mSUCCESS 0[0m in 2.15s]
[0m00:09:13.495170 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_pets
[0m00:09:13.495170 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m00:09:13.495170 [info ] [Thread-1 (]: 5 of 5 START sql incremental model odl.fact_orders ............................. [RUN]
[0m00:09:13.495170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_pets, now model.ManyPets.fact_orders)
[0m00:09:13.507648 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_orders
[0m00:09:13.522803 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_orders"
[0m00:09:13.524856 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_orders
[0m00:09:13.552130 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.fact_orders"
[0m00:09:13.552130 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:09:13.552130 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
create or replace transient table DEV.odl.fact_orders
         as
        ( 
WITH fact_data AS (
    SELECT 
        f.order_id,
        f.order_date,
        f.cessation_date,
        f.affiliate_code,
        f.pet_value,
        f.source,
        f.event_type,
        /*f.event_time,
        f.envelope_version,
        f.detail_version,
        f.intent,
        f.tenant,
        f.experiments,*/
        c.customer_sk,
        p.pet_sk,
        f.ingest_date
    FROM DEV.staging.stg_orders f
    LEFT JOIN DEV.odl.dim_customers c 
        ON f.customer_email = c.customer_nk
    LEFT JOIN DEV.odl.dim_pets p 
        ON f.pet_name = p.pet_name 
        AND f.pet_dob = p.pet_dob
        AND f.pet_breed = p.pet_breed
    
)

, dedup AS (
    SELECT 
        f.*,
        ROW_NUMBER() OVER(PARTITION BY f.order_id, f.customer_sk, f.pet_sk ORDER BY f.ingest_date DESC) AS rnk
    FROM fact_data f
)

SELECT 
     order_id || '|' || f.customer_sk || '|'|| f.pet_sk     AS order_nk,
    md5(cast(coalesce(cast(order_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))    AS order_sk,
    customer_sk                                             AS customer_sk,
    pet_sk                                                  AS pet_sk,
    order_date                                              AS order_date,
    cessation_date                                          AS cessation_date,
    COALESCE(affiliate_code, 'unknown')                     AS affiliate_code,
    pet_value                                               AS pet_value,
    source                                                  AS order_source,
    event_type                                              AS order_type,
/*
    event_time,
    envelope_version,
    detail_version,
    intent,
    tenant,
    experiments,
*/
    ingest_date
FROM dedup
WHERE rnk = 1
        );
[0m00:09:13.647694 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0e84-0000-e3b4-0000-0001b3ceb3d9
[0m00:09:13.663020 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 40 at position 24
invalid identifier 'F.CUSTOMER_SK'
[0m00:09:13.663020 [debug] [Thread-1 (]: Database Error in model fact_orders (models\fact\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 40 at position 24
  invalid identifier 'F.CUSTOMER_SK'
  compiled code at target\run\ManyPets\models\fact\fact_orders.sql
[0m00:09:13.663020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12cbef7f-dda3-4479-a605-a80ead0d2974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002834CF42CB0>]}
[0m00:09:13.663020 [error] [Thread-1 (]: 5 of 5 ERROR creating sql incremental model odl.fact_orders .................... [[31mERROR[0m in 0.17s]
[0m00:09:13.663020 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m00:09:13.663020 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_orders (models\fact\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 40 at position 24
  invalid identifier 'F.CUSTOMER_SK'
  compiled code at target\run\ManyPets\models\fact\fact_orders.sql.
[0m00:09:13.663020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:09:13.663020 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m00:09:13.663020 [debug] [MainThread]: On list_DEV: Close
[0m00:09:13.763987 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m00:09:13.763987 [debug] [MainThread]: On list_DEV_staging: Close
[0m00:09:13.880139 [debug] [MainThread]: Connection 'model.ManyPets.fact_orders' was left open.
[0m00:09:13.880139 [debug] [MainThread]: On model.ManyPets.fact_orders: Close
[0m00:09:13.980182 [info ] [MainThread]: 
[0m00:09:13.980182 [info ] [MainThread]: Finished running 5 incremental models in 0 hours 0 minutes and 11.12 seconds (11.12s).
[0m00:09:13.980182 [debug] [MainThread]: Command end result
[0m00:09:14.115268 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m00:09:14.115268 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m00:09:14.133394 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m00:09:14.133394 [info ] [MainThread]: 
[0m00:09:14.133394 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:09:14.133394 [info ] [MainThread]: 
[0m00:09:14.133394 [error] [MainThread]:   Database Error in model fact_orders (models\fact\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 40 at position 24
  invalid identifier 'F.CUSTOMER_SK'
  compiled code at target\run\ManyPets\models\fact\fact_orders.sql
[0m00:09:14.133394 [info ] [MainThread]: 
[0m00:09:14.147830 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m00:09:14.150934 [debug] [MainThread]: Command `dbt run` failed at 00:09:14.150934 after 13.33 seconds
[0m00:09:14.150934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283488D5FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028347DEAA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002834A7CE290>]}
[0m00:09:14.150934 [debug] [MainThread]: Flushing usage events
[0m00:09:14.750423 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:09:46.103534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025893286080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258951AEA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258951AE830>]}


============================== 00:09:46.103534 | 70a8533a-9ac4-442b-8ea8-f57a453f10e6 ==============================
[0m00:09:46.103534 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:09:46.103534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:09:46.742122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70a8533a-9ac4-442b-8ea8-f57a453f10e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025895143CD0>]}
[0m00:09:46.820227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70a8533a-9ac4-442b-8ea8-f57a453f10e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258950528F0>]}
[0m00:09:46.835855 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m00:09:47.289519 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:09:47.662506 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:09:47.662506 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:09:47.755803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70a8533a-9ac4-442b-8ea8-f57a453f10e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025897088130>]}
[0m00:09:47.984067 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m00:09:47.984067 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m00:09:48.021837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70a8533a-9ac4-442b-8ea8-f57a453f10e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025897056890>]}
[0m00:09:48.021837 [info ] [MainThread]: Found 6 models, 11 data tests, 2 sources, 591 macros
[0m00:09:48.021837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70a8533a-9ac4-442b-8ea8-f57a453f10e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025895AD7BE0>]}
[0m00:09:48.021837 [info ] [MainThread]: 
[0m00:09:48.021837 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:09:48.036697 [info ] [MainThread]: 
[0m00:09:48.039098 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:09:48.059679 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m00:09:48.238103 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m00:09:48.238103 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m00:09:48.238103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:09:48.962364 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.721 seconds
[0m00:09:48.972211 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m00:09:48.972211 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m00:09:49.041655 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.078 seconds
[0m00:09:49.056842 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m00:09:49.072433 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m00:09:49.072433 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m00:09:49.072433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:09:49.443479 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.361 seconds
[0m00:09:49.443479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m00:09:49.459098 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m00:09:49.459098 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m00:09:49.606600 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.138 seconds
[0m00:09:49.613140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70a8533a-9ac4-442b-8ea8-f57a453f10e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025895AC66B0>]}
[0m00:09:49.613140 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_order_complete
[0m00:09:49.613140 [info ] [Thread-1 (]: 1 of 5 START sql incremental model staging.stg_order_complete .................. [RUN]
[0m00:09:49.613140 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_order_complete'
[0m00:09:49.613140 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_order_complete
[0m00:09:49.649766 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_order_complete"
[0m00:09:49.649766 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_order_complete
[0m00:09:49.728809 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:09:49.728809 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
create or replace  temporary view DEV.staging.stg_order_complete__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING        AS order_id,
        data:detail:intent::STRING          AS intent,
        data:detail:tenant::STRING          AS tenant,
        data:detail:customer_id::STRING     AS customer_id,
        pet.value                           AS pet_id,  
        data:time::TIMESTAMP                AS event_time,
        data:source::STRING                 AS source,
        data:type::STRING                   AS event_type,
        ingest_date                         AS ingest_date
    FROM dev.rdl.order_complete o,
    LATERAL FLATTEN(input => o.data:detail:pet_ids) AS pet  

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_order_complete)
    
)
SELECT 
    order_id,
    customer_id,
    pet_id,
    intent,
    tenant,
    event_time,
    source,
    event_type,
    ingest_date
FROM source_data
  );
[0m00:09:49.728809 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:09:50.538518 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.815 seconds
[0m00:09:50.553886 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:09:50.553886 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table DEV.staging.stg_order_complete__dbt_tmp
[0m00:09:50.639413 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.090 seconds
[0m00:09:50.654785 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:09:50.654785 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table DEV.staging.stg_order_complete
[0m00:09:50.740023 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.079 seconds
[0m00:09:50.755132 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:09:50.755132 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table "DEV"."STAGING"."STG_ORDER_COMPLETE"
[0m00:09:50.840214 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.083 seconds
[0m00:09:50.886743 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_order_complete"
[0m00:09:50.902359 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:09:50.902359 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
-- back compat for old kwarg name
  
  begin;
[0m00:09:51.040694 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.142 seconds
[0m00:09:51.040694 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:09:51.040694 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
merge into DEV.staging.stg_order_complete as DBT_INTERNAL_DEST
        using DEV.staging.stg_order_complete__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
                ) and (
                    DBT_INTERNAL_SOURCE.pet_id = DBT_INTERNAL_DEST.pet_id
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PET_ID" = DBT_INTERNAL_SOURCE."PET_ID","INTENT" = DBT_INTERNAL_SOURCE."INTENT","TENANT" = DBT_INTERNAL_SOURCE."TENANT","EVENT_TIME" = DBT_INTERNAL_SOURCE."EVENT_TIME","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PET_ID", "INTENT", "TENANT", "EVENT_TIME", "SOURCE", "EVENT_TYPE", "INGEST_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PET_ID", "INTENT", "TENANT", "EVENT_TIME", "SOURCE", "EVENT_TYPE", "INGEST_DATE")

;
[0m00:09:51.599224 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.546 seconds
[0m00:09:51.599224 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:09:51.599224 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
COMMIT
[0m00:09:51.737319 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.142 seconds
[0m00:09:51.768586 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_order_complete__dbt_tmp
[0m00:09:51.784208 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:09:51.784208 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
drop view if exists DEV.staging.stg_order_complete__dbt_tmp cascade
[0m00:09:51.938109 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.151 seconds
[0m00:09:51.984998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70a8533a-9ac4-442b-8ea8-f57a453f10e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258977B7F10>]}
[0m00:09:51.984998 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model staging.stg_order_complete ............. [[32mSUCCESS 0[0m in 2.36s]
[0m00:09:51.984998 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_order_complete
[0m00:09:51.984998 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m00:09:51.984998 [info ] [Thread-1 (]: 2 of 5 START sql incremental model staging.stg_orders .......................... [RUN]
[0m00:09:51.984998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_order_complete, now model.ManyPets.stg_orders)
[0m00:09:51.984998 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m00:09:51.984998 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m00:09:52.000624 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m00:09:52.020147 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:09:52.020147 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace  temporary view DEV.staging.stg_orders__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS event_type,
        data:time::TIMESTAMP                            AS event_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_orders)
    
),
dedup AS
(
    SELECT
        *
        ,ROW_NUMBER() OVER(PARTITION BY order_id, email, pet_dob, pet_name, pet_breed  ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)
SELECT 
    order_id ,
    email AS customer_email,
    pet_dob,
    pet_name,
    COALESCE(NULLIF(TRIM(COALESCE(first_name, '') || ' ' || COALESCE(last_name, '')), ''), 'unknown') AS customer_name,
    dob                                         AS customer_dob,
    phone                                       AS customer_phone,
    address_line1 || ' ' || address_line2       AS customer_address,
    city                                        AS customer_city,
    country                                     AS customer_country,
    postcode                                    AS customer_postcode,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_date,
    cessation_date,
    affiliate_code,
    source,
    event_type,
    event_time,
    ingest_date
FROM dedup
WHERE 
    rnk =1
  );
[0m00:09:52.566299 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.543 seconds
[0m00:09:52.572281 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:09:52.572281 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders__dbt_tmp
[0m00:09:52.662052 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.089 seconds
[0m00:09:52.662052 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:09:52.662052 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders
[0m00:09:52.746658 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.071 seconds
[0m00:09:52.762326 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:09:52.762326 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table "DEV"."STAGING"."STG_ORDERS"
[0m00:09:52.825424 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.068 seconds
[0m00:09:52.840433 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m00:09:52.846945 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:09:52.846945 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m00:09:52.947526 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.104 seconds
[0m00:09:52.947526 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:09:52.947526 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
merge into DEV.staging.stg_orders as DBT_INTERNAL_DEST
        using DEV.staging.stg_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.customer_email = DBT_INTERNAL_DEST.customer_email
                ) and (
                    DBT_INTERNAL_SOURCE.pet_dob = DBT_INTERNAL_DEST.pet_dob
                ) and (
                    DBT_INTERNAL_SOURCE.pet_name = DBT_INTERNAL_DEST.pet_name
                ) and (
                    DBT_INTERNAL_SOURCE.pet_breed = DBT_INTERNAL_DEST.pet_breed
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_EMAIL" = DBT_INTERNAL_SOURCE."CUSTOMER_EMAIL","PET_DOB" = DBT_INTERNAL_SOURCE."PET_DOB","PET_NAME" = DBT_INTERNAL_SOURCE."PET_NAME","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","PET_BREED" = DBT_INTERNAL_SOURCE."PET_BREED","PET_GENDER" = DBT_INTERNAL_SOURCE."PET_GENDER","PET_SPECIES" = DBT_INTERNAL_SOURCE."PET_SPECIES","PEDIGREE_TYPE" = DBT_INTERNAL_SOURCE."PEDIGREE_TYPE","SPAYED_NEUTERED" = DBT_INTERNAL_SOURCE."SPAYED_NEUTERED","PET_POSTCODE" = DBT_INTERNAL_SOURCE."PET_POSTCODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","CESSATION_DATE" = DBT_INTERNAL_SOURCE."CESSATION_DATE","AFFILIATE_CODE" = DBT_INTERNAL_SOURCE."AFFILIATE_CODE","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","EVENT_TIME" = DBT_INTERNAL_SOURCE."EVENT_TIME","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")
    values
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")

;
[0m00:09:54.302022 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.350 seconds
[0m00:09:54.302022 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:09:54.302022 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
COMMIT
[0m00:09:54.518350 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.217 seconds
[0m00:09:54.533781 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_orders__dbt_tmp
[0m00:09:54.533781 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:09:54.533781 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
drop view if exists DEV.staging.stg_orders__dbt_tmp cascade
[0m00:09:54.677881 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.132 seconds
[0m00:09:54.680884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70a8533a-9ac4-442b-8ea8-f57a453f10e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025897894F70>]}
[0m00:09:54.681884 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model staging.stg_orders ..................... [[32mSUCCESS 0[0m in 2.70s]
[0m00:09:54.683884 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m00:09:54.684880 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m00:09:54.685884 [info ] [Thread-1 (]: 3 of 5 START sql incremental model odl.dim_customers ........................... [RUN]
[0m00:09:54.688376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_orders, now model.ManyPets.dim_customers)
[0m00:09:54.688376 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m00:09:54.718375 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m00:09:54.719436 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m00:09:54.727418 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:09:54.729425 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace  temporary view DEV.odl.dim_customers__dbt_tmp
  
   as (
    
WITH stg_data AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date  
    FROM DEV.staging.stg_orders
    
    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.dim_customers)
    
),
dedup AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date,
        ROW_NUMBER() OVER (PARTITION BY customer_email ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    customer_email                                                          AS customer_nk, 
    md5(cast(coalesce(cast(customer_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                 AS customer_sk,
    customer_name,
    customer_dob,
    customer_phone,
    customer_address,
    customer_city,
    customer_country,
    customer_postcode,
    ingest_date
FROM dedup
WHERE rnk = 1
  );
[0m00:09:55.020840 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.301 seconds
[0m00:09:55.035989 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:09:55.035989 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table DEV.odl.dim_customers__dbt_tmp
[0m00:09:55.136402 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.097 seconds
[0m00:09:55.136402 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:09:55.136402 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table DEV.odl.dim_customers
[0m00:09:55.227270 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.078 seconds
[0m00:09:55.242893 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:09:55.242893 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table "DEV"."ODL"."DIM_CUSTOMERS"
[0m00:09:55.305808 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.065 seconds
[0m00:09:55.321031 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_customers"
[0m00:09:55.336645 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:09:55.336645 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m00:09:55.437918 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.102 seconds
[0m00:09:55.437918 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:09:55.437918 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
merge into DEV.odl.dim_customers as DBT_INTERNAL_DEST
        using DEV.odl.dim_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.customer_nk = DBT_INTERNAL_DEST.customer_nk))

    
    when matched then update set
        "CUSTOMER_NK" = DBT_INTERNAL_SOURCE."CUSTOMER_NK","CUSTOMER_SK" = DBT_INTERNAL_SOURCE."CUSTOMER_SK","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("CUSTOMER_NK", "CUSTOMER_SK", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "INGEST_DATE")
    values
        ("CUSTOMER_NK", "CUSTOMER_SK", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "INGEST_DATE")

;
[0m00:09:56.543013 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.107 seconds
[0m00:09:56.543013 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:09:56.543013 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
COMMIT
[0m00:09:56.793675 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.239 seconds
[0m00:09:56.799654 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_customers__dbt_tmp
[0m00:09:56.801664 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:09:56.801664 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
drop view if exists DEV.odl.dim_customers__dbt_tmp cascade
[0m00:09:56.929682 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.133 seconds
[0m00:09:56.945128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70a8533a-9ac4-442b-8ea8-f57a453f10e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258979429E0>]}
[0m00:09:56.945128 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model odl.dim_customers ...................... [[32mSUCCESS 0[0m in 2.26s]
[0m00:09:56.945128 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m00:09:56.945128 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_pets
[0m00:09:56.945128 [info ] [Thread-1 (]: 4 of 5 START sql incremental model odl.dim_pets ................................ [RUN]
[0m00:09:56.945128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_customers, now model.ManyPets.dim_pets)
[0m00:09:56.960944 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_pets
[0m00:09:56.976283 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_pets"
[0m00:09:56.978807 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_pets
[0m00:09:56.978807 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:09:56.978807 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
create or replace  temporary view DEV.odl.dim_pets__dbt_tmp
  
   as (
    

WITH stg_data AS (
    SELECT
        customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date
    FROM DEV.staging.stg_orders
    
    
        WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.dim_pets)
    
),

dedup AS (
    SELECT
        customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date,
        ROW_NUMBER() OVER(PARTITION BY customer_email, pet_dob, pet_name, pet_breed ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    d.customer_email ||'|'||d.pet_name || '|' || d.pet_dob || '|' || d.pet_breed      AS pet_nk,  
    md5(cast(coalesce(cast(pet_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                                AS pet_sk,  
    d.pet_name,
    d.pet_dob,
    d.pet_breed,
    d.pet_gender,
    d.pet_species,
    d.pedigree_type,
    d.spayed_neutered,
    d.pet_postcode,
    d.pet_value,
    d.ingest_date,
    c.customer_sk
FROM dedup AS d
    INNER JOIN DEV.odl.dim_customers AS c ON (c.customer_nk=d.customer_email)
WHERE d.rnk = 1
  );
[0m00:09:57.299313 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.313 seconds
[0m00:09:57.299313 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:09:57.299313 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
describe table DEV.odl.dim_pets__dbt_tmp
[0m00:09:57.399970 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.096 seconds
[0m00:09:57.399970 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:09:57.399970 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
describe table DEV.odl.dim_pets
[0m00:09:57.500206 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.086 seconds
[0m00:09:57.500206 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:09:57.515841 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
describe table "DEV"."ODL"."DIM_PETS"
[0m00:09:57.585669 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.079 seconds
[0m00:09:57.600913 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_pets"
[0m00:09:57.600913 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:09:57.600913 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
-- back compat for old kwarg name
  
  begin;
[0m00:09:57.701298 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.100 seconds
[0m00:09:57.716605 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:09:57.716605 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
merge into DEV.odl.dim_pets as DBT_INTERNAL_DEST
        using DEV.odl.dim_pets__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.pet_nk = DBT_INTERNAL_DEST.pet_nk))

    
    when matched then update set
        "PET_NK" = DBT_INTERNAL_SOURCE."PET_NK","PET_SK" = DBT_INTERNAL_SOURCE."PET_SK","PET_NAME" = DBT_INTERNAL_SOURCE."PET_NAME","PET_DOB" = DBT_INTERNAL_SOURCE."PET_DOB","PET_BREED" = DBT_INTERNAL_SOURCE."PET_BREED","PET_GENDER" = DBT_INTERNAL_SOURCE."PET_GENDER","PET_SPECIES" = DBT_INTERNAL_SOURCE."PET_SPECIES","PEDIGREE_TYPE" = DBT_INTERNAL_SOURCE."PEDIGREE_TYPE","SPAYED_NEUTERED" = DBT_INTERNAL_SOURCE."SPAYED_NEUTERED","PET_POSTCODE" = DBT_INTERNAL_SOURCE."PET_POSTCODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE","CUSTOMER_SK" = DBT_INTERNAL_SOURCE."CUSTOMER_SK"
    

    when not matched then insert
        ("PET_NK", "PET_SK", "PET_NAME", "PET_DOB", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "INGEST_DATE", "CUSTOMER_SK")
    values
        ("PET_NK", "PET_SK", "PET_NAME", "PET_DOB", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "INGEST_DATE", "CUSTOMER_SK")

;
[0m00:09:58.851332 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.141 seconds
[0m00:09:58.851332 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:09:58.866759 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
COMMIT
[0m00:09:59.121267 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.257 seconds
[0m00:09:59.121267 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_pets__dbt_tmp
[0m00:09:59.121267 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:09:59.121267 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
drop view if exists DEV.odl.dim_pets__dbt_tmp cascade
[0m00:09:59.250981 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.122 seconds
[0m00:09:59.250981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70a8533a-9ac4-442b-8ea8-f57a453f10e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258979A2D40>]}
[0m00:09:59.250981 [info ] [Thread-1 (]: 4 of 5 OK created sql incremental model odl.dim_pets ........................... [[32mSUCCESS 0[0m in 2.31s]
[0m00:09:59.250981 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_pets
[0m00:09:59.266331 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m00:09:59.266331 [info ] [Thread-1 (]: 5 of 5 START sql incremental model odl.fact_orders ............................. [RUN]
[0m00:09:59.266331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_pets, now model.ManyPets.fact_orders)
[0m00:09:59.274537 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_orders
[0m00:09:59.278602 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_orders"
[0m00:09:59.278602 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_orders
[0m00:09:59.310031 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.fact_orders"
[0m00:09:59.324992 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:09:59.324992 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
create or replace transient table DEV.odl.fact_orders
         as
        ( 
WITH fact_data AS (
    SELECT 
        f.order_id,
        f.order_date,
        f.cessation_date,
        f.affiliate_code,
        f.pet_value,
        f.source,
        f.event_type,
        /*f.event_time,
        f.envelope_version,
        f.detail_version,
        f.intent,
        f.tenant,
        f.experiments,*/
        c.customer_sk,
        p.pet_sk,
        f.ingest_date
    FROM DEV.staging.stg_orders f
    LEFT JOIN DEV.odl.dim_customers c 
        ON f.customer_email = c.customer_nk
    LEFT JOIN DEV.odl.dim_pets p 
        ON f.pet_name = p.pet_name 
        AND f.pet_dob = p.pet_dob
        AND f.pet_breed = p.pet_breed
    
)

, dedup AS (
    SELECT 
        f.*,
        ROW_NUMBER() OVER(PARTITION BY f.order_id, f.customer_sk, f.pet_sk ORDER BY f.ingest_date DESC) AS rnk
    FROM fact_data f
)

SELECT 
     order_id || '|' || customer_sk || '|'|| pet_sk         AS order_nk,
    md5(cast(coalesce(cast(order_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))    AS order_sk,
    customer_sk                                             AS customer_sk,
    pet_sk                                                  AS pet_sk,
    order_date                                              AS order_date,
    cessation_date                                          AS cessation_date,
    COALESCE(affiliate_code, 'unknown')                     AS affiliate_code,
    pet_value                                               AS pet_value,
    source                                                  AS order_source,
    event_type                                              AS order_type,
/*
    event_time,
    envelope_version,
    detail_version,
    intent,
    tenant,
    experiments,
*/
    ingest_date
FROM dedup
WHERE rnk = 1
        );
[0m00:10:00.897495 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.580 seconds
[0m00:10:00.912832 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.fact_orders__dbt_tmp
[0m00:10:00.912832 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:10:00.912832 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
drop view if exists DEV.odl.fact_orders__dbt_tmp cascade
[0m00:10:00.997902 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.085 seconds
[0m00:10:00.997902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70a8533a-9ac4-442b-8ea8-f57a453f10e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025897903490>]}
[0m00:10:00.997902 [info ] [Thread-1 (]: 5 of 5 OK created sql incremental model odl.fact_orders ........................ [[32mSUCCESS 1[0m in 1.73s]
[0m00:10:01.013269 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m00:10:01.013269 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:10:01.013269 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m00:10:01.013269 [debug] [MainThread]: On list_DEV: Close
[0m00:10:01.121660 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m00:10:01.121660 [debug] [MainThread]: On list_DEV_staging: Close
[0m00:10:01.246140 [debug] [MainThread]: Connection 'model.ManyPets.fact_orders' was left open.
[0m00:10:01.246140 [debug] [MainThread]: On model.ManyPets.fact_orders: Close
[0m00:10:01.346237 [info ] [MainThread]: 
[0m00:10:01.346237 [info ] [MainThread]: Finished running 5 incremental models in 0 hours 0 minutes and 13.31 seconds (13.31s).
[0m00:10:01.346237 [debug] [MainThread]: Command end result
[0m00:10:01.483815 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m00:10:01.499453 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m00:10:01.499453 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m00:10:01.499453 [info ] [MainThread]: 
[0m00:10:01.499453 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:10:01.515078 [info ] [MainThread]: 
[0m00:10:01.515078 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m00:10:01.515078 [debug] [MainThread]: Command `dbt run` succeeded at 00:10:01.515078 after 15.53 seconds
[0m00:10:01.515078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025893286080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025895DEBA60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025896FEE2C0>]}
[0m00:10:01.515078 [debug] [MainThread]: Flushing usage events
[0m00:10:02.064641 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:15:14.238522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D5CB75FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D5EA6C040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D5EA6E1A0>]}


============================== 00:15:14.243507 | 4740b4b6-4b2b-457e-9eb9-8cd73b65efa5 ==============================
[0m00:15:14.243507 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:15:14.245833 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:15:15.039645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4740b4b6-4b2b-457e-9eb9-8cd73b65efa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D5B3F9C60>]}
[0m00:15:15.139679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4740b4b6-4b2b-457e-9eb9-8cd73b65efa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D5EAB3D90>]}
[0m00:15:15.142697 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m00:15:15.688999 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:15:16.071202 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:15:16.072204 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:15:16.165833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4740b4b6-4b2b-457e-9eb9-8cd73b65efa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D60968130>]}
[0m00:15:16.412786 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m00:15:16.419786 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m00:15:16.627290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4740b4b6-4b2b-457e-9eb9-8cd73b65efa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D60975F30>]}
[0m00:15:16.628299 [info ] [MainThread]: Found 6 models, 11 data tests, 2 sources, 591 macros
[0m00:15:16.630292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4740b4b6-4b2b-457e-9eb9-8cd73b65efa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D608E4730>]}
[0m00:15:16.633294 [info ] [MainThread]: 
[0m00:15:16.634305 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:15:16.636294 [info ] [MainThread]: 
[0m00:15:16.638298 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:15:16.655315 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m00:15:16.795307 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m00:15:16.795307 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m00:15:16.796308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:15:17.504589 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.708 seconds
[0m00:15:17.508582 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m00:15:17.516952 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m00:15:17.517949 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m00:15:17.667272 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.149 seconds
[0m00:15:17.679751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4740b4b6-4b2b-457e-9eb9-8cd73b65efa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D60975ED0>]}
[0m00:15:17.694671 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m00:15:17.696668 [info ] [Thread-1 (]: 1 of 11 START test not_null_stg_order_complete_customer_id ..................... [RUN]
[0m00:15:17.698679 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b'
[0m00:15:17.700664 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m00:15:17.769085 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b"
[0m00:15:17.776235 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m00:15:17.807843 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b"
[0m00:15:17.811945 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b"
[0m00:15:17.812945 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from DEV.staging.stg_order_complete
where customer_id is null



      
    ) dbt_internal_test
[0m00:15:17.813945 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:15:18.518805 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.704 seconds
[0m00:15:18.545193 [info ] [Thread-1 (]: 1 of 11 PASS not_null_stg_order_complete_customer_id ........................... [[32mPASS[0m in 0.85s]
[0m00:15:18.547194 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m00:15:18.547194 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m00:15:18.548627 [info ] [Thread-1 (]: 2 of 11 START test not_null_stg_order_complete_ingest_date ..................... [RUN]
[0m00:15:18.549402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b, now test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec)
[0m00:15:18.550419 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m00:15:18.558254 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m00:15:18.560995 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m00:15:18.571984 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m00:15:18.575986 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m00:15:18.576984 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ingest_date
from DEV.staging.stg_order_complete
where ingest_date is null



      
    ) dbt_internal_test
[0m00:15:18.888296 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.310 seconds
[0m00:15:18.892290 [info ] [Thread-1 (]: 2 of 11 PASS not_null_stg_order_complete_ingest_date ........................... [[32mPASS[0m in 0.34s]
[0m00:15:18.894288 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m00:15:18.895284 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m00:15:18.896288 [info ] [Thread-1 (]: 3 of 11 START test not_null_stg_order_complete_order_id ........................ [RUN]
[0m00:15:18.897286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec, now test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce)
[0m00:15:18.898290 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m00:15:18.904290 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m00:15:18.909968 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m00:15:18.919001 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m00:15:18.921968 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m00:15:18.922970 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from DEV.staging.stg_order_complete
where order_id is null



      
    ) dbt_internal_test
[0m00:15:19.197608 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.273 seconds
[0m00:15:19.206609 [info ] [Thread-1 (]: 3 of 11 PASS not_null_stg_order_complete_order_id .............................. [[32mPASS[0m in 0.31s]
[0m00:15:19.211617 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m00:15:19.214617 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_order_id__customer_id__pet_id__ingest_date.125d0b22e9
[0m00:15:19.217616 [info ] [Thread-1 (]: 4 of 11 START test not_null_stg_order_complete_order_id__customer_id__pet_id__ingest_date  [RUN]
[0m00:15:19.222278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce, now test.ManyPets.not_null_stg_order_complete_order_id__customer_id__pet_id__ingest_date.125d0b22e9)
[0m00:15:19.228275 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_order_id__customer_id__pet_id__ingest_date.125d0b22e9
[0m00:15:19.313282 [debug] [Thread-1 (]: Compilation Error in test not_null_stg_order_complete_order_id__customer_id__pet_id__ingest_date (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_not_null' takes no keyword argument 'columns'
[0m00:15:19.315293 [error] [Thread-1 (]: 4 of 11 ERROR not_null_stg_order_complete_order_id__customer_id__pet_id__ingest_date  [[31mERROR[0m in 0.09s]
[0m00:15:19.317283 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_order_id__customer_id__pet_id__ingest_date.125d0b22e9
[0m00:15:19.318284 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m00:15:19.320303 [debug] [Thread-4 (]: Marking all children of 'test.ManyPets.not_null_stg_order_complete_order_id__customer_id__pet_id__ingest_date.125d0b22e9' to be skipped because of status 'error'.  Reason: Compilation Error in test not_null_stg_order_complete_order_id__customer_id__pet_id__ingest_date (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_not_null' takes no keyword argument 'columns'.
[0m00:15:19.321285 [info ] [Thread-1 (]: 5 of 11 START test not_null_stg_order_complete_pet_id .......................... [RUN]
[0m00:15:19.326286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_order_id__customer_id__pet_id__ingest_date.125d0b22e9, now test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1)
[0m00:15:19.327285 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m00:15:19.339292 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1"
[0m00:15:19.344956 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m00:15:19.355961 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1"
[0m00:15:19.360966 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1"
[0m00:15:19.362967 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pet_id
from DEV.staging.stg_order_complete
where pet_id is null



      
    ) dbt_internal_test
[0m00:15:19.672417 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.307 seconds
[0m00:15:19.682007 [info ] [Thread-1 (]: 5 of 11 PASS not_null_stg_order_complete_pet_id ................................ [[32mPASS[0m in 0.36s]
[0m00:15:19.686008 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m00:15:19.688008 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_email.5fa7373d74
[0m00:15:19.690009 [info ] [Thread-1 (]: 6 of 11 START test not_null_stg_orders_email ................................... [RUN]
[0m00:15:19.692114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1, now test.ManyPets.not_null_stg_orders_email.5fa7373d74)
[0m00:15:19.694113 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_email.5fa7373d74
[0m00:15:19.712113 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_email.5fa7373d74"
[0m00:15:19.715112 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_email.5fa7373d74
[0m00:15:19.720107 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_email.5fa7373d74"
[0m00:15:19.723114 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_email.5fa7373d74"
[0m00:15:19.725127 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_email.5fa7373d74: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_email.5fa7373d74"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from DEV.staging.stg_orders
where email is null



      
    ) dbt_internal_test
[0m00:15:19.916029 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0e8a-0000-e37b-0001-b3ce0001b2fa
[0m00:15:19.919032 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'EMAIL'
[0m00:15:19.926943 [debug] [Thread-1 (]: Database Error in test not_null_stg_orders_email (models\staging\staging_schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'EMAIL'
  compiled code at target\run\ManyPets\models\staging\staging_schema.yml\not_null_stg_orders_email.sql
[0m00:15:19.928942 [error] [Thread-1 (]: 6 of 11 ERROR not_null_stg_orders_email ........................................ [[31mERROR[0m in 0.24s]
[0m00:15:19.930944 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_email.5fa7373d74
[0m00:15:19.932943 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m00:15:19.933969 [debug] [Thread-4 (]: Marking all children of 'test.ManyPets.not_null_stg_orders_email.5fa7373d74' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_orders_email (models\staging\staging_schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'EMAIL'
  compiled code at target\run\ManyPets\models\staging\staging_schema.yml\not_null_stg_orders_email.sql.
[0m00:15:19.934933 [info ] [Thread-1 (]: 7 of 11 START test not_null_stg_orders_ingest_date ............................. [RUN]
[0m00:15:19.936937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_email.5fa7373d74, now test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e)
[0m00:15:19.937948 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m00:15:19.949937 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m00:15:19.951933 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m00:15:19.958931 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m00:15:19.962961 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m00:15:19.963934 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ingest_date
from DEV.staging.stg_orders
where ingest_date is null



      
    ) dbt_internal_test
[0m00:15:20.196714 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.231 seconds
[0m00:15:20.209142 [info ] [Thread-1 (]: 7 of 11 PASS not_null_stg_orders_ingest_date ................................... [[32mPASS[0m in 0.27s]
[0m00:15:20.215176 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m00:15:20.218154 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m00:15:20.220069 [info ] [Thread-1 (]: 8 of 11 START test not_null_stg_orders_order_id ................................ [RUN]
[0m00:15:20.224941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e, now test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64)
[0m00:15:20.227947 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m00:15:20.249955 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:15:20.256942 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m00:15:20.265940 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:15:20.269939 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:15:20.269939 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from DEV.staging.stg_orders
where order_id is null



      
    ) dbt_internal_test
[0m00:15:20.395281 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.124 seconds
[0m00:15:20.398276 [info ] [Thread-1 (]: 8 of 11 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 0.17s]
[0m00:15:20.400941 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m00:15:20.401920 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m00:15:20.401920 [info ] [Thread-1 (]: 9 of 11 START test not_null_stg_orders_pet_dob ................................. [RUN]
[0m00:15:20.403920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64, now test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6)
[0m00:15:20.404921 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m00:15:20.415230 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m00:15:20.417232 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m00:15:20.422228 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m00:15:20.427240 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m00:15:20.429251 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pet_dob
from DEV.staging.stg_orders
where pet_dob is null



      
    ) dbt_internal_test
[0m00:15:20.537326 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.108 seconds
[0m00:15:20.545168 [info ] [Thread-1 (]: 9 of 11 PASS not_null_stg_orders_pet_dob ....................................... [[32mPASS[0m in 0.14s]
[0m00:15:20.549357 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m00:15:20.551355 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m00:15:20.553346 [info ] [Thread-1 (]: 10 of 11 START test not_null_stg_orders_pet_name ............................... [RUN]
[0m00:15:20.556631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6, now test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5)
[0m00:15:20.559630 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m00:15:20.569629 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m00:15:20.576633 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m00:15:20.584624 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m00:15:20.586626 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m00:15:20.587624 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pet_name
from DEV.staging.stg_orders
where pet_name is null



      
    ) dbt_internal_test
[0m00:15:20.809403 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.220 seconds
[0m00:15:20.820402 [info ] [Thread-1 (]: 10 of 11 PASS not_null_stg_orders_pet_name ..................................... [[32mPASS[0m in 0.26s]
[0m00:15:20.827184 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m00:15:20.829174 [debug] [Thread-1 (]: Began running node test.ManyPets.unique_stg_order_complete_order_id__customer_id__pet_id.7ca998ef43
[0m00:15:20.831170 [info ] [Thread-1 (]: 11 of 11 START test unique_stg_order_complete_order_id__customer_id__pet_id .... [RUN]
[0m00:15:20.833801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5, now test.ManyPets.unique_stg_order_complete_order_id__customer_id__pet_id.7ca998ef43)
[0m00:15:20.836806 [debug] [Thread-1 (]: Began compiling node test.ManyPets.unique_stg_order_complete_order_id__customer_id__pet_id.7ca998ef43
[0m00:15:20.852813 [debug] [Thread-1 (]: Compilation Error in test unique_stg_order_complete_order_id__customer_id__pet_id (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'columns'
[0m00:15:20.853800 [error] [Thread-1 (]: 11 of 11 ERROR unique_stg_order_complete_order_id__customer_id__pet_id ......... [[31mERROR[0m in 0.02s]
[0m00:15:20.856797 [debug] [Thread-1 (]: Finished running node test.ManyPets.unique_stg_order_complete_order_id__customer_id__pet_id.7ca998ef43
[0m00:15:20.858840 [debug] [Thread-4 (]: Marking all children of 'test.ManyPets.unique_stg_order_complete_order_id__customer_id__pet_id.7ca998ef43' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_stg_order_complete_order_id__customer_id__pet_id (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'columns'.
[0m00:15:20.862801 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:15:20.862801 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m00:15:20.863814 [debug] [MainThread]: On list_DEV_staging: Close
[0m00:15:21.021516 [debug] [MainThread]: Connection 'test.ManyPets.unique_stg_order_complete_order_id__customer_id__pet_id.7ca998ef43' was left open.
[0m00:15:21.023410 [debug] [MainThread]: On test.ManyPets.unique_stg_order_complete_order_id__customer_id__pet_id.7ca998ef43: Close
[0m00:15:21.121353 [info ] [MainThread]: 
[0m00:15:21.126841 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 4.48 seconds (4.48s).
[0m00:15:21.141613 [debug] [MainThread]: Command end result
[0m00:15:21.222605 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m00:15:21.227605 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m00:15:21.242609 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m00:15:21.243605 [info ] [MainThread]: 
[0m00:15:21.245605 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m00:15:21.246605 [info ] [MainThread]: 
[0m00:15:21.247602 [error] [MainThread]:   Compilation Error in test not_null_stg_order_complete_order_id__customer_id__pet_id__ingest_date (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_not_null' takes no keyword argument 'columns'
[0m00:15:21.249604 [info ] [MainThread]: 
[0m00:15:21.251606 [error] [MainThread]:   Database Error in test not_null_stg_orders_email (models\staging\staging_schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'EMAIL'
  compiled code at target\run\ManyPets\models\staging\staging_schema.yml\not_null_stg_orders_email.sql
[0m00:15:21.257679 [info ] [MainThread]: 
[0m00:15:21.262624 [error] [MainThread]:   Compilation Error in test unique_stg_order_complete_order_id__customer_id__pet_id (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'columns'
[0m00:15:21.264607 [info ] [MainThread]: 
[0m00:15:21.265605 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=3 SKIP=0 TOTAL=11
[0m00:15:21.268604 [debug] [MainThread]: Command `dbt test` failed at 00:15:21.268604 after 7.17 seconds
[0m00:15:21.269604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D5CB75FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D5CE73A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D6139DA20>]}
[0m00:15:21.271604 [debug] [MainThread]: Flushing usage events
[0m00:15:21.782844 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:19:11.498900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE6A785FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE6C6AE920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE6C6AE740>]}


============================== 00:19:11.514528 | 998f193d-18d4-406a-8347-61d97f5a21a2 ==============================
[0m00:19:11.514528 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:19:11.514528 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:19:12.131365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '998f193d-18d4-406a-8347-61d97f5a21a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE6AADDED0>]}
[0m00:19:12.227388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '998f193d-18d4-406a-8347-61d97f5a21a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE6C51B2B0>]}
[0m00:19:12.235445 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m00:19:12.723750 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:19:13.076140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:19:13.076140 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:19:13.167342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '998f193d-18d4-406a-8347-61d97f5a21a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE6E578130>]}
[0m00:19:13.402311 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m00:19:13.402311 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m00:19:13.449055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '998f193d-18d4-406a-8347-61d97f5a21a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE6D2E8070>]}
[0m00:19:13.449055 [info ] [MainThread]: Found 6 models, 11 data tests, 2 sources, 591 macros
[0m00:19:13.449055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '998f193d-18d4-406a-8347-61d97f5a21a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE6E454370>]}
[0m00:19:13.449055 [info ] [MainThread]: 
[0m00:19:13.449055 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:19:13.449055 [info ] [MainThread]: 
[0m00:19:13.461120 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:19:13.485941 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m00:19:13.664758 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m00:19:13.664758 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m00:19:13.664758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:14.351222 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.691 seconds
[0m00:19:14.366864 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m00:19:14.366864 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m00:19:14.452240 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.085 seconds
[0m00:19:14.452240 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m00:19:14.467877 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m00:19:14.467877 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m00:19:14.467877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:14.938099 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.468 seconds
[0m00:19:14.938099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m00:19:14.953721 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m00:19:14.953721 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m00:19:15.070090 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.113 seconds
[0m00:19:15.070090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '998f193d-18d4-406a-8347-61d97f5a21a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE6E450B50>]}
[0m00:19:15.085736 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_order_complete
[0m00:19:15.085736 [info ] [Thread-1 (]: 1 of 5 START sql incremental model staging.stg_order_complete .................. [RUN]
[0m00:19:15.101357 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_order_complete'
[0m00:19:15.101357 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_order_complete
[0m00:19:15.137765 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_order_complete"
[0m00:19:15.137765 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_order_complete
[0m00:19:15.219150 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_order_complete"
[0m00:19:15.234765 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:19:15.234765 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
create or replace transient table DEV.staging.stg_order_complete
         as
        (

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING        AS order_id,
        data:detail:intent::STRING          AS intent,
        data:detail:tenant::STRING          AS tenant,
        data:detail:customer_id::STRING     AS customer_id,
        pet.value                           AS pet_id,  
        data:time::TIMESTAMP                AS event_time,
        data:source::STRING                 AS source,
        data:type::STRING                   AS event_type,
        ingest_date                         AS ingest_date
    FROM dev.rdl.order_complete o,
    LATERAL FLATTEN(input => o.data:detail:pet_ids) AS pet  

    
)
,
dedup AS (
    SELECT 
        *,
        ROW_NUMBER() OVER ( PARTITION BY order_id, customer_id, pet_id ORDER BY ingest_date DESC ) AS rnk
    FROM source_data
)
SELECT 
    order_id,
    customer_id,
    pet_id,
    intent,
    tenant,
    event_time,
    source,
    event_type,
    ingest_date
FROM dedup
WHERE rnk =1
        );
[0m00:19:15.234765 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:19:16.306919 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.072 seconds
[0m00:19:16.322534 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_order_complete__dbt_tmp
[0m00:19:16.322534 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:19:16.322534 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
drop view if exists DEV.staging.stg_order_complete__dbt_tmp cascade
[0m00:19:16.407777 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.077 seconds
[0m00:19:16.438728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '998f193d-18d4-406a-8347-61d97f5a21a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE68E002B0>]}
[0m00:19:16.438728 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model staging.stg_order_complete ............. [[32mSUCCESS 1[0m in 1.34s]
[0m00:19:16.438728 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_order_complete
[0m00:19:16.438728 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m00:19:16.438728 [info ] [Thread-1 (]: 2 of 5 START sql incremental model staging.stg_orders .......................... [RUN]
[0m00:19:16.438728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_order_complete, now model.ManyPets.stg_orders)
[0m00:19:16.438728 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m00:19:16.462990 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m00:19:16.464030 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m00:19:16.493910 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:19:16.493910 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace  temporary view DEV.staging.stg_orders__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS event_type,
        data:time::TIMESTAMP                            AS event_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_orders)
    
),
dedup AS
(
    SELECT
        *
        ,ROW_NUMBER() OVER(PARTITION BY order_id, email, pet_dob, pet_name, pet_breed  ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)
SELECT 
    order_id ,
    email AS customer_email,
    pet_dob,
    pet_name,
    COALESCE(NULLIF(TRIM(COALESCE(first_name, '') || ' ' || COALESCE(last_name, '')), ''), 'unknown') AS customer_name,
    dob                                         AS customer_dob,
    phone                                       AS customer_phone,
    address_line1 || ' ' || address_line2       AS customer_address,
    city                                        AS customer_city,
    country                                     AS customer_country,
    postcode                                    AS customer_postcode,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_date,
    cessation_date,
    affiliate_code,
    source,
    event_type,
    event_time,
    ingest_date
FROM dedup
WHERE 
    rnk =1
  );
[0m00:19:16.994582 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.502 seconds
[0m00:19:17.009785 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:19:17.009785 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders__dbt_tmp
[0m00:19:17.100865 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.100 seconds
[0m00:19:17.116151 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:19:17.116151 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders
[0m00:19:17.179378 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.063 seconds
[0m00:19:17.194539 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:19:17.194539 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table "DEV"."STAGING"."STG_ORDERS"
[0m00:19:17.279853 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.083 seconds
[0m00:19:17.326328 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m00:19:17.341946 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:19:17.341946 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m00:19:17.426855 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.092 seconds
[0m00:19:17.426855 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:19:17.426855 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
merge into DEV.staging.stg_orders as DBT_INTERNAL_DEST
        using DEV.staging.stg_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.customer_email = DBT_INTERNAL_DEST.customer_email
                ) and (
                    DBT_INTERNAL_SOURCE.pet_dob = DBT_INTERNAL_DEST.pet_dob
                ) and (
                    DBT_INTERNAL_SOURCE.pet_name = DBT_INTERNAL_DEST.pet_name
                ) and (
                    DBT_INTERNAL_SOURCE.pet_breed = DBT_INTERNAL_DEST.pet_breed
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_EMAIL" = DBT_INTERNAL_SOURCE."CUSTOMER_EMAIL","PET_DOB" = DBT_INTERNAL_SOURCE."PET_DOB","PET_NAME" = DBT_INTERNAL_SOURCE."PET_NAME","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","PET_BREED" = DBT_INTERNAL_SOURCE."PET_BREED","PET_GENDER" = DBT_INTERNAL_SOURCE."PET_GENDER","PET_SPECIES" = DBT_INTERNAL_SOURCE."PET_SPECIES","PEDIGREE_TYPE" = DBT_INTERNAL_SOURCE."PEDIGREE_TYPE","SPAYED_NEUTERED" = DBT_INTERNAL_SOURCE."SPAYED_NEUTERED","PET_POSTCODE" = DBT_INTERNAL_SOURCE."PET_POSTCODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","CESSATION_DATE" = DBT_INTERNAL_SOURCE."CESSATION_DATE","AFFILIATE_CODE" = DBT_INTERNAL_SOURCE."AFFILIATE_CODE","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","EVENT_TIME" = DBT_INTERNAL_SOURCE."EVENT_TIME","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")
    values
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")

;
[0m00:19:18.547287 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.109 seconds
[0m00:19:18.547287 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:19:18.547287 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
COMMIT
[0m00:19:18.770659 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.225 seconds
[0m00:19:18.786336 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_orders__dbt_tmp
[0m00:19:18.786336 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:19:18.786336 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
drop view if exists DEV.staging.stg_orders__dbt_tmp cascade
[0m00:19:18.902244 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.111 seconds
[0m00:19:18.902244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '998f193d-18d4-406a-8347-61d97f5a21a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE6ED78A60>]}
[0m00:19:18.902244 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model staging.stg_orders ..................... [[32mSUCCESS 0[0m in 2.46s]
[0m00:19:18.917865 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m00:19:18.917865 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m00:19:18.917865 [info ] [Thread-1 (]: 3 of 5 START sql incremental model odl.dim_customers ........................... [RUN]
[0m00:19:18.917865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_orders, now model.ManyPets.dim_customers)
[0m00:19:18.927022 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m00:19:18.968843 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m00:19:18.970820 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m00:19:18.986184 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:19:18.986184 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace  temporary view DEV.odl.dim_customers__dbt_tmp
  
   as (
    
WITH stg_data AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date  
    FROM DEV.staging.stg_orders
    
    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.dim_customers)
    
),
dedup AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date,
        ROW_NUMBER() OVER (PARTITION BY customer_email ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    customer_email                                                          AS customer_nk, 
    md5(cast(coalesce(cast(customer_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                 AS customer_sk,
    customer_name,
    customer_dob,
    customer_phone,
    customer_address,
    customer_city,
    customer_country,
    customer_postcode,
    ingest_date
FROM dedup
WHERE rnk = 1
  );
[0m00:19:19.287831 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.297 seconds
[0m00:19:19.287831 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:19:19.287831 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table DEV.odl.dim_customers__dbt_tmp
[0m00:19:19.388554 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.095 seconds
[0m00:19:19.403797 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:19:19.403797 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table DEV.odl.dim_customers
[0m00:19:19.472815 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.072 seconds
[0m00:19:19.488474 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:19:19.488474 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table "DEV"."ODL"."DIM_CUSTOMERS"
[0m00:19:19.551444 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.069 seconds
[0m00:19:19.573142 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_customers"
[0m00:19:19.588795 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:19:19.588795 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m00:19:19.673372 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.089 seconds
[0m00:19:19.673372 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:19:19.673372 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
merge into DEV.odl.dim_customers as DBT_INTERNAL_DEST
        using DEV.odl.dim_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.customer_nk = DBT_INTERNAL_DEST.customer_nk))

    
    when matched then update set
        "CUSTOMER_NK" = DBT_INTERNAL_SOURCE."CUSTOMER_NK","CUSTOMER_SK" = DBT_INTERNAL_SOURCE."CUSTOMER_SK","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("CUSTOMER_NK", "CUSTOMER_SK", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "INGEST_DATE")
    values
        ("CUSTOMER_NK", "CUSTOMER_SK", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "INGEST_DATE")

;
[0m00:19:20.492612 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.810 seconds
[0m00:19:20.492612 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:19:20.492612 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
COMMIT
[0m00:19:20.719999 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.225 seconds
[0m00:19:20.719999 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_customers__dbt_tmp
[0m00:19:20.735381 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:19:20.735381 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
drop view if exists DEV.odl.dim_customers__dbt_tmp cascade
[0m00:19:20.860915 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.133 seconds
[0m00:19:20.876143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '998f193d-18d4-406a-8347-61d97f5a21a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE6EDB2290>]}
[0m00:19:20.878656 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model odl.dim_customers ...................... [[32mSUCCESS 0[0m in 1.96s]
[0m00:19:20.878656 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m00:19:20.878656 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_pets
[0m00:19:20.878656 [info ] [Thread-1 (]: 4 of 5 START sql incremental model odl.dim_pets ................................ [RUN]
[0m00:19:20.878656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_customers, now model.ManyPets.dim_pets)
[0m00:19:20.892041 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_pets
[0m00:19:20.909344 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_pets"
[0m00:19:20.909344 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_pets
[0m00:19:20.916029 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:19:20.916029 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
create or replace  temporary view DEV.odl.dim_pets__dbt_tmp
  
   as (
    

WITH stg_data AS (
    SELECT
        customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date
    FROM DEV.staging.stg_orders
    
    
        WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.dim_pets)
    
),

dedup AS (
    SELECT
        customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date,
        ROW_NUMBER() OVER(PARTITION BY customer_email, pet_dob, pet_name, pet_breed ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    d.customer_email ||'|'||d.pet_name || '|' || d.pet_dob || '|' || d.pet_breed      AS pet_nk,  
    md5(cast(coalesce(cast(pet_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                                AS pet_sk,  
    d.pet_name,
    d.pet_dob,
    d.pet_breed,
    d.pet_gender,
    d.pet_species,
    d.pedigree_type,
    d.spayed_neutered,
    d.pet_postcode,
    d.pet_value,
    d.ingest_date,
    c.customer_sk
FROM dedup AS d
    INNER JOIN DEV.odl.dim_customers AS c ON (c.customer_nk=d.customer_email)
WHERE d.rnk = 1
  );
[0m00:19:21.298353 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.378 seconds
[0m00:19:21.313983 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:19:21.313983 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
describe table DEV.odl.dim_pets__dbt_tmp
[0m00:19:21.412132 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.089 seconds
[0m00:19:21.412132 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:19:21.412132 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
describe table DEV.odl.dim_pets
[0m00:19:21.481384 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.073 seconds
[0m00:19:21.497037 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:19:21.497037 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
describe table "DEV"."ODL"."DIM_PETS"
[0m00:19:21.575416 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.072 seconds
[0m00:19:21.581462 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_pets"
[0m00:19:21.597128 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:19:21.597128 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
-- back compat for old kwarg name
  
  begin;
[0m00:19:21.698259 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.100 seconds
[0m00:19:21.698259 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:19:21.698259 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
merge into DEV.odl.dim_pets as DBT_INTERNAL_DEST
        using DEV.odl.dim_pets__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.pet_nk = DBT_INTERNAL_DEST.pet_nk))

    
    when matched then update set
        "PET_NK" = DBT_INTERNAL_SOURCE."PET_NK","PET_SK" = DBT_INTERNAL_SOURCE."PET_SK","PET_NAME" = DBT_INTERNAL_SOURCE."PET_NAME","PET_DOB" = DBT_INTERNAL_SOURCE."PET_DOB","PET_BREED" = DBT_INTERNAL_SOURCE."PET_BREED","PET_GENDER" = DBT_INTERNAL_SOURCE."PET_GENDER","PET_SPECIES" = DBT_INTERNAL_SOURCE."PET_SPECIES","PEDIGREE_TYPE" = DBT_INTERNAL_SOURCE."PEDIGREE_TYPE","SPAYED_NEUTERED" = DBT_INTERNAL_SOURCE."SPAYED_NEUTERED","PET_POSTCODE" = DBT_INTERNAL_SOURCE."PET_POSTCODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE","CUSTOMER_SK" = DBT_INTERNAL_SOURCE."CUSTOMER_SK"
    

    when not matched then insert
        ("PET_NK", "PET_SK", "PET_NAME", "PET_DOB", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "INGEST_DATE", "CUSTOMER_SK")
    values
        ("PET_NK", "PET_SK", "PET_NAME", "PET_DOB", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "INGEST_DATE", "CUSTOMER_SK")

;
[0m00:19:22.686709 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.979 seconds
[0m00:19:22.686709 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:19:22.692728 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
COMMIT
[0m00:19:22.896926 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.202 seconds
[0m00:19:22.896926 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_pets__dbt_tmp
[0m00:19:22.896926 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:19:22.896926 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
drop view if exists DEV.odl.dim_pets__dbt_tmp cascade
[0m00:19:23.025089 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.127 seconds
[0m00:19:23.040503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '998f193d-18d4-406a-8347-61d97f5a21a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE6EDB8340>]}
[0m00:19:23.040503 [info ] [Thread-1 (]: 4 of 5 OK created sql incremental model odl.dim_pets ........................... [[32mSUCCESS 0[0m in 2.15s]
[0m00:19:23.040503 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_pets
[0m00:19:23.040503 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m00:19:23.040503 [info ] [Thread-1 (]: 5 of 5 START sql incremental model odl.fact_orders ............................. [RUN]
[0m00:19:23.056108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_pets, now model.ManyPets.fact_orders)
[0m00:19:23.058998 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_orders
[0m00:19:23.072119 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_orders"
[0m00:19:23.073217 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_orders
[0m00:19:23.082712 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:19:23.082712 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
create or replace  temporary view DEV.odl.fact_orders__dbt_tmp
  
   as (
     
WITH fact_data AS (
    SELECT 
        f.order_id,
        f.order_date,
        f.cessation_date,
        f.affiliate_code,
        f.pet_value,
        f.source,
        f.event_type,
        /*f.event_time,
        f.envelope_version,
        f.detail_version,
        f.intent,
        f.tenant,
        f.experiments,*/
        c.customer_sk,
        p.pet_sk,
        f.ingest_date
    FROM DEV.staging.stg_orders f
    LEFT JOIN DEV.odl.dim_customers c 
        ON f.customer_email = c.customer_nk
    LEFT JOIN DEV.odl.dim_pets p 
        ON f.pet_name = p.pet_name 
        AND f.pet_dob = p.pet_dob
        AND f.pet_breed = p.pet_breed
        
    
        WHERE f.ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.fact_orders)
    
)

, dedup AS (
    SELECT 
        f.*,
        ROW_NUMBER() OVER(PARTITION BY f.order_id, f.customer_sk, f.pet_sk ORDER BY f.ingest_date DESC) AS rnk
    FROM fact_data f
)

SELECT 
     order_id || '|' || customer_sk || '|'|| pet_sk         AS order_nk,
    md5(cast(coalesce(cast(order_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))    AS order_sk,
    customer_sk                                             AS customer_sk,
    pet_sk                                                  AS pet_sk,
    order_date                                              AS order_date,
    cessation_date                                          AS cessation_date,
    COALESCE(affiliate_code, 'unknown')                     AS affiliate_code,
    pet_value                                               AS pet_value,
    source                                                  AS order_source,
    event_type                                              AS order_type,
/*
    event_time,
    envelope_version,
    detail_version,
    intent,
    tenant,
    experiments,
*/
    ingest_date
FROM dedup
WHERE rnk = 1
  );
[0m00:19:23.408024 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.320 seconds
[0m00:19:23.412691 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:19:23.412691 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
describe table DEV.odl.fact_orders__dbt_tmp
[0m00:19:23.496207 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.091 seconds
[0m00:19:23.511869 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:19:23.527489 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
describe table DEV.odl.fact_orders
[0m00:19:23.596902 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.082 seconds
[0m00:19:23.675048 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:19:23.675048 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
describe table "DEV"."ODL"."FACT_ORDERS"
[0m00:19:23.759892 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.076 seconds
[0m00:19:23.759892 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.fact_orders"
[0m00:19:23.759892 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:19:23.759892 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m00:19:23.860088 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.099 seconds
[0m00:19:23.875299 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:19:23.875299 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
merge into DEV.odl.fact_orders as DBT_INTERNAL_DEST
        using DEV.odl.fact_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_nk = DBT_INTERNAL_DEST.order_nk))

    
    when matched then update set
        "ORDER_NK" = DBT_INTERNAL_SOURCE."ORDER_NK","ORDER_SK" = DBT_INTERNAL_SOURCE."ORDER_SK","CUSTOMER_SK" = DBT_INTERNAL_SOURCE."CUSTOMER_SK","PET_SK" = DBT_INTERNAL_SOURCE."PET_SK","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","CESSATION_DATE" = DBT_INTERNAL_SOURCE."CESSATION_DATE","AFFILIATE_CODE" = DBT_INTERNAL_SOURCE."AFFILIATE_CODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","ORDER_SOURCE" = DBT_INTERNAL_SOURCE."ORDER_SOURCE","ORDER_TYPE" = DBT_INTERNAL_SOURCE."ORDER_TYPE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_NK", "ORDER_SK", "CUSTOMER_SK", "PET_SK", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "PET_VALUE", "ORDER_SOURCE", "ORDER_TYPE", "INGEST_DATE")
    values
        ("ORDER_NK", "ORDER_SK", "CUSTOMER_SK", "PET_SK", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "PET_VALUE", "ORDER_SOURCE", "ORDER_TYPE", "INGEST_DATE")

;
[0m00:19:24.694632 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.820 seconds
[0m00:19:24.700666 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:19:24.700666 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
COMMIT
[0m00:19:24.848339 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.148 seconds
[0m00:19:24.848339 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.fact_orders__dbt_tmp
[0m00:19:24.848339 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:19:24.848339 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
drop view if exists DEV.odl.fact_orders__dbt_tmp cascade
[0m00:19:24.982260 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.125 seconds
[0m00:19:24.995122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '998f193d-18d4-406a-8347-61d97f5a21a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE6EBAEE30>]}
[0m00:19:24.999136 [info ] [Thread-1 (]: 5 of 5 OK created sql incremental model odl.fact_orders ........................ [[32mSUCCESS 0[0m in 1.94s]
[0m00:19:25.002115 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m00:19:25.004112 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:19:25.005109 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m00:19:25.005109 [debug] [MainThread]: On list_DEV: Close
[0m00:19:25.102236 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m00:19:25.102236 [debug] [MainThread]: On list_DEV_staging: Close
[0m00:19:25.196040 [debug] [MainThread]: Connection 'model.ManyPets.fact_orders' was left open.
[0m00:19:25.196040 [debug] [MainThread]: On model.ManyPets.fact_orders: Close
[0m00:19:25.318548 [info ] [MainThread]: 
[0m00:19:25.318548 [info ] [MainThread]: Finished running 5 incremental models in 0 hours 0 minutes and 11.86 seconds (11.86s).
[0m00:19:25.318548 [debug] [MainThread]: Command end result
[0m00:19:25.380000 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m00:19:25.394160 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m00:19:25.406182 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m00:19:25.407159 [info ] [MainThread]: 
[0m00:19:25.407721 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:19:25.428067 [info ] [MainThread]: 
[0m00:19:25.431098 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m00:19:25.436915 [debug] [MainThread]: Command `dbt run` succeeded at 00:19:25.436915 after 14.05 seconds
[0m00:19:25.437921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE6A785FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE6AA83A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE6AADDED0>]}
[0m00:19:25.439934 [debug] [MainThread]: Flushing usage events
[0m00:19:26.070380 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:19:36.018491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF7E605FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF7E94FF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF005A3BB0>]}


============================== 00:19:36.020532 | 260c25de-d1cf-4ce9-ae71-e7f23a2cd46a ==============================
[0m00:19:36.020532 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:19:36.020532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:19:36.699257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '260c25de-d1cf-4ce9-ae71-e7f23a2cd46a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF00527D60>]}
[0m00:19:36.796556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '260c25de-d1cf-4ce9-ae71-e7f23a2cd46a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF0007E860>]}
[0m00:19:36.798590 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m00:19:37.269938 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:19:37.617691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:19:37.633321 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:19:37.732743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '260c25de-d1cf-4ce9-ae71-e7f23a2cd46a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF02558130>]}
[0m00:19:37.956012 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m00:19:37.956012 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m00:19:38.018530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '260c25de-d1cf-4ce9-ae71-e7f23a2cd46a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF024D71C0>]}
[0m00:19:38.018530 [info ] [MainThread]: Found 6 models, 11 data tests, 2 sources, 591 macros
[0m00:19:38.018530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '260c25de-d1cf-4ce9-ae71-e7f23a2cd46a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF0055F280>]}
[0m00:19:38.018530 [info ] [MainThread]: 
[0m00:19:38.018530 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:19:38.031951 [info ] [MainThread]: 
[0m00:19:38.034477 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:19:38.049592 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m00:19:38.218678 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m00:19:38.218678 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m00:19:38.218678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:38.974446 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.756 seconds
[0m00:19:38.974446 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m00:19:38.990071 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m00:19:38.990071 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m00:19:39.121904 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.128 seconds
[0m00:19:39.137544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '260c25de-d1cf-4ce9-ae71-e7f23a2cd46a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF025585E0>]}
[0m00:19:39.144068 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m00:19:39.159737 [info ] [Thread-1 (]: 1 of 11 START test not_null_stg_order_complete_customer_id ..................... [RUN]
[0m00:19:39.159737 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b'
[0m00:19:39.159737 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m00:19:39.198571 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b"
[0m00:19:39.198571 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m00:19:39.235674 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b"
[0m00:19:39.238674 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b"
[0m00:19:39.238674 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from DEV.staging.stg_order_complete
where customer_id is null



      
    ) dbt_internal_test
[0m00:19:39.239690 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:19:40.063154 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.835 seconds
[0m00:19:40.093976 [info ] [Thread-1 (]: 1 of 11 PASS not_null_stg_order_complete_customer_id ........................... [[32mPASS[0m in 0.93s]
[0m00:19:40.093976 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m00:19:40.093976 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m00:19:40.093976 [info ] [Thread-1 (]: 2 of 11 START test not_null_stg_order_complete_ingest_date ..................... [RUN]
[0m00:19:40.093976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b, now test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec)
[0m00:19:40.093976 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m00:19:40.093976 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m00:19:40.109597 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m00:19:40.121249 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m00:19:40.124205 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m00:19:40.125249 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ingest_date
from DEV.staging.stg_order_complete
where ingest_date is null



      
    ) dbt_internal_test
[0m00:19:40.397561 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.286 seconds
[0m00:19:40.413183 [info ] [Thread-1 (]: 2 of 11 PASS not_null_stg_order_complete_ingest_date ........................... [[32mPASS[0m in 0.32s]
[0m00:19:40.413183 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m00:19:40.413183 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m00:19:40.413183 [info ] [Thread-1 (]: 3 of 11 START test not_null_stg_order_complete_order_id ........................ [RUN]
[0m00:19:40.413183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec, now test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce)
[0m00:19:40.413183 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m00:19:40.413183 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m00:19:40.430348 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m00:19:40.431399 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m00:19:40.431399 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m00:19:40.431399 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from DEV.staging.stg_order_complete
where order_id is null



      
    ) dbt_internal_test
[0m00:19:40.663709 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.236 seconds
[0m00:19:40.679343 [info ] [Thread-1 (]: 3 of 11 PASS not_null_stg_order_complete_order_id .............................. [[32mPASS[0m in 0.27s]
[0m00:19:40.679343 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m00:19:40.679343 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_order_id__customer_id__pet_id__ingest_date.125d0b22e9
[0m00:19:40.679343 [info ] [Thread-1 (]: 4 of 11 START test not_null_stg_order_complete_order_id__customer_id__pet_id__ingest_date  [RUN]
[0m00:19:40.679343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce, now test.ManyPets.not_null_stg_order_complete_order_id__customer_id__pet_id__ingest_date.125d0b22e9)
[0m00:19:40.679343 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_order_id__customer_id__pet_id__ingest_date.125d0b22e9
[0m00:19:40.697287 [debug] [Thread-1 (]: Compilation Error in test not_null_stg_order_complete_order_id__customer_id__pet_id__ingest_date (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_not_null' takes no keyword argument 'columns'
[0m00:19:40.697287 [error] [Thread-1 (]: 4 of 11 ERROR not_null_stg_order_complete_order_id__customer_id__pet_id__ingest_date  [[31mERROR[0m in 0.02s]
[0m00:19:40.697287 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_order_id__customer_id__pet_id__ingest_date.125d0b22e9
[0m00:19:40.708422 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m00:19:40.709436 [debug] [Thread-4 (]: Marking all children of 'test.ManyPets.not_null_stg_order_complete_order_id__customer_id__pet_id__ingest_date.125d0b22e9' to be skipped because of status 'error'.  Reason: Compilation Error in test not_null_stg_order_complete_order_id__customer_id__pet_id__ingest_date (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_not_null' takes no keyword argument 'columns'.
[0m00:19:40.710423 [info ] [Thread-1 (]: 5 of 11 START test not_null_stg_order_complete_pet_id .......................... [RUN]
[0m00:19:40.712425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_order_id__customer_id__pet_id__ingest_date.125d0b22e9, now test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1)
[0m00:19:40.713391 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m00:19:40.713391 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1"
[0m00:19:40.713391 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m00:19:40.734348 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1"
[0m00:19:40.737411 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1"
[0m00:19:40.737411 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pet_id
from DEV.staging.stg_order_complete
where pet_id is null



      
    ) dbt_internal_test
[0m00:19:41.064309 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.326 seconds
[0m00:19:41.064309 [info ] [Thread-1 (]: 5 of 11 PASS not_null_stg_order_complete_pet_id ................................ [[32mPASS[0m in 0.35s]
[0m00:19:41.064309 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m00:19:41.064309 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_email.5fa7373d74
[0m00:19:41.064309 [info ] [Thread-1 (]: 6 of 11 START test not_null_stg_orders_email ................................... [RUN]
[0m00:19:41.076269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1, now test.ManyPets.not_null_stg_orders_email.5fa7373d74)
[0m00:19:41.077323 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_email.5fa7373d74
[0m00:19:41.082596 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_email.5fa7373d74"
[0m00:19:41.082596 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_email.5fa7373d74
[0m00:19:41.082596 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_email.5fa7373d74"
[0m00:19:41.097333 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_email.5fa7373d74"
[0m00:19:41.098332 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_email.5fa7373d74: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_email.5fa7373d74"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from DEV.staging.stg_orders
where email is null



      
    ) dbt_internal_test
[0m00:19:41.179827 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0e8e-0000-e3c5-0001-b3ce000163aa
[0m00:19:41.179827 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'EMAIL'
[0m00:19:41.195408 [debug] [Thread-1 (]: Database Error in test not_null_stg_orders_email (models\staging\staging_schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'EMAIL'
  compiled code at target\run\ManyPets\models\staging\staging_schema.yml\not_null_stg_orders_email.sql
[0m00:19:41.195408 [error] [Thread-1 (]: 6 of 11 ERROR not_null_stg_orders_email ........................................ [[31mERROR[0m in 0.13s]
[0m00:19:41.195408 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_email.5fa7373d74
[0m00:19:41.195408 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m00:19:41.195408 [debug] [Thread-4 (]: Marking all children of 'test.ManyPets.not_null_stg_orders_email.5fa7373d74' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_orders_email (models\staging\staging_schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'EMAIL'
  compiled code at target\run\ManyPets\models\staging\staging_schema.yml\not_null_stg_orders_email.sql.
[0m00:19:41.195408 [info ] [Thread-1 (]: 7 of 11 START test not_null_stg_orders_ingest_date ............................. [RUN]
[0m00:19:41.195408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_email.5fa7373d74, now test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e)
[0m00:19:41.195408 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m00:19:41.214222 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m00:19:41.215225 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m00:19:41.221222 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m00:19:41.223226 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m00:19:41.224238 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ingest_date
from DEV.staging.stg_orders
where ingest_date is null



      
    ) dbt_internal_test
[0m00:19:41.329666 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.105 seconds
[0m00:19:41.329666 [info ] [Thread-1 (]: 7 of 11 PASS not_null_stg_orders_ingest_date ................................... [[32mPASS[0m in 0.13s]
[0m00:19:41.329666 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m00:19:41.329666 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m00:19:41.329666 [info ] [Thread-1 (]: 8 of 11 START test not_null_stg_orders_order_id ................................ [RUN]
[0m00:19:41.329666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e, now test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64)
[0m00:19:41.329666 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m00:19:41.352561 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:19:41.352561 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m00:19:41.352561 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:19:41.367737 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:19:41.368093 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from DEV.staging.stg_orders
where order_id is null



      
    ) dbt_internal_test
[0m00:19:41.548772 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.181 seconds
[0m00:19:41.548772 [info ] [Thread-1 (]: 8 of 11 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 0.22s]
[0m00:19:41.564437 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m00:19:41.564437 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m00:19:41.564437 [info ] [Thread-1 (]: 9 of 11 START test not_null_stg_orders_pet_dob ................................. [RUN]
[0m00:19:41.564437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64, now test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6)
[0m00:19:41.573558 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m00:19:41.587511 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m00:19:41.588608 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m00:19:41.588608 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m00:19:41.597701 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m00:19:41.598892 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pet_dob
from DEV.staging.stg_orders
where pet_dob is null



      
    ) dbt_internal_test
[0m00:19:41.695408 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.100 seconds
[0m00:19:41.695408 [info ] [Thread-1 (]: 9 of 11 PASS not_null_stg_orders_pet_dob ....................................... [[32mPASS[0m in 0.13s]
[0m00:19:41.695408 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m00:19:41.695408 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m00:19:41.695408 [info ] [Thread-1 (]: 10 of 11 START test not_null_stg_orders_pet_name ............................... [RUN]
[0m00:19:41.710506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6, now test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5)
[0m00:19:41.713698 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m00:19:41.717788 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m00:19:41.728959 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m00:19:41.738610 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m00:19:41.739648 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m00:19:41.739648 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pet_name
from DEV.staging.stg_orders
where pet_name is null



      
    ) dbt_internal_test
[0m00:19:41.927759 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.187 seconds
[0m00:19:41.927759 [info ] [Thread-1 (]: 10 of 11 PASS not_null_stg_orders_pet_name ..................................... [[32mPASS[0m in 0.22s]
[0m00:19:41.927759 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m00:19:41.927759 [debug] [Thread-1 (]: Began running node test.ManyPets.unique_stg_order_complete_order_id__customer_id__pet_id.7ca998ef43
[0m00:19:41.927759 [info ] [Thread-1 (]: 11 of 11 START test unique_stg_order_complete_order_id__customer_id__pet_id .... [RUN]
[0m00:19:41.944592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5, now test.ManyPets.unique_stg_order_complete_order_id__customer_id__pet_id.7ca998ef43)
[0m00:19:41.948047 [debug] [Thread-1 (]: Began compiling node test.ManyPets.unique_stg_order_complete_order_id__customer_id__pet_id.7ca998ef43
[0m00:19:41.963886 [debug] [Thread-1 (]: Compilation Error in test unique_stg_order_complete_order_id__customer_id__pet_id (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'columns'
[0m00:19:41.965569 [error] [Thread-1 (]: 11 of 11 ERROR unique_stg_order_complete_order_id__customer_id__pet_id ......... [[31mERROR[0m in 0.02s]
[0m00:19:41.968409 [debug] [Thread-1 (]: Finished running node test.ManyPets.unique_stg_order_complete_order_id__customer_id__pet_id.7ca998ef43
[0m00:19:41.969389 [debug] [Thread-4 (]: Marking all children of 'test.ManyPets.unique_stg_order_complete_order_id__customer_id__pet_id.7ca998ef43' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_stg_order_complete_order_id__customer_id__pet_id (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'columns'.
[0m00:19:41.970466 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:19:41.970466 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m00:19:41.970466 [debug] [MainThread]: On list_DEV_odl: Close
[0m00:19:42.056252 [debug] [MainThread]: Connection 'test.ManyPets.unique_stg_order_complete_order_id__customer_id__pet_id.7ca998ef43' was left open.
[0m00:19:42.057252 [debug] [MainThread]: On test.ManyPets.unique_stg_order_complete_order_id__customer_id__pet_id.7ca998ef43: Close
[0m00:19:42.150831 [info ] [MainThread]: 
[0m00:19:42.150831 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 4.12 seconds (4.12s).
[0m00:19:42.166469 [debug] [MainThread]: Command end result
[0m00:19:42.214719 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m00:19:42.230583 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m00:19:42.245308 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m00:19:42.246330 [info ] [MainThread]: 
[0m00:19:42.248310 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m00:19:42.249311 [info ] [MainThread]: 
[0m00:19:42.250317 [error] [MainThread]:   Compilation Error in test not_null_stg_order_complete_order_id__customer_id__pet_id__ingest_date (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_not_null' takes no keyword argument 'columns'
[0m00:19:42.252307 [info ] [MainThread]: 
[0m00:19:42.253311 [error] [MainThread]:   Database Error in test not_null_stg_orders_email (models\staging\staging_schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'EMAIL'
  compiled code at target\run\ManyPets\models\staging\staging_schema.yml\not_null_stg_orders_email.sql
[0m00:19:42.261733 [info ] [MainThread]: 
[0m00:19:42.263746 [error] [MainThread]:   Compilation Error in test unique_stg_order_complete_order_id__customer_id__pet_id (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'columns'
[0m00:19:42.266444 [info ] [MainThread]: 
[0m00:19:42.266444 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=3 SKIP=0 TOTAL=11
[0m00:19:42.266444 [debug] [MainThread]: Command `dbt test` failed at 00:19:42.266444 after 6.38 seconds
[0m00:19:42.266444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF7E605FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF7DB1AA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF02D9B340>]}
[0m00:19:42.266444 [debug] [MainThread]: Flushing usage events
[0m00:19:42.716321 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:31:55.506924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002323C116020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002323E03EB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002323E03E980>]}


============================== 00:31:55.506924 | c44db4d9-ed64-44da-885a-c1c0367938f9 ==============================
[0m00:31:55.506924 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:31:55.506924 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:31:56.130015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c44db4d9-ed64-44da-885a-c1c0367938f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002323DEE2200>]}
[0m00:31:56.221709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c44db4d9-ed64-44da-885a-c1c0367938f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002323E9B2C80>]}
[0m00:31:56.229811 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m00:31:56.697303 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:31:57.047147 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:31:57.047147 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:31:57.138364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c44db4d9-ed64-44da-885a-c1c0367938f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002323FF08130>]}
[0m00:31:57.371776 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m00:31:57.379830 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m00:31:57.405495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c44db4d9-ed64-44da-885a-c1c0367938f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023237CC9EA0>]}
[0m00:31:57.421121 [info ] [MainThread]: Found 6 models, 11 data tests, 2 sources, 591 macros
[0m00:31:57.421121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c44db4d9-ed64-44da-885a-c1c0367938f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002323BF8BA00>]}
[0m00:31:57.421121 [info ] [MainThread]: 
[0m00:31:57.421121 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:31:57.421121 [info ] [MainThread]: 
[0m00:31:57.430625 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:31:57.452296 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m00:31:57.589906 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m00:31:57.589906 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m00:31:57.589906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:58.324535 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.724 seconds
[0m00:31:58.324535 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m00:31:58.324535 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m00:31:58.456161 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.130 seconds
[0m00:31:58.471445 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m00:31:58.493477 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m00:31:58.494478 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m00:31:58.494478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:59.030152 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.543 seconds
[0m00:31:59.047467 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m00:31:59.056703 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m00:31:59.056703 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m00:31:59.196300 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.138 seconds
[0m00:31:59.196300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c44db4d9-ed64-44da-885a-c1c0367938f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002323A80C190>]}
[0m00:31:59.196300 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_order_complete
[0m00:31:59.211940 [info ] [Thread-1 (]: 1 of 6 START sql incremental model staging.stg_order_complete .................. [RUN]
[0m00:31:59.211940 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_order_complete'
[0m00:31:59.211940 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_order_complete
[0m00:31:59.242148 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_order_complete"
[0m00:31:59.258401 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_order_complete
[0m00:31:59.327841 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:31:59.327841 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
create or replace  temporary view DEV.staging.stg_order_complete__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING        AS order_id,
        data:detail:intent::STRING          AS intent,
        data:detail:tenant::STRING          AS tenant,
        data:detail:customer_id::STRING     AS customer_id,
        pet.value                           AS pet_id,  
        data:time::TIMESTAMP                AS event_time,
        data:source::STRING                 AS source,
        data:type::STRING                   AS event_type,
        ingest_date                         AS ingest_date
    FROM dev.rdl.order_complete o,
    LATERAL FLATTEN(input => o.data:detail:pet_ids) AS pet  

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_order_complete)
    
)
,
dedup AS (
    SELECT 
        *,
        ROW_NUMBER() OVER ( PARTITION BY order_id, customer_id, pet_id ORDER BY ingest_date DESC ) AS rnk
    FROM source_data
)
SELECT 
    order_id,
    customer_id,
    pet_id,
    intent,
    tenant,
    event_time,
    source,
    event_type,
    ingest_date
FROM dedup
WHERE rnk =1
  );
[0m00:31:59.327841 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:32:00.046539 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.722 seconds
[0m00:32:00.078906 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:32:00.078906 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table DEV.staging.stg_order_complete__dbt_tmp
[0m00:32:00.200032 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.122 seconds
[0m00:32:00.215674 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:32:00.215674 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table DEV.staging.stg_order_complete
[0m00:32:00.300363 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.087 seconds
[0m00:32:00.347264 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:32:00.347264 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table "DEV"."STAGING"."STG_ORDER_COMPLETE"
[0m00:32:00.416381 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.073 seconds
[0m00:32:00.478858 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_order_complete"
[0m00:32:00.478858 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:32:00.478858 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
-- back compat for old kwarg name
  
  begin;
[0m00:32:00.623289 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.132 seconds
[0m00:32:00.628287 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:32:00.632285 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
merge into DEV.staging.stg_order_complete as DBT_INTERNAL_DEST
        using DEV.staging.stg_order_complete__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
                ) and (
                    DBT_INTERNAL_SOURCE.pet_id = DBT_INTERNAL_DEST.pet_id
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PET_ID" = DBT_INTERNAL_SOURCE."PET_ID","INTENT" = DBT_INTERNAL_SOURCE."INTENT","TENANT" = DBT_INTERNAL_SOURCE."TENANT","EVENT_TIME" = DBT_INTERNAL_SOURCE."EVENT_TIME","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PET_ID", "INTENT", "TENANT", "EVENT_TIME", "SOURCE", "EVENT_TYPE", "INGEST_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PET_ID", "INTENT", "TENANT", "EVENT_TIME", "SOURCE", "EVENT_TYPE", "INGEST_DATE")

;
[0m00:32:01.419110 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.797 seconds
[0m00:32:01.419110 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:32:01.434730 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
COMMIT
[0m00:32:01.651062 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.226 seconds
[0m00:32:01.683862 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_order_complete__dbt_tmp
[0m00:32:01.687448 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:32:01.687448 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
drop view if exists DEV.staging.stg_order_complete__dbt_tmp cascade
[0m00:32:01.820008 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.126 seconds
[0m00:32:01.882508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c44db4d9-ed64-44da-885a-c1c0367938f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232405D49D0>]}
[0m00:32:01.882508 [info ] [Thread-1 (]: 1 of 6 OK created sql incremental model staging.stg_order_complete ............. [[32mSUCCESS 0[0m in 2.67s]
[0m00:32:01.882508 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_order_complete
[0m00:32:01.882508 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m00:32:01.898132 [info ] [Thread-1 (]: 2 of 6 START sql incremental model staging.stg_orders .......................... [RUN]
[0m00:32:01.898132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_order_complete, now model.ManyPets.stg_orders)
[0m00:32:01.900811 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m00:32:01.908119 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m00:32:01.908119 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m00:32:01.937228 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:32:01.939233 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace  temporary view DEV.staging.stg_orders__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS event_type,
        data:time::TIMESTAMP                            AS event_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_orders)
    
),
dedup AS
(
    SELECT
        *
        ,ROW_NUMBER() OVER(PARTITION BY order_id, email, pet_dob, pet_name, pet_breed  ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)
SELECT 
    order_id ,
    email AS customer_email,
    pet_dob,
    pet_name,
    COALESCE(NULLIF(TRIM(COALESCE(first_name, '') || ' ' || COALESCE(last_name, '')), ''), 'unknown') AS customer_name,
    dob                                         AS customer_dob,
    phone                                       AS customer_phone,
    address_line1 || ' ' || address_line2       AS customer_address,
    city                                        AS customer_city,
    country                                     AS customer_country,
    postcode                                    AS customer_postcode,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_date,
    cessation_date,
    affiliate_code,
    source,
    event_type,
    event_time,
    ingest_date
FROM dedup
WHERE 
    rnk =1
  );
[0m00:32:02.337099 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.397 seconds
[0m00:32:02.352716 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:32:02.352716 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders__dbt_tmp
[0m00:32:02.438373 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.087 seconds
[0m00:32:02.438373 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:32:02.438373 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders
[0m00:32:02.506941 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.058 seconds
[0m00:32:02.506941 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:32:02.506941 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table "DEV"."STAGING"."STG_ORDERS"
[0m00:32:02.585253 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.068 seconds
[0m00:32:02.585253 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m00:32:02.600701 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:32:02.600701 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m00:32:02.707667 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.107 seconds
[0m00:32:02.707667 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:32:02.707667 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
merge into DEV.staging.stg_orders as DBT_INTERNAL_DEST
        using DEV.staging.stg_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.customer_email = DBT_INTERNAL_DEST.customer_email
                ) and (
                    DBT_INTERNAL_SOURCE.pet_dob = DBT_INTERNAL_DEST.pet_dob
                ) and (
                    DBT_INTERNAL_SOURCE.pet_name = DBT_INTERNAL_DEST.pet_name
                ) and (
                    DBT_INTERNAL_SOURCE.pet_breed = DBT_INTERNAL_DEST.pet_breed
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_EMAIL" = DBT_INTERNAL_SOURCE."CUSTOMER_EMAIL","PET_DOB" = DBT_INTERNAL_SOURCE."PET_DOB","PET_NAME" = DBT_INTERNAL_SOURCE."PET_NAME","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","PET_BREED" = DBT_INTERNAL_SOURCE."PET_BREED","PET_GENDER" = DBT_INTERNAL_SOURCE."PET_GENDER","PET_SPECIES" = DBT_INTERNAL_SOURCE."PET_SPECIES","PEDIGREE_TYPE" = DBT_INTERNAL_SOURCE."PEDIGREE_TYPE","SPAYED_NEUTERED" = DBT_INTERNAL_SOURCE."SPAYED_NEUTERED","PET_POSTCODE" = DBT_INTERNAL_SOURCE."PET_POSTCODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","CESSATION_DATE" = DBT_INTERNAL_SOURCE."CESSATION_DATE","AFFILIATE_CODE" = DBT_INTERNAL_SOURCE."AFFILIATE_CODE","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","EVENT_TIME" = DBT_INTERNAL_SOURCE."EVENT_TIME","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")
    values
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")

;
[0m00:32:03.976052 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.270 seconds
[0m00:32:03.976052 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:32:03.976052 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
COMMIT
[0m00:32:04.214467 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.228 seconds
[0m00:32:04.214467 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_orders__dbt_tmp
[0m00:32:04.214467 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:32:04.214467 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
drop view if exists DEV.staging.stg_orders__dbt_tmp cascade
[0m00:32:04.337212 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.109 seconds
[0m00:32:04.340213 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c44db4d9-ed64-44da-885a-c1c0367938f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232406B8D60>]}
[0m00:32:04.342213 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model staging.stg_orders ..................... [[32mSUCCESS 0[0m in 2.44s]
[0m00:32:04.344206 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m00:32:04.346207 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m00:32:04.347214 [info ] [Thread-1 (]: 3 of 6 START sql incremental model odl.dim_customers ........................... [RUN]
[0m00:32:04.349211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_orders, now model.ManyPets.dim_customers)
[0m00:32:04.351010 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m00:32:04.386310 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m00:32:04.386310 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m00:32:04.402293 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:32:04.402293 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace  temporary view DEV.odl.dim_customers__dbt_tmp
  
   as (
    
WITH stg_data AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date  
    FROM DEV.staging.stg_orders
    
    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.dim_customers)
    
),
dedup AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date,
        ROW_NUMBER() OVER (PARTITION BY customer_email ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    customer_email                                                          AS customer_nk, 
    md5(cast(coalesce(cast(customer_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                 AS customer_sk,
    customer_name,
    customer_dob,
    customer_phone,
    customer_address,
    customer_city,
    customer_country,
    customer_postcode,
    ingest_date
FROM dedup
WHERE rnk = 1
  );
[0m00:32:04.763344 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.365 seconds
[0m00:32:04.778633 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:32:04.778633 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table DEV.odl.dim_customers__dbt_tmp
[0m00:32:04.866718 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.085 seconds
[0m00:32:04.868058 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:32:04.868058 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table DEV.odl.dim_customers
[0m00:32:05.051823 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.181 seconds
[0m00:32:05.051823 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:32:05.051823 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table "DEV"."ODL"."DIM_CUSTOMERS"
[0m00:32:05.118405 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.067 seconds
[0m00:32:05.134042 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_customers"
[0m00:32:05.149672 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:32:05.149672 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m00:32:05.250434 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.098 seconds
[0m00:32:05.250434 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:32:05.250434 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
merge into DEV.odl.dim_customers as DBT_INTERNAL_DEST
        using DEV.odl.dim_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.customer_nk = DBT_INTERNAL_DEST.customer_nk))

    
    when matched then update set
        "CUSTOMER_NK" = DBT_INTERNAL_SOURCE."CUSTOMER_NK","CUSTOMER_SK" = DBT_INTERNAL_SOURCE."CUSTOMER_SK","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("CUSTOMER_NK", "CUSTOMER_SK", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "INGEST_DATE")
    values
        ("CUSTOMER_NK", "CUSTOMER_SK", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "INGEST_DATE")

;
[0m00:32:06.842188 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.602 seconds
[0m00:32:06.857466 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:32:06.857466 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
COMMIT
[0m00:32:07.074038 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.223 seconds
[0m00:32:07.089041 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_customers__dbt_tmp
[0m00:32:07.089041 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:32:07.089041 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
drop view if exists DEV.odl.dim_customers__dbt_tmp cascade
[0m00:32:07.221038 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.131 seconds
[0m00:32:07.227565 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c44db4d9-ed64-44da-885a-c1c0367938f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023240762BC0>]}
[0m00:32:07.227565 [info ] [Thread-1 (]: 3 of 6 OK created sql incremental model odl.dim_customers ...................... [[32mSUCCESS 0[0m in 2.88s]
[0m00:32:07.227565 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m00:32:07.227565 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_pets
[0m00:32:07.227565 [info ] [Thread-1 (]: 4 of 6 START sql incremental model odl.dim_pets ................................ [RUN]
[0m00:32:07.227565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_customers, now model.ManyPets.dim_pets)
[0m00:32:07.227565 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_pets
[0m00:32:07.243215 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_pets"
[0m00:32:07.245539 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_pets
[0m00:32:07.259516 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:32:07.259516 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
create or replace  temporary view DEV.odl.dim_pets__dbt_tmp
  
   as (
    

WITH stg_data AS (
    SELECT
        customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date
    FROM DEV.staging.stg_orders
    
    
        WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.dim_pets)
    
),

dedup AS (
    SELECT
        customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date,
        ROW_NUMBER() OVER(PARTITION BY customer_email, pet_dob, pet_name, pet_breed ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    d.customer_email ||'|'||d.pet_name || '|' || d.pet_dob || '|' || d.pet_breed      AS pet_nk,  
    md5(cast(coalesce(cast(pet_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                                AS pet_sk,  
    d.pet_name,
    d.pet_dob,
    d.pet_breed,
    d.pet_gender,
    d.pet_species,
    d.pedigree_type,
    d.spayed_neutered,
    d.pet_postcode,
    d.pet_value,
    d.ingest_date,
    c.customer_sk
FROM dedup AS d
    INNER JOIN DEV.odl.dim_customers AS c ON (c.customer_nk=d.customer_email)
WHERE d.rnk = 1
  );
[0m00:32:07.579243 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.319 seconds
[0m00:32:07.579243 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:32:07.579243 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
describe table DEV.odl.dim_pets__dbt_tmp
[0m00:32:07.644230 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.070 seconds
[0m00:32:07.659470 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:32:07.659470 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
describe table DEV.odl.dim_pets
[0m00:32:07.728750 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.066 seconds
[0m00:32:07.744399 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:32:07.744399 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
describe table "DEV"."ODL"."DIM_PETS"
[0m00:32:07.807390 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.062 seconds
[0m00:32:07.807390 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_pets"
[0m00:32:07.822522 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:32:07.822522 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
-- back compat for old kwarg name
  
  begin;
[0m00:32:07.929147 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.102 seconds
[0m00:32:07.929147 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:32:07.929147 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
merge into DEV.odl.dim_pets as DBT_INTERNAL_DEST
        using DEV.odl.dim_pets__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.pet_nk = DBT_INTERNAL_DEST.pet_nk))

    
    when matched then update set
        "PET_NK" = DBT_INTERNAL_SOURCE."PET_NK","PET_SK" = DBT_INTERNAL_SOURCE."PET_SK","PET_NAME" = DBT_INTERNAL_SOURCE."PET_NAME","PET_DOB" = DBT_INTERNAL_SOURCE."PET_DOB","PET_BREED" = DBT_INTERNAL_SOURCE."PET_BREED","PET_GENDER" = DBT_INTERNAL_SOURCE."PET_GENDER","PET_SPECIES" = DBT_INTERNAL_SOURCE."PET_SPECIES","PEDIGREE_TYPE" = DBT_INTERNAL_SOURCE."PEDIGREE_TYPE","SPAYED_NEUTERED" = DBT_INTERNAL_SOURCE."SPAYED_NEUTERED","PET_POSTCODE" = DBT_INTERNAL_SOURCE."PET_POSTCODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE","CUSTOMER_SK" = DBT_INTERNAL_SOURCE."CUSTOMER_SK"
    

    when not matched then insert
        ("PET_NK", "PET_SK", "PET_NAME", "PET_DOB", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "INGEST_DATE", "CUSTOMER_SK")
    values
        ("PET_NK", "PET_SK", "PET_NAME", "PET_DOB", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "INGEST_DATE", "CUSTOMER_SK")

;
[0m00:32:08.956849 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.024 seconds
[0m00:32:08.956849 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:32:08.956849 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
COMMIT
[0m00:32:09.163752 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.209 seconds
[0m00:32:09.179045 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_pets__dbt_tmp
[0m00:32:09.179045 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:32:09.179045 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
drop view if exists DEV.odl.dim_pets__dbt_tmp cascade
[0m00:32:09.281550 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.099 seconds
[0m00:32:09.281550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c44db4d9-ed64-44da-885a-c1c0367938f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232407C6F20>]}
[0m00:32:09.281550 [info ] [Thread-1 (]: 4 of 6 OK created sql incremental model odl.dim_pets ........................... [[32mSUCCESS 0[0m in 2.05s]
[0m00:32:09.296893 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_pets
[0m00:32:09.296893 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_order_complete
[0m00:32:09.296893 [info ] [Thread-1 (]: 5 of 6 START sql incremental model odl.fact_order_complete ..................... [RUN]
[0m00:32:09.296893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_pets, now model.ManyPets.fact_order_complete)
[0m00:32:09.296893 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_order_complete
[0m00:32:09.296893 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_order_complete"
[0m00:32:09.312518 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_order_complete
[0m00:32:09.340746 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.fact_order_complete"
[0m00:32:09.347765 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_order_complete"
[0m00:32:09.347765 [debug] [Thread-1 (]: On model.ManyPets.fact_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_order_complete"} */
create or replace transient table DEV.odl.fact_order_complete
         as
        ( 

WITH fact_data AS (
    SELECT
        data:detail:order_id::STRING        AS order_id,
        data:detail:intent::STRING          AS intent,
        data:detail:tenant::STRING          AS tenant, 
        data:time::TIMESTAMP                AS event_time,
        data:source::STRING                 AS source,
        data:type::STRING                   AS event_type,
        ingest_date                         AS ingest_date,
        c.customer_sk                       AS customer_sk,                      
        p.pet_sk                            AS pet_sk                         
    FROM dev.rdl.order_complete o,
    LATERAL FLATTEN(input => o.data:detail:pet_ids) AS pet

    LEFT JOIN DEV.odl.dim_customers c 
        ON o.data:detail:customer_id::STRING = c.customer_nk
    LEFT JOIN DEV.odl.dim_pets p 
        ON pet.value = p.pet_nk

    
),

dedup AS (
    SELECT 
        *,
        ROW_NUMBER() OVER ( PARTITION BY order_id, customer_sk, pet_sk ORDER BY ingest_date DESC ) AS rnk
    FROM fact_data
)

SELECT 
    order_id || '|' || customer_sk || '|' || pet_sk         AS order_nk,
    md5(cast(coalesce(cast(order_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))    AS order_sk,
    customer_sk                                             AS customer_sk,
    pet_sk                                                  AS pet_sk,
    intent                                                  AS intent,
    tenant                                                  AS tenant,
    event_time                                              AS event_time,
    source                                                  AS source,
    event_type                                              AS event_type,
    ingest_date                                             AS ingest_date
FROM dedup
WHERE rnk = 1
        );
[0m00:32:09.427886 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0e9b-0000-e3c5-0001-b3ce000163ca
[0m00:32:09.429885 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001072 (42601): SQL compilation error:
Lateral View cannot be on the left side of join
[0m00:32:09.434991 [debug] [Thread-1 (]: Database Error in model fact_order_complete (models\fact\fact_order_complete.sql)
  001072 (42601): SQL compilation error:
  Lateral View cannot be on the left side of join
  compiled code at target\run\ManyPets\models\fact\fact_order_complete.sql
[0m00:32:09.434991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c44db4d9-ed64-44da-885a-c1c0367938f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232405CF280>]}
[0m00:32:09.434991 [error] [Thread-1 (]: 5 of 6 ERROR creating sql incremental model odl.fact_order_complete ............ [[31mERROR[0m in 0.14s]
[0m00:32:09.434991 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_order_complete
[0m00:32:09.434991 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m00:32:09.434991 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.fact_order_complete' to be skipped because of status 'error'.  Reason: Database Error in model fact_order_complete (models\fact\fact_order_complete.sql)
  001072 (42601): SQL compilation error:
  Lateral View cannot be on the left side of join
  compiled code at target\run\ManyPets\models\fact\fact_order_complete.sql.
[0m00:32:09.434991 [info ] [Thread-1 (]: 6 of 6 START sql incremental model odl.fact_orders ............................. [RUN]
[0m00:32:09.446843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.fact_order_complete, now model.ManyPets.fact_orders)
[0m00:32:09.448273 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_orders
[0m00:32:09.468494 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_orders"
[0m00:32:09.471494 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_orders
[0m00:32:09.483725 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:32:09.483725 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
create or replace  temporary view DEV.odl.fact_orders__dbt_tmp
  
   as (
     
WITH fact_data AS (
    SELECT 
        f.order_id,
        f.order_date,
        f.cessation_date,
        f.affiliate_code,
        f.pet_value,
        f.source,
        f.event_type,
        /*f.event_time,
        f.envelope_version,
        f.detail_version,
        f.intent,
        f.tenant,
        f.experiments,*/
        c.customer_sk,
        p.pet_sk,
        f.ingest_date
    FROM DEV.staging.stg_orders f
    LEFT JOIN DEV.odl.dim_customers c 
        ON f.customer_email = c.customer_nk
    LEFT JOIN DEV.odl.dim_pets p 
        ON f.pet_name = p.pet_name 
        AND f.pet_dob = p.pet_dob
        AND f.pet_breed = p.pet_breed
        
    
        WHERE f.ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.fact_orders)
    
)

, dedup AS (
    SELECT 
        f.*,
        ROW_NUMBER() OVER(PARTITION BY f.order_id, f.customer_sk, f.pet_sk ORDER BY f.ingest_date DESC) AS rnk
    FROM fact_data f
)

SELECT 
     order_id || '|' || customer_sk || '|'|| pet_sk         AS order_nk,
    md5(cast(coalesce(cast(order_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))    AS order_sk,
    customer_sk                                             AS customer_sk,
    pet_sk                                                  AS pet_sk,
    order_date                                              AS order_date,
    cessation_date                                          AS cessation_date,
    COALESCE(affiliate_code, 'unknown')                     AS affiliate_code,
    pet_value                                               AS pet_value,
    source                                                  AS order_source,
    event_type                                              AS order_type,
/*
    event_time,
    envelope_version,
    detail_version,
    intent,
    tenant,
    experiments,
*/
    ingest_date
FROM dedup
WHERE rnk = 1
  );
[0m00:32:09.795122 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.308 seconds
[0m00:32:09.804095 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:32:09.804095 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
describe table DEV.odl.fact_orders__dbt_tmp
[0m00:32:09.883051 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.077 seconds
[0m00:32:09.952109 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:32:09.952109 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
describe table DEV.odl.fact_orders
[0m00:32:10.023091 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.071 seconds
[0m00:32:10.023091 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:32:10.036618 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
describe table "DEV"."ODL"."FACT_ORDERS"
[0m00:32:10.099423 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.075 seconds
[0m00:32:10.114771 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.fact_orders"
[0m00:32:10.130388 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:32:10.136901 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m00:32:10.212924 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.086 seconds
[0m00:32:10.212924 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:32:10.212924 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
merge into DEV.odl.fact_orders as DBT_INTERNAL_DEST
        using DEV.odl.fact_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_nk = DBT_INTERNAL_DEST.order_nk))

    
    when matched then update set
        "ORDER_NK" = DBT_INTERNAL_SOURCE."ORDER_NK","ORDER_SK" = DBT_INTERNAL_SOURCE."ORDER_SK","CUSTOMER_SK" = DBT_INTERNAL_SOURCE."CUSTOMER_SK","PET_SK" = DBT_INTERNAL_SOURCE."PET_SK","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","CESSATION_DATE" = DBT_INTERNAL_SOURCE."CESSATION_DATE","AFFILIATE_CODE" = DBT_INTERNAL_SOURCE."AFFILIATE_CODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","ORDER_SOURCE" = DBT_INTERNAL_SOURCE."ORDER_SOURCE","ORDER_TYPE" = DBT_INTERNAL_SOURCE."ORDER_TYPE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_NK", "ORDER_SK", "CUSTOMER_SK", "PET_SK", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "PET_VALUE", "ORDER_SOURCE", "ORDER_TYPE", "INGEST_DATE")
    values
        ("ORDER_NK", "ORDER_SK", "CUSTOMER_SK", "PET_SK", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "PET_VALUE", "ORDER_SOURCE", "ORDER_TYPE", "INGEST_DATE")

;
[0m00:32:11.055891 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.843 seconds
[0m00:32:11.071136 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:32:11.071136 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
COMMIT
[0m00:32:11.203549 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.140 seconds
[0m00:32:11.218592 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.fact_orders__dbt_tmp
[0m00:32:11.218592 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:32:11.218592 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
drop view if exists DEV.odl.fact_orders__dbt_tmp cascade
[0m00:32:11.325355 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.114 seconds
[0m00:32:11.340410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c44db4d9-ed64-44da-885a-c1c0367938f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023240634F70>]}
[0m00:32:11.340410 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model odl.fact_orders ........................ [[32mSUCCESS 0[0m in 1.89s]
[0m00:32:11.340410 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m00:32:11.340410 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:32:11.356072 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m00:32:11.358806 [debug] [MainThread]: On list_DEV: Close
[0m00:32:11.457051 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m00:32:11.457051 [debug] [MainThread]: On list_DEV_staging: Close
[0m00:32:11.588139 [debug] [MainThread]: Connection 'model.ManyPets.fact_orders' was left open.
[0m00:32:11.588139 [debug] [MainThread]: On model.ManyPets.fact_orders: Close
[0m00:32:11.688364 [info ] [MainThread]: 
[0m00:32:11.688364 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 0 minutes and 14.26 seconds (14.26s).
[0m00:32:11.688364 [debug] [MainThread]: Command end result
[0m00:32:11.767435 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m00:32:11.771453 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m00:32:11.778209 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m00:32:11.778209 [info ] [MainThread]: 
[0m00:32:11.778209 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:32:11.778209 [info ] [MainThread]: 
[0m00:32:11.778209 [error] [MainThread]:   Database Error in model fact_order_complete (models\fact\fact_order_complete.sql)
  001072 (42601): SQL compilation error:
  Lateral View cannot be on the left side of join
  compiled code at target\run\ManyPets\models\fact\fact_order_complete.sql
[0m00:32:11.778209 [info ] [MainThread]: 
[0m00:32:11.792899 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m00:32:11.794899 [debug] [MainThread]: Command `dbt run` failed at 00:32:11.794899 after 16.42 seconds
[0m00:32:11.798099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002323C116020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002323C410F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232406D1CC0>]}
[0m00:32:11.800360 [debug] [MainThread]: Flushing usage events
[0m00:32:12.390454 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:34:07.607200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1A5316080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1A723EA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1A723E830>]}


============================== 00:34:07.607200 | 7ebf1e44-0158-4917-8341-79095b143e68 ==============================
[0m00:34:07.607200 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:34:07.607200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:34:08.240377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ebf1e44-0158-4917-8341-79095b143e68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1A71D3CD0>]}
[0m00:34:08.335826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ebf1e44-0158-4917-8341-79095b143e68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1A70E28F0>]}
[0m00:34:08.335826 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m00:34:08.813072 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:34:09.175587 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:34:09.175587 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:34:09.266670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ebf1e44-0158-4917-8341-79095b143e68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1A9108130>]}
[0m00:34:09.492105 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m00:34:09.507771 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m00:34:09.538978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ebf1e44-0158-4917-8341-79095b143e68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1A7EB19C0>]}
[0m00:34:09.538978 [info ] [MainThread]: Found 6 models, 11 data tests, 2 sources, 591 macros
[0m00:34:09.538978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ebf1e44-0158-4917-8341-79095b143e68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1A43FAFB0>]}
[0m00:34:09.538978 [info ] [MainThread]: 
[0m00:34:09.538978 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:34:09.538978 [info ] [MainThread]: 
[0m00:34:09.555671 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:34:09.573014 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m00:34:09.776878 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m00:34:09.776878 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m00:34:09.776878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:34:10.427656 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.646 seconds
[0m00:34:10.444212 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m00:34:10.445211 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m00:34:10.542044 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.108 seconds
[0m00:34:10.557302 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m00:34:10.579431 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m00:34:10.579431 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m00:34:10.579431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:34:11.075612 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.490 seconds
[0m00:34:11.082143 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m00:34:11.082143 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m00:34:11.097807 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m00:34:11.214054 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.125 seconds
[0m00:34:11.229487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ebf1e44-0158-4917-8341-79095b143e68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1A8FE1D50>]}
[0m00:34:11.245084 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_order_complete
[0m00:34:11.245084 [info ] [Thread-1 (]: 1 of 6 START sql incremental model staging.stg_order_complete .................. [RUN]
[0m00:34:11.245084 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_order_complete'
[0m00:34:11.245084 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_order_complete
[0m00:34:11.268307 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_order_complete"
[0m00:34:11.268307 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_order_complete
[0m00:34:11.349436 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:34:11.349436 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
create or replace  temporary view DEV.staging.stg_order_complete__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING        AS order_id,
        data:detail:intent::STRING          AS intent,
        data:detail:tenant::STRING          AS tenant,
        data:detail:customer_id::STRING     AS customer_id,
        pet.value                           AS pet_id,  
        data:time::TIMESTAMP                AS event_time,
        data:source::STRING                 AS source,
        data:type::STRING                   AS event_type,
        ingest_date                         AS ingest_date
    FROM dev.rdl.order_complete o,
    LATERAL FLATTEN(input => o.data:detail:pet_ids) AS pet  

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_order_complete)
    
)
,
dedup AS (
    SELECT 
        *,
        ROW_NUMBER() OVER ( PARTITION BY order_id, customer_id, pet_id ORDER BY ingest_date DESC ) AS rnk
    FROM source_data
)
SELECT 
    order_id,
    customer_id,
    pet_id,
    intent,
    tenant,
    event_time,
    source,
    event_type,
    ingest_date
FROM dedup
WHERE rnk =1
  );
[0m00:34:11.349436 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:34:11.847183 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.497 seconds
[0m00:34:11.862566 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:34:11.862566 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table DEV.staging.stg_order_complete__dbt_tmp
[0m00:34:11.948039 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.090 seconds
[0m00:34:11.963422 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:34:11.963422 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table DEV.staging.stg_order_complete
[0m00:34:12.049560 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.087 seconds
[0m00:34:12.065205 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:34:12.065205 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table "DEV"."STAGING"."STG_ORDER_COMPLETE"
[0m00:34:12.149881 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.077 seconds
[0m00:34:12.202913 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_order_complete"
[0m00:34:12.202913 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:34:12.202913 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
-- back compat for old kwarg name
  
  begin;
[0m00:34:12.303943 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.108 seconds
[0m00:34:12.319252 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:34:12.319252 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
merge into DEV.staging.stg_order_complete as DBT_INTERNAL_DEST
        using DEV.staging.stg_order_complete__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
                ) and (
                    DBT_INTERNAL_SOURCE.pet_id = DBT_INTERNAL_DEST.pet_id
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PET_ID" = DBT_INTERNAL_SOURCE."PET_ID","INTENT" = DBT_INTERNAL_SOURCE."INTENT","TENANT" = DBT_INTERNAL_SOURCE."TENANT","EVENT_TIME" = DBT_INTERNAL_SOURCE."EVENT_TIME","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PET_ID", "INTENT", "TENANT", "EVENT_TIME", "SOURCE", "EVENT_TYPE", "INGEST_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PET_ID", "INTENT", "TENANT", "EVENT_TIME", "SOURCE", "EVENT_TYPE", "INGEST_DATE")

;
[0m00:34:13.571194 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.254 seconds
[0m00:34:13.571194 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:34:13.571194 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
COMMIT
[0m00:34:13.810035 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.239 seconds
[0m00:34:13.825381 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_order_complete__dbt_tmp
[0m00:34:13.841008 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:34:13.841008 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
drop view if exists DEV.staging.stg_order_complete__dbt_tmp cascade
[0m00:34:14.137022 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.291 seconds
[0m00:34:14.162747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ebf1e44-0158-4917-8341-79095b143e68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1A97CD120>]}
[0m00:34:14.162747 [info ] [Thread-1 (]: 1 of 6 OK created sql incremental model staging.stg_order_complete ............. [[32mSUCCESS 0[0m in 2.92s]
[0m00:34:14.162747 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_order_complete
[0m00:34:14.162747 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m00:34:14.162747 [info ] [Thread-1 (]: 2 of 6 START sql incremental model staging.stg_orders .......................... [RUN]
[0m00:34:14.162747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_order_complete, now model.ManyPets.stg_orders)
[0m00:34:14.162747 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m00:34:14.190585 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m00:34:14.192583 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m00:34:14.197628 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:34:14.197628 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace  temporary view DEV.staging.stg_orders__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS event_type,
        data:time::TIMESTAMP                            AS event_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_orders)
    
),
dedup AS
(
    SELECT
        *
        ,ROW_NUMBER() OVER(PARTITION BY order_id, email, pet_dob, pet_name, pet_breed  ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)
SELECT 
    order_id ,
    email AS customer_email,
    pet_dob,
    pet_name,
    COALESCE(NULLIF(TRIM(COALESCE(first_name, '') || ' ' || COALESCE(last_name, '')), ''), 'unknown') AS customer_name,
    dob                                         AS customer_dob,
    phone                                       AS customer_phone,
    address_line1 || ' ' || address_line2       AS customer_address,
    city                                        AS customer_city,
    country                                     AS customer_country,
    postcode                                    AS customer_postcode,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_date,
    cessation_date,
    affiliate_code,
    source,
    event_type,
    event_time,
    ingest_date
FROM dedup
WHERE 
    rnk =1
  );
[0m00:34:14.628574 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.421 seconds
[0m00:34:14.644194 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:34:14.644194 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders__dbt_tmp
[0m00:34:14.713298 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.081 seconds
[0m00:34:14.728759 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:34:14.728759 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders
[0m00:34:14.798214 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.068 seconds
[0m00:34:14.813866 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:34:14.813866 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table "DEV"."STAGING"."STG_ORDERS"
[0m00:34:14.898381 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.080 seconds
[0m00:34:14.914040 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m00:34:14.929656 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:34:14.929656 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m00:34:15.045187 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.110 seconds
[0m00:34:15.045187 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:34:15.045187 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
merge into DEV.staging.stg_orders as DBT_INTERNAL_DEST
        using DEV.staging.stg_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.customer_email = DBT_INTERNAL_DEST.customer_email
                ) and (
                    DBT_INTERNAL_SOURCE.pet_dob = DBT_INTERNAL_DEST.pet_dob
                ) and (
                    DBT_INTERNAL_SOURCE.pet_name = DBT_INTERNAL_DEST.pet_name
                ) and (
                    DBT_INTERNAL_SOURCE.pet_breed = DBT_INTERNAL_DEST.pet_breed
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_EMAIL" = DBT_INTERNAL_SOURCE."CUSTOMER_EMAIL","PET_DOB" = DBT_INTERNAL_SOURCE."PET_DOB","PET_NAME" = DBT_INTERNAL_SOURCE."PET_NAME","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","PET_BREED" = DBT_INTERNAL_SOURCE."PET_BREED","PET_GENDER" = DBT_INTERNAL_SOURCE."PET_GENDER","PET_SPECIES" = DBT_INTERNAL_SOURCE."PET_SPECIES","PEDIGREE_TYPE" = DBT_INTERNAL_SOURCE."PEDIGREE_TYPE","SPAYED_NEUTERED" = DBT_INTERNAL_SOURCE."SPAYED_NEUTERED","PET_POSTCODE" = DBT_INTERNAL_SOURCE."PET_POSTCODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","CESSATION_DATE" = DBT_INTERNAL_SOURCE."CESSATION_DATE","AFFILIATE_CODE" = DBT_INTERNAL_SOURCE."AFFILIATE_CODE","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","EVENT_TIME" = DBT_INTERNAL_SOURCE."EVENT_TIME","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")
    values
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")

;
[0m00:34:16.182326 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.144 seconds
[0m00:34:16.182326 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:34:16.197405 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
COMMIT
[0m00:34:16.405437 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.219 seconds
[0m00:34:16.421108 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_orders__dbt_tmp
[0m00:34:16.436727 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:34:16.436727 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
drop view if exists DEV.staging.stg_orders__dbt_tmp cascade
[0m00:34:16.537126 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.102 seconds
[0m00:34:16.537126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ebf1e44-0158-4917-8341-79095b143e68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1A98B4F70>]}
[0m00:34:16.537126 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model staging.stg_orders ..................... [[32mSUCCESS 0[0m in 2.37s]
[0m00:34:16.552768 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m00:34:16.552768 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m00:34:16.552768 [info ] [Thread-1 (]: 3 of 6 START sql incremental model odl.dim_customers ........................... [RUN]
[0m00:34:16.552768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_orders, now model.ManyPets.dim_customers)
[0m00:34:16.565660 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m00:34:16.597304 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m00:34:16.605813 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m00:34:16.613430 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:34:16.614430 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace  temporary view DEV.odl.dim_customers__dbt_tmp
  
   as (
    
WITH stg_data AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date  
    FROM DEV.staging.stg_orders
    
    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.dim_customers)
    
),
dedup AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date,
        ROW_NUMBER() OVER (PARTITION BY customer_email ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    customer_email                                                          AS customer_nk, 
    md5(cast(coalesce(cast(customer_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                 AS customer_sk,
    customer_name,
    customer_dob,
    customer_phone,
    customer_address,
    customer_city,
    customer_country,
    customer_postcode,
    ingest_date
FROM dedup
WHERE rnk = 1
  );
[0m00:34:16.889862 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.277 seconds
[0m00:34:16.889862 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:34:16.889862 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table DEV.odl.dim_customers__dbt_tmp
[0m00:34:17.022788 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.125 seconds
[0m00:34:17.022788 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:34:17.022788 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table DEV.odl.dim_customers
[0m00:34:17.101393 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.071 seconds
[0m00:34:17.107404 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:34:17.107404 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table "DEV"."ODL"."DIM_CUSTOMERS"
[0m00:34:17.170271 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.062 seconds
[0m00:34:17.185550 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_customers"
[0m00:34:17.185550 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:34:17.185550 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m00:34:17.391610 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.200 seconds
[0m00:34:17.391610 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:34:17.391610 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
merge into DEV.odl.dim_customers as DBT_INTERNAL_DEST
        using DEV.odl.dim_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.customer_nk = DBT_INTERNAL_DEST.customer_nk))

    
    when matched then update set
        "CUSTOMER_NK" = DBT_INTERNAL_SOURCE."CUSTOMER_NK","CUSTOMER_SK" = DBT_INTERNAL_SOURCE."CUSTOMER_SK","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("CUSTOMER_NK", "CUSTOMER_SK", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "INGEST_DATE")
    values
        ("CUSTOMER_NK", "CUSTOMER_SK", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "INGEST_DATE")

;
[0m00:34:18.146225 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.745 seconds
[0m00:34:18.146225 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:34:18.146225 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
COMMIT
[0m00:34:18.375795 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.227 seconds
[0m00:34:18.391025 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_customers__dbt_tmp
[0m00:34:18.391025 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:34:18.391025 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
drop view if exists DEV.odl.dim_customers__dbt_tmp cascade
[0m00:34:18.513736 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.126 seconds
[0m00:34:18.529399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ebf1e44-0158-4917-8341-79095b143e68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1A9962C20>]}
[0m00:34:18.529399 [info ] [Thread-1 (]: 3 of 6 OK created sql incremental model odl.dim_customers ...................... [[32mSUCCESS 0[0m in 1.98s]
[0m00:34:18.529399 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m00:34:18.529399 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_pets
[0m00:34:18.529399 [info ] [Thread-1 (]: 4 of 6 START sql incremental model odl.dim_pets ................................ [RUN]
[0m00:34:18.529399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_customers, now model.ManyPets.dim_pets)
[0m00:34:18.529399 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_pets
[0m00:34:18.551638 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_pets"
[0m00:34:18.554824 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_pets
[0m00:34:18.563333 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:34:18.563333 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
create or replace  temporary view DEV.odl.dim_pets__dbt_tmp
  
   as (
    

WITH stg_data AS (
    SELECT
        customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date
    FROM DEV.staging.stg_orders
    
    
        WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.dim_pets)
    
),

dedup AS (
    SELECT
        customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date,
        ROW_NUMBER() OVER(PARTITION BY customer_email, pet_dob, pet_name, pet_breed ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    d.customer_email ||'|'||d.pet_name || '|' || d.pet_dob || '|' || d.pet_breed      AS pet_nk,  
    md5(cast(coalesce(cast(pet_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                                AS pet_sk,  
    d.pet_name,
    d.pet_dob,
    d.pet_breed,
    d.pet_gender,
    d.pet_species,
    d.pedigree_type,
    d.spayed_neutered,
    d.pet_postcode,
    d.pet_value,
    d.ingest_date,
    c.customer_sk
FROM dedup AS d
    INNER JOIN DEV.odl.dim_customers AS c ON (c.customer_nk=d.customer_email)
WHERE d.rnk = 1
  );
[0m00:34:18.862592 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.304 seconds
[0m00:34:18.877979 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:34:18.877979 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
describe table DEV.odl.dim_pets__dbt_tmp
[0m00:34:18.959361 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.080 seconds
[0m00:34:18.974675 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:34:18.974675 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
describe table DEV.odl.dim_pets
[0m00:34:19.063657 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.073 seconds
[0m00:34:19.079287 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:34:19.079287 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
describe table "DEV"."ODL"."DIM_PETS"
[0m00:34:19.149198 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.070 seconds
[0m00:34:19.149198 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_pets"
[0m00:34:19.149198 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:34:19.164340 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
-- back compat for old kwarg name
  
  begin;
[0m00:34:19.264685 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.101 seconds
[0m00:34:19.264685 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:34:19.264685 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
merge into DEV.odl.dim_pets as DBT_INTERNAL_DEST
        using DEV.odl.dim_pets__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.pet_nk = DBT_INTERNAL_DEST.pet_nk))

    
    when matched then update set
        "PET_NK" = DBT_INTERNAL_SOURCE."PET_NK","PET_SK" = DBT_INTERNAL_SOURCE."PET_SK","PET_NAME" = DBT_INTERNAL_SOURCE."PET_NAME","PET_DOB" = DBT_INTERNAL_SOURCE."PET_DOB","PET_BREED" = DBT_INTERNAL_SOURCE."PET_BREED","PET_GENDER" = DBT_INTERNAL_SOURCE."PET_GENDER","PET_SPECIES" = DBT_INTERNAL_SOURCE."PET_SPECIES","PEDIGREE_TYPE" = DBT_INTERNAL_SOURCE."PEDIGREE_TYPE","SPAYED_NEUTERED" = DBT_INTERNAL_SOURCE."SPAYED_NEUTERED","PET_POSTCODE" = DBT_INTERNAL_SOURCE."PET_POSTCODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE","CUSTOMER_SK" = DBT_INTERNAL_SOURCE."CUSTOMER_SK"
    

    when not matched then insert
        ("PET_NK", "PET_SK", "PET_NAME", "PET_DOB", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "INGEST_DATE", "CUSTOMER_SK")
    values
        ("PET_NK", "PET_SK", "PET_NAME", "PET_DOB", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "INGEST_DATE", "CUSTOMER_SK")

;
[0m00:34:20.252800 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.992 seconds
[0m00:34:20.252800 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:34:20.252800 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
COMMIT
[0m00:34:20.472700 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.213 seconds
[0m00:34:20.472700 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_pets__dbt_tmp
[0m00:34:20.472700 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:34:20.472700 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
drop view if exists DEV.odl.dim_pets__dbt_tmp cascade
[0m00:34:20.586208 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.109 seconds
[0m00:34:20.601550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ebf1e44-0158-4917-8341-79095b143e68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1A99C2F80>]}
[0m00:34:20.601550 [info ] [Thread-1 (]: 4 of 6 OK created sql incremental model odl.dim_pets ........................... [[32mSUCCESS 0[0m in 2.07s]
[0m00:34:20.601550 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_pets
[0m00:34:20.601550 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_order_complete
[0m00:34:20.619306 [info ] [Thread-1 (]: 5 of 6 START sql incremental model odl.fact_order_complete ..................... [RUN]
[0m00:34:20.621943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_pets, now model.ManyPets.fact_order_complete)
[0m00:34:20.624987 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_order_complete
[0m00:34:20.634288 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_order_complete"
[0m00:34:20.634288 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_order_complete
[0m00:34:20.667448 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.fact_order_complete"
[0m00:34:20.677470 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_order_complete"
[0m00:34:20.677470 [debug] [Thread-1 (]: On model.ManyPets.fact_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_order_complete"} */
create or replace transient table DEV.odl.fact_order_complete
         as
        ( 

WITH fact_data AS (
    SELECT
        data:detail:order_id::STRING        AS order_id,
        data:detail:intent::STRING          AS intent,
        data:detail:tenant::STRING          AS tenant, 
        data:time::TIMESTAMP                AS event_time,
        data:source::STRING                 AS source,
        data:type::STRING                   AS event_type,
        ingest_date                         AS ingest_date,
        c.customer_sk                       AS customer_sk,                      
        p.pet_sk                            AS pet_sk                         
    FROM dev.rdl.order_complete o,
    LATERAL FLATTEN(input => o.data:detail:pet_ids) AS pet

    LEFT JOIN DEV.odl.dim_customers c 
        ON o.data:detail:customer_id::STRING = c.customer_nk
    LEFT JOIN DEV.odl.dim_pets p 
        ON pet.value = p.pet_nk

    
),

dedup AS (
    SELECT 
        *,
        ROW_NUMBER() OVER ( PARTITION BY order_id, customer_sk, pet_sk ORDER BY ingest_date DESC ) AS rnk
    FROM fact_data
)

SELECT 
    order_id || '|' || customer_sk || '|' || pet_sk         AS order_nk,
    md5(cast(coalesce(cast(order_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))    AS order_sk,
    customer_sk                                             AS customer_sk,
    pet_sk                                                  AS pet_sk,
    intent                                                  AS intent,
    tenant                                                  AS tenant,
    event_time                                              AS event_time,
    source                                                  AS source,
    event_type                                              AS event_type,
    ingest_date                                             AS ingest_date
FROM dedup
WHERE rnk = 1
        );
[0m00:34:20.757000 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0e9d-0000-e37b-0001-b3ce0001b382
[0m00:34:20.757000 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001072 (42601): SQL compilation error:
Lateral View cannot be on the left side of join
[0m00:34:20.757000 [debug] [Thread-1 (]: Database Error in model fact_order_complete (models\fact\fact_order_complete.sql)
  001072 (42601): SQL compilation error:
  Lateral View cannot be on the left side of join
  compiled code at target\run\ManyPets\models\fact\fact_order_complete.sql
[0m00:34:20.757000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ebf1e44-0158-4917-8341-79095b143e68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1A97CDB40>]}
[0m00:34:20.757000 [error] [Thread-1 (]: 5 of 6 ERROR creating sql incremental model odl.fact_order_complete ............ [[31mERROR[0m in 0.14s]
[0m00:34:20.757000 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_order_complete
[0m00:34:20.772630 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m00:34:20.772630 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.fact_order_complete' to be skipped because of status 'error'.  Reason: Database Error in model fact_order_complete (models\fact\fact_order_complete.sql)
  001072 (42601): SQL compilation error:
  Lateral View cannot be on the left side of join
  compiled code at target\run\ManyPets\models\fact\fact_order_complete.sql.
[0m00:34:20.772630 [info ] [Thread-1 (]: 6 of 6 START sql incremental model odl.fact_orders ............................. [RUN]
[0m00:34:20.772630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.fact_order_complete, now model.ManyPets.fact_orders)
[0m00:34:20.772630 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_orders
[0m00:34:20.772630 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_orders"
[0m00:34:20.772630 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_orders
[0m00:34:20.794761 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:34:20.794761 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
create or replace  temporary view DEV.odl.fact_orders__dbt_tmp
  
   as (
     
WITH fact_data AS (
    SELECT 
        f.order_id,
        f.order_date,
        f.cessation_date,
        f.affiliate_code,
        f.pet_value,
        f.source,
        f.event_type,
        /*f.event_time,
        f.envelope_version,
        f.detail_version,
        f.intent,
        f.tenant,
        f.experiments,*/
        c.customer_sk,
        p.pet_sk,
        f.ingest_date
    FROM DEV.staging.stg_orders f
    LEFT JOIN DEV.odl.dim_customers c 
        ON f.customer_email = c.customer_nk
    LEFT JOIN DEV.odl.dim_pets p 
        ON f.pet_name = p.pet_name 
        AND f.pet_dob = p.pet_dob
        AND f.pet_breed = p.pet_breed
        
    
        WHERE f.ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.fact_orders)
    
)

, dedup AS (
    SELECT 
        f.*,
        ROW_NUMBER() OVER(PARTITION BY f.order_id, f.customer_sk, f.pet_sk ORDER BY f.ingest_date DESC) AS rnk
    FROM fact_data f
)

SELECT 
     order_id || '|' || customer_sk || '|'|| pet_sk         AS order_nk,
    md5(cast(coalesce(cast(order_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))    AS order_sk,
    customer_sk                                             AS customer_sk,
    pet_sk                                                  AS pet_sk,
    order_date                                              AS order_date,
    cessation_date                                          AS cessation_date,
    COALESCE(affiliate_code, 'unknown')                     AS affiliate_code,
    pet_value                                               AS pet_value,
    source                                                  AS order_source,
    event_type                                              AS order_type,
/*
    event_time,
    envelope_version,
    detail_version,
    intent,
    tenant,
    experiments,
*/
    ingest_date
FROM dedup
WHERE rnk = 1
  );
[0m00:34:21.141187 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.353 seconds
[0m00:34:21.156410 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:34:21.156410 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
describe table DEV.odl.fact_orders__dbt_tmp
[0m00:34:21.226274 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.081 seconds
[0m00:34:21.304418 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:34:21.304418 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
describe table DEV.odl.fact_orders
[0m00:34:21.374119 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.068 seconds
[0m00:34:21.389272 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:34:21.389272 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
describe table "DEV"."ODL"."FACT_ORDERS"
[0m00:34:21.459136 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.067 seconds
[0m00:34:21.459136 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.fact_orders"
[0m00:34:21.474030 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:34:21.474030 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m00:34:21.577344 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.101 seconds
[0m00:34:21.579329 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:34:21.579329 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
merge into DEV.odl.fact_orders as DBT_INTERNAL_DEST
        using DEV.odl.fact_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_nk = DBT_INTERNAL_DEST.order_nk))

    
    when matched then update set
        "ORDER_NK" = DBT_INTERNAL_SOURCE."ORDER_NK","ORDER_SK" = DBT_INTERNAL_SOURCE."ORDER_SK","CUSTOMER_SK" = DBT_INTERNAL_SOURCE."CUSTOMER_SK","PET_SK" = DBT_INTERNAL_SOURCE."PET_SK","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","CESSATION_DATE" = DBT_INTERNAL_SOURCE."CESSATION_DATE","AFFILIATE_CODE" = DBT_INTERNAL_SOURCE."AFFILIATE_CODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","ORDER_SOURCE" = DBT_INTERNAL_SOURCE."ORDER_SOURCE","ORDER_TYPE" = DBT_INTERNAL_SOURCE."ORDER_TYPE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_NK", "ORDER_SK", "CUSTOMER_SK", "PET_SK", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "PET_VALUE", "ORDER_SOURCE", "ORDER_TYPE", "INGEST_DATE")
    values
        ("ORDER_NK", "ORDER_SK", "CUSTOMER_SK", "PET_SK", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "PET_VALUE", "ORDER_SOURCE", "ORDER_TYPE", "INGEST_DATE")

;
[0m00:34:22.393658 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.813 seconds
[0m00:34:22.393658 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:34:22.393658 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
COMMIT
[0m00:34:22.532425 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.147 seconds
[0m00:34:22.548096 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.fact_orders__dbt_tmp
[0m00:34:22.548096 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:34:22.563710 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
drop view if exists DEV.odl.fact_orders__dbt_tmp cascade
[0m00:34:22.655582 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.103 seconds
[0m00:34:22.671201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ebf1e44-0158-4917-8341-79095b143e68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1A51815D0>]}
[0m00:34:22.671201 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model odl.fact_orders ........................ [[32mSUCCESS 0[0m in 1.90s]
[0m00:34:22.671201 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m00:34:22.671201 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:34:22.671201 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m00:34:22.671201 [debug] [MainThread]: On list_DEV: Close
[0m00:34:22.773013 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m00:34:22.773013 [debug] [MainThread]: On list_DEV_staging: Close
[0m00:34:22.864624 [debug] [MainThread]: Connection 'model.ManyPets.fact_orders' was left open.
[0m00:34:22.864624 [debug] [MainThread]: On model.ManyPets.fact_orders: Close
[0m00:34:22.965233 [info ] [MainThread]: 
[0m00:34:22.965233 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 0 minutes and 13.41 seconds (13.41s).
[0m00:34:22.980850 [debug] [MainThread]: Command end result
[0m00:34:23.041662 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m00:34:23.041662 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m00:34:23.062364 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m00:34:23.063360 [info ] [MainThread]: 
[0m00:34:23.064350 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:34:23.065907 [info ] [MainThread]: 
[0m00:34:23.066925 [error] [MainThread]:   Database Error in model fact_order_complete (models\fact\fact_order_complete.sql)
  001072 (42601): SQL compilation error:
  Lateral View cannot be on the left side of join
  compiled code at target\run\ManyPets\models\fact\fact_order_complete.sql
[0m00:34:23.068924 [info ] [MainThread]: 
[0m00:34:23.070922 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m00:34:23.073923 [debug] [MainThread]: Command `dbt run` failed at 00:34:23.072927 after 15.60 seconds
[0m00:34:23.077374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1A5316080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1A662EA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1A98D2800>]}
[0m00:34:23.077374 [debug] [MainThread]: Flushing usage events
[0m00:34:23.688829 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:42:16.125335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0603A6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0622CEBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0622CEA10>]}


============================== 00:42:16.130563 | 61321c30-392a-4546-8cfe-6ef70b266d44 ==============================
[0m00:42:16.130563 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:42:16.133826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select fact_order_complete', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:42:16.846873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61321c30-392a-4546-8cfe-6ef70b266d44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0606EE6E0>]}
[0m00:42:16.973297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61321c30-392a-4546-8cfe-6ef70b266d44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C062171240>]}
[0m00:42:16.979217 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m00:42:17.545896 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:42:17.986918 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:42:17.986918 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:42:18.095622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61321c30-392a-4546-8cfe-6ef70b266d44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C06419C130>]}
[0m00:42:18.379584 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m00:42:18.386336 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m00:42:18.427218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61321c30-392a-4546-8cfe-6ef70b266d44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C06417E8C0>]}
[0m00:42:18.429284 [info ] [MainThread]: Found 6 models, 11 data tests, 2 sources, 591 macros
[0m00:42:18.431262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61321c30-392a-4546-8cfe-6ef70b266d44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C064074580>]}
[0m00:42:18.432267 [info ] [MainThread]: 
[0m00:42:18.436007 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:42:18.438362 [info ] [MainThread]: 
[0m00:42:18.441149 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:42:18.446309 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m00:42:18.669568 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m00:42:18.669568 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m00:42:18.669568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:42:19.618264 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.942 seconds
[0m00:42:19.649205 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m00:42:19.668586 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m00:42:19.668586 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m00:42:19.668586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:42:20.127792 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.458 seconds
[0m00:42:20.135839 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m00:42:20.155021 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m00:42:20.157464 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m00:42:20.311206 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.152 seconds
[0m00:42:20.330590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61321c30-392a-4546-8cfe-6ef70b266d44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C062BEBB80>]}
[0m00:42:20.359537 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_order_complete
[0m00:42:20.361727 [info ] [Thread-1 (]: 1 of 1 START sql incremental model odl.fact_order_complete ..................... [RUN]
[0m00:42:20.366154 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.fact_order_complete'
[0m00:42:20.366154 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_order_complete
[0m00:42:20.421619 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_order_complete"
[0m00:42:20.421619 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_order_complete
[0m00:42:20.559870 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.fact_order_complete"
[0m00:42:20.571835 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_order_complete"
[0m00:42:20.571835 [debug] [Thread-1 (]: On model.ManyPets.fact_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_order_complete"} */
create or replace transient table DEV.odl.fact_order_complete
         as
        ( 

WITH fact_data AS (
    SELECT
        data:detail:order_id::STRING        AS order_id,
        data:detail:intent::STRING          AS intent,
        data:detail:tenant::STRING          AS tenant, 
        data:time::TIMESTAMP                AS event_time,
        data:source::STRING                 AS source,
        data:type::STRING                   AS event_type,
        ingest_date                         AS ingest_date,
        c.customer_sk                       AS customer_sk,                      
        p.pet_sk                            AS pet_sk                         
    FROM dev.rdl.order_complete o,
    LATERAL FLATTEN(input => o.data:detail:pet_ids) AS pet

    LEFT JOIN DEV.odl.dim_customers c 
        ON o.data:detail:customer_id::STRING = c.customer_nk
    LEFT JOIN DEV.odl.dim_pets p 
        ON pet.value = p.pet_nk

    
),

dedup AS (
    SELECT 
        *,
        ROW_NUMBER() OVER ( PARTITION BY order_id, customer_sk, pet_sk ORDER BY ingest_date DESC ) AS rnk
    FROM fact_data
)

SELECT 
    order_id || '|' || customer_sk || '|' || pet_sk         AS order_nk,
    md5(cast(coalesce(cast(order_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))    AS order_sk,
    customer_sk                                             AS customer_sk,
    pet_sk                                                  AS pet_sk,
    intent                                                  AS intent,
    tenant                                                  AS tenant,
    event_time                                              AS event_time,
    source                                                  AS source,
    event_type                                              AS event_type,
    ingest_date                                             AS ingest_date
FROM dedup
WHERE rnk = 1
        );
[0m00:42:20.571835 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:42:21.269049 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0ea5-0000-e39c-0001-b3ce0001c362
[0m00:42:21.269049 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001072 (42601): SQL compilation error:
Lateral View cannot be on the left side of join
[0m00:42:21.277123 [debug] [Thread-1 (]: Database Error in model fact_order_complete (models\fact\fact_order_complete.sql)
  001072 (42601): SQL compilation error:
  Lateral View cannot be on the left side of join
  compiled code at target\run\ManyPets\models\fact\fact_order_complete.sql
[0m00:42:21.283526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61321c30-392a-4546-8cfe-6ef70b266d44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C060211C30>]}
[0m00:42:21.284528 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model odl.fact_order_complete ............ [[31mERROR[0m in 0.91s]
[0m00:42:21.288351 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_order_complete
[0m00:42:21.289349 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.fact_order_complete' to be skipped because of status 'error'.  Reason: Database Error in model fact_order_complete (models\fact\fact_order_complete.sql)
  001072 (42601): SQL compilation error:
  Lateral View cannot be on the left side of join
  compiled code at target\run\ManyPets\models\fact\fact_order_complete.sql.
[0m00:42:21.294267 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:42:21.295269 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m00:42:21.296275 [debug] [MainThread]: On list_DEV: Close
[0m00:42:21.409921 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m00:42:21.417938 [debug] [MainThread]: On list_DEV_odl: Close
[0m00:42:21.542481 [debug] [MainThread]: Connection 'model.ManyPets.fact_order_complete' was left open.
[0m00:42:21.542975 [debug] [MainThread]: On model.ManyPets.fact_order_complete: Close
[0m00:42:21.646653 [info ] [MainThread]: 
[0m00:42:21.656942 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.21 seconds (3.21s).
[0m00:42:21.663686 [debug] [MainThread]: Command end result
[0m00:42:21.752792 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m00:42:21.756946 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m00:42:21.771607 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m00:42:21.773644 [info ] [MainThread]: 
[0m00:42:21.775653 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:42:21.776613 [info ] [MainThread]: 
[0m00:42:21.778250 [error] [MainThread]:   Database Error in model fact_order_complete (models\fact\fact_order_complete.sql)
  001072 (42601): SQL compilation error:
  Lateral View cannot be on the left side of join
  compiled code at target\run\ManyPets\models\fact\fact_order_complete.sql
[0m00:42:21.780803 [info ] [MainThread]: 
[0m00:42:21.782253 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:42:21.784965 [debug] [MainThread]: Command `dbt run` failed at 00:42:21.784965 after 5.82 seconds
[0m00:42:21.784965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0603A6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C062172200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0606A1090>]}
[0m00:42:21.788443 [debug] [MainThread]: Flushing usage events
[0m00:42:22.560392 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:56:15.705825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002051C976050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002051E89EBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002051E89EA10>]}


============================== 00:56:15.706826 | c45dda5d-f60c-48f3-a315-3ef5670dd7e1 ==============================
[0m00:56:15.706826 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:56:15.713452 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select fact_order_complete', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:56:16.448552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c45dda5d-f60c-48f3-a315-3ef5670dd7e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002051CCBE6E0>]}
[0m00:56:16.556444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c45dda5d-f60c-48f3-a315-3ef5670dd7e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002051E741240>]}
[0m00:56:16.556444 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m00:56:17.117312 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:56:17.520249 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:56:17.520249 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:56:17.617558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c45dda5d-f60c-48f3-a315-3ef5670dd7e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002052076C130>]}
[0m00:56:17.885831 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m00:56:17.893022 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m00:56:17.925310 [error] [MainThread]: Encountered an error:
Found a cycle: model.ManyPets.dim_pets
[0m00:56:17.937384 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\main.py", line 578, in run
    results = task.run()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 574, in run
    self._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\base.py", line 134, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 475, in compile
    linker.link_graph(manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 195, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.ManyPets.dim_pets

[0m00:56:17.954701 [debug] [MainThread]: Command `dbt run` failed at 00:56:17.951926 after 2.40 seconds
[0m00:56:17.955698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002051C976050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002052074F0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002052074F340>]}
[0m00:56:17.955698 [debug] [MainThread]: Flushing usage events
[0m00:56:18.828446 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:56:35.361723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFFC976050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFFE89E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFFE89E7D0>]}


============================== 00:56:35.366438 | 143154ec-5234-4128-a532-c889099cc46a ==============================
[0m00:56:35.366438 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:56:35.369190 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m00:56:36.045663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '143154ec-5234-4128-a532-c889099cc46a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFFB1F5C90>]}
[0m00:56:36.157938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '143154ec-5234-4128-a532-c889099cc46a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFFE741B70>]}
[0m00:56:36.167109 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m00:56:36.679426 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:56:37.107078 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:56:37.107078 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:56:37.212745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '143154ec-5234-4128-a532-c889099cc46a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFFF79C130>]}
[0m00:56:37.502152 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m00:56:37.510634 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m00:56:37.542801 [error] [MainThread]: Encountered an error:
Found a cycle: model.ManyPets.dim_pets
[0m00:56:37.549640 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\main.py", line 578, in run
    results = task.run()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 574, in run
    self._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\base.py", line 134, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 475, in compile
    linker.link_graph(manifest)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\compilation.py", line 195, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.ManyPets.dim_pets

[0m00:56:37.559595 [debug] [MainThread]: Command `dbt run` failed at 00:56:37.559595 after 2.34 seconds
[0m00:56:37.564873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFFC976050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFFF774640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFFF775420>]}
[0m00:56:37.568647 [debug] [MainThread]: Flushing usage events
[0m00:56:38.089710 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:57:27.676637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD61C5FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD80EE920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD80EE740>]}


============================== 00:57:27.682317 | 5dcda3c0-d116-4110-a6e5-2861b2cd065a ==============================
[0m00:57:27.682317 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:57:27.685491 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:57:28.439757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dcda3c0-d116-4110-a6e5-2861b2cd065a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD651DED0>]}
[0m00:57:28.559404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dcda3c0-d116-4110-a6e5-2861b2cd065a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD7F5B2B0>]}
[0m00:57:28.562456 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m00:57:29.081388 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:57:29.481983 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:57:29.483513 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:57:29.576763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dcda3c0-d116-4110-a6e5-2861b2cd065a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD9FB8130>]}
[0m00:57:29.857429 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m00:57:29.873942 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m00:57:29.914221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dcda3c0-d116-4110-a6e5-2861b2cd065a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD8D2CA60>]}
[0m00:57:29.916171 [info ] [MainThread]: Found 6 models, 11 data tests, 2 sources, 591 macros
[0m00:57:29.918244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dcda3c0-d116-4110-a6e5-2861b2cd065a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD9F839A0>]}
[0m00:57:29.919234 [info ] [MainThread]: 
[0m00:57:29.925344 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:57:29.928993 [info ] [MainThread]: 
[0m00:57:29.931223 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:57:29.954860 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m00:57:30.159288 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m00:57:30.159288 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m00:57:30.159288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:57:31.042990 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.885 seconds
[0m00:57:31.057574 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m00:57:31.057574 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m00:57:31.171051 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.103 seconds
[0m00:57:31.187545 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m00:57:31.227406 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m00:57:31.227406 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m00:57:31.227406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:57:31.778097 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.553 seconds
[0m00:57:31.778097 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m00:57:31.788661 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m00:57:31.788661 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m00:57:32.053626 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.260 seconds
[0m00:57:32.070327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dcda3c0-d116-4110-a6e5-2861b2cd065a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD8D2C190>]}
[0m00:57:32.091010 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_order_complete
[0m00:57:32.092011 [info ] [Thread-1 (]: 1 of 6 START sql incremental model staging.stg_order_complete .................. [RUN]
[0m00:57:32.097852 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_order_complete'
[0m00:57:32.097852 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_order_complete
[0m00:57:32.144956 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_order_complete"
[0m00:57:32.150735 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_order_complete
[0m00:57:32.228115 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:57:32.228115 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
create or replace  temporary view DEV.staging.stg_order_complete__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING        AS order_id,
        data:detail:intent::STRING          AS intent,
        data:detail:tenant::STRING          AS tenant,
        data:detail:customer_id::STRING     AS customer_id,
        pet.value                           AS pet_id,  
        data:time::TIMESTAMP                AS event_time,
        data:source::STRING                 AS source,
        data:type::STRING                   AS event_type,
        ingest_date                         AS ingest_date
    FROM dev.rdl.order_complete o,
    LATERAL FLATTEN(input => o.data:detail:pet_ids) AS pet  

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_order_complete)
    
)
,
dedup AS (
    SELECT 
        *,
        ROW_NUMBER() OVER ( PARTITION BY order_id, customer_id, pet_id ORDER BY ingest_date DESC ) AS rnk
    FROM source_data
)
SELECT 
    order_id,
    customer_id,
    pet_id,
    intent,
    tenant,
    event_time,
    source,
    event_type,
    ingest_date
FROM dedup
WHERE rnk =1
  );
[0m00:57:32.228115 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:57:33.078465 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.845 seconds
[0m00:57:33.096783 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:57:33.096783 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table DEV.staging.stg_order_complete__dbt_tmp
[0m00:57:33.213056 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.114 seconds
[0m00:57:33.243907 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:57:33.243907 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table DEV.staging.stg_order_complete
[0m00:57:33.344379 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.097 seconds
[0m00:57:33.375652 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:57:33.375652 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
describe table "DEV"."STAGING"."STG_ORDER_COMPLETE"
[0m00:57:33.456805 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.075 seconds
[0m00:57:33.517143 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_order_complete"
[0m00:57:33.531085 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:57:33.531085 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
-- back compat for old kwarg name
  
  begin;
[0m00:57:33.635676 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.105 seconds
[0m00:57:33.635676 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:57:33.635676 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
merge into DEV.staging.stg_order_complete as DBT_INTERNAL_DEST
        using DEV.staging.stg_order_complete__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
                ) and (
                    DBT_INTERNAL_SOURCE.pet_id = DBT_INTERNAL_DEST.pet_id
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PET_ID" = DBT_INTERNAL_SOURCE."PET_ID","INTENT" = DBT_INTERNAL_SOURCE."INTENT","TENANT" = DBT_INTERNAL_SOURCE."TENANT","EVENT_TIME" = DBT_INTERNAL_SOURCE."EVENT_TIME","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PET_ID", "INTENT", "TENANT", "EVENT_TIME", "SOURCE", "EVENT_TYPE", "INGEST_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PET_ID", "INTENT", "TENANT", "EVENT_TIME", "SOURCE", "EVENT_TYPE", "INGEST_DATE")

;
[0m00:57:34.988156 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.346 seconds
[0m00:57:34.988156 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:57:34.988156 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
COMMIT
[0m00:57:35.235947 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.244 seconds
[0m00:57:35.267176 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_order_complete__dbt_tmp
[0m00:57:35.282796 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m00:57:35.282796 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
drop view if exists DEV.staging.stg_order_complete__dbt_tmp cascade
[0m00:57:35.390625 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.108 seconds
[0m00:57:35.432477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dcda3c0-d116-4110-a6e5-2861b2cd065a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EADA717EE0>]}
[0m00:57:35.433479 [info ] [Thread-1 (]: 1 of 6 OK created sql incremental model staging.stg_order_complete ............. [[32mSUCCESS 0[0m in 3.33s]
[0m00:57:35.435676 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_order_complete
[0m00:57:35.438847 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m00:57:35.440060 [info ] [Thread-1 (]: 2 of 6 START sql incremental model staging.stg_orders .......................... [RUN]
[0m00:57:35.442765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_order_complete, now model.ManyPets.stg_orders)
[0m00:57:35.443785 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m00:57:35.456747 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m00:57:35.463171 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m00:57:35.483702 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:57:35.483702 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace  temporary view DEV.staging.stg_orders__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS event_type,
        data:time::TIMESTAMP                            AS event_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_orders)
    
),
dedup AS
(
    SELECT
        *
        ,ROW_NUMBER() OVER(PARTITION BY order_id, email, pet_dob, pet_name, pet_breed  ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)
SELECT 
    order_id ,
    email AS customer_email,
    pet_dob,
    pet_name,
    COALESCE(NULLIF(TRIM(COALESCE(first_name, '') || ' ' || COALESCE(last_name, '')), ''), 'unknown') AS customer_name,
    dob                                         AS customer_dob,
    phone                                       AS customer_phone,
    address_line1 || ' ' || address_line2       AS customer_address,
    city                                        AS customer_city,
    country                                     AS customer_country,
    postcode                                    AS customer_postcode,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_date,
    cessation_date,
    affiliate_code,
    source,
    event_type,
    event_time,
    ingest_date
FROM dedup
WHERE 
    rnk =1
  );
[0m00:57:35.988107 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.504 seconds
[0m00:57:36.005528 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:57:36.005528 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders__dbt_tmp
[0m00:57:36.105754 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.097 seconds
[0m00:57:36.121434 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:57:36.121434 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders
[0m00:57:36.213168 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.084 seconds
[0m00:57:36.239058 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:57:36.239058 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table "DEV"."STAGING"."STG_ORDERS"
[0m00:57:36.321853 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.075 seconds
[0m00:57:36.337487 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m00:57:36.351091 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:57:36.351091 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m00:57:36.471859 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.116 seconds
[0m00:57:36.471859 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:57:36.471859 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
merge into DEV.staging.stg_orders as DBT_INTERNAL_DEST
        using DEV.staging.stg_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.customer_email = DBT_INTERNAL_DEST.customer_email
                ) and (
                    DBT_INTERNAL_SOURCE.pet_dob = DBT_INTERNAL_DEST.pet_dob
                ) and (
                    DBT_INTERNAL_SOURCE.pet_name = DBT_INTERNAL_DEST.pet_name
                ) and (
                    DBT_INTERNAL_SOURCE.pet_breed = DBT_INTERNAL_DEST.pet_breed
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_EMAIL" = DBT_INTERNAL_SOURCE."CUSTOMER_EMAIL","PET_DOB" = DBT_INTERNAL_SOURCE."PET_DOB","PET_NAME" = DBT_INTERNAL_SOURCE."PET_NAME","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","PET_BREED" = DBT_INTERNAL_SOURCE."PET_BREED","PET_GENDER" = DBT_INTERNAL_SOURCE."PET_GENDER","PET_SPECIES" = DBT_INTERNAL_SOURCE."PET_SPECIES","PEDIGREE_TYPE" = DBT_INTERNAL_SOURCE."PEDIGREE_TYPE","SPAYED_NEUTERED" = DBT_INTERNAL_SOURCE."SPAYED_NEUTERED","PET_POSTCODE" = DBT_INTERNAL_SOURCE."PET_POSTCODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","CESSATION_DATE" = DBT_INTERNAL_SOURCE."CESSATION_DATE","AFFILIATE_CODE" = DBT_INTERNAL_SOURCE."AFFILIATE_CODE","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","EVENT_TIME" = DBT_INTERNAL_SOURCE."EVENT_TIME","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")
    values
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")

;
[0m00:57:37.686649 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.207 seconds
[0m00:57:37.686649 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:57:37.686649 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
COMMIT
[0m00:57:37.995919 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.300 seconds
[0m00:57:38.011464 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_orders__dbt_tmp
[0m00:57:38.011464 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m00:57:38.011464 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
drop view if exists DEV.staging.stg_orders__dbt_tmp cascade
[0m00:57:38.112063 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.102 seconds
[0m00:57:38.127735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dcda3c0-d116-4110-a6e5-2861b2cd065a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EADA7E8FD0>]}
[0m00:57:38.127735 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model staging.stg_orders ..................... [[32mSUCCESS 0[0m in 2.69s]
[0m00:57:38.140341 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m00:57:38.145643 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m00:57:38.148942 [info ] [Thread-1 (]: 3 of 6 START sql incremental model odl.dim_customers ........................... [RUN]
[0m00:57:38.153050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_orders, now model.ManyPets.dim_customers)
[0m00:57:38.154062 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m00:57:38.194085 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m00:57:38.197764 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m00:57:38.207828 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:57:38.207828 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace  temporary view DEV.odl.dim_customers__dbt_tmp
  
   as (
    
WITH stg_data AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date  
    FROM DEV.staging.stg_orders
    
    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.dim_customers)
    
),
dedup AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date,
        ROW_NUMBER() OVER (PARTITION BY customer_email ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    customer_email                                                          AS customer_nk, 
    md5(cast(coalesce(cast(customer_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                 AS customer_sk,
    customer_name,
    customer_dob,
    customer_phone,
    customer_address,
    customer_city,
    customer_country,
    customer_postcode,
    ingest_date
FROM dedup
WHERE rnk = 1
  );
[0m00:57:38.494199 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.297 seconds
[0m00:57:38.513526 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:57:38.513526 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table DEV.odl.dim_customers__dbt_tmp
[0m00:57:38.618994 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.095 seconds
[0m00:57:38.636414 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:57:38.636414 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table DEV.odl.dim_customers
[0m00:57:38.716660 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.072 seconds
[0m00:57:38.716660 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:57:38.716660 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table "DEV"."ODL"."DIM_CUSTOMERS"
[0m00:57:38.783010 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.063 seconds
[0m00:57:38.814860 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_customers"
[0m00:57:38.823940 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:57:38.823940 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m00:57:38.917208 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.091 seconds
[0m00:57:38.917208 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:57:38.917208 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
merge into DEV.odl.dim_customers as DBT_INTERNAL_DEST
        using DEV.odl.dim_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.customer_nk = DBT_INTERNAL_DEST.customer_nk))

    
    when matched then update set
        "CUSTOMER_NK" = DBT_INTERNAL_SOURCE."CUSTOMER_NK","CUSTOMER_SK" = DBT_INTERNAL_SOURCE."CUSTOMER_SK","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("CUSTOMER_NK", "CUSTOMER_SK", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "INGEST_DATE")
    values
        ("CUSTOMER_NK", "CUSTOMER_SK", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "INGEST_DATE")

;
[0m00:57:40.136198 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.221 seconds
[0m00:57:40.136198 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:57:40.136198 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
COMMIT
[0m00:57:40.449671 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.300 seconds
[0m00:57:40.465360 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_customers__dbt_tmp
[0m00:57:40.465360 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m00:57:40.465360 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
drop view if exists DEV.odl.dim_customers__dbt_tmp cascade
[0m00:57:40.590550 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.120 seconds
[0m00:57:40.607821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dcda3c0-d116-4110-a6e5-2861b2cd065a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EADA8A2B90>]}
[0m00:57:40.607821 [info ] [Thread-1 (]: 3 of 6 OK created sql incremental model odl.dim_customers ...................... [[32mSUCCESS 0[0m in 2.45s]
[0m00:57:40.616198 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m00:57:40.619854 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_pets
[0m00:57:40.623775 [info ] [Thread-1 (]: 4 of 6 START sql incremental model odl.dim_pets ................................ [RUN]
[0m00:57:40.628960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_customers, now model.ManyPets.dim_pets)
[0m00:57:40.633327 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_pets
[0m00:57:40.654193 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_pets"
[0m00:57:40.659875 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_pets
[0m00:57:40.674561 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:57:40.674561 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
create or replace  temporary view DEV.odl.dim_pets__dbt_tmp
  
   as (
    

WITH stg_data AS (
    SELECT
        customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date
    FROM DEV.staging.stg_orders
    
    
        WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.dim_pets)
    
),

dedup AS (
    SELECT
        customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date,
        ROW_NUMBER() OVER(PARTITION BY customer_email, pet_dob, pet_name, pet_breed ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    d.customer_email ||'|'||d.pet_name || '|' || d.pet_dob || '|' || d.pet_breed      AS pet_nk,  
    md5(cast(coalesce(cast(pet_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                                AS pet_sk,  
    d.pet_name,
    d.pet_dob,
    d.pet_breed,
    d.pet_gender,
    d.pet_species,
    d.pedigree_type,
    d.spayed_neutered,
    d.pet_postcode,
    d.pet_value,
    d.ingest_date,
    c.customer_sk
FROM dedup AS d
    INNER JOIN DEV.odl.dim_customers AS c ON (c.customer_nk=d.customer_email)
WHERE d.rnk = 1
  );
[0m00:57:41.039151 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.368 seconds
[0m00:57:41.054778 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:57:41.054778 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
describe table DEV.odl.dim_pets__dbt_tmp
[0m00:57:41.575590 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.515 seconds
[0m00:57:41.575590 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:57:41.575590 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
describe table DEV.odl.dim_pets
[0m00:57:41.641061 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.062 seconds
[0m00:57:41.659474 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:57:41.659474 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
describe table "DEV"."ODL"."DIM_PETS"
[0m00:57:41.741535 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.075 seconds
[0m00:57:41.767312 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_pets"
[0m00:57:41.783767 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:57:41.783767 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
-- back compat for old kwarg name
  
  begin;
[0m00:57:41.887696 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.099 seconds
[0m00:57:41.887696 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:57:41.887696 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
merge into DEV.odl.dim_pets as DBT_INTERNAL_DEST
        using DEV.odl.dim_pets__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.pet_nk = DBT_INTERNAL_DEST.pet_nk))

    
    when matched then update set
        "PET_NK" = DBT_INTERNAL_SOURCE."PET_NK","PET_SK" = DBT_INTERNAL_SOURCE."PET_SK","PET_NAME" = DBT_INTERNAL_SOURCE."PET_NAME","PET_DOB" = DBT_INTERNAL_SOURCE."PET_DOB","PET_BREED" = DBT_INTERNAL_SOURCE."PET_BREED","PET_GENDER" = DBT_INTERNAL_SOURCE."PET_GENDER","PET_SPECIES" = DBT_INTERNAL_SOURCE."PET_SPECIES","PEDIGREE_TYPE" = DBT_INTERNAL_SOURCE."PEDIGREE_TYPE","SPAYED_NEUTERED" = DBT_INTERNAL_SOURCE."SPAYED_NEUTERED","PET_POSTCODE" = DBT_INTERNAL_SOURCE."PET_POSTCODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE","CUSTOMER_SK" = DBT_INTERNAL_SOURCE."CUSTOMER_SK"
    

    when not matched then insert
        ("PET_NK", "PET_SK", "PET_NAME", "PET_DOB", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "INGEST_DATE", "CUSTOMER_SK")
    values
        ("PET_NK", "PET_SK", "PET_NAME", "PET_DOB", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "INGEST_DATE", "CUSTOMER_SK")

;
[0m00:57:43.218791 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.323 seconds
[0m00:57:43.218791 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:57:43.218791 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
COMMIT
[0m00:57:43.518116 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.299 seconds
[0m00:57:43.533513 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_pets__dbt_tmp
[0m00:57:43.533513 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m00:57:43.551041 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
drop view if exists DEV.odl.dim_pets__dbt_tmp cascade
[0m00:57:43.671936 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.120 seconds
[0m00:57:43.671936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dcda3c0-d116-4110-a6e5-2861b2cd065a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EADA906EF0>]}
[0m00:57:43.671936 [info ] [Thread-1 (]: 4 of 6 OK created sql incremental model odl.dim_pets ........................... [[32mSUCCESS 0[0m in 3.04s]
[0m00:57:43.683912 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_pets
[0m00:57:43.685441 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_order_complete
[0m00:57:43.686447 [info ] [Thread-1 (]: 5 of 6 START sql incremental model odl.fact_order_complete ..................... [RUN]
[0m00:57:43.688444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_pets, now model.ManyPets.fact_order_complete)
[0m00:57:43.688444 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_order_complete
[0m00:57:43.700229 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_order_complete"
[0m00:57:43.709055 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_order_complete
[0m00:57:43.735542 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.fact_order_complete"
[0m00:57:43.750498 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_order_complete"
[0m00:57:43.752048 [debug] [Thread-1 (]: On model.ManyPets.fact_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_order_complete"} */
create or replace transient table DEV.odl.fact_order_complete
         as
        ( 

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING        AS order_id,
        data:detail:intent::STRING          AS intent,
        data:detail:tenant::STRING          AS tenant,
        data:detail:customer_id::STRING     AS customer_id,
        pet.value                           AS pet_id,  
        data:time::TIMESTAMP                AS event_time,
        data:source::STRING                 AS source,
        data:type::STRING                   AS event_type,
        ingest_date                         AS ingest_date
    FROM dev.rdl.order_complete o,
    LATERAL FLATTEN(input => o.data:detail:pet_ids) AS pet   

    
),
fact_data AS (
    SELECT
        s.order_id,
        s.intent,
        s.tenant,
        s.event_time,
        s.source,
        s.event_type,
        s.ingest_date,
        c.customer_sk,
        p.pet_sk
    FROM source_data s
    LEFT JOIN DEV.odl.dim_customers c 
        ON s.customer_id = c.customer_nk   
    LEFT JOIN DEV.odl.dim_pets p 
        ON s.pet_id = p.pet_nk            
),

dedup AS (
    SELECT 
        *,
        ROW_NUMBER() OVER ( PARTITION BY order_id, customer_sk, pet_sk ORDER BY ingest_date DESC ) AS rnk
    FROM fact_data
)

SELECT 
    order_id || '|' || customer_sk || '|' || pet_sk         AS order_nk,
    md5(cast(coalesce(cast(order_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))    AS order_sk,
    customer_sk                                             AS customer_sk,
    pet_sk                                                  AS pet_sk,
    intent                                                  AS intent,
    tenant                                                  AS tenant,
    event_time                                              AS event_time,
    source                                                  AS source,
    event_type                                              AS event_type,
    ingest_date                                             AS ingest_date
FROM dedup
WHERE rnk = 1
        );
[0m00:57:44.955572 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.203 seconds
[0m00:57:44.964205 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.fact_order_complete__dbt_tmp
[0m00:57:44.964205 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_order_complete"
[0m00:57:44.964205 [debug] [Thread-1 (]: On model.ManyPets.fact_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_order_complete"} */
drop view if exists DEV.odl.fact_order_complete__dbt_tmp cascade
[0m00:57:45.029089 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.067 seconds
[0m00:57:45.044656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dcda3c0-d116-4110-a6e5-2861b2cd065a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EADA89F220>]}
[0m00:57:45.044656 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model odl.fact_order_complete ................ [[32mSUCCESS 1[0m in 1.36s]
[0m00:57:45.054577 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_order_complete
[0m00:57:45.056395 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m00:57:45.057391 [info ] [Thread-1 (]: 6 of 6 START sql incremental model odl.fact_orders ............................. [RUN]
[0m00:57:45.060034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.fact_order_complete, now model.ManyPets.fact_orders)
[0m00:57:45.062119 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_orders
[0m00:57:45.069680 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_orders"
[0m00:57:45.069680 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_orders
[0m00:57:45.083677 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:57:45.083677 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
create or replace  temporary view DEV.odl.fact_orders__dbt_tmp
  
   as (
     
WITH fact_data AS (
    SELECT 
        f.order_id,
        f.order_date,
        f.cessation_date,
        f.affiliate_code,
        f.pet_value,
        f.source,
        f.event_type,
        /*f.event_time,
        f.envelope_version,
        f.detail_version,
        f.intent,
        f.tenant,
        f.experiments,*/
        c.customer_sk,
        p.pet_sk,
        f.ingest_date
    FROM DEV.staging.stg_orders f
    LEFT JOIN DEV.odl.dim_customers c 
        ON f.customer_email = c.customer_nk
    LEFT JOIN DEV.odl.dim_pets p 
        ON f.pet_name = p.pet_name 
        AND f.pet_dob = p.pet_dob
        AND f.pet_breed = p.pet_breed
        
    
        WHERE f.ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.fact_orders)
    
)

, dedup AS (
    SELECT 
        f.*,
        ROW_NUMBER() OVER(PARTITION BY f.order_id, f.customer_sk, f.pet_sk ORDER BY f.ingest_date DESC) AS rnk
    FROM fact_data f
)

SELECT 
     order_id || '|' || customer_sk || '|'|| pet_sk         AS order_nk,
    md5(cast(coalesce(cast(order_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))    AS order_sk,
    customer_sk                                             AS customer_sk,
    pet_sk                                                  AS pet_sk,
    order_date                                              AS order_date,
    cessation_date                                          AS cessation_date,
    COALESCE(affiliate_code, 'unknown')                     AS affiliate_code,
    pet_value                                               AS pet_value,
    source                                                  AS order_source,
    event_type                                              AS order_type,
/*
    event_time,
    envelope_version,
    detail_version,
    intent,
    tenant,
    experiments,
*/
    ingest_date
FROM dedup
WHERE rnk = 1
  );
[0m00:57:45.462415 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.380 seconds
[0m00:57:45.579718 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:57:45.579718 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
describe table DEV.odl.fact_orders__dbt_tmp
[0m00:57:45.679523 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.090 seconds
[0m00:57:45.697739 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:57:45.697739 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
describe table DEV.odl.fact_orders
[0m00:57:45.766057 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.071 seconds
[0m00:57:45.783304 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:57:45.783304 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
describe table "DEV"."ODL"."FACT_ORDERS"
[0m00:57:45.873621 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.077 seconds
[0m00:57:45.890946 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.fact_orders"
[0m00:57:45.904004 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:57:45.904004 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m00:57:46.183730 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.276 seconds
[0m00:57:46.183730 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:57:46.183730 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
merge into DEV.odl.fact_orders as DBT_INTERNAL_DEST
        using DEV.odl.fact_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_nk = DBT_INTERNAL_DEST.order_nk))

    
    when matched then update set
        "ORDER_NK" = DBT_INTERNAL_SOURCE."ORDER_NK","ORDER_SK" = DBT_INTERNAL_SOURCE."ORDER_SK","CUSTOMER_SK" = DBT_INTERNAL_SOURCE."CUSTOMER_SK","PET_SK" = DBT_INTERNAL_SOURCE."PET_SK","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","CESSATION_DATE" = DBT_INTERNAL_SOURCE."CESSATION_DATE","AFFILIATE_CODE" = DBT_INTERNAL_SOURCE."AFFILIATE_CODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","ORDER_SOURCE" = DBT_INTERNAL_SOURCE."ORDER_SOURCE","ORDER_TYPE" = DBT_INTERNAL_SOURCE."ORDER_TYPE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_NK", "ORDER_SK", "CUSTOMER_SK", "PET_SK", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "PET_VALUE", "ORDER_SOURCE", "ORDER_TYPE", "INGEST_DATE")
    values
        ("ORDER_NK", "ORDER_SK", "CUSTOMER_SK", "PET_SK", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "PET_VALUE", "ORDER_SOURCE", "ORDER_TYPE", "INGEST_DATE")

;
[0m00:57:47.107843 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.915 seconds
[0m00:57:47.107843 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:57:47.107843 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
COMMIT
[0m00:57:47.303450 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.192 seconds
[0m00:57:47.319326 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.fact_orders__dbt_tmp
[0m00:57:47.335336 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m00:57:47.336344 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
drop view if exists DEV.odl.fact_orders__dbt_tmp cascade
[0m00:57:47.443437 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.113 seconds
[0m00:57:47.459106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dcda3c0-d116-4110-a6e5-2861b2cd065a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EADA79F430>]}
[0m00:57:47.459106 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model odl.fact_orders ........................ [[32mSUCCESS 0[0m in 2.40s]
[0m00:57:47.467953 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m00:57:47.473879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:57:47.478985 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m00:57:47.482035 [debug] [MainThread]: On list_DEV: Close
[0m00:57:47.587271 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m00:57:47.590480 [debug] [MainThread]: On list_DEV_odl: Close
[0m00:57:47.721369 [debug] [MainThread]: Connection 'model.ManyPets.fact_orders' was left open.
[0m00:57:47.721369 [debug] [MainThread]: On model.ManyPets.fact_orders: Close
[0m00:57:47.846497 [info ] [MainThread]: 
[0m00:57:47.852969 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 0 minutes and 17.92 seconds (17.92s).
[0m00:57:47.864680 [debug] [MainThread]: Command end result
[0m00:57:47.942553 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m00:57:47.946993 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m00:57:47.960525 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m00:57:47.961735 [info ] [MainThread]: 
[0m00:57:47.962838 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:57:47.968889 [info ] [MainThread]: 
[0m00:57:47.970292 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m00:57:47.973930 [debug] [MainThread]: Command `dbt run` succeeded at 00:57:47.973697 after 20.47 seconds
[0m00:57:47.975689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD61C5FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD651DED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EADA803490>]}
[0m00:57:47.979004 [debug] [MainThread]: Flushing usage events
[0m00:57:49.038750 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:03:47.674265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E5B0A6080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E5CF9D570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E5CF9D180>]}


============================== 10:03:47.683502 | b63af871-3881-4e7b-b30d-4ddd78330f25 ==============================
[0m10:03:47.683502 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:03:47.685036 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:03:48.705562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b63af871-3881-4e7b-b30d-4ddd78330f25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E5B3FE080>]}
[0m10:03:48.831012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b63af871-3881-4e7b-b30d-4ddd78330f25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E5CE73130>]}
[0m10:03:48.831012 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:03:49.521617 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:03:49.979842 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:03:49.979842 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:03:50.079867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b63af871-3881-4e7b-b30d-4ddd78330f25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E5EE98130>]}
[0m10:03:50.377128 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m10:03:50.388685 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m10:03:50.486171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b63af871-3881-4e7b-b30d-4ddd78330f25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E5EE99090>]}
[0m10:03:50.487047 [info ] [MainThread]: Found 6 models, 11 data tests, 2 sources, 591 macros
[0m10:03:50.489359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b63af871-3881-4e7b-b30d-4ddd78330f25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E5EE98220>]}
[0m10:03:50.496618 [info ] [MainThread]: 
[0m10:03:50.499423 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:03:50.501822 [info ] [MainThread]: 
[0m10:03:50.505121 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:03:50.538977 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m10:03:50.755031 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m10:03:50.755031 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m10:03:50.755031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:51.711888 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.962 seconds
[0m10:03:51.725259 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m10:03:51.729642 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m10:03:51.737666 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m10:03:51.914341 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.175 seconds
[0m10:03:51.928325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b63af871-3881-4e7b-b30d-4ddd78330f25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E5EE9ABC0>]}
[0m10:03:51.962212 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m10:03:51.962212 [info ] [Thread-1 (]: 1 of 11 START test not_null_stg_order_complete_customer_id ..................... [RUN]
[0m10:03:51.967814 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b'
[0m10:03:51.967814 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m10:03:52.013430 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b"
[0m10:03:52.023846 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m10:03:52.061423 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b"
[0m10:03:52.068238 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b"
[0m10:03:52.069240 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from DEV.staging.stg_order_complete
where customer_id is null



      
    ) dbt_internal_test
[0m10:03:52.069240 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:03:53.038306 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.967 seconds
[0m10:03:53.077303 [info ] [Thread-1 (]: 1 of 11 PASS not_null_stg_order_complete_customer_id ........................... [[32mPASS[0m in 1.11s]
[0m10:03:53.087013 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m10:03:53.088544 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m10:03:53.088544 [info ] [Thread-1 (]: 2 of 11 START test not_null_stg_order_complete_ingest_date ..................... [RUN]
[0m10:03:53.090258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b, now test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec)
[0m10:03:53.092290 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m10:03:53.093394 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m10:03:53.101435 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m10:03:53.110110 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m10:03:53.120571 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m10:03:53.121571 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ingest_date
from DEV.staging.stg_order_complete
where ingest_date is null



      
    ) dbt_internal_test
[0m10:03:53.346412 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.224 seconds
[0m10:03:53.346412 [info ] [Thread-1 (]: 2 of 11 PASS not_null_stg_order_complete_ingest_date ........................... [[32mPASS[0m in 0.26s]
[0m10:03:53.357416 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m10:03:53.358934 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m10:03:53.361415 [info ] [Thread-1 (]: 3 of 11 START test not_null_stg_order_complete_order_id ........................ [RUN]
[0m10:03:53.363909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec, now test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce)
[0m10:03:53.367074 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m10:03:53.388655 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m10:03:53.395601 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m10:03:53.408611 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m10:03:53.415833 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m10:03:53.417168 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from DEV.staging.stg_order_complete
where order_id is null



      
    ) dbt_internal_test
[0m10:03:53.860590 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.443 seconds
[0m10:03:53.868670 [info ] [Thread-1 (]: 3 of 11 PASS not_null_stg_order_complete_order_id .............................. [[32mPASS[0m in 0.50s]
[0m10:03:53.879777 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m10:03:53.879777 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91
[0m10:03:53.887032 [info ] [Thread-1 (]: 4 of 11 START test not_null_stg_order_complete_order_id__ingest_date ........... [RUN]
[0m10:03:53.895062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce, now test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91)
[0m10:03:53.899482 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91
[0m10:03:53.975632 [debug] [Thread-1 (]: Compilation Error in test not_null_stg_order_complete_order_id__ingest_date (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_not_null' takes no keyword argument 'columns'
[0m10:03:53.977633 [error] [Thread-1 (]: 4 of 11 ERROR not_null_stg_order_complete_order_id__ingest_date ................ [[31mERROR[0m in 0.08s]
[0m10:03:53.979634 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91
[0m10:03:53.980935 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m10:03:53.981940 [debug] [Thread-4 (]: Marking all children of 'test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91' to be skipped because of status 'error'.  Reason: Compilation Error in test not_null_stg_order_complete_order_id__ingest_date (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_not_null' takes no keyword argument 'columns'.
[0m10:03:53.984442 [info ] [Thread-1 (]: 5 of 11 START test not_null_stg_order_complete_pet_id .......................... [RUN]
[0m10:03:53.988587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91, now test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1)
[0m10:03:53.989591 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m10:03:54.015648 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1"
[0m10:03:54.018170 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m10:03:54.030827 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1"
[0m10:03:54.030827 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1"
[0m10:03:54.038967 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pet_id
from DEV.staging.stg_order_complete
where pet_id is null



      
    ) dbt_internal_test
[0m10:03:55.292878 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.250 seconds
[0m10:03:55.304368 [info ] [Thread-1 (]: 5 of 11 PASS not_null_stg_order_complete_pet_id ................................ [[32mPASS[0m in 1.31s]
[0m10:03:55.311700 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m10:03:55.311700 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_email.5fa7373d74
[0m10:03:55.311700 [info ] [Thread-1 (]: 6 of 11 START test not_null_stg_orders_email ................................... [RUN]
[0m10:03:55.324771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1, now test.ManyPets.not_null_stg_orders_email.5fa7373d74)
[0m10:03:55.327398 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_email.5fa7373d74
[0m10:03:55.348231 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_email.5fa7373d74"
[0m10:03:55.358226 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_email.5fa7373d74
[0m10:03:55.363069 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_email.5fa7373d74"
[0m10:03:55.369874 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_email.5fa7373d74"
[0m10:03:55.370879 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_email.5fa7373d74: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_email.5fa7373d74"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from DEV.staging.stg_orders
where email is null



      
    ) dbt_internal_test
[0m10:03:55.628229 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb10d7-0000-e3df-0001-b3ce00020082
[0m10:03:55.628229 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'EMAIL'
[0m10:03:55.640012 [debug] [Thread-1 (]: Database Error in test not_null_stg_orders_email (models\staging\staging_schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'EMAIL'
  compiled code at target\run\ManyPets\models\staging\staging_schema.yml\not_null_stg_orders_email.sql
[0m10:03:55.642499 [error] [Thread-1 (]: 6 of 11 ERROR not_null_stg_orders_email ........................................ [[31mERROR[0m in 0.32s]
[0m10:03:55.647025 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_email.5fa7373d74
[0m10:03:55.648953 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m10:03:55.649954 [debug] [Thread-4 (]: Marking all children of 'test.ManyPets.not_null_stg_orders_email.5fa7373d74' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_orders_email (models\staging\staging_schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'EMAIL'
  compiled code at target\run\ManyPets\models\staging\staging_schema.yml\not_null_stg_orders_email.sql.
[0m10:03:55.652473 [info ] [Thread-1 (]: 7 of 11 START test not_null_stg_orders_ingest_date ............................. [RUN]
[0m10:03:55.656751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_email.5fa7373d74, now test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e)
[0m10:03:55.659575 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m10:03:55.677782 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m10:03:55.680526 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m10:03:55.681517 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m10:03:55.690211 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m10:03:55.691559 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ingest_date
from DEV.staging.stg_orders
where ingest_date is null



      
    ) dbt_internal_test
[0m10:03:55.907527 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.212 seconds
[0m10:03:55.916937 [info ] [Thread-1 (]: 7 of 11 PASS not_null_stg_orders_ingest_date ................................... [[32mPASS[0m in 0.26s]
[0m10:03:55.926126 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m10:03:55.928805 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m10:03:55.933972 [info ] [Thread-1 (]: 8 of 11 START test not_null_stg_orders_order_id ................................ [RUN]
[0m10:03:55.940268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e, now test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64)
[0m10:03:55.949619 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m10:03:55.976401 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:03:55.978602 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m10:03:55.993968 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:03:55.997868 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:03:55.999746 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from DEV.staging.stg_orders
where order_id is null



      
    ) dbt_internal_test
[0m10:03:56.311394 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.315 seconds
[0m10:03:56.325047 [info ] [Thread-1 (]: 8 of 11 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 0.38s]
[0m10:03:56.332257 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m10:03:56.332257 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m10:03:56.337274 [info ] [Thread-1 (]: 9 of 11 START test not_null_stg_orders_pet_dob ................................. [RUN]
[0m10:03:56.343263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64, now test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6)
[0m10:03:56.345961 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m10:03:56.398606 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m10:03:56.412953 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m10:03:56.425282 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m10:03:56.437200 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m10:03:56.440474 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pet_dob
from DEV.staging.stg_orders
where pet_dob is null



      
    ) dbt_internal_test
[0m10:03:56.623061 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.180 seconds
[0m10:03:56.632862 [info ] [Thread-1 (]: 9 of 11 PASS not_null_stg_orders_pet_dob ....................................... [[32mPASS[0m in 0.28s]
[0m10:03:56.640045 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m10:03:56.643086 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m10:03:56.647350 [info ] [Thread-1 (]: 10 of 11 START test not_null_stg_orders_pet_name ............................... [RUN]
[0m10:03:56.652918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6, now test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5)
[0m10:03:56.663953 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m10:03:56.698408 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m10:03:56.707460 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m10:03:56.724772 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m10:03:56.739240 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m10:03:56.740243 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pet_name
from DEV.staging.stg_orders
where pet_name is null



      
    ) dbt_internal_test
[0m10:03:56.876531 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.138 seconds
[0m10:03:56.892274 [info ] [Thread-1 (]: 10 of 11 PASS not_null_stg_orders_pet_name ..................................... [[32mPASS[0m in 0.24s]
[0m10:03:56.899772 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m10:03:56.899772 [debug] [Thread-1 (]: Began running node test.ManyPets.unique_stg_order_complete_order_id__customer_id__pet_id.7ca998ef43
[0m10:03:56.907186 [info ] [Thread-1 (]: 11 of 11 START test unique_stg_order_complete_order_id__customer_id__pet_id .... [RUN]
[0m10:03:56.912886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5, now test.ManyPets.unique_stg_order_complete_order_id__customer_id__pet_id.7ca998ef43)
[0m10:03:56.920534 [debug] [Thread-1 (]: Began compiling node test.ManyPets.unique_stg_order_complete_order_id__customer_id__pet_id.7ca998ef43
[0m10:03:56.990967 [debug] [Thread-1 (]: Compilation Error in test unique_stg_order_complete_order_id__customer_id__pet_id (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'columns'
[0m10:03:56.990967 [error] [Thread-1 (]: 11 of 11 ERROR unique_stg_order_complete_order_id__customer_id__pet_id ......... [[31mERROR[0m in 0.08s]
[0m10:03:56.998283 [debug] [Thread-1 (]: Finished running node test.ManyPets.unique_stg_order_complete_order_id__customer_id__pet_id.7ca998ef43
[0m10:03:56.999456 [debug] [Thread-4 (]: Marking all children of 'test.ManyPets.unique_stg_order_complete_order_id__customer_id__pet_id.7ca998ef43' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_stg_order_complete_order_id__customer_id__pet_id (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'columns'.
[0m10:03:57.005521 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:03:57.007554 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m10:03:57.008859 [debug] [MainThread]: On list_DEV_staging: Close
[0m10:03:57.124252 [debug] [MainThread]: Connection 'test.ManyPets.unique_stg_order_complete_order_id__customer_id__pet_id.7ca998ef43' was left open.
[0m10:03:57.124252 [debug] [MainThread]: On test.ManyPets.unique_stg_order_complete_order_id__customer_id__pet_id.7ca998ef43: Close
[0m10:03:57.259579 [info ] [MainThread]: 
[0m10:03:57.263908 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 6.75 seconds (6.75s).
[0m10:03:57.280056 [debug] [MainThread]: Command end result
[0m10:03:57.400573 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m10:03:57.405368 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m10:03:57.421167 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m10:03:57.421748 [info ] [MainThread]: 
[0m10:03:57.423288 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m10:03:57.425288 [info ] [MainThread]: 
[0m10:03:57.426359 [error] [MainThread]:   Compilation Error in test not_null_stg_order_complete_order_id__ingest_date (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_not_null' takes no keyword argument 'columns'
[0m10:03:57.433924 [info ] [MainThread]: 
[0m10:03:57.441776 [error] [MainThread]:   Database Error in test not_null_stg_orders_email (models\staging\staging_schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'EMAIL'
  compiled code at target\run\ManyPets\models\staging\staging_schema.yml\not_null_stg_orders_email.sql
[0m10:03:57.448371 [info ] [MainThread]: 
[0m10:03:57.453005 [error] [MainThread]:   Compilation Error in test unique_stg_order_complete_order_id__customer_id__pet_id (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'columns'
[0m10:03:57.458105 [info ] [MainThread]: 
[0m10:03:57.466252 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=3 SKIP=0 TOTAL=11
[0m10:03:57.476127 [debug] [MainThread]: Command `dbt test` failed at 10:03:57.476127 after 9.99 seconds
[0m10:03:57.478501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E5B0A6080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E5B3EE680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E5F71CBB0>]}
[0m10:03:57.478501 [debug] [MainThread]: Flushing usage events
[0m10:03:58.166207 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:05:52.932279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBCAA76050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBCC99EBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBCC99EA10>]}


============================== 10:05:52.936512 | 2d9f4fcf-7d3c-45b0-a7df-ea6efea54dfb ==============================
[0m10:05:52.936512 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:05:52.939736 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select fact_order_complete', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:05:53.690541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d9f4fcf-7d3c-45b0-a7df-ea6efea54dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBCADBE6E0>]}
[0m10:05:53.806076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d9f4fcf-7d3c-45b0-a7df-ea6efea54dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBCC841240>]}
[0m10:05:53.806076 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:05:54.321957 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:05:54.739107 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:05:54.739107 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:05:54.835878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d9f4fcf-7d3c-45b0-a7df-ea6efea54dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBCE868130>]}
[0m10:05:55.113404 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m10:05:55.122200 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m10:05:55.165529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d9f4fcf-7d3c-45b0-a7df-ea6efea54dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBCE845750>]}
[0m10:05:55.166530 [info ] [MainThread]: Found 6 models, 11 data tests, 2 sources, 591 macros
[0m10:05:55.167888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d9f4fcf-7d3c-45b0-a7df-ea6efea54dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBCD774580>]}
[0m10:05:55.170818 [info ] [MainThread]: 
[0m10:05:55.173619 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:05:55.176570 [info ] [MainThread]: 
[0m10:05:55.178428 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:05:55.182721 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m10:05:55.390706 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m10:05:55.390706 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m10:05:55.390706 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:05:56.116769 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.712 seconds
[0m10:05:56.137387 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m10:05:56.168616 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m10:05:56.170188 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m10:05:56.172290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:05:56.761310 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.592 seconds
[0m10:05:56.769464 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m10:05:56.782833 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m10:05:56.782833 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m10:05:56.902643 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.121 seconds
[0m10:05:56.919873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d9f4fcf-7d3c-45b0-a7df-ea6efea54dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBCD2BBB80>]}
[0m10:05:56.941538 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_order_complete
[0m10:05:56.942533 [info ] [Thread-1 (]: 1 of 1 START sql incremental model odl.fact_order_complete ..................... [RUN]
[0m10:05:56.949081 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.fact_order_complete'
[0m10:05:56.949081 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_order_complete
[0m10:05:57.019296 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_order_complete"
[0m10:05:57.019296 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_order_complete
[0m10:05:57.103493 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.fact_order_complete"
[0m10:05:57.120327 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_order_complete"
[0m10:05:57.120327 [debug] [Thread-1 (]: On model.ManyPets.fact_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_order_complete"} */
create or replace transient table DEV.odl.fact_order_complete
         as
        ( 

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING        AS order_id,
        data:detail:intent::STRING          AS intent,
        data:detail:tenant::STRING          AS tenant,
        data:detail:customer_id::STRING     AS customer_id,
        pet.value                           AS pet_id,  
        data:time::TIMESTAMP                AS event_time,
        data:source::STRING                 AS source,
        data:type::STRING                   AS event_type,
        ingest_date                         AS ingest_date
    FROM dev.rdl.order_complete o,
    LATERAL FLATTEN(input => o.data:detail:pet_ids) AS pet   

    
),
fact_data AS (
    SELECT
        s.order_id,
        s.intent,
        s.tenant,
        s.event_time,
        s.source,
        s.event_type,
        s.ingest_date,
        c.customer_sk,
        p.pet_sk
    FROM source_data s
    LEFT JOIN DEV.odl.dim_customers c 
        ON s.customer_id = c.customer_nk   
    LEFT JOIN DEV.odl.dim_pets p 
        ON s.pet_id = p.pet_nk            
),

dedup AS (
    SELECT 
        *,
        ROW_NUMBER() OVER ( PARTITION BY order_id ORDER BY ingest_date DESC ) AS rnk
    FROM fact_data
)

SELECT 
    --order_id || '|' || customer_sk || '|' || pet_sk       AS order_nk,
    --customer_sk and pet_sk will be null 
    order_id                                                AS order_nk,
    md5(cast(coalesce(cast(order_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))    AS order_sk,
    -- order_id is added as connecting between order and order_complete on order_sk is not feasible due to missing customer_id and pet_id in the dataset.
    order_id                                                AS order_id,
    customer_sk                                             AS customer_sk,
    pet_sk                                                  AS pet_sk,
    intent                                                  AS intent,
    tenant                                                  AS tenant,
    event_time                                              AS event_time,
    source                                                  AS source,
    event_type                                              AS event_type,
    ingest_date                                             AS ingest_date
FROM dedup
WHERE rnk = 1
        );
[0m10:05:57.120327 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:06:00.620907 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.503 seconds
[0m10:06:00.652159 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.fact_order_complete__dbt_tmp
[0m10:06:00.667772 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_order_complete"
[0m10:06:00.667772 [debug] [Thread-1 (]: On model.ManyPets.fact_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_order_complete"} */
drop view if exists DEV.odl.fact_order_complete__dbt_tmp cascade
[0m10:06:00.739335 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.069 seconds
[0m10:06:00.807591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d9f4fcf-7d3c-45b0-a7df-ea6efea54dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBCEF766B0>]}
[0m10:06:00.808588 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model odl.fact_order_complete ................ [[32mSUCCESS 1[0m in 3.85s]
[0m10:06:00.810705 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_order_complete
[0m10:06:00.813212 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:06:00.814215 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m10:06:00.814215 [debug] [MainThread]: On list_DEV: Close
[0m10:06:00.924814 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m10:06:00.924814 [debug] [MainThread]: On list_DEV_odl: Close
[0m10:06:01.043427 [debug] [MainThread]: Connection 'model.ManyPets.fact_order_complete' was left open.
[0m10:06:01.043427 [debug] [MainThread]: On model.ManyPets.fact_order_complete: Close
[0m10:06:01.167602 [info ] [MainThread]: 
[0m10:06:01.179879 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.99 seconds (5.99s).
[0m10:06:01.184893 [debug] [MainThread]: Command end result
[0m10:06:01.276694 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m10:06:01.292863 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m10:06:01.306062 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m10:06:01.307064 [info ] [MainThread]: 
[0m10:06:01.308603 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:06:01.314169 [info ] [MainThread]: 
[0m10:06:01.315208 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:06:01.318821 [debug] [MainThread]: Command `dbt run` succeeded at 10:06:01.318821 after 8.56 seconds
[0m10:06:01.318821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBCAA76050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBCADB29E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBCAD72380>]}
[0m10:06:01.318821 [debug] [MainThread]: Flushing usage events
[0m10:06:02.157760 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:06:08.275064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002465F5A5F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246614FEA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246614FE890>]}


============================== 10:06:08.279739 | d772913d-3fec-4394-bb25-ad427db2d792 ==============================
[0m10:06:08.279739 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:06:08.282683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:06:09.056686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd772913d-3fec-4394-bb25-ad427db2d792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024661DE7CD0>]}
[0m10:06:09.156565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd772913d-3fec-4394-bb25-ad427db2d792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246613722C0>]}
[0m10:06:09.172701 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:06:09.666288 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:06:10.081675 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:06:10.081675 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:06:10.192837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd772913d-3fec-4394-bb25-ad427db2d792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024663398130>]}
[0m10:06:10.462060 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m10:06:10.486262 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m10:06:10.569913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd772913d-3fec-4394-bb25-ad427db2d792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246633996C0>]}
[0m10:06:10.571775 [info ] [MainThread]: Found 6 models, 11 data tests, 2 sources, 591 macros
[0m10:06:10.573670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd772913d-3fec-4394-bb25-ad427db2d792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002466339B7F0>]}
[0m10:06:10.581242 [info ] [MainThread]: 
[0m10:06:10.583657 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:06:10.586346 [info ] [MainThread]: 
[0m10:06:10.589062 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:06:10.620122 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m10:06:10.798032 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m10:06:10.798032 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m10:06:10.798032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:06:11.711802 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.912 seconds
[0m10:06:11.711802 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m10:06:11.732756 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m10:06:11.732756 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m10:06:11.990275 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.246 seconds
[0m10:06:12.007401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd772913d-3fec-4394-bb25-ad427db2d792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002466339A500>]}
[0m10:06:12.026531 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m10:06:12.027542 [info ] [Thread-1 (]: 1 of 11 START test not_null_stg_order_complete_customer_id ..................... [RUN]
[0m10:06:12.034044 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b'
[0m10:06:12.035059 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m10:06:12.082907 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b"
[0m10:06:12.082907 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m10:06:12.124014 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b"
[0m10:06:12.129662 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b"
[0m10:06:12.131664 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from DEV.staging.stg_order_complete
where customer_id is null



      
    ) dbt_internal_test
[0m10:06:12.132665 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:06:12.735661 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.607 seconds
[0m10:06:12.768421 [info ] [Thread-1 (]: 1 of 11 PASS not_null_stg_order_complete_customer_id ........................... [[32mPASS[0m in 0.74s]
[0m10:06:12.779201 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m10:06:12.780982 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m10:06:12.781972 [info ] [Thread-1 (]: 2 of 11 START test not_null_stg_order_complete_ingest_date ..................... [RUN]
[0m10:06:12.784747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b, now test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec)
[0m10:06:12.785742 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m10:06:12.799027 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m10:06:12.799027 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m10:06:12.803066 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m10:06:12.814148 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m10:06:12.815456 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ingest_date
from DEV.staging.stg_order_complete
where ingest_date is null



      
    ) dbt_internal_test
[0m10:06:12.996116 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.182 seconds
[0m10:06:12.996116 [info ] [Thread-1 (]: 2 of 11 PASS not_null_stg_order_complete_ingest_date ........................... [[32mPASS[0m in 0.21s]
[0m10:06:13.013440 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m10:06:13.013440 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m10:06:13.018305 [info ] [Thread-1 (]: 3 of 11 START test not_null_stg_order_complete_order_id ........................ [RUN]
[0m10:06:13.024117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec, now test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce)
[0m10:06:13.028099 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m10:06:13.045140 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m10:06:13.048809 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m10:06:13.055737 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m10:06:13.058796 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m10:06:13.059785 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from DEV.staging.stg_order_complete
where order_id is null



      
    ) dbt_internal_test
[0m10:06:13.164712 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.103 seconds
[0m10:06:13.164712 [info ] [Thread-1 (]: 3 of 11 PASS not_null_stg_order_complete_order_id .............................. [[32mPASS[0m in 0.14s]
[0m10:06:13.182704 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m10:06:13.188036 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91
[0m10:06:13.188036 [info ] [Thread-1 (]: 4 of 11 START test not_null_stg_order_complete_order_id__ingest_date ........... [RUN]
[0m10:06:13.194152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce, now test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91)
[0m10:06:13.195587 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91
[0m10:06:13.220758 [debug] [Thread-1 (]: Compilation Error in test not_null_stg_order_complete_order_id__ingest_date (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_not_null' takes no keyword argument 'columns'
[0m10:06:13.221759 [error] [Thread-1 (]: 4 of 11 ERROR not_null_stg_order_complete_order_id__ingest_date ................ [[31mERROR[0m in 0.03s]
[0m10:06:13.224205 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91
[0m10:06:13.225204 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m10:06:13.226049 [debug] [Thread-4 (]: Marking all children of 'test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91' to be skipped because of status 'error'.  Reason: Compilation Error in test not_null_stg_order_complete_order_id__ingest_date (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_not_null' takes no keyword argument 'columns'.
[0m10:06:13.227552 [info ] [Thread-1 (]: 5 of 11 START test not_null_stg_order_complete_pet_id .......................... [RUN]
[0m10:06:13.232728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91, now test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1)
[0m10:06:13.233723 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m10:06:13.239884 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1"
[0m10:06:13.239884 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m10:06:13.253917 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1"
[0m10:06:13.260058 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1"
[0m10:06:13.262955 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pet_id
from DEV.staging.stg_order_complete
where pet_id is null



      
    ) dbt_internal_test
[0m10:06:13.377086 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.118 seconds
[0m10:06:13.392846 [info ] [Thread-1 (]: 5 of 11 PASS not_null_stg_order_complete_pet_id ................................ [[32mPASS[0m in 0.16s]
[0m10:06:13.404657 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m10:06:13.404657 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_email.5fa7373d74
[0m10:06:13.404657 [info ] [Thread-1 (]: 6 of 11 START test not_null_stg_orders_email ................................... [RUN]
[0m10:06:13.417539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1, now test.ManyPets.not_null_stg_orders_email.5fa7373d74)
[0m10:06:13.421755 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_email.5fa7373d74
[0m10:06:13.454362 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_email.5fa7373d74"
[0m10:06:13.454362 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_email.5fa7373d74
[0m10:06:13.463190 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_email.5fa7373d74"
[0m10:06:13.472780 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_email.5fa7373d74"
[0m10:06:13.473783 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_email.5fa7373d74: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_email.5fa7373d74"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from DEV.staging.stg_orders
where email is null



      
    ) dbt_internal_test
[0m10:06:13.585350 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb10d9-0000-e36c-0001-b3ce0001e2b2
[0m10:06:13.585350 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'EMAIL'
[0m10:06:13.585350 [debug] [Thread-1 (]: Database Error in test not_null_stg_orders_email (models\staging\staging_schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'EMAIL'
  compiled code at target\run\ManyPets\models\staging\staging_schema.yml\not_null_stg_orders_email.sql
[0m10:06:13.585350 [error] [Thread-1 (]: 6 of 11 ERROR not_null_stg_orders_email ........................................ [[31mERROR[0m in 0.17s]
[0m10:06:13.604224 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_email.5fa7373d74
[0m10:06:13.604224 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m10:06:13.604224 [debug] [Thread-4 (]: Marking all children of 'test.ManyPets.not_null_stg_orders_email.5fa7373d74' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_orders_email (models\staging\staging_schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'EMAIL'
  compiled code at target\run\ManyPets\models\staging\staging_schema.yml\not_null_stg_orders_email.sql.
[0m10:06:13.616054 [info ] [Thread-1 (]: 7 of 11 START test not_null_stg_orders_ingest_date ............................. [RUN]
[0m10:06:13.638603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_email.5fa7373d74, now test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e)
[0m10:06:13.652048 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m10:06:13.685239 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m10:06:13.685239 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m10:06:13.695101 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m10:06:13.705325 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m10:06:13.705325 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ingest_date
from DEV.staging.stg_orders
where ingest_date is null



      
    ) dbt_internal_test
[0m10:06:14.446396 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.740 seconds
[0m10:06:14.446396 [info ] [Thread-1 (]: 7 of 11 PASS not_null_stg_orders_ingest_date ................................... [[32mPASS[0m in 0.82s]
[0m10:06:14.462398 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m10:06:14.462398 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m10:06:14.462398 [info ] [Thread-1 (]: 8 of 11 START test not_null_stg_orders_order_id ................................ [RUN]
[0m10:06:14.473439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e, now test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64)
[0m10:06:14.476669 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m10:06:14.494039 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:06:14.497197 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m10:06:14.501422 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:06:14.501422 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:06:14.510751 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from DEV.staging.stg_orders
where order_id is null



      
    ) dbt_internal_test
[0m10:06:14.855668 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.347 seconds
[0m10:06:14.855668 [info ] [Thread-1 (]: 8 of 11 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 0.38s]
[0m10:06:14.873174 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m10:06:14.876284 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m10:06:14.878813 [info ] [Thread-1 (]: 9 of 11 START test not_null_stg_orders_pet_dob ................................. [RUN]
[0m10:06:14.883599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64, now test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6)
[0m10:06:14.888681 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m10:06:14.915354 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m10:06:14.916345 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m10:06:14.920521 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m10:06:14.930068 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m10:06:14.931041 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pet_dob
from DEV.staging.stg_orders
where pet_dob is null



      
    ) dbt_internal_test
[0m10:06:15.051215 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.120 seconds
[0m10:06:15.051215 [info ] [Thread-1 (]: 9 of 11 PASS not_null_stg_orders_pet_dob ....................................... [[32mPASS[0m in 0.17s]
[0m10:06:15.068190 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m10:06:15.068190 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m10:06:15.072908 [info ] [Thread-1 (]: 10 of 11 START test not_null_stg_orders_pet_name ............................... [RUN]
[0m10:06:15.077598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6, now test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5)
[0m10:06:15.081176 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m10:06:15.098283 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m10:06:15.098283 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m10:06:15.105430 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m10:06:15.112234 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m10:06:15.113231 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pet_name
from DEV.staging.stg_orders
where pet_name is null



      
    ) dbt_internal_test
[0m10:06:15.201310 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.096 seconds
[0m10:06:15.217964 [info ] [Thread-1 (]: 10 of 11 PASS not_null_stg_orders_pet_name ..................................... [[32mPASS[0m in 0.14s]
[0m10:06:15.229698 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m10:06:15.229698 [debug] [Thread-1 (]: Began running node test.ManyPets.unique_stg_order_complete_order_id__customer_id__pet_id.7ca998ef43
[0m10:06:15.229698 [info ] [Thread-1 (]: 11 of 11 START test unique_stg_order_complete_order_id__customer_id__pet_id .... [RUN]
[0m10:06:15.241096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5, now test.ManyPets.unique_stg_order_complete_order_id__customer_id__pet_id.7ca998ef43)
[0m10:06:15.242661 [debug] [Thread-1 (]: Began compiling node test.ManyPets.unique_stg_order_complete_order_id__customer_id__pet_id.7ca998ef43
[0m10:06:15.298178 [debug] [Thread-1 (]: Compilation Error in test unique_stg_order_complete_order_id__customer_id__pet_id (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'columns'
[0m10:06:15.298178 [error] [Thread-1 (]: 11 of 11 ERROR unique_stg_order_complete_order_id__customer_id__pet_id ......... [[31mERROR[0m in 0.06s]
[0m10:06:15.306219 [debug] [Thread-1 (]: Finished running node test.ManyPets.unique_stg_order_complete_order_id__customer_id__pet_id.7ca998ef43
[0m10:06:15.307748 [debug] [Thread-4 (]: Marking all children of 'test.ManyPets.unique_stg_order_complete_order_id__customer_id__pet_id.7ca998ef43' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_stg_order_complete_order_id__customer_id__pet_id (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'columns'.
[0m10:06:15.310266 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:06:15.311266 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m10:06:15.311266 [debug] [MainThread]: On list_DEV_odl: Close
[0m10:06:15.414137 [debug] [MainThread]: Connection 'test.ManyPets.unique_stg_order_complete_order_id__customer_id__pet_id.7ca998ef43' was left open.
[0m10:06:15.414137 [debug] [MainThread]: On test.ManyPets.unique_stg_order_complete_order_id__customer_id__pet_id.7ca998ef43: Close
[0m10:06:15.541868 [info ] [MainThread]: 
[0m10:06:15.548975 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 4.95 seconds (4.95s).
[0m10:06:15.577107 [debug] [MainThread]: Command end result
[0m10:06:15.701424 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m10:06:15.711197 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m10:06:15.731934 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m10:06:15.733041 [info ] [MainThread]: 
[0m10:06:15.734432 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m10:06:15.736438 [info ] [MainThread]: 
[0m10:06:15.738760 [error] [MainThread]:   Compilation Error in test not_null_stg_order_complete_order_id__ingest_date (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_not_null' takes no keyword argument 'columns'
[0m10:06:15.739822 [info ] [MainThread]: 
[0m10:06:15.761789 [error] [MainThread]:   Database Error in test not_null_stg_orders_email (models\staging\staging_schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'EMAIL'
  compiled code at target\run\ManyPets\models\staging\staging_schema.yml\not_null_stg_orders_email.sql
[0m10:06:15.765939 [info ] [MainThread]: 
[0m10:06:15.768363 [error] [MainThread]:   Compilation Error in test unique_stg_order_complete_order_id__customer_id__pet_id (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'columns'
[0m10:06:15.771129 [info ] [MainThread]: 
[0m10:06:15.772042 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=3 SKIP=0 TOTAL=11
[0m10:06:15.776908 [debug] [MainThread]: Command `dbt test` failed at 10:06:15.775901 after 7.66 seconds
[0m10:06:15.778545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002465F5A5F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024663D5A560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024663D5A710>]}
[0m10:06:15.780643 [debug] [MainThread]: Flushing usage events
[0m10:06:16.343885 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:09:42.481807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5BCD96080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5BEC8D570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5BEC8D180>]}


============================== 10:09:42.486680 | ad21ee27-3b37-4fab-a784-43d06b8967c7 ==============================
[0m10:09:42.486680 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:09:42.490113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:09:43.169454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad21ee27-3b37-4fab-a784-43d06b8967c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5BD0EE080>]}
[0m10:09:43.264554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad21ee27-3b37-4fab-a784-43d06b8967c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5BEB63130>]}
[0m10:09:43.266605 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:09:43.798857 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:09:44.219793 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:09:44.219793 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:09:44.320149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad21ee27-3b37-4fab-a784-43d06b8967c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5C0B84130>]}
[0m10:09:44.598609 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m10:09:44.605977 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m10:09:44.698067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad21ee27-3b37-4fab-a784-43d06b8967c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5BECD7640>]}
[0m10:09:44.699281 [info ] [MainThread]: Found 6 models, 8 data tests, 2 sources, 591 macros
[0m10:09:44.701440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad21ee27-3b37-4fab-a784-43d06b8967c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5BE7D7D90>]}
[0m10:09:44.705954 [info ] [MainThread]: 
[0m10:09:44.711171 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:09:44.714270 [info ] [MainThread]: 
[0m10:09:44.716698 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:09:44.746462 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m10:09:45.001542 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m10:09:45.001542 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m10:09:45.001542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:09:45.999044 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.001 seconds
[0m10:09:46.016694 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m10:09:46.018602 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m10:09:46.018602 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m10:09:46.169803 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.138 seconds
[0m10:09:46.179653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad21ee27-3b37-4fab-a784-43d06b8967c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5C0B02B60>]}
[0m10:09:46.209971 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m10:09:46.212765 [info ] [Thread-1 (]: 1 of 8 START test not_null_stg_order_complete_ingest_date ...................... [RUN]
[0m10:09:46.217194 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec'
[0m10:09:46.217194 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m10:09:46.265939 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m10:09:46.265939 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m10:09:46.306210 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m10:09:46.306210 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m10:09:46.310223 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ingest_date
from DEV.staging.stg_order_complete
where ingest_date is null



      
    ) dbt_internal_test
[0m10:09:46.311240 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:09:46.954385 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.643 seconds
[0m10:09:46.956536 [info ] [Thread-1 (]: 1 of 8 PASS not_null_stg_order_complete_ingest_date ............................ [[32mPASS[0m in 0.74s]
[0m10:09:46.975233 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m10:09:46.976127 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m10:09:46.976127 [info ] [Thread-1 (]: 2 of 8 START test not_null_stg_order_complete_order_id ......................... [RUN]
[0m10:09:46.979832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec, now test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce)
[0m10:09:46.979832 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m10:09:46.998020 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m10:09:47.000010 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m10:09:47.016521 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m10:09:47.020665 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m10:09:47.021670 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from DEV.staging.stg_order_complete
where order_id is null



      
    ) dbt_internal_test
[0m10:09:47.331852 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.309 seconds
[0m10:09:47.341631 [info ] [Thread-1 (]: 2 of 8 PASS not_null_stg_order_complete_order_id ............................... [[32mPASS[0m in 0.36s]
[0m10:09:47.347925 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m10:09:47.347925 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91
[0m10:09:47.352936 [info ] [Thread-1 (]: 3 of 8 START test not_null_stg_order_complete_order_id__ingest_date ............ [RUN]
[0m10:09:47.357772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce, now test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91)
[0m10:09:47.361729 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91
[0m10:09:47.405267 [debug] [Thread-1 (]: Compilation Error in test not_null_stg_order_complete_order_id__ingest_date (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_not_null' takes no keyword argument 'columns'
[0m10:09:47.405840 [error] [Thread-1 (]: 3 of 8 ERROR not_null_stg_order_complete_order_id__ingest_date ................. [[31mERROR[0m in 0.05s]
[0m10:09:47.409050 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91
[0m10:09:47.412487 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_email.5fa7373d74
[0m10:09:47.415145 [debug] [Thread-4 (]: Marking all children of 'test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91' to be skipped because of status 'error'.  Reason: Compilation Error in test not_null_stg_order_complete_order_id__ingest_date (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_not_null' takes no keyword argument 'columns'.
[0m10:09:47.416709 [info ] [Thread-1 (]: 4 of 8 START test not_null_stg_orders_email .................................... [RUN]
[0m10:09:47.420507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91, now test.ManyPets.not_null_stg_orders_email.5fa7373d74)
[0m10:09:47.421506 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_email.5fa7373d74
[0m10:09:47.436727 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_email.5fa7373d74"
[0m10:09:47.439582 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_email.5fa7373d74
[0m10:09:47.449531 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_email.5fa7373d74"
[0m10:09:47.452895 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_email.5fa7373d74"
[0m10:09:47.453891 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_email.5fa7373d74: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_email.5fa7373d74"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from DEV.staging.stg_orders
where email is null



      
    ) dbt_internal_test
[0m10:09:47.569078 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb10dd-0000-e37b-0001-b3ce0001b69a
[0m10:09:47.569078 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'EMAIL'
[0m10:09:47.569078 [debug] [Thread-1 (]: Database Error in test not_null_stg_orders_email (models\staging\staging_schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'EMAIL'
  compiled code at target\run\ManyPets\models\staging\staging_schema.yml\not_null_stg_orders_email.sql
[0m10:09:47.569078 [error] [Thread-1 (]: 4 of 8 ERROR not_null_stg_orders_email ......................................... [[31mERROR[0m in 0.15s]
[0m10:09:47.588658 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_email.5fa7373d74
[0m10:09:47.588658 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m10:09:47.588658 [debug] [Thread-4 (]: Marking all children of 'test.ManyPets.not_null_stg_orders_email.5fa7373d74' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_orders_email (models\staging\staging_schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'EMAIL'
  compiled code at target\run\ManyPets\models\staging\staging_schema.yml\not_null_stg_orders_email.sql.
[0m10:09:47.602547 [info ] [Thread-1 (]: 5 of 8 START test not_null_stg_orders_ingest_date .............................. [RUN]
[0m10:09:47.606707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_email.5fa7373d74, now test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e)
[0m10:09:47.608099 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m10:09:47.618515 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m10:09:47.633228 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m10:09:47.647202 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m10:09:47.653414 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m10:09:47.654416 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ingest_date
from DEV.staging.stg_orders
where ingest_date is null



      
    ) dbt_internal_test
[0m10:09:47.764828 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.112 seconds
[0m10:09:47.764828 [info ] [Thread-1 (]: 5 of 8 PASS not_null_stg_orders_ingest_date .................................... [[32mPASS[0m in 0.16s]
[0m10:09:47.780967 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m10:09:47.780967 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m10:09:47.787687 [info ] [Thread-1 (]: 6 of 8 START test not_null_stg_orders_order_id ................................. [RUN]
[0m10:09:47.792258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e, now test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64)
[0m10:09:47.795998 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m10:09:47.846699 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:09:47.854264 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m10:09:47.874444 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:09:47.882567 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:09:47.883617 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from DEV.staging.stg_orders
where order_id is null



      
    ) dbt_internal_test
[0m10:09:48.001085 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.115 seconds
[0m10:09:48.001085 [info ] [Thread-1 (]: 6 of 8 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.21s]
[0m10:09:48.019913 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m10:09:48.019913 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m10:09:48.019913 [info ] [Thread-1 (]: 7 of 8 START test not_null_stg_orders_pet_dob .................................. [RUN]
[0m10:09:48.031669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64, now test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6)
[0m10:09:48.035996 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m10:09:48.080333 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m10:09:48.081339 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m10:09:48.084382 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m10:09:48.106669 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m10:09:48.111046 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pet_dob
from DEV.staging.stg_orders
where pet_dob is null



      
    ) dbt_internal_test
[0m10:09:48.555927 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.448 seconds
[0m10:09:48.571967 [info ] [Thread-1 (]: 7 of 8 PASS not_null_stg_orders_pet_dob ........................................ [[32mPASS[0m in 0.53s]
[0m10:09:48.574756 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m10:09:48.574756 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m10:09:48.582559 [info ] [Thread-1 (]: 8 of 8 START test not_null_stg_orders_pet_name ................................. [RUN]
[0m10:09:48.586931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6, now test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5)
[0m10:09:48.591613 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m10:09:48.610350 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m10:09:48.614821 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m10:09:48.616321 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m10:09:48.624189 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m10:09:48.626925 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pet_name
from DEV.staging.stg_orders
where pet_name is null



      
    ) dbt_internal_test
[0m10:09:48.730816 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.102 seconds
[0m10:09:48.730816 [info ] [Thread-1 (]: 8 of 8 PASS not_null_stg_orders_pet_name ....................................... [[32mPASS[0m in 0.14s]
[0m10:09:48.746172 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m10:09:48.751931 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:09:48.751931 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m10:09:48.751931 [debug] [MainThread]: On list_DEV_staging: Close
[0m10:09:48.854656 [debug] [MainThread]: Connection 'test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5' was left open.
[0m10:09:48.854656 [debug] [MainThread]: On test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5: Close
[0m10:09:48.981779 [info ] [MainThread]: 
[0m10:09:48.990199 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 4.27 seconds (4.27s).
[0m10:09:48.996686 [debug] [MainThread]: Command end result
[0m10:09:49.077889 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m10:09:49.087114 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m10:09:49.101956 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m10:09:49.103162 [info ] [MainThread]: 
[0m10:09:49.104163 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m10:09:49.105595 [info ] [MainThread]: 
[0m10:09:49.107262 [error] [MainThread]:   Compilation Error in test not_null_stg_order_complete_order_id__ingest_date (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_not_null' takes no keyword argument 'columns'
[0m10:09:49.109680 [info ] [MainThread]: 
[0m10:09:49.111179 [error] [MainThread]:   Database Error in test not_null_stg_orders_email (models\staging\staging_schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'EMAIL'
  compiled code at target\run\ManyPets\models\staging\staging_schema.yml\not_null_stg_orders_email.sql
[0m10:09:49.113973 [info ] [MainThread]: 
[0m10:09:49.116162 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=2 SKIP=0 TOTAL=8
[0m10:09:49.119024 [debug] [MainThread]: Command `dbt test` failed at 10:09:49.118557 after 6.81 seconds
[0m10:09:49.122176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5BCD96080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5BECD7A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5BECD44F0>]}
[0m10:09:49.123173 [debug] [MainThread]: Flushing usage events
[0m10:09:49.892891 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:10:28.012109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CDAC96080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CDCB8D570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CDCB8D180>]}


============================== 10:10:28.017024 | 5bd3d849-b963-476d-916c-b45a1eb212a7 ==============================
[0m10:10:28.017024 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:10:28.019805 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:10:28.744800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bd3d849-b963-476d-916c-b45a1eb212a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CDAFEE080>]}
[0m10:10:28.872122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5bd3d849-b963-476d-916c-b45a1eb212a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CDCA63130>]}
[0m10:10:28.872122 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:10:29.391519 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:10:29.783333 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:10:29.783333 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:10:29.874361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5bd3d849-b963-476d-916c-b45a1eb212a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CDEA84130>]}
[0m10:10:30.149173 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m10:10:30.157301 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m10:10:30.235782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5bd3d849-b963-476d-916c-b45a1eb212a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CDCBD7640>]}
[0m10:10:30.236783 [info ] [MainThread]: Found 6 models, 8 data tests, 2 sources, 591 macros
[0m10:10:30.239075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bd3d849-b963-476d-916c-b45a1eb212a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CDC6D7D90>]}
[0m10:10:30.241587 [info ] [MainThread]: 
[0m10:10:30.245284 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:10:30.246833 [info ] [MainThread]: 
[0m10:10:30.251012 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:10:30.280676 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m10:10:30.477608 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m10:10:30.477608 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m10:10:30.477608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:10:31.274067 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.800 seconds
[0m10:10:31.292216 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m10:10:31.307933 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m10:10:31.307933 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m10:10:31.428020 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.118 seconds
[0m10:10:31.428020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bd3d849-b963-476d-916c-b45a1eb212a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CDEA02B60>]}
[0m10:10:31.459193 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m10:10:31.459193 [info ] [Thread-1 (]: 1 of 8 START test not_null_stg_order_complete_ingest_date ...................... [RUN]
[0m10:10:31.470475 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec'
[0m10:10:31.470475 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m10:10:31.521522 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m10:10:31.521522 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m10:10:31.558066 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m10:10:31.563143 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m10:10:31.564144 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ingest_date
from DEV.staging.stg_order_complete
where ingest_date is null



      
    ) dbt_internal_test
[0m10:10:31.564144 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:10:32.476482 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.926 seconds
[0m10:10:32.524866 [info ] [Thread-1 (]: 1 of 8 PASS not_null_stg_order_complete_ingest_date ............................ [[32mPASS[0m in 1.06s]
[0m10:10:32.533594 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m10:10:32.534809 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m10:10:32.535807 [info ] [Thread-1 (]: 2 of 8 START test not_null_stg_order_complete_order_id ......................... [RUN]
[0m10:10:32.538383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec, now test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce)
[0m10:10:32.541097 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m10:10:32.560482 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m10:10:32.560482 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m10:10:32.572191 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m10:10:32.576402 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m10:10:32.578332 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from DEV.staging.stg_order_complete
where order_id is null



      
    ) dbt_internal_test
[0m10:10:32.793721 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.218 seconds
[0m10:10:32.793721 [info ] [Thread-1 (]: 2 of 8 PASS not_null_stg_order_complete_order_id ............................... [[32mPASS[0m in 0.26s]
[0m10:10:32.812749 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m10:10:32.812749 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91
[0m10:10:32.819033 [info ] [Thread-1 (]: 3 of 8 START test not_null_stg_order_complete_order_id__ingest_date ............ [RUN]
[0m10:10:32.824584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce, now test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91)
[0m10:10:32.827101 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91
[0m10:10:32.859977 [debug] [Thread-1 (]: Compilation Error in test not_null_stg_order_complete_order_id__ingest_date (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_not_null' takes no keyword argument 'columns'
[0m10:10:32.862282 [error] [Thread-1 (]: 3 of 8 ERROR not_null_stg_order_complete_order_id__ingest_date ................. [[31mERROR[0m in 0.04s]
[0m10:10:32.864497 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91
[0m10:10:32.865912 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_email.5fa7373d74
[0m10:10:32.866917 [debug] [Thread-4 (]: Marking all children of 'test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91' to be skipped because of status 'error'.  Reason: Compilation Error in test not_null_stg_order_complete_order_id__ingest_date (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_not_null' takes no keyword argument 'columns'.
[0m10:10:32.868188 [info ] [Thread-1 (]: 4 of 8 START test not_null_stg_orders_email .................................... [RUN]
[0m10:10:32.874638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91, now test.ManyPets.not_null_stg_orders_email.5fa7373d74)
[0m10:10:32.876213 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_email.5fa7373d74
[0m10:10:32.877735 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_email.5fa7373d74"
[0m10:10:32.888802 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_email.5fa7373d74
[0m10:10:32.895378 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_email.5fa7373d74"
[0m10:10:32.899434 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_email.5fa7373d74"
[0m10:10:32.903016 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_email.5fa7373d74: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_email.5fa7373d74"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from DEV.staging.stg_orders
where email is null



      
    ) dbt_internal_test
[0m10:10:33.003364 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb10dd-0000-e37b-0001-b3ce0001b69e
[0m10:10:33.003364 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'EMAIL'
[0m10:10:33.003364 [debug] [Thread-1 (]: Database Error in test not_null_stg_orders_email (models\staging\staging_schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'EMAIL'
  compiled code at target\run\ManyPets\models\staging\staging_schema.yml\not_null_stg_orders_email.sql
[0m10:10:33.003364 [error] [Thread-1 (]: 4 of 8 ERROR not_null_stg_orders_email ......................................... [[31mERROR[0m in 0.13s]
[0m10:10:33.022934 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_email.5fa7373d74
[0m10:10:33.022934 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m10:10:33.022934 [debug] [Thread-4 (]: Marking all children of 'test.ManyPets.not_null_stg_orders_email.5fa7373d74' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_orders_email (models\staging\staging_schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'EMAIL'
  compiled code at target\run\ManyPets\models\staging\staging_schema.yml\not_null_stg_orders_email.sql.
[0m10:10:33.031800 [info ] [Thread-1 (]: 5 of 8 START test not_null_stg_orders_ingest_date .............................. [RUN]
[0m10:10:33.037330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_email.5fa7373d74, now test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e)
[0m10:10:33.039924 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m10:10:33.064152 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m10:10:33.064152 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m10:10:33.076770 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m10:10:33.081211 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m10:10:33.081211 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ingest_date
from DEV.staging.stg_orders
where ingest_date is null



      
    ) dbt_internal_test
[0m10:10:33.188901 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.106 seconds
[0m10:10:33.200092 [info ] [Thread-1 (]: 5 of 8 PASS not_null_stg_orders_ingest_date .................................... [[32mPASS[0m in 0.16s]
[0m10:10:33.206027 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m10:10:33.206027 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m10:10:33.206027 [info ] [Thread-1 (]: 6 of 8 START test not_null_stg_orders_order_id ................................. [RUN]
[0m10:10:33.215439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e, now test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64)
[0m10:10:33.216437 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m10:10:33.265524 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:10:33.276637 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m10:10:33.285465 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:10:33.302952 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:10:33.303967 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from DEV.staging.stg_orders
where order_id is null



      
    ) dbt_internal_test
[0m10:10:33.423999 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.118 seconds
[0m10:10:33.423999 [info ] [Thread-1 (]: 6 of 8 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.21s]
[0m10:10:33.439461 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m10:10:33.439461 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m10:10:33.444435 [info ] [Thread-1 (]: 7 of 8 START test not_null_stg_orders_pet_dob .................................. [RUN]
[0m10:10:33.449111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64, now test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6)
[0m10:10:33.450124 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m10:10:33.473923 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m10:10:33.477511 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m10:10:33.479124 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m10:10:33.486643 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m10:10:33.488420 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pet_dob
from DEV.staging.stg_orders
where pet_dob is null



      
    ) dbt_internal_test
[0m10:10:33.598295 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.107 seconds
[0m10:10:33.598295 [info ] [Thread-1 (]: 7 of 8 PASS not_null_stg_orders_pet_dob ........................................ [[32mPASS[0m in 0.15s]
[0m10:10:33.613638 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m10:10:33.613638 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m10:10:33.613638 [info ] [Thread-1 (]: 8 of 8 START test not_null_stg_orders_pet_name ................................. [RUN]
[0m10:10:33.627888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6, now test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5)
[0m10:10:33.630248 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m10:10:33.649302 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m10:10:33.653743 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m10:10:33.672520 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m10:10:33.677849 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m10:10:33.678862 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pet_name
from DEV.staging.stg_orders
where pet_name is null



      
    ) dbt_internal_test
[0m10:10:33.807309 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.127 seconds
[0m10:10:33.814658 [info ] [Thread-1 (]: 8 of 8 PASS not_null_stg_orders_pet_name ....................................... [[32mPASS[0m in 0.19s]
[0m10:10:33.816915 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m10:10:33.819063 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:10:33.820088 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m10:10:33.820088 [debug] [MainThread]: On list_DEV_staging: Close
[0m10:10:33.907384 [debug] [MainThread]: Connection 'test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5' was left open.
[0m10:10:33.907384 [debug] [MainThread]: On test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5: Close
[0m10:10:34.006236 [info ] [MainThread]: 
[0m10:10:34.019586 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 3.76 seconds (3.76s).
[0m10:10:34.037169 [debug] [MainThread]: Command end result
[0m10:10:34.125248 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m10:10:34.129556 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m10:10:34.146056 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m10:10:34.147054 [info ] [MainThread]: 
[0m10:10:34.148214 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m10:10:34.150224 [info ] [MainThread]: 
[0m10:10:34.151218 [error] [MainThread]:   Compilation Error in test not_null_stg_order_complete_order_id__ingest_date (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_not_null' takes no keyword argument 'columns'
[0m10:10:34.159399 [info ] [MainThread]: 
[0m10:10:34.161369 [error] [MainThread]:   Database Error in test not_null_stg_orders_email (models\staging\staging_schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'EMAIL'
  compiled code at target\run\ManyPets\models\staging\staging_schema.yml\not_null_stg_orders_email.sql
[0m10:10:34.165321 [info ] [MainThread]: 
[0m10:10:34.167205 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=2 SKIP=0 TOTAL=8
[0m10:10:34.173014 [debug] [MainThread]: Command `dbt test` failed at 10:10:34.172390 after 6.30 seconds
[0m10:10:34.176535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CDAC96080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CDCBD7A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CDCBD44F0>]}
[0m10:10:34.177533 [debug] [MainThread]: Flushing usage events
[0m10:10:34.833796 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:11:15.138287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D94B4F5FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D94D41E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D94D41E7A0>]}


============================== 10:11:15.139282 | 162bae36-0924-4c31-9ae3-67ceac9020f0 ==============================
[0m10:11:15.139282 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:11:15.145774 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select fact_orders', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:11:15.876438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '162bae36-0924-4c31-9ae3-67ceac9020f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D94B84DED0>]}
[0m10:11:15.983248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '162bae36-0924-4c31-9ae3-67ceac9020f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D94D28B2B0>]}
[0m10:11:15.983248 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:11:16.497152 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:11:16.912803 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:11:16.912803 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:11:17.004636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '162bae36-0924-4c31-9ae3-67ceac9020f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D94F2E4130>]}
[0m10:11:17.280887 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m10:11:17.288895 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m10:11:17.328114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '162bae36-0924-4c31-9ae3-67ceac9020f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D94E060640>]}
[0m10:11:17.329830 [info ] [MainThread]: Found 6 models, 8 data tests, 2 sources, 591 macros
[0m10:11:17.331306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '162bae36-0924-4c31-9ae3-67ceac9020f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D94F251B10>]}
[0m10:11:17.333312 [info ] [MainThread]: 
[0m10:11:17.337614 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:11:17.339331 [info ] [MainThread]: 
[0m10:11:17.341651 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:11:17.345700 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m10:11:17.555690 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m10:11:17.555690 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m10:11:17.555690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:11:18.668096 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.116 seconds
[0m10:11:18.707912 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m10:11:18.728722 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m10:11:18.728722 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m10:11:18.728722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:11:19.296756 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.557 seconds
[0m10:11:19.297758 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m10:11:19.305127 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m10:11:19.308774 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m10:11:19.419247 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.120 seconds
[0m10:11:19.436060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '162bae36-0924-4c31-9ae3-67ceac9020f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D94DD26650>]}
[0m10:11:19.459112 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m10:11:19.459112 [info ] [Thread-1 (]: 1 of 1 START sql incremental model odl.fact_orders ............................. [RUN]
[0m10:11:19.467343 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.fact_orders'
[0m10:11:19.467343 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_orders
[0m10:11:19.534907 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_orders"
[0m10:11:19.540713 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_orders
[0m10:11:19.653650 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.fact_orders"
[0m10:11:19.659062 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m10:11:19.659062 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
create or replace transient table DEV.odl.fact_orders
         as
        ( 
WITH fact_data AS (
    SELECT 
        f.order_id,
        f.order_date,
        f.cessation_date,
        f.affiliate_code,
        f.pet_value,
        f.source,
        f.event_type,
        /*f.event_time,
        f.envelope_version,
        f.detail_version,
        f.intent,
        f.tenant,
        f.experiments,*/
        c.customer_sk,
        p.pet_sk,
        f.ingest_date
    FROM DEV.staging.stg_orders f
    LEFT JOIN DEV.odl.dim_customers c 
        ON f.customer_email = c.customer_nk
    LEFT JOIN DEV.odl.dim_pets p 
        ON f.pet_name = p.pet_name 
        AND f.pet_dob = p.pet_dob
        AND f.pet_breed = p.pet_breed

    
)

, dedup AS (
    SELECT 
        f.*,
        ROW_NUMBER() OVER(PARTITION BY f.order_id, f.customer_sk, f.pet_sk ORDER BY f.ingest_date DESC) AS rnk
    FROM fact_data f
)

SELECT 
     order_id || '|' || customer_sk || '|'|| pet_sk         AS order_nk,
    md5(cast(coalesce(cast(order_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))    AS order_sk,
    -- order_id is added as connecting between order and order_complete on order_sk is not feasible due to missing customer_id and pet_id in the dataset.
    order_id                                                AS order_id,
    customer_sk                                             AS customer_sk,
    pet_sk                                                  AS pet_sk,
    order_date                                              AS order_date,
    cessation_date                                          AS cessation_date,
    COALESCE(affiliate_code, 'unknown')                     AS affiliate_code,
    pet_value                                               AS pet_value,
    source                                                  AS order_source,
    event_type                                              AS order_type,
/*
    event_time,
    envelope_version,
    detail_version,
    intent,
    tenant,
    experiments,
*/
    ingest_date
FROM dedup
WHERE rnk = 1
        );
[0m10:11:19.659062 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:11:22.332584 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.671 seconds
[0m10:11:22.348543 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.fact_orders__dbt_tmp
[0m10:11:22.348543 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m10:11:22.348543 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
drop view if exists DEV.odl.fact_orders__dbt_tmp cascade
[0m10:11:22.433190 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.071 seconds
[0m10:11:22.492164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '162bae36-0924-4c31-9ae3-67ceac9020f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D94F98F7F0>]}
[0m10:11:22.493168 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model odl.fact_orders ........................ [[32mSUCCESS 1[0m in 3.02s]
[0m10:11:22.496438 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m10:11:22.498794 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:11:22.499791 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m10:11:22.499791 [debug] [MainThread]: On list_DEV: Close
[0m10:11:22.611897 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m10:11:22.611897 [debug] [MainThread]: On list_DEV_staging: Close
[0m10:11:22.743932 [debug] [MainThread]: Connection 'model.ManyPets.fact_orders' was left open.
[0m10:11:22.744944 [debug] [MainThread]: On model.ManyPets.fact_orders: Close
[0m10:11:22.844625 [info ] [MainThread]: 
[0m10:11:22.859455 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.50 seconds (5.50s).
[0m10:11:22.863981 [debug] [MainThread]: Command end result
[0m10:11:22.962064 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m10:11:22.967721 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m10:11:22.981987 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m10:11:22.982995 [info ] [MainThread]: 
[0m10:11:22.984740 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:11:22.985775 [info ] [MainThread]: 
[0m10:11:22.987283 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:11:22.989992 [debug] [MainThread]: Command `dbt run` succeeded at 10:11:22.989992 after 8.00 seconds
[0m10:11:22.992492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D94B4F5FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D94B84DED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D94FA60760>]}
[0m10:11:22.992492 [debug] [MainThread]: Flushing usage events
[0m10:11:23.567492 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:23:48.276385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002052F735FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002052FA7DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205316734F0>]}


============================== 18:23:48.289316 | 40ef796d-25c9-43df-a4c1-0101cf31ba84 ==============================
[0m18:23:48.289316 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:23:48.293198 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:23:50.933077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40ef796d-25c9-43df-a4c1-0101cf31ba84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002052FA72800>]}
[0m18:23:51.131994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40ef796d-25c9-43df-a4c1-0101cf31ba84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205315022C0>]}
[0m18:23:51.135119 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:23:52.442643 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:23:53.022918 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:23:53.022918 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:23:53.191432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40ef796d-25c9-43df-a4c1-0101cf31ba84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020533524130>]}
[0m18:23:53.288794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40ef796d-25c9-43df-a4c1-0101cf31ba84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205334C5FF0>]}
[0m18:23:53.290906 [info ] [MainThread]: Found 6 models, 8 data tests, 2 sources, 591 macros
[0m18:23:53.293130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40ef796d-25c9-43df-a4c1-0101cf31ba84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205334C6830>]}
[0m18:23:53.293130 [info ] [MainThread]: 
[0m18:23:53.300219 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:23:53.302609 [info ] [MainThread]: 
[0m18:23:53.308374 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:23:53.346921 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m18:23:58.452110 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m18:23:58.452110 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m18:23:58.452110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:23:59.490115 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.036 seconds
[0m18:23:59.500390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m18:23:59.516950 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m18:23:59.516950 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m18:23:59.649296 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.129 seconds
[0m18:23:59.657166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40ef796d-25c9-43df-a4c1-0101cf31ba84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020531F667A0>]}
[0m18:23:59.675198 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_order_complete
[0m18:23:59.676205 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_order_complete'
[0m18:23:59.676205 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_order_complete
[0m18:23:59.716157 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_order_complete"
[0m18:23:59.720009 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_order_complete
[0m18:23:59.722984 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_order_complete
[0m18:23:59.723916 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m18:23:59.724932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_order_complete, now model.ManyPets.stg_orders)
[0m18:23:59.726300 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m18:23:59.733784 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m18:23:59.733784 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m18:23:59.740183 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m18:23:59.740183 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m18:23:59.742185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_orders, now test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec)
[0m18:23:59.743067 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m18:23:59.758918 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m18:23:59.765713 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m18:23:59.767311 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m18:23:59.768314 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m18:23:59.769773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec, now test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce)
[0m18:23:59.770773 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m18:23:59.770773 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m18:23:59.778830 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m18:23:59.782319 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m18:23:59.783329 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91
[0m18:23:59.783329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce, now test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91)
[0m18:23:59.783329 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91
[0m18:23:59.997080 [debug] [Thread-1 (]: Compilation Error in test not_null_stg_order_complete_order_id__ingest_date (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_not_null' takes no keyword argument 'columns'
[0m18:23:59.998634 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91
[0m18:23:59.998634 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m18:23:59.998634 [debug] [Thread-4 (]: Marking all children of 'test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91' to be skipped because of status 'error'.  Reason: Compilation Error in test not_null_stg_order_complete_order_id__ingest_date (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_not_null' takes no keyword argument 'columns'.
[0m18:24:00.001341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91, now model.ManyPets.dim_customers)
[0m18:24:00.002260 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m18:24:00.032006 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m18:24:00.041932 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m18:24:00.042931 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m18:24:00.042931 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_email.5fa7373d74
[0m18:24:00.047252 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:24:00.048752 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m18:24:00.049763 [debug] [MainThread]: On list_DEV_odl: Close
[0m18:24:00.151296 [debug] [MainThread]: Connection 'model.ManyPets.dim_customers' was properly closed.
[0m18:24:00.159563 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.ManyPets.not_null_stg_orders_email.5fa7373d74'
[0m18:24:00.162442 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_email.5fa7373d74
[0m18:24:00.151296 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in test not_null_stg_order_complete_order_id__ingest_date (models\staging\staging_schema.yml)
    macro 'dbt_macro__test_not_null' takes no keyword argument 'columns'
[0m18:24:00.194066 [debug] [MainThread]: Command `dbt docs generate` failed at 18:24:00.194066 after 12.18 seconds
[0m18:24:00.199167 [debug] [MainThread]: Connection 'test.ManyPets.not_null_stg_orders_email.5fa7373d74' was properly closed.
[0m18:24:00.210616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002052F735FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053358DAB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205334A2B90>]}
[0m18:24:00.217175 [debug] [MainThread]: Flushing usage events
[0m18:24:00.225293 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_email.5fa7373d74"
[0m18:24:00.236490 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_email.5fa7373d74
[0m18:24:00.241048 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_email.5fa7373d74
[0m18:24:00.244650 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m18:24:00.248812 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e'
[0m18:24:00.250560 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m18:24:00.265674 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m18:24:00.277761 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m18:24:00.281591 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m18:24:00.283538 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m18:24:00.285160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e, now test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64)
[0m18:24:00.286161 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m18:24:00.298707 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m18:24:00.307255 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m18:24:00.310820 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m18:24:00.310820 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m18:24:00.314823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64, now test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6)
[0m18:24:00.316688 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m18:24:00.332058 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m18:24:00.337058 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m18:24:00.338056 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m18:24:00.338056 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m18:24:00.342389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6, now test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5)
[0m18:24:00.343417 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m18:24:00.349116 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m18:24:00.349116 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m18:24:00.355974 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m18:24:01.099315 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:51:12.714877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C12536020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C1445EB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C1445E9B0>]}


============================== 18:51:12.724791 | 13210694-9f12-4534-bc59-056577b92309 ==============================
[0m18:51:12.724791 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:51:12.727461 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_orders', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:51:13.799988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13210694-9f12-4534-bc59-056577b92309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C10DB9C60>]}
[0m18:51:13.885056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13210694-9f12-4534-bc59-056577b92309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C14301B70>]}
[0m18:51:13.900638 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:51:14.459890 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:51:14.885558 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:51:14.885558 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:51:14.986921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13210694-9f12-4534-bc59-056577b92309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C16324130>]}
[0m18:51:15.243117 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m18:51:15.329984 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m18:51:15.407546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13210694-9f12-4534-bc59-056577b92309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C16327580>]}
[0m18:51:15.409784 [info ] [MainThread]: Found 6 models, 8 data tests, 2 sources, 591 macros
[0m18:51:15.411784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13210694-9f12-4534-bc59-056577b92309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C16327640>]}
[0m18:51:15.415263 [info ] [MainThread]: 
[0m18:51:15.417753 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:51:15.420142 [info ] [MainThread]: 
[0m18:51:15.422387 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:51:15.426412 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m18:51:15.663089 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m18:51:15.663089 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m18:51:15.663089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:51:37.664456 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 21.999 seconds
[0m18:51:37.677980 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m18:51:37.694681 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m18:51:37.694681 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m18:51:37.694681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:51:38.426550 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.734 seconds
[0m18:51:38.443917 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m18:51:38.446701 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m18:51:38.446701 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m18:51:38.590375 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.125 seconds
[0m18:51:38.591385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13210694-9f12-4534-bc59-056577b92309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C14DBBD30>]}
[0m18:51:38.634317 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m18:51:38.634317 [info ] [Thread-1 (]: 1 of 1 START sql incremental model staging.stg_orders .......................... [RUN]
[0m18:51:38.641447 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_orders'
[0m18:51:38.642448 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m18:51:38.679030 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m18:51:38.690819 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m18:51:38.779577 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m18:51:38.779577 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace  temporary view DEV.staging.stg_orders__dbt_tmp
  
   as (
    

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_effective_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS type,
        data:time::TIMESTAMP                            AS order_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.staging.stg_orders)
    
),
dedup AS
(
    SELECT
        *
        ,ROW_NUMBER() OVER(PARTITION BY order_id, email, pet_dob, pet_name, pet_breed  ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)
SELECT 
    order_id ,
    email                                                       AS customer_email,
    COALESCE(NULLIF(TRIM(COALESCE(first_name, '') || ' ' || 
            COALESCE(last_name, '')), ''), 'unknown')           AS customer_name,
    dob                                                         AS customer_dob,
    phone                                                       AS customer_phone,
    address_line1 || ' ' || address_line2                       AS customer_address,
    city                                                        AS customer_city,
    country                                                     AS customer_country,
    postcode                                                    AS customer_postcode,
    pet_dob,
    pet_name,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_time::DATE                                            AS order_date,
    order_time                                                  AS order_timestamp,
    cessation_date,
    affiliate_code,
    source,
    type,
    order_effective_date,
    ingest_date
FROM dedup
WHERE 
    rnk =1
  );
[0m18:51:38.779577 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:51:39.538108 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.751 seconds
[0m18:51:39.569431 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m18:51:39.569431 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders__dbt_tmp
[0m18:51:39.703187 [debug] [Thread-1 (]: SQL status: SUCCESS 26 in 0.126 seconds
[0m18:51:39.718928 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m18:51:39.730948 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table DEV.staging.stg_orders
[0m18:51:39.899517 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.174 seconds
[0m18:51:39.949362 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m18:51:39.951365 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
describe table "DEV"."STAGING"."STG_ORDERS"
[0m18:51:40.047329 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.096 seconds
[0m18:51:40.131858 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m18:51:40.142961 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m18:51:40.142961 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m18:51:40.247432 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.105 seconds
[0m18:51:40.247432 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m18:51:40.247432 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
merge into DEV.staging.stg_orders as DBT_INTERNAL_DEST
        using DEV.staging.stg_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.customer_email = DBT_INTERNAL_DEST.customer_email
                ) and (
                    DBT_INTERNAL_SOURCE.pet_dob = DBT_INTERNAL_DEST.pet_dob
                ) and (
                    DBT_INTERNAL_SOURCE.pet_name = DBT_INTERNAL_DEST.pet_name
                ) and (
                    DBT_INTERNAL_SOURCE.pet_breed = DBT_INTERNAL_DEST.pet_breed
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_EMAIL" = DBT_INTERNAL_SOURCE."CUSTOMER_EMAIL","PET_DOB" = DBT_INTERNAL_SOURCE."PET_DOB","PET_NAME" = DBT_INTERNAL_SOURCE."PET_NAME","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","PET_BREED" = DBT_INTERNAL_SOURCE."PET_BREED","PET_GENDER" = DBT_INTERNAL_SOURCE."PET_GENDER","PET_SPECIES" = DBT_INTERNAL_SOURCE."PET_SPECIES","PEDIGREE_TYPE" = DBT_INTERNAL_SOURCE."PEDIGREE_TYPE","SPAYED_NEUTERED" = DBT_INTERNAL_SOURCE."SPAYED_NEUTERED","PET_POSTCODE" = DBT_INTERNAL_SOURCE."PET_POSTCODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","CESSATION_DATE" = DBT_INTERNAL_SOURCE."CESSATION_DATE","AFFILIATE_CODE" = DBT_INTERNAL_SOURCE."AFFILIATE_CODE","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","EVENT_TIME" = DBT_INTERNAL_SOURCE."EVENT_TIME","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")
    values
        ("ORDER_ID", "CUSTOMER_EMAIL", "PET_DOB", "PET_NAME", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "ORDER_DATE", "CESSATION_DATE", "AFFILIATE_CODE", "SOURCE", "EVENT_TYPE", "EVENT_TIME", "INGEST_DATE")

;
[0m18:51:40.627878 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb12e6-0000-e39c-0001-b3ce0001c686
[0m18:51:40.643548 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 23 at position 358
invalid identifier 'EVENT_TYPE'
[0m18:51:40.647335 [debug] [Thread-1 (]: Database Error in model stg_orders (models\staging\stg_orders.sql)
  000904 (42000): SQL compilation error: error line 23 at position 358
  invalid identifier 'EVENT_TYPE'
  compiled code at target\run\ManyPets\models\staging\stg_orders.sql
[0m18:51:40.651083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13210694-9f12-4534-bc59-056577b92309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C123A3B80>]}
[0m18:51:40.652108 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model staging.stg_orders ................. [[31mERROR[0m in 2.01s]
[0m18:51:40.655195 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m18:51:40.655195 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models\staging\stg_orders.sql)
  000904 (42000): SQL compilation error: error line 23 at position 358
  invalid identifier 'EVENT_TYPE'
  compiled code at target\run\ManyPets\models\staging\stg_orders.sql.
[0m18:51:40.659052 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:51:40.660052 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m18:51:40.660052 [debug] [MainThread]: On list_DEV: Close
[0m18:51:40.765651 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m18:51:40.765651 [debug] [MainThread]: On list_DEV_odl: Close
[0m18:51:40.865487 [debug] [MainThread]: Connection 'model.ManyPets.stg_orders' was left open.
[0m18:51:40.882735 [debug] [MainThread]: On model.ManyPets.stg_orders: Close
[0m18:51:40.991115 [info ] [MainThread]: 
[0m18:51:41.001388 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 25.57 seconds (25.57s).
[0m18:51:41.007360 [debug] [MainThread]: Command end result
[0m18:51:41.090711 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m18:51:41.095229 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m18:51:41.113142 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m18:51:41.113142 [info ] [MainThread]: 
[0m18:51:41.115883 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:51:41.116711 [info ] [MainThread]: 
[0m18:51:41.118405 [error] [MainThread]:   Database Error in model stg_orders (models\staging\stg_orders.sql)
  000904 (42000): SQL compilation error: error line 23 at position 358
  invalid identifier 'EVENT_TYPE'
  compiled code at target\run\ManyPets\models\staging\stg_orders.sql
[0m18:51:41.121645 [info ] [MainThread]: 
[0m18:51:41.122686 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:51:41.125896 [debug] [MainThread]: Command `dbt run` failed at 18:51:41.125896 after 28.60 seconds
[0m18:51:41.126903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C12536020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C0E194610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C12830F40>]}
[0m18:51:41.126903 [debug] [MainThread]: Flushing usage events
[0m18:51:41.805904 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:53:08.102816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1667E5FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B16870EB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B16870E950>]}


============================== 18:53:08.108821 | 65c5ccd3-0a66-4f25-9d2c-efbe7436201b ==============================
[0m18:53:08.108821 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:53:08.112253 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_orders', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:53:08.993599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65c5ccd3-0a66-4f25-9d2c-efbe7436201b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B168259150>]}
[0m18:53:09.107269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65c5ccd3-0a66-4f25-9d2c-efbe7436201b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B16857B2B0>]}
[0m18:53:09.110275 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:53:09.674579 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:53:10.105991 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:53:10.105991 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:53:10.214866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65c5ccd3-0a66-4f25-9d2c-efbe7436201b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B16A5D4130>]}
[0m18:53:10.479535 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m18:53:10.494007 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m18:53:10.559364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65c5ccd3-0a66-4f25-9d2c-efbe7436201b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B169073EB0>]}
[0m18:53:10.561265 [info ] [MainThread]: Found 6 models, 8 data tests, 2 sources, 591 macros
[0m18:53:10.563924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65c5ccd3-0a66-4f25-9d2c-efbe7436201b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B169072830>]}
[0m18:53:10.566798 [info ] [MainThread]: 
[0m18:53:10.569527 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:53:10.571115 [info ] [MainThread]: 
[0m18:53:10.575526 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:53:10.579152 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m18:53:10.912259 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m18:53:10.912259 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m18:53:10.912259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:11.793597 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.880 seconds
[0m18:53:11.829557 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m18:53:11.858220 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m18:53:11.858220 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m18:53:11.858220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:12.359415 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.513 seconds
[0m18:53:12.374691 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m18:53:12.393818 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m18:53:12.393818 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m18:53:12.508169 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.105 seconds
[0m18:53:12.520250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65c5ccd3-0a66-4f25-9d2c-efbe7436201b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B16A5FD570>]}
[0m18:53:12.538588 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m18:53:12.538588 [info ] [Thread-1 (]: 1 of 1 START sql incremental model staging.stg_orders .......................... [RUN]
[0m18:53:12.546826 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_orders'
[0m18:53:12.546826 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m18:53:12.591034 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m18:53:12.604054 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m18:53:12.727341 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m18:53:12.730426 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m18:53:12.730426 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace transient table DEV.staging.stg_orders
         as
        (

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_effective_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS type,
        data:time::TIMESTAMP                            AS order_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
),
dedup AS
(
    SELECT
        *
        ,ROW_NUMBER() OVER(PARTITION BY order_id, email, pet_dob, pet_name, pet_breed  ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)
SELECT 
    order_id ,
    email                                                       AS customer_email,
    COALESCE(NULLIF(TRIM(COALESCE(first_name, '') || ' ' || 
            COALESCE(last_name, '')), ''), 'unknown')           AS customer_name,
    dob                                                         AS customer_dob,
    phone                                                       AS customer_phone,
    address_line1 || ' ' || address_line2                       AS customer_address,
    city                                                        AS customer_city,
    country                                                     AS customer_country,
    postcode                                                    AS customer_postcode,
    pet_dob,
    pet_name,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_time::DATE                                            AS order_date,
    order_time                                                  AS order_timestamp,
    cessation_date,
    affiliate_code,
    source,
    type,
    order_effective_date,
    ingest_date
FROM dedup
WHERE 
    rnk =1
        );
[0m18:53:12.730426 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:53:15.503882 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.770 seconds
[0m18:53:15.520843 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_orders__dbt_tmp
[0m18:53:15.520843 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m18:53:15.520843 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
drop view if exists DEV.staging.stg_orders__dbt_tmp cascade
[0m18:53:15.589011 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.066 seconds
[0m18:53:15.659174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65c5ccd3-0a66-4f25-9d2c-efbe7436201b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B164E60280>]}
[0m18:53:15.660164 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model staging.stg_orders ..................... [[32mSUCCESS 1[0m in 3.11s]
[0m18:53:15.663163 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m18:53:15.665399 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:53:15.666399 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m18:53:15.666399 [debug] [MainThread]: On list_DEV: Close
[0m18:53:15.756394 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m18:53:15.756394 [debug] [MainThread]: On list_DEV_staging: Close
[0m18:53:15.875711 [debug] [MainThread]: Connection 'model.ManyPets.stg_orders' was left open.
[0m18:53:15.875711 [debug] [MainThread]: On model.ManyPets.stg_orders: Close
[0m18:53:15.989398 [info ] [MainThread]: 
[0m18:53:16.000411 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.41 seconds (5.41s).
[0m18:53:16.002883 [debug] [MainThread]: Command end result
[0m18:53:16.085446 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m18:53:16.089798 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m18:53:16.104045 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m18:53:16.105043 [info ] [MainThread]: 
[0m18:53:16.106642 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:53:16.107728 [info ] [MainThread]: 
[0m18:53:16.109040 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:53:16.112559 [debug] [MainThread]: Command `dbt run` succeeded at 18:53:16.111550 after 8.18 seconds
[0m18:53:16.113282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1667E5FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B166B3DA20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B166AE29E0>]}
[0m18:53:16.114284 [debug] [MainThread]: Flushing usage events
[0m18:53:16.937485 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:53:30.484909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159E5726080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159E764EA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159E764E860>]}


============================== 18:53:30.491755 | b1867a0e-d3ea-4e68-a92d-676f2c8e6500 ==============================
[0m18:53:30.491755 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:53:30.494964 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_order_complete', 'send_anonymous_usage_stats': 'True'}
[0m18:53:31.386529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1867a0e-d3ea-4e68-a92d-676f2c8e6500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159E7164BB0>]}
[0m18:53:31.499307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1867a0e-d3ea-4e68-a92d-676f2c8e6500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159E7F03490>]}
[0m18:53:31.507297 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:53:32.101230 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:53:32.494196 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:53:32.494196 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:53:32.576030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1867a0e-d3ea-4e68-a92d-676f2c8e6500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159E9514130>]}
[0m18:53:32.858865 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m18:53:32.866679 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m18:53:32.941120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1867a0e-d3ea-4e68-a92d-676f2c8e6500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159E9517C70>]}
[0m18:53:32.943441 [info ] [MainThread]: Found 6 models, 8 data tests, 2 sources, 591 macros
[0m18:53:32.944739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1867a0e-d3ea-4e68-a92d-676f2c8e6500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159E7FAB700>]}
[0m18:53:32.946741 [info ] [MainThread]: 
[0m18:53:32.949671 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:53:32.952472 [info ] [MainThread]: 
[0m18:53:32.954972 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:53:32.962316 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m18:53:33.180291 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m18:53:33.180291 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m18:53:33.180291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:34.029636 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.849 seconds
[0m18:53:34.071089 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m18:53:34.089490 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m18:53:34.089490 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m18:53:34.089490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:34.454048 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.351 seconds
[0m18:53:34.454048 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m18:53:34.469767 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m18:53:34.469767 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m18:53:34.576961 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.096 seconds
[0m18:53:34.592505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1867a0e-d3ea-4e68-a92d-676f2c8e6500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159E9502A10>]}
[0m18:53:34.611492 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_order_complete
[0m18:53:34.611492 [info ] [Thread-1 (]: 1 of 1 START sql incremental model staging.stg_order_complete .................. [RUN]
[0m18:53:34.618268 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_order_complete'
[0m18:53:34.618268 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_order_complete
[0m18:53:34.652781 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_order_complete"
[0m18:53:34.652781 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_order_complete
[0m18:53:34.757012 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_order_complete"
[0m18:53:34.766191 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m18:53:34.766191 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
create or replace transient table DEV.staging.stg_order_complete
         as
        (

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING        AS order_id,
        data:detail:intent::STRING          AS intent,
        data:detail:tenant::STRING          AS tenant,
        data:detail:customer_id::STRING     AS customer_id,
        pet.value                           AS pet_id,  
        data:time::TIMESTAMP                AS event_time,
        data:source::STRING                 AS source,
        data:type::STRING                   AS event_type,
        ingest_date                         AS ingest_date
    FROM dev.rdl.order_complete o,
    LATERAL FLATTEN(input => o.data:detail:pet_ids) AS pet  

    
)
,
dedup AS (
    SELECT 
        *,
        ROW_NUMBER() OVER ( PARTITION BY order_id, customer_id, pet_id ORDER BY ingest_date DESC ) AS rnk
    FROM source_data
)
SELECT 
    order_id,
    customer_id,
    pet_id,
    intent,
    tenant,
    event_time,
    source,
    event_type,
    ingest_date
FROM dedup
WHERE rnk =1
        );
[0m18:53:34.766191 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:53:37.000633 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.241 seconds
[0m18:53:37.031909 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_order_complete__dbt_tmp
[0m18:53:37.047527 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m18:53:37.047527 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
drop view if exists DEV.staging.stg_order_complete__dbt_tmp cascade
[0m18:53:37.116928 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.067 seconds
[0m18:53:37.193796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1867a0e-d3ea-4e68-a92d-676f2c8e6500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159E3DA0340>]}
[0m18:53:37.194802 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model staging.stg_order_complete ............. [[32mSUCCESS 1[0m in 2.56s]
[0m18:53:37.197223 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_order_complete
[0m18:53:37.200332 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:53:37.201336 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m18:53:37.201336 [debug] [MainThread]: On list_DEV: Close
[0m18:53:37.304797 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m18:53:37.314127 [debug] [MainThread]: On list_DEV_odl: Close
[0m18:53:37.421307 [debug] [MainThread]: Connection 'model.ManyPets.stg_order_complete' was left open.
[0m18:53:37.421307 [debug] [MainThread]: On model.ManyPets.stg_order_complete: Close
[0m18:53:37.535615 [info ] [MainThread]: 
[0m18:53:37.543703 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.58 seconds (4.58s).
[0m18:53:37.547751 [debug] [MainThread]: Command end result
[0m18:53:37.638246 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m18:53:37.643298 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m18:53:37.656921 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m18:53:37.657917 [info ] [MainThread]: 
[0m18:53:37.660742 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:53:37.663597 [info ] [MainThread]: 
[0m18:53:37.664927 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:53:37.668957 [debug] [MainThread]: Command `dbt run` succeeded at 18:53:37.668957 after 7.33 seconds
[0m18:53:37.668957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159E5726080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159E7F27DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159E5A6E680>]}
[0m18:53:37.668957 [debug] [MainThread]: Flushing usage events
[0m18:53:38.437230 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:54:03.388089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3A8A86020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3AA81AFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3AA81BE50>]}


============================== 18:54:03.395569 | af419d6a-c200-440e-b69f-b9372ccfef8a ==============================
[0m18:54:03.395569 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:54:03.399530 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:54:04.616261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af419d6a-c200-440e-b69f-b9372ccfef8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3A7309C60>]}
[0m18:54:04.720426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af419d6a-c200-440e-b69f-b9372ccfef8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3AB25F550>]}
[0m18:54:04.728618 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:54:05.443580 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:54:06.021010 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:54:06.021010 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:54:06.179422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af419d6a-c200-440e-b69f-b9372ccfef8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3AC874130>]}
[0m18:54:06.529296 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m18:54:06.541624 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m18:54:06.760667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af419d6a-c200-440e-b69f-b9372ccfef8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3AB3228F0>]}
[0m18:54:06.762540 [info ] [MainThread]: Found 6 models, 8 data tests, 2 sources, 591 macros
[0m18:54:06.765072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af419d6a-c200-440e-b69f-b9372ccfef8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3AB305E40>]}
[0m18:54:06.771393 [info ] [MainThread]: 
[0m18:54:06.773529 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:54:06.776336 [info ] [MainThread]: 
[0m18:54:06.779380 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:54:06.815081 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m18:54:07.036248 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m18:54:07.040823 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m18:54:07.040823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:08.067118 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.026 seconds
[0m18:54:08.073661 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m18:54:08.086675 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m18:54:08.086675 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m18:54:08.219076 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.126 seconds
[0m18:54:08.237942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af419d6a-c200-440e-b69f-b9372ccfef8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3A8609720>]}
[0m18:54:08.256653 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m18:54:08.256653 [info ] [Thread-1 (]: 1 of 8 START test not_null_stg_order_complete_ingest_date ...................... [RUN]
[0m18:54:08.263163 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec'
[0m18:54:08.263163 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m18:54:08.369539 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m18:54:08.375794 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m18:54:08.444876 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m18:54:08.458541 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m18:54:08.459580 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ingest_date
from DEV.staging.stg_order_complete
where ingest_date is null



      
    ) dbt_internal_test
[0m18:54:08.460586 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:54:09.571114 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.113 seconds
[0m18:54:09.613950 [info ] [Thread-1 (]: 1 of 8 PASS not_null_stg_order_complete_ingest_date ............................ [[32mPASS[0m in 1.35s]
[0m18:54:09.631772 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m18:54:09.631772 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m18:54:09.637425 [info ] [Thread-1 (]: 2 of 8 START test not_null_stg_order_complete_order_id ......................... [RUN]
[0m18:54:09.641514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec, now test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce)
[0m18:54:09.647106 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m18:54:09.702499 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m18:54:09.710804 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m18:54:09.732811 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m18:54:09.737407 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m18:54:09.738407 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from DEV.staging.stg_order_complete
where order_id is null



      
    ) dbt_internal_test
[0m18:54:09.971555 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.235 seconds
[0m18:54:09.971555 [info ] [Thread-1 (]: 2 of 8 PASS not_null_stg_order_complete_order_id ............................... [[32mPASS[0m in 0.33s]
[0m18:54:09.989184 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m18:54:09.989184 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91
[0m18:54:09.994468 [info ] [Thread-1 (]: 3 of 8 START test not_null_stg_order_complete_order_id__ingest_date ............ [RUN]
[0m18:54:09.998380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce, now test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91)
[0m18:54:10.003925 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91
[0m18:54:10.084596 [debug] [Thread-1 (]: Compilation Error in test not_null_stg_order_complete_order_id__ingest_date (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_not_null' takes no keyword argument 'columns'
[0m18:54:10.084596 [error] [Thread-1 (]: 3 of 8 ERROR not_null_stg_order_complete_order_id__ingest_date ................. [[31mERROR[0m in 0.09s]
[0m18:54:10.091818 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91
[0m18:54:10.091818 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_customer_email.f7618da361
[0m18:54:10.091818 [debug] [Thread-4 (]: Marking all children of 'test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91' to be skipped because of status 'error'.  Reason: Compilation Error in test not_null_stg_order_complete_order_id__ingest_date (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_not_null' takes no keyword argument 'columns'.
[0m18:54:10.099214 [info ] [Thread-1 (]: 4 of 8 START test not_null_stg_orders_customer_email ........................... [RUN]
[0m18:54:10.108787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_order_id__ingest_date.415f8c7e91, now test.ManyPets.not_null_stg_orders_customer_email.f7618da361)
[0m18:54:10.113763 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_customer_email.f7618da361
[0m18:54:10.160698 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_customer_email.f7618da361"
[0m18:54:10.170648 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_customer_email.f7618da361
[0m18:54:10.183252 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_customer_email.f7618da361"
[0m18:54:10.198948 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_customer_email.f7618da361"
[0m18:54:10.200066 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_customer_email.f7618da361: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_customer_email.f7618da361"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_email
from DEV.staging.stg_orders
where customer_email is null



      
    ) dbt_internal_test
[0m18:54:10.886297 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.686 seconds
[0m18:54:10.886297 [info ] [Thread-1 (]: 4 of 8 PASS not_null_stg_orders_customer_email ................................. [[32mPASS[0m in 0.78s]
[0m18:54:10.903364 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_customer_email.f7618da361
[0m18:54:10.903364 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m18:54:10.909238 [info ] [Thread-1 (]: 5 of 8 START test not_null_stg_orders_ingest_date .............................. [RUN]
[0m18:54:10.915235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_customer_email.f7618da361, now test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e)
[0m18:54:10.918952 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m18:54:10.959795 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m18:54:10.974021 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m18:54:10.993318 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m18:54:11.001350 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m18:54:11.002347 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ingest_date
from DEV.staging.stg_orders
where ingest_date is null



      
    ) dbt_internal_test
[0m18:54:11.299816 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.308 seconds
[0m18:54:11.316385 [info ] [Thread-1 (]: 5 of 8 PASS not_null_stg_orders_ingest_date .................................... [[32mPASS[0m in 0.40s]
[0m18:54:11.335042 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m18:54:11.335042 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m18:54:11.335042 [info ] [Thread-1 (]: 6 of 8 START test not_null_stg_orders_order_id ................................. [RUN]
[0m18:54:11.345376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e, now test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64)
[0m18:54:11.350478 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m18:54:11.392537 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m18:54:11.398029 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m18:54:11.417168 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m18:54:11.428089 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m18:54:11.432634 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from DEV.staging.stg_orders
where order_id is null



      
    ) dbt_internal_test
[0m18:54:12.028536 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.596 seconds
[0m18:54:12.028536 [info ] [Thread-1 (]: 6 of 8 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.68s]
[0m18:54:12.045396 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m18:54:12.045396 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m18:54:12.050342 [info ] [Thread-1 (]: 7 of 8 START test not_null_stg_orders_pet_dob .................................. [RUN]
[0m18:54:12.055043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64, now test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6)
[0m18:54:12.060194 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m18:54:12.089548 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m18:54:12.098442 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m18:54:12.123208 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m18:54:12.134665 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m18:54:12.135678 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pet_dob
from DEV.staging.stg_orders
where pet_dob is null



      
    ) dbt_internal_test
[0m18:54:12.252759 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.116 seconds
[0m18:54:12.259406 [info ] [Thread-1 (]: 7 of 8 PASS not_null_stg_orders_pet_dob ........................................ [[32mPASS[0m in 0.21s]
[0m18:54:12.269385 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m18:54:12.269385 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m18:54:12.275623 [info ] [Thread-1 (]: 8 of 8 START test not_null_stg_orders_pet_name ................................. [RUN]
[0m18:54:12.280726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6, now test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5)
[0m18:54:12.284856 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m18:54:12.327361 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m18:54:12.340989 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m18:54:12.357657 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m18:54:12.368742 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m18:54:12.368742 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pet_name
from DEV.staging.stg_orders
where pet_name is null



      
    ) dbt_internal_test
[0m18:54:12.642204 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.269 seconds
[0m18:54:12.658377 [info ] [Thread-1 (]: 8 of 8 PASS not_null_stg_orders_pet_name ....................................... [[32mPASS[0m in 0.36s]
[0m18:54:12.663357 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m18:54:12.669469 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:54:12.669469 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m18:54:12.669469 [debug] [MainThread]: On list_DEV_odl: Close
[0m18:54:12.780721 [debug] [MainThread]: Connection 'test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5' was left open.
[0m18:54:12.780721 [debug] [MainThread]: On test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5: Close
[0m18:54:12.882270 [info ] [MainThread]: 
[0m18:54:12.897751 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 6.10 seconds (6.10s).
[0m18:54:12.905855 [debug] [MainThread]: Command end result
[0m18:54:13.151466 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m18:54:13.167680 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m18:54:13.193079 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m18:54:13.193079 [info ] [MainThread]: 
[0m18:54:13.196703 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:54:13.199831 [info ] [MainThread]: 
[0m18:54:13.204267 [error] [MainThread]:   Compilation Error in test not_null_stg_order_complete_order_id__ingest_date (models\staging\staging_schema.yml)
  macro 'dbt_macro__test_not_null' takes no keyword argument 'columns'
[0m18:54:13.207477 [info ] [MainThread]: 
[0m18:54:13.218304 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m18:54:13.224460 [debug] [MainThread]: Command `dbt test` failed at 18:54:13.223454 after 10.00 seconds
[0m18:54:13.225471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3A8A86020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3A8D80F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3AD1EE2F0>]}
[0m18:54:13.225471 [debug] [MainThread]: Flushing usage events
[0m18:54:13.973419 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:03:52.617372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AF23E5FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AF42DC040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AF42DE1A0>]}


============================== 19:03:52.623603 | a8218b17-90fc-4457-b0d5-3c7dde696e2c ==============================
[0m19:03:52.623603 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:03:52.628712 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:03:53.842954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8218b17-90fc-4457-b0d5-3c7dde696e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AF0C65C60>]}
[0m19:03:53.974593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8218b17-90fc-4457-b0d5-3c7dde696e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AF4323D90>]}
[0m19:03:53.984484 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:03:54.630190 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:03:55.112716 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:03:55.112716 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:03:55.278953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8218b17-90fc-4457-b0d5-3c7dde696e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AF61D8130>]}
[0m19:03:55.645397 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m19:03:55.657099 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m19:03:55.800633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8218b17-90fc-4457-b0d5-3c7dde696e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AF61915A0>]}
[0m19:03:55.801634 [info ] [MainThread]: Found 6 models, 9 data tests, 2 sources, 591 macros
[0m19:03:55.806770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8218b17-90fc-4457-b0d5-3c7dde696e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AF4C80B80>]}
[0m19:03:55.821019 [info ] [MainThread]: 
[0m19:03:55.836098 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:03:55.859268 [info ] [MainThread]: 
[0m19:03:55.863990 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:03:55.912318 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m19:03:56.169139 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m19:03:56.177195 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m19:03:56.177195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:57.166135 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.993 seconds
[0m19:03:57.174187 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m19:03:57.190860 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m19:03:57.198888 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m19:03:57.433705 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.237 seconds
[0m19:03:57.451387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8218b17-90fc-4457-b0d5-3c7dde696e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AF0ADD450>]}
[0m19:03:57.470479 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m19:03:57.470479 [info ] [Thread-1 (]: 1 of 9 START test not_null_stg_order_complete_customer_id ...................... [RUN]
[0m19:03:57.477824 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b'
[0m19:03:57.477824 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m19:03:57.595071 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b"
[0m19:03:57.601534 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m19:03:57.657804 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b"
[0m19:03:57.661520 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b"
[0m19:03:57.662524 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from DEV.staging.stg_order_complete
where customer_id is null



      
    ) dbt_internal_test
[0m19:03:57.662524 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:03:58.284725 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.623 seconds
[0m19:03:58.326047 [info ] [Thread-1 (]: 1 of 9 PASS not_null_stg_order_complete_customer_id ............................ [[32mPASS[0m in 0.85s]
[0m19:03:58.334762 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m19:03:58.334762 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m19:03:58.339685 [info ] [Thread-1 (]: 2 of 9 START test not_null_stg_order_complete_ingest_date ...................... [RUN]
[0m19:03:58.342926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b, now test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec)
[0m19:03:58.345922 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m19:03:58.369152 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m19:03:58.369152 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m19:03:58.389105 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m19:03:58.401474 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m19:03:58.403476 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ingest_date
from DEV.staging.stg_order_complete
where ingest_date is null



      
    ) dbt_internal_test
[0m19:03:58.563182 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.160 seconds
[0m19:03:58.571201 [info ] [Thread-1 (]: 2 of 9 PASS not_null_stg_order_complete_ingest_date ............................ [[32mPASS[0m in 0.23s]
[0m19:03:58.580341 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m19:03:58.580341 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m19:03:58.585121 [info ] [Thread-1 (]: 3 of 9 START test not_null_stg_order_complete_order_id ......................... [RUN]
[0m19:03:58.590383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec, now test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce)
[0m19:03:58.593663 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m19:03:58.644736 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m19:03:58.656683 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m19:03:58.686213 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m19:03:58.698350 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m19:03:58.699975 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from DEV.staging.stg_order_complete
where order_id is null



      
    ) dbt_internal_test
[0m19:03:58.823216 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.122 seconds
[0m19:03:58.837118 [info ] [Thread-1 (]: 3 of 9 PASS not_null_stg_order_complete_order_id ............................... [[32mPASS[0m in 0.25s]
[0m19:03:58.843890 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m19:03:58.843890 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m19:03:58.849747 [info ] [Thread-1 (]: 4 of 9 START test not_null_stg_order_complete_pet_id ........................... [RUN]
[0m19:03:58.854748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce, now test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1)
[0m19:03:58.857931 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m19:03:58.898129 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1"
[0m19:03:58.907047 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m19:03:58.933250 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1"
[0m19:03:58.935978 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1"
[0m19:03:58.935978 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pet_id
from DEV.staging.stg_order_complete
where pet_id is null



      
    ) dbt_internal_test
[0m19:03:59.382551 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.438 seconds
[0m19:03:59.393173 [info ] [Thread-1 (]: 4 of 9 PASS not_null_stg_order_complete_pet_id ................................. [[32mPASS[0m in 0.54s]
[0m19:03:59.401255 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m19:03:59.405008 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_customer_email.f7618da361
[0m19:03:59.405008 [info ] [Thread-1 (]: 5 of 9 START test not_null_stg_orders_customer_email ........................... [RUN]
[0m19:03:59.415360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1, now test.ManyPets.not_null_stg_orders_customer_email.f7618da361)
[0m19:03:59.415360 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_customer_email.f7618da361
[0m19:03:59.475096 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_customer_email.f7618da361"
[0m19:03:59.484958 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_customer_email.f7618da361
[0m19:03:59.500518 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_customer_email.f7618da361"
[0m19:03:59.515204 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_customer_email.f7618da361"
[0m19:03:59.516782 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_customer_email.f7618da361: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_customer_email.f7618da361"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_email
from DEV.staging.stg_orders
where customer_email is null



      
    ) dbt_internal_test
[0m19:03:59.608807 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.093 seconds
[0m19:03:59.618324 [info ] [Thread-1 (]: 5 of 9 PASS not_null_stg_orders_customer_email ................................. [[32mPASS[0m in 0.20s]
[0m19:03:59.624951 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_customer_email.f7618da361
[0m19:03:59.624951 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m19:03:59.624951 [info ] [Thread-1 (]: 6 of 9 START test not_null_stg_orders_ingest_date .............................. [RUN]
[0m19:03:59.637606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_customer_email.f7618da361, now test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e)
[0m19:03:59.640326 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m19:03:59.707540 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m19:03:59.723580 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m19:03:59.765073 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m19:03:59.773071 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m19:03:59.782198 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ingest_date
from DEV.staging.stg_orders
where ingest_date is null



      
    ) dbt_internal_test
[0m19:03:59.991374 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.206 seconds
[0m19:04:00.004913 [info ] [Thread-1 (]: 6 of 9 PASS not_null_stg_orders_ingest_date .................................... [[32mPASS[0m in 0.37s]
[0m19:04:00.010130 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m19:04:00.010130 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m19:04:00.020172 [info ] [Thread-1 (]: 7 of 9 START test not_null_stg_orders_order_id ................................. [RUN]
[0m19:04:00.030202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e, now test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64)
[0m19:04:00.038234 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m19:04:00.086837 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m19:04:00.088152 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m19:04:00.114870 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m19:04:00.127322 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m19:04:00.127322 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from DEV.staging.stg_orders
where order_id is null



      
    ) dbt_internal_test
[0m19:04:00.218255 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.088 seconds
[0m19:04:00.227813 [info ] [Thread-1 (]: 7 of 9 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.20s]
[0m19:04:00.233433 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m19:04:00.233433 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m19:04:00.241079 [info ] [Thread-1 (]: 8 of 9 START test not_null_stg_orders_pet_dob .................................. [RUN]
[0m19:04:00.245636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64, now test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6)
[0m19:04:00.249426 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m19:04:00.300209 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m19:04:00.302427 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m19:04:00.332863 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m19:04:00.341716 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m19:04:00.342190 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pet_dob
from DEV.staging.stg_orders
where pet_dob is null



      
    ) dbt_internal_test
[0m19:04:00.433462 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.088 seconds
[0m19:04:00.446747 [info ] [Thread-1 (]: 8 of 9 PASS not_null_stg_orders_pet_dob ........................................ [[32mPASS[0m in 0.20s]
[0m19:04:00.452516 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m19:04:00.452516 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m19:04:00.461472 [info ] [Thread-1 (]: 9 of 9 START test not_null_stg_orders_pet_name ................................. [RUN]
[0m19:04:00.469250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6, now test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5)
[0m19:04:00.473469 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m19:04:00.533276 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m19:04:00.535289 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m19:04:00.556628 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m19:04:00.567369 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m19:04:00.567369 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pet_name
from DEV.staging.stg_orders
where pet_name is null



      
    ) dbt_internal_test
[0m19:04:00.674665 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.101 seconds
[0m19:04:00.684435 [info ] [Thread-1 (]: 9 of 9 PASS not_null_stg_orders_pet_name ....................................... [[32mPASS[0m in 0.22s]
[0m19:04:00.694007 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m19:04:00.702980 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:04:00.703986 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m19:04:00.707941 [debug] [MainThread]: On list_DEV_odl: Close
[0m19:04:00.843106 [debug] [MainThread]: Connection 'test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5' was left open.
[0m19:04:00.843106 [debug] [MainThread]: On test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5: Close
[0m19:04:00.957632 [info ] [MainThread]: 
[0m19:04:00.965214 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 5.09 seconds (5.09s).
[0m19:04:00.989033 [debug] [MainThread]: Command end result
[0m19:04:01.161119 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m19:04:01.169121 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m19:04:01.200186 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m19:04:01.201565 [info ] [MainThread]: 
[0m19:04:01.204001 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:04:01.205108 [info ] [MainThread]: 
[0m19:04:01.206660 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m19:04:01.211348 [debug] [MainThread]: Command `dbt test` succeeded at 19:04:01.209516 after 8.77 seconds
[0m19:04:01.213237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AF23E5FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AF273DA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AF26E3A30>]}
[0m19:04:01.214243 [debug] [MainThread]: Flushing usage events
[0m19:04:01.824131 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:05:01.408094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209935E5F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020995521C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020995521240>]}


============================== 19:05:01.418593 | acd78a39-e26b-45cb-abce-b0f86aceb313 ==============================
[0m19:05:01.418593 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:05:01.420625 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:05:02.600401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'acd78a39-e26b-45cb-abce-b0f86aceb313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020991E3B0A0>]}
[0m19:05:02.711537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'acd78a39-e26b-45cb-abce-b0f86aceb313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209953B22C0>]}
[0m19:05:02.714314 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:05:03.481469 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:05:03.986760 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:05:03.987759 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:05:04.089799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'acd78a39-e26b-45cb-abce-b0f86aceb313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209973D8130>]}
[0m19:05:04.168543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acd78a39-e26b-45cb-abce-b0f86aceb313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209973760B0>]}
[0m19:05:04.170461 [info ] [MainThread]: Found 6 models, 9 data tests, 2 sources, 591 macros
[0m19:05:04.172461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acd78a39-e26b-45cb-abce-b0f86aceb313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020997376A40>]}
[0m19:05:04.173464 [info ] [MainThread]: 
[0m19:05:04.179806 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:05:04.181362 [info ] [MainThread]: 
[0m19:05:04.185531 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:05:04.213299 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m19:05:04.546067 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m19:05:04.546067 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m19:05:04.546067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:05.532850 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.981 seconds
[0m19:05:05.545317 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m19:05:05.561200 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m19:05:05.561200 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m19:05:05.677376 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.117 seconds
[0m19:05:05.702255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acd78a39-e26b-45cb-abce-b0f86aceb313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099734F8E0>]}
[0m19:05:05.726424 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_order_complete
[0m19:05:05.734499 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_order_complete'
[0m19:05:05.737085 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_order_complete
[0m19:05:05.831186 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_order_complete"
[0m19:05:05.835602 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_order_complete
[0m19:05:05.837984 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_order_complete
[0m19:05:05.837984 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m19:05:05.841746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_order_complete, now model.ManyPets.stg_orders)
[0m19:05:05.842702 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m19:05:05.854836 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m19:05:05.854836 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m19:05:05.860455 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m19:05:05.860455 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m19:05:05.864713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_orders, now test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b)
[0m19:05:05.865990 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m19:05:05.897117 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b"
[0m19:05:05.897117 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m19:05:05.904258 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m19:05:05.906295 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m19:05:05.907522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b, now test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec)
[0m19:05:05.908530 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m19:05:05.917860 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m19:05:05.917860 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m19:05:05.925883 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m19:05:05.926914 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m19:05:05.927932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec, now test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce)
[0m19:05:05.927932 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m19:05:05.935029 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m19:05:05.935029 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m19:05:05.942931 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m19:05:05.942931 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m19:05:05.944949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce, now test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1)
[0m19:05:05.945969 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m19:05:05.945969 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1"
[0m19:05:05.945969 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m19:05:05.960877 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m19:05:05.961868 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m19:05:05.962639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1, now model.ManyPets.dim_customers)
[0m19:05:05.963640 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m19:05:05.980521 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m19:05:05.996250 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m19:05:05.998459 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m19:05:05.999880 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_customer_email.f7618da361
[0m19:05:06.000994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_customers, now test.ManyPets.not_null_stg_orders_customer_email.f7618da361)
[0m19:05:06.002229 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_customer_email.f7618da361
[0m19:05:06.004234 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_customer_email.f7618da361"
[0m19:05:06.012269 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_customer_email.f7618da361
[0m19:05:06.015181 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_customer_email.f7618da361
[0m19:05:06.015966 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m19:05:06.017014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_customer_email.f7618da361, now test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e)
[0m19:05:06.018015 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m19:05:06.020242 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m19:05:06.020242 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m19:05:06.032722 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m19:05:06.034432 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m19:05:06.035442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e, now test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64)
[0m19:05:06.035442 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m19:05:06.044985 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m19:05:06.044985 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m19:05:06.049548 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m19:05:06.050387 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m19:05:06.051390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64, now test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6)
[0m19:05:06.051390 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m19:05:06.051390 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m19:05:06.051390 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m19:05:06.067156 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m19:05:06.068154 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m19:05:06.069163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6, now test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5)
[0m19:05:06.070198 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m19:05:06.070198 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m19:05:06.070198 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m19:05:06.083482 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m19:05:06.084744 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_pets
[0m19:05:06.085747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5, now model.ManyPets.dim_pets)
[0m19:05:06.085747 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_pets
[0m19:05:06.085747 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_pets"
[0m19:05:06.102715 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_pets
[0m19:05:06.103715 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_pets
[0m19:05:06.106251 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_order_complete
[0m19:05:06.107255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_pets, now model.ManyPets.fact_order_complete)
[0m19:05:06.108773 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_order_complete
[0m19:05:06.109759 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_order_complete"
[0m19:05:06.123218 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_order_complete
[0m19:05:06.124212 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_order_complete
[0m19:05:06.124212 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m19:05:06.127516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.fact_order_complete, now model.ManyPets.fact_orders)
[0m19:05:06.128539 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_orders
[0m19:05:06.128539 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_orders"
[0m19:05:06.128539 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_orders
[0m19:05:06.145044 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m19:05:06.147685 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:05:06.148684 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m19:05:06.148684 [debug] [MainThread]: On list_DEV_staging: Close
[0m19:05:06.263675 [debug] [MainThread]: Connection 'model.ManyPets.fact_orders' was properly closed.
[0m19:05:06.281793 [debug] [MainThread]: Command end result
[0m19:05:06.636530 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m19:05:06.647110 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m19:05:06.672609 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m19:05:07.840593 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m19:05:07.842220 [info ] [MainThread]: Building catalog
[0m19:05:07.890202 [debug] [ThreadPool]: Acquiring new snowflake connection 'DEV.information_schema'
[0m19:05:07.931484 [debug] [ThreadPool]: Using snowflake connection "DEV.information_schema"
[0m19:05:07.931484 [debug] [ThreadPool]: On DEV.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "DEV.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from DEV.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'odl' and upper("table_schema") = upper('odl')

                    and 
    "table_name" ilike 'fact_order_complete' and upper("table_name") = upper('fact_order_complete')

                )
             or 
                (
                    
    "table_schema" ilike 'odl' and upper("table_schema") = upper('odl')

                    and 
    "table_name" ilike 'fact_orders' and upper("table_name") = upper('fact_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'odl' and upper("table_schema") = upper('odl')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'odl' and upper("table_schema") = upper('odl')

                    and 
    "table_name" ilike 'dim_pets' and upper("table_name") = upper('dim_pets')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_order_complete' and upper("table_name") = upper('stg_order_complete')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from DEV.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'odl' and upper("table_schema") = upper('odl')

                    and 
    "table_name" ilike 'fact_order_complete' and upper("table_name") = upper('fact_order_complete')

                )
             or 
                (
                    
    "table_schema" ilike 'odl' and upper("table_schema") = upper('odl')

                    and 
    "table_name" ilike 'fact_orders' and upper("table_name") = upper('fact_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'odl' and upper("table_schema") = upper('odl')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'odl' and upper("table_schema") = upper('odl')

                    and 
    "table_name" ilike 'dim_pets' and upper("table_name") = upper('dim_pets')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_order_complete' and upper("table_name") = upper('stg_order_complete')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m19:05:07.939624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:13.638279 [debug] [ThreadPool]: SQL status: SUCCESS 81 in 5.699 seconds
[0m19:05:13.730447 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly DEV.information_schema, now dev.information_schema)
[0m19:05:13.747455 [debug] [ThreadPool]: Using snowflake connection "dev.information_schema"
[0m19:05:13.755016 [debug] [ThreadPool]: On dev.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "dev.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from dev.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'rdl' and upper("table_schema") = upper('rdl')

                    and 
    "table_name" ilike 'orders' and upper("table_name") = upper('orders')

                )
             or 
                (
                    
    "table_schema" ilike 'rdl' and upper("table_schema") = upper('rdl')

                    and 
    "table_name" ilike 'order_complete' and upper("table_name") = upper('order_complete')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from dev.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'rdl' and upper("table_schema") = upper('rdl')

                    and 
    "table_name" ilike 'orders' and upper("table_name") = upper('orders')

                )
             or 
                (
                    
    "table_schema" ilike 'rdl' and upper("table_schema") = upper('rdl')

                    and 
    "table_name" ilike 'order_complete' and upper("table_name") = upper('order_complete')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m19:05:17.406834 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 3.653 seconds
[0m19:05:17.563238 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\HP\Documents\manypets\ManyPets\target\catalog.json
[0m19:05:17.689896 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m19:05:17.696921 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m19:05:17.699415 [info ] [MainThread]: Catalog written to C:\Users\HP\Documents\manypets\ManyPets\target\catalog.json
[0m19:05:17.704302 [debug] [MainThread]: Command `dbt docs generate` succeeded at 19:05:17.703294 after 16.47 seconds
[0m19:05:17.704302 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m19:05:17.704302 [debug] [MainThread]: Connection 'dev.information_schema' was left open.
[0m19:05:17.704302 [debug] [MainThread]: On dev.information_schema: Close
[0m19:05:17.827060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209935E5F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209953B22C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020997B5F4F0>]}
[0m19:05:17.827060 [debug] [MainThread]: Flushing usage events
[0m19:05:18.441243 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:05:59.179763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002798D205FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002798F152B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002798F152980>]}


============================== 19:05:59.186914 | 5258b611-0fbb-47bb-ab35-12a446a3c089 ==============================
[0m19:05:59.186914 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:05:59.190246 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m19:06:00.368724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5258b611-0fbb-47bb-ab35-12a446a3c089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002798F0C79D0>]}
[0m19:06:00.535461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5258b611-0fbb-47bb-ab35-12a446a3c089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002798EFD2200>]}
[0m19:09:58.184255 [error] [MainThread]: Encountered an error:

[0m19:09:58.345625 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\HP\AppData\Local\Programs\Python\Python310\lib\socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "C:\Users\HP\AppData\Local\Programs\Python\Python310\lib\selectors.py", line 324, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "C:\Users\HP\AppData\Local\Programs\Python\Python310\lib\selectors.py", line 315, in _select
    r, w, x = select.select(r, w, w, timeout)
KeyboardInterrupt

[0m19:09:58.355969 [debug] [MainThread]: Command `dbt docs serve` failed at 19:09:58.355969 after 239.34 seconds
[0m19:09:58.355969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002798D205FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002798FC47F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002798FC47FD0>]}
[0m19:09:58.355969 [debug] [MainThread]: Flushing usage events
[0m19:09:59.101923 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:10:08.985652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A91526020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A934603A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A93460A60>]}


============================== 19:10:08.992114 | 72bd4878-27d7-4952-a82c-1e4cfee89e40 ==============================
[0m19:10:08.992114 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:10:08.997532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m19:10:10.299305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72bd4878-27d7-4952-a82c-1e4cfee89e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A93D5CD90>]}
[0m19:10:10.400070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72bd4878-27d7-4952-a82c-1e4cfee89e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A92F66D70>]}
[0m19:10:10.410254 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:10:11.248711 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:10:12.133764 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:10:12.133764 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:10:12.311040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72bd4878-27d7-4952-a82c-1e4cfee89e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A95314130>]}
[0m19:10:12.399221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72bd4878-27d7-4952-a82c-1e4cfee89e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A95293BB0>]}
[0m19:10:12.400977 [info ] [MainThread]: Found 6 models, 9 data tests, 2 sources, 591 macros
[0m19:10:12.403560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72bd4878-27d7-4952-a82c-1e4cfee89e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A95292FB0>]}
[0m19:10:12.408723 [info ] [MainThread]: 
[0m19:10:12.410724 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:10:12.413510 [info ] [MainThread]: 
[0m19:10:12.419172 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:10:12.437556 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m19:10:12.926152 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m19:10:12.926152 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m19:10:12.926152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:10:14.002078 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.075 seconds
[0m19:10:14.016834 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m19:10:14.035689 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m19:10:14.036695 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m19:10:14.368783 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.331 seconds
[0m19:10:14.392137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72bd4878-27d7-4952-a82c-1e4cfee89e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A93D5E7D0>]}
[0m19:10:14.422193 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_order_complete
[0m19:10:14.422193 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_order_complete'
[0m19:10:14.422193 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_order_complete
[0m19:10:14.496645 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_order_complete"
[0m19:10:14.501868 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_order_complete
[0m19:10:14.504465 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_order_complete
[0m19:10:14.504465 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m19:10:14.507965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_order_complete, now model.ManyPets.stg_orders)
[0m19:10:14.509608 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m19:10:14.512617 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m19:10:14.512617 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m19:10:14.526804 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m19:10:14.527980 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m19:10:14.530028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_orders, now test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b)
[0m19:10:14.530028 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m19:10:14.566156 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b"
[0m19:10:14.566156 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m19:10:14.572388 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m19:10:14.574136 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m19:10:14.576222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b, now test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec)
[0m19:10:14.577235 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m19:10:14.591327 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m19:10:14.591327 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m19:10:14.598046 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m19:10:14.599351 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m19:10:14.600361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec, now test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce)
[0m19:10:14.600361 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m19:10:14.626823 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m19:10:14.627826 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m19:10:14.631929 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m19:10:14.633663 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m19:10:14.635991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce, now test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1)
[0m19:10:14.636990 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m19:10:14.651564 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1"
[0m19:10:14.653995 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m19:10:14.656877 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m19:10:14.659574 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m19:10:14.660513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1, now model.ManyPets.dim_customers)
[0m19:10:14.661517 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m19:10:14.725076 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m19:10:14.732059 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m19:10:14.736093 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m19:10:14.736093 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_customer_email.f7618da361
[0m19:10:14.740914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_customers, now test.ManyPets.not_null_stg_orders_customer_email.f7618da361)
[0m19:10:14.743840 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_customer_email.f7618da361
[0m19:10:14.769117 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_customer_email.f7618da361"
[0m19:10:14.774089 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_customer_email.f7618da361
[0m19:10:14.785281 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_customer_email.f7618da361
[0m19:10:14.787541 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m19:10:14.790013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_customer_email.f7618da361, now test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e)
[0m19:10:14.790013 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m19:10:14.823225 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m19:10:14.823225 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m19:10:14.832135 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m19:10:14.834462 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m19:10:14.836458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e, now test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64)
[0m19:10:14.837453 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m19:10:14.859554 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m19:10:14.874369 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m19:10:14.877950 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m19:10:14.879673 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m19:10:14.883999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64, now test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6)
[0m19:10:14.883999 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m19:10:14.939052 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m19:10:14.952308 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m19:10:14.953331 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m19:10:14.958864 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m19:10:14.958864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6, now test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5)
[0m19:10:14.966870 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m19:10:15.007633 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m19:10:15.007633 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m19:10:15.013832 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m19:10:15.013832 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_pets
[0m19:10:15.020098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5, now model.ManyPets.dim_pets)
[0m19:10:15.020098 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_pets
[0m19:10:15.047073 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_pets"
[0m19:10:15.047073 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_pets
[0m19:10:15.059713 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_pets
[0m19:10:15.059713 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_order_complete
[0m19:10:15.059713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_pets, now model.ManyPets.fact_order_complete)
[0m19:10:15.059713 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_order_complete
[0m19:10:15.121531 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_order_complete"
[0m19:10:15.121531 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_order_complete
[0m19:10:15.131663 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_order_complete
[0m19:10:15.147064 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m19:10:15.149655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.fact_order_complete, now model.ManyPets.fact_orders)
[0m19:10:15.151741 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_orders
[0m19:10:15.169967 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_orders"
[0m19:10:15.169967 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_orders
[0m19:10:15.169967 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m19:10:15.188005 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:10:15.188005 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m19:10:15.188005 [debug] [MainThread]: On list_DEV_odl: Close
[0m19:10:15.309919 [debug] [MainThread]: Connection 'model.ManyPets.fact_orders' was properly closed.
[0m19:10:15.355315 [debug] [MainThread]: Command end result
[0m19:10:15.732426 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m19:10:15.756169 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m19:10:15.820704 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m19:10:15.833532 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m19:10:15.835106 [info ] [MainThread]: Building catalog
[0m19:10:15.903079 [debug] [ThreadPool]: Acquiring new snowflake connection 'DEV.information_schema'
[0m19:10:15.977583 [debug] [ThreadPool]: Using snowflake connection "DEV.information_schema"
[0m19:10:15.984350 [debug] [ThreadPool]: On DEV.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "DEV.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from DEV.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'odl' and upper("table_schema") = upper('odl')

                    and 
    "table_name" ilike 'fact_orders' and upper("table_name") = upper('fact_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'odl' and upper("table_schema") = upper('odl')

                    and 
    "table_name" ilike 'fact_order_complete' and upper("table_name") = upper('fact_order_complete')

                )
             or 
                (
                    
    "table_schema" ilike 'odl' and upper("table_schema") = upper('odl')

                    and 
    "table_name" ilike 'dim_pets' and upper("table_name") = upper('dim_pets')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_order_complete' and upper("table_name") = upper('stg_order_complete')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'odl' and upper("table_schema") = upper('odl')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from DEV.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'odl' and upper("table_schema") = upper('odl')

                    and 
    "table_name" ilike 'fact_orders' and upper("table_name") = upper('fact_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'odl' and upper("table_schema") = upper('odl')

                    and 
    "table_name" ilike 'fact_order_complete' and upper("table_name") = upper('fact_order_complete')

                )
             or 
                (
                    
    "table_schema" ilike 'odl' and upper("table_schema") = upper('odl')

                    and 
    "table_name" ilike 'dim_pets' and upper("table_name") = upper('dim_pets')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_order_complete' and upper("table_name") = upper('stg_order_complete')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'odl' and upper("table_schema") = upper('odl')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m19:10:15.988536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:10:21.842339 [debug] [ThreadPool]: SQL status: SUCCESS 81 in 5.853 seconds
[0m19:10:22.013050 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly DEV.information_schema, now dev.information_schema)
[0m19:10:22.046268 [debug] [ThreadPool]: Using snowflake connection "dev.information_schema"
[0m19:10:22.054622 [debug] [ThreadPool]: On dev.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "dev.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from dev.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'rdl' and upper("table_schema") = upper('rdl')

                    and 
    "table_name" ilike 'order_complete' and upper("table_name") = upper('order_complete')

                )
             or 
                (
                    
    "table_schema" ilike 'rdl' and upper("table_schema") = upper('rdl')

                    and 
    "table_name" ilike 'orders' and upper("table_name") = upper('orders')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from dev.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'rdl' and upper("table_schema") = upper('rdl')

                    and 
    "table_name" ilike 'order_complete' and upper("table_name") = upper('order_complete')

                )
             or 
                (
                    
    "table_schema" ilike 'rdl' and upper("table_schema") = upper('rdl')

                    and 
    "table_name" ilike 'orders' and upper("table_name") = upper('orders')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m19:10:24.904378 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.852 seconds
[0m19:10:25.077286 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\HP\Documents\manypets\ManyPets\target\catalog.json
[0m19:10:25.253047 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m19:10:25.270840 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m19:10:25.274381 [info ] [MainThread]: Catalog written to C:\Users\HP\Documents\manypets\ManyPets\target\catalog.json
[0m19:10:25.279155 [debug] [MainThread]: Command `dbt docs generate` succeeded at 19:10:25.279155 after 16.46 seconds
[0m19:10:25.279155 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m19:10:25.279155 [debug] [MainThread]: Connection 'dev.information_schema' was left open.
[0m19:10:25.279155 [debug] [MainThread]: On dev.information_schema: Close
[0m19:10:25.388889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A91526020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A92F66D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A8FC3E710>]}
[0m19:10:25.390084 [debug] [MainThread]: Flushing usage events
[0m19:10:26.051513 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:14:53.103128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221722C60B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221741EEC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221741EEA40>]}


============================== 19:14:53.109664 | eb50373e-4dbc-43a7-b978-c94ab0099760 ==============================
[0m19:14:53.109664 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:14:53.114358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_orders', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:14:54.317861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb50373e-4dbc-43a7-b978-c94ab0099760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022173D08B80>]}
[0m19:14:54.461253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb50373e-4dbc-43a7-b978-c94ab0099760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022174AA3490>]}
[0m19:14:54.469337 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:14:55.194437 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:14:55.710347 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:14:55.710347 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:14:55.848437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb50373e-4dbc-43a7-b978-c94ab0099760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221760B4130>]}
[0m19:14:56.168098 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m19:14:56.177843 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m19:14:56.258587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb50373e-4dbc-43a7-b978-c94ab0099760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221760298D0>]}
[0m19:14:56.259902 [info ] [MainThread]: Found 6 models, 9 data tests, 2 sources, 591 macros
[0m19:14:56.262238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb50373e-4dbc-43a7-b978-c94ab0099760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022174C5DB40>]}
[0m19:14:56.263228 [info ] [MainThread]: 
[0m19:14:56.267797 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:14:56.270211 [info ] [MainThread]: 
[0m19:14:56.272156 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:14:56.276124 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m19:14:56.617057 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m19:14:56.617057 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m19:14:56.617057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:57.489808 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.873 seconds
[0m19:14:57.529603 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m19:14:57.557945 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m19:14:57.557945 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m19:14:57.557945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:58.301626 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.740 seconds
[0m19:14:58.318417 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m19:14:58.328593 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m19:14:58.328593 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m19:14:58.434432 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.094 seconds
[0m19:14:58.444297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb50373e-4dbc-43a7-b978-c94ab0099760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002217609DD80>]}
[0m19:14:58.463669 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m19:14:58.463669 [info ] [Thread-1 (]: 1 of 1 START sql incremental model staging.stg_orders .......................... [RUN]
[0m19:14:58.470602 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_orders'
[0m19:14:58.471600 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m19:14:58.567632 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m19:14:58.567632 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m19:14:58.791411 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m19:14:58.809502 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m19:14:58.812644 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace transient table DEV.staging.stg_orders
         as
        (

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_effective_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS type,
        data:time::TIMESTAMP                            AS order_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
),
dedup AS
(
    SELECT
        *
        ,ROW_NUMBER() OVER(PARTITION BY order_id, email, pet_dob, pet_name, pet_breed  ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)
SELECT 
    order_id ,
    email                                                       AS customer_email,
    COALESCE(NULLIF(TRIM(COALESCE(first_name, '') || ' ' || 
            COALESCE(last_name, '')), ''), 'unknown')           AS customer_name,
    dob                                                         AS customer_dob,
    phone                                                       AS customer_phone,
    address_line1 || ' ' || address_line2                       AS customer_address,
    city                                                        AS customer_city,
    country                                                     AS customer_country,
    postcode                                                    AS customer_postcode,
    pet_dob,
    pet_name,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_time::DATE                                            AS order_create_date,
    order_time                                                  AS order_created_timestamp,
    cessation_date,
    affiliate_code,
    source,
    type,
    order_effective_date,
    ingest_date
FROM dedup
WHERE 
    rnk =1
        );
[0m19:14:58.812644 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:15:00.721468 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.907 seconds
[0m19:15:00.769367 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_orders__dbt_tmp
[0m19:15:00.803444 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m19:15:00.803444 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
drop view if exists DEV.staging.stg_orders__dbt_tmp cascade
[0m19:15:00.884244 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.070 seconds
[0m19:15:00.958654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb50373e-4dbc-43a7-b978-c94ab0099760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022170940370>]}
[0m19:15:00.961088 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model staging.stg_orders ..................... [[32mSUCCESS 1[0m in 2.48s]
[0m19:15:00.965089 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m19:15:00.969490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:15:00.970476 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m19:15:00.970476 [debug] [MainThread]: On list_DEV: Close
[0m19:15:01.087338 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m19:15:01.091484 [debug] [MainThread]: On list_DEV_staging: Close
[0m19:15:01.195742 [debug] [MainThread]: Connection 'model.ManyPets.stg_orders' was left open.
[0m19:15:01.196740 [debug] [MainThread]: On model.ManyPets.stg_orders: Close
[0m19:15:01.319322 [info ] [MainThread]: 
[0m19:15:01.322958 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.05 seconds (5.05s).
[0m19:15:01.329138 [debug] [MainThread]: Command end result
[0m19:15:01.522762 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m19:15:01.527775 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m19:15:01.567160 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m19:15:01.568411 [info ] [MainThread]: 
[0m19:15:01.572699 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:15:01.574343 [info ] [MainThread]: 
[0m19:15:01.577318 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:15:01.583500 [debug] [MainThread]: Command `dbt run` succeeded at 19:15:01.581229 after 8.71 seconds
[0m19:15:01.590558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221722C60B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221742008B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002217260CBB0>]}
[0m19:15:01.590558 [debug] [MainThread]: Flushing usage events
[0m19:15:02.404131 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:15:21.413738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024500036020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024501F5E9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024501F5E800>]}


============================== 19:15:21.423365 | 4d2908e8-f8bf-491e-838a-425da9cafa9a ==============================
[0m19:15:21.423365 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:15:21.427295 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_order_complete', 'send_anonymous_usage_stats': 'True'}
[0m19:15:22.605063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d2908e8-f8bf-491e-838a-425da9cafa9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002457E7E5C60>]}
[0m19:15:22.718573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d2908e8-f8bf-491e-838a-425da9cafa9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024501E022C0>]}
[0m19:15:22.725781 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:15:23.448077 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:15:24.047650 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:15:24.047650 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:15:24.151886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d2908e8-f8bf-491e-838a-425da9cafa9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024503F34130>]}
[0m19:15:24.483942 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m19:15:24.493050 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m19:15:24.566878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d2908e8-f8bf-491e-838a-425da9cafa9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024503EA9B70>]}
[0m19:15:24.569438 [info ] [MainThread]: Found 6 models, 9 data tests, 2 sources, 591 macros
[0m19:15:24.571948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d2908e8-f8bf-491e-838a-425da9cafa9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024502ADC1C0>]}
[0m19:15:24.572954 [info ] [MainThread]: 
[0m19:15:24.572954 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:15:24.582472 [info ] [MainThread]: 
[0m19:15:24.584974 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:15:24.588741 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m19:15:24.870094 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m19:15:24.870094 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m19:15:24.870094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:25.847969 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.976 seconds
[0m19:15:25.888748 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m19:15:25.934719 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m19:15:25.934719 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m19:15:25.934719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:26.543122 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.607 seconds
[0m19:15:26.551152 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m19:15:26.557211 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m19:15:26.573741 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m19:15:26.697380 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.125 seconds
[0m19:15:26.712781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d2908e8-f8bf-491e-838a-425da9cafa9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024502AA7820>]}
[0m19:15:26.725948 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_order_complete
[0m19:15:26.726947 [info ] [Thread-1 (]: 1 of 1 START sql incremental model staging.stg_order_complete .................. [RUN]
[0m19:15:26.730918 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_order_complete'
[0m19:15:26.730918 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_order_complete
[0m19:15:26.800600 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_order_complete"
[0m19:15:26.806773 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_order_complete
[0m19:15:26.940597 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_order_complete"
[0m19:15:26.956713 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m19:15:26.956713 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
create or replace transient table DEV.staging.stg_order_complete
         as
        (

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING        AS order_id,
        data:detail:intent::STRING          AS intent,
        data:detail:tenant::STRING          AS tenant,
        data:detail:customer_id::STRING     AS customer_id,
        pet.value                           AS pet_id,  
        data:time::TIMESTAMP                AS order_time,
        data:source::STRING                 AS source,
        data:type::STRING                   AS type,
        ingest_date                         AS ingest_date
    FROM dev.rdl.order_complete o,
    LATERAL FLATTEN(input => o.data:detail:pet_ids) AS pet  

    
)
,
dedup AS (
    SELECT 
        *,
        ROW_NUMBER() OVER ( PARTITION BY order_id, customer_id, pet_id ORDER BY ingest_date DESC ) AS rnk
    FROM source_data
)
SELECT 
    order_id,
    customer_id,
    pet_id,
    intent,
    tenant,
    order_time::DATE            AS order_complete_date,
    order_time                  AS order_complete_timestamp,
    source,
    type,
    ingest_date
FROM dedup
WHERE rnk =1
        );
[0m19:15:26.956713 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:15:28.921763 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.965 seconds
[0m19:15:28.968764 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_order_complete__dbt_tmp
[0m19:15:29.000034 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m19:15:29.000034 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
drop view if exists DEV.staging.stg_order_complete__dbt_tmp cascade
[0m19:15:29.091614 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.088 seconds
[0m19:15:29.195496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d2908e8-f8bf-491e-838a-425da9cafa9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002457E5E02E0>]}
[0m19:15:29.195496 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model staging.stg_order_complete ............. [[32mSUCCESS 1[0m in 2.46s]
[0m19:15:29.203683 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_order_complete
[0m19:15:29.210281 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:15:29.210281 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m19:15:29.210281 [debug] [MainThread]: On list_DEV: Close
[0m19:15:29.323307 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m19:15:29.323307 [debug] [MainThread]: On list_DEV_odl: Close
[0m19:15:29.439995 [debug] [MainThread]: Connection 'model.ManyPets.stg_order_complete' was left open.
[0m19:15:29.439995 [debug] [MainThread]: On model.ManyPets.stg_order_complete: Close
[0m19:15:29.558243 [info ] [MainThread]: 
[0m19:15:29.569382 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.97 seconds (4.97s).
[0m19:15:29.573442 [debug] [MainThread]: Command end result
[0m19:15:29.776185 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m19:15:29.782996 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m19:15:29.806939 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m19:15:29.808012 [info ] [MainThread]: 
[0m19:15:29.811005 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:15:29.812519 [info ] [MainThread]: 
[0m19:15:29.813896 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:15:29.816549 [debug] [MainThread]: Command `dbt run` succeeded at 19:15:29.816549 after 8.60 seconds
[0m19:15:29.820961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024500036020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024501E022C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245029E5C60>]}
[0m19:15:29.823501 [debug] [MainThread]: Flushing usage events
[0m19:15:30.665910 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:15:43.172830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B412636050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B41452CE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4143CB9A0>]}


============================== 19:15:43.180012 | 87e994f5-81bc-48f4-9b22-ec979f981857 ==============================
[0m19:15:43.180012 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:15:43.185972 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:15:44.448920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87e994f5-81bc-48f4-9b22-ec979f981857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B414576A10>]}
[0m19:15:44.582783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87e994f5-81bc-48f4-9b22-ec979f981857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4144028C0>]}
[0m19:15:44.593110 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:15:45.447642 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:15:45.932490 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:15:45.932490 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:15:46.071424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87e994f5-81bc-48f4-9b22-ec979f981857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B416428130>]}
[0m19:15:46.471792 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m19:15:46.482421 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m19:15:46.607051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87e994f5-81bc-48f4-9b22-ec979f981857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4163CC640>]}
[0m19:15:46.609963 [info ] [MainThread]: Found 6 models, 9 data tests, 2 sources, 591 macros
[0m19:15:46.612197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87e994f5-81bc-48f4-9b22-ec979f981857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4163CF460>]}
[0m19:15:46.623299 [info ] [MainThread]: 
[0m19:15:46.627085 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:15:46.629859 [info ] [MainThread]: 
[0m19:15:46.632512 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:15:46.679036 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m19:15:46.882317 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m19:15:46.882317 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m19:15:46.882317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:47.809367 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.920 seconds
[0m19:15:47.809367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m19:15:47.831947 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m19:15:47.831947 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m19:15:47.947148 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.115 seconds
[0m19:15:47.962578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87e994f5-81bc-48f4-9b22-ec979f981857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B410D3E530>]}
[0m19:15:47.990225 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m19:15:47.991234 [info ] [Thread-1 (]: 1 of 9 START test not_null_stg_order_complete_customer_id ...................... [RUN]
[0m19:15:47.998432 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b'
[0m19:15:47.999434 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m19:15:48.104947 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b"
[0m19:15:48.113170 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m19:15:48.147963 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b"
[0m19:15:48.162314 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b"
[0m19:15:48.163362 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from DEV.staging.stg_order_complete
where customer_id is null



      
    ) dbt_internal_test
[0m19:15:48.164372 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:15:48.982074 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.832 seconds
[0m19:15:49.035273 [info ] [Thread-1 (]: 1 of 9 PASS not_null_stg_order_complete_customer_id ............................ [[32mPASS[0m in 1.04s]
[0m19:15:49.042602 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m19:15:49.042602 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m19:15:49.048774 [info ] [Thread-1 (]: 2 of 9 START test not_null_stg_order_complete_ingest_date ...................... [RUN]
[0m19:15:49.055249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b, now test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec)
[0m19:15:49.059640 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m19:15:49.090748 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m19:15:49.091746 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m19:15:49.123520 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m19:15:49.124521 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m19:15:49.124521 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ingest_date
from DEV.staging.stg_order_complete
where ingest_date is null



      
    ) dbt_internal_test
[0m19:15:49.439738 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.320 seconds
[0m19:15:49.457653 [info ] [Thread-1 (]: 2 of 9 PASS not_null_stg_order_complete_ingest_date ............................ [[32mPASS[0m in 0.40s]
[0m19:15:49.473285 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m19:15:49.473285 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m19:15:49.473285 [info ] [Thread-1 (]: 3 of 9 START test not_null_stg_order_complete_order_id ......................... [RUN]
[0m19:15:49.483906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec, now test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce)
[0m19:15:49.489032 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m19:15:49.552696 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m19:15:49.556958 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m19:15:49.580325 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m19:15:49.588575 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m19:15:49.588575 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from DEV.staging.stg_order_complete
where order_id is null



      
    ) dbt_internal_test
[0m19:15:49.919699 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.318 seconds
[0m19:15:49.936839 [info ] [Thread-1 (]: 3 of 9 PASS not_null_stg_order_complete_order_id ............................... [[32mPASS[0m in 0.45s]
[0m19:15:49.943445 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m19:15:49.943445 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m19:15:49.949239 [info ] [Thread-1 (]: 4 of 9 START test not_null_stg_order_complete_pet_id ........................... [RUN]
[0m19:15:49.954324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce, now test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1)
[0m19:15:49.957129 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m19:15:50.003244 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1"
[0m19:15:50.004249 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m19:15:50.019939 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1"
[0m19:15:50.035163 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1"
[0m19:15:50.035163 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pet_id
from DEV.staging.stg_order_complete
where pet_id is null



      
    ) dbt_internal_test
[0m19:15:50.321686 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.285 seconds
[0m19:15:50.321686 [info ] [Thread-1 (]: 4 of 9 PASS not_null_stg_order_complete_pet_id ................................. [[32mPASS[0m in 0.37s]
[0m19:15:50.340926 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m19:15:50.340926 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_customer_email.f7618da361
[0m19:15:50.345600 [info ] [Thread-1 (]: 5 of 9 START test not_null_stg_orders_customer_email ........................... [RUN]
[0m19:15:50.350346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1, now test.ManyPets.not_null_stg_orders_customer_email.f7618da361)
[0m19:15:50.355971 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_customer_email.f7618da361
[0m19:15:50.393918 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_customer_email.f7618da361"
[0m19:15:50.403280 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_customer_email.f7618da361
[0m19:15:50.418740 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_customer_email.f7618da361"
[0m19:15:50.434447 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_customer_email.f7618da361"
[0m19:15:50.437219 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_customer_email.f7618da361: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_customer_email.f7618da361"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_email
from DEV.staging.stg_orders
where customer_email is null



      
    ) dbt_internal_test
[0m19:15:50.749345 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.309 seconds
[0m19:15:50.762473 [info ] [Thread-1 (]: 5 of 9 PASS not_null_stg_orders_customer_email ................................. [[32mPASS[0m in 0.41s]
[0m19:15:50.770577 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_customer_email.f7618da361
[0m19:15:50.774867 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m19:15:50.779983 [info ] [Thread-1 (]: 6 of 9 START test not_null_stg_orders_ingest_date .............................. [RUN]
[0m19:15:50.788402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_customer_email.f7618da361, now test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e)
[0m19:15:50.795701 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m19:15:50.843515 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m19:15:50.853206 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m19:15:50.874928 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m19:15:50.879355 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m19:15:50.881958 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ingest_date
from DEV.staging.stg_orders
where ingest_date is null



      
    ) dbt_internal_test
[0m19:15:51.157830 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.288 seconds
[0m19:15:51.172973 [info ] [Thread-1 (]: 6 of 9 PASS not_null_stg_orders_ingest_date .................................... [[32mPASS[0m in 0.39s]
[0m19:15:51.183212 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m19:15:51.183212 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m19:15:51.191049 [info ] [Thread-1 (]: 7 of 9 START test not_null_stg_orders_order_id ................................. [RUN]
[0m19:15:51.195008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e, now test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64)
[0m19:15:51.199652 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m19:15:51.243673 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m19:15:51.253251 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m19:15:51.272525 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m19:15:51.290724 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m19:15:51.290724 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from DEV.staging.stg_orders
where order_id is null



      
    ) dbt_internal_test
[0m19:15:51.542706 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.260 seconds
[0m19:15:51.559751 [info ] [Thread-1 (]: 7 of 9 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.36s]
[0m19:15:51.572108 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m19:15:51.572108 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m19:15:51.578121 [info ] [Thread-1 (]: 8 of 9 START test not_null_stg_orders_pet_dob .................................. [RUN]
[0m19:15:51.584425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64, now test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6)
[0m19:15:51.589699 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m19:15:51.707495 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m19:15:51.721255 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m19:15:51.734974 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m19:15:51.751068 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m19:15:51.752047 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pet_dob
from DEV.staging.stg_orders
where pet_dob is null



      
    ) dbt_internal_test
[0m19:15:52.065695 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.312 seconds
[0m19:15:52.076897 [info ] [Thread-1 (]: 8 of 9 PASS not_null_stg_orders_pet_dob ........................................ [[32mPASS[0m in 0.49s]
[0m19:15:52.083832 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m19:15:52.083832 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m19:15:52.089004 [info ] [Thread-1 (]: 9 of 9 START test not_null_stg_orders_pet_name ................................. [RUN]
[0m19:15:52.093535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6, now test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5)
[0m19:15:52.099712 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m19:15:52.135053 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m19:15:52.142532 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m19:15:52.167569 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m19:15:52.178734 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m19:15:52.178734 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pet_name
from DEV.staging.stg_orders
where pet_name is null



      
    ) dbt_internal_test
[0m19:15:52.475178 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.294 seconds
[0m19:15:52.475178 [info ] [Thread-1 (]: 9 of 9 PASS not_null_stg_orders_pet_name ....................................... [[32mPASS[0m in 0.38s]
[0m19:15:52.492986 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m19:15:52.499213 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:15:52.499213 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m19:15:52.499213 [debug] [MainThread]: On list_DEV_odl: Close
[0m19:15:52.610885 [debug] [MainThread]: Connection 'test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5' was left open.
[0m19:15:52.610885 [debug] [MainThread]: On test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5: Close
[0m19:15:52.740099 [info ] [MainThread]: 
[0m19:15:52.747673 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 6.11 seconds (6.11s).
[0m19:15:52.775095 [debug] [MainThread]: Command end result
[0m19:15:52.919671 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m19:15:52.924449 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m19:15:52.948463 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m19:15:52.951718 [info ] [MainThread]: 
[0m19:15:52.953938 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:15:52.955467 [info ] [MainThread]: 
[0m19:15:52.957805 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m19:15:52.966155 [debug] [MainThread]: Command `dbt test` succeeded at 19:15:52.964089 after 9.95 seconds
[0m19:15:52.971569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B412636050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B412931090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B412201660>]}
[0m19:15:52.971569 [debug] [MainThread]: Flushing usage events
[0m19:15:53.523459 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:16:54.936153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019638E65F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001963ADA1C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001963ADA1240>]}


============================== 19:16:54.941760 | 5cd266bb-256f-49ca-9321-be6c8a8e993c ==============================
[0m19:16:54.941760 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:16:54.947254 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m19:16:56.208823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5cd266bb-256f-49ca-9321-be6c8a8e993c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196376BF0A0>]}
[0m19:16:56.356710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5cd266bb-256f-49ca-9321-be6c8a8e993c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001963AC322C0>]}
[0m19:16:56.365794 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:16:57.017114 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:16:57.614187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:16:57.614187 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:16:57.727860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5cd266bb-256f-49ca-9321-be6c8a8e993c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001963CC58130>]}
[0m19:16:57.802263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5cd266bb-256f-49ca-9321-be6c8a8e993c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001963CBFE080>]}
[0m19:16:57.803263 [info ] [MainThread]: Found 6 models, 9 data tests, 2 sources, 591 macros
[0m19:16:57.807105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cd266bb-256f-49ca-9321-be6c8a8e993c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001963CBFE9E0>]}
[0m19:16:57.808104 [info ] [MainThread]: 
[0m19:16:57.812604 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:16:57.815332 [info ] [MainThread]: 
[0m19:16:57.817120 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:16:57.846832 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m19:16:58.121568 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m19:16:58.121568 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m19:16:58.121568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:58.959333 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.833 seconds
[0m19:16:58.970107 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m19:16:58.972972 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m19:16:58.972972 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m19:16:59.091869 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.114 seconds
[0m19:16:59.118842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cd266bb-256f-49ca-9321-be6c8a8e993c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001963B692740>]}
[0m19:16:59.139671 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_order_complete
[0m19:16:59.141671 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_order_complete'
[0m19:16:59.148906 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_order_complete
[0m19:16:59.207712 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_order_complete"
[0m19:16:59.207712 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_order_complete
[0m19:16:59.227541 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_order_complete
[0m19:16:59.229516 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m19:16:59.230524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_order_complete, now model.ManyPets.stg_orders)
[0m19:16:59.232395 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m19:16:59.234749 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m19:16:59.234749 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m19:16:59.247070 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m19:16:59.248066 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m19:16:59.249551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_orders, now test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b)
[0m19:16:59.250538 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m19:16:59.274649 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b"
[0m19:16:59.277303 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m19:16:59.278976 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m19:16:59.280649 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m19:16:59.281640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b, now test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec)
[0m19:16:59.281640 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m19:16:59.281640 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m19:16:59.281640 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m19:16:59.298792 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m19:16:59.299908 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m19:16:59.301050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec, now test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce)
[0m19:16:59.302228 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m19:16:59.303228 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m19:16:59.303228 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m19:16:59.318624 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m19:16:59.319628 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m19:16:59.321527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce, now test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1)
[0m19:16:59.322534 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m19:16:59.322534 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1"
[0m19:16:59.322534 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m19:16:59.337326 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m19:16:59.338324 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m19:16:59.338324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1, now model.ManyPets.dim_customers)
[0m19:16:59.338324 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m19:16:59.374724 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m19:16:59.377446 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m19:16:59.379376 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m19:16:59.379376 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_customer_email.f7618da361
[0m19:16:59.382185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_customers, now test.ManyPets.not_null_stg_orders_customer_email.f7618da361)
[0m19:16:59.383173 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_customer_email.f7618da361
[0m19:16:59.383173 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_customer_email.f7618da361"
[0m19:16:59.383173 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_customer_email.f7618da361
[0m19:16:59.396813 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_customer_email.f7618da361
[0m19:16:59.397596 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m19:16:59.398615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_customer_email.f7618da361, now test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e)
[0m19:16:59.398615 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m19:16:59.401117 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m19:16:59.401117 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m19:16:59.412457 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m19:16:59.413886 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m19:16:59.414885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e, now test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64)
[0m19:16:59.414885 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m19:16:59.414885 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m19:16:59.414885 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m19:16:59.431158 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m19:16:59.433947 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m19:16:59.434946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64, now test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6)
[0m19:16:59.434946 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m19:16:59.450843 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m19:16:59.454458 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m19:16:59.456315 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m19:16:59.458309 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m19:16:59.459740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6, now test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5)
[0m19:16:59.460740 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m19:16:59.471506 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m19:16:59.471506 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m19:16:59.478212 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m19:16:59.479969 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_pets
[0m19:16:59.481482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5, now model.ManyPets.dim_pets)
[0m19:16:59.482482 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_pets
[0m19:16:59.488101 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_pets"
[0m19:16:59.488101 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_pets
[0m19:16:59.502509 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_pets
[0m19:16:59.505135 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_order_complete
[0m19:16:59.506243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_pets, now model.ManyPets.fact_order_complete)
[0m19:16:59.507822 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_order_complete
[0m19:16:59.508823 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_order_complete"
[0m19:16:59.525691 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_order_complete
[0m19:16:59.528309 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_order_complete
[0m19:16:59.528309 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m19:16:59.531068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.fact_order_complete, now model.ManyPets.fact_orders)
[0m19:16:59.532066 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_orders
[0m19:16:59.532066 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_orders"
[0m19:16:59.532066 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_orders
[0m19:16:59.547446 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m19:16:59.549636 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:16:59.550644 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m19:16:59.550644 [debug] [MainThread]: On list_DEV_odl: Close
[0m19:16:59.643925 [debug] [MainThread]: Connection 'model.ManyPets.fact_orders' was properly closed.
[0m19:16:59.684962 [debug] [MainThread]: Command end result
[0m19:17:00.052595 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m19:17:00.065687 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m19:17:00.086849 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m19:17:00.092156 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m19:17:00.093617 [info ] [MainThread]: Building catalog
[0m19:17:00.123702 [debug] [ThreadPool]: Acquiring new snowflake connection 'dev.information_schema'
[0m19:17:00.176941 [debug] [ThreadPool]: Using snowflake connection "dev.information_schema"
[0m19:17:00.176941 [debug] [ThreadPool]: On dev.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "dev.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from dev.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'rdl' and upper("table_schema") = upper('rdl')

                    and 
    "table_name" ilike 'order_complete' and upper("table_name") = upper('order_complete')

                )
             or 
                (
                    
    "table_schema" ilike 'rdl' and upper("table_schema") = upper('rdl')

                    and 
    "table_name" ilike 'orders' and upper("table_name") = upper('orders')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from dev.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'rdl' and upper("table_schema") = upper('rdl')

                    and 
    "table_name" ilike 'order_complete' and upper("table_name") = upper('order_complete')

                )
             or 
                (
                    
    "table_schema" ilike 'rdl' and upper("table_schema") = upper('rdl')

                    and 
    "table_name" ilike 'orders' and upper("table_name") = upper('orders')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m19:17:00.176941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:03.235924 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 3.055 seconds
[0m19:17:03.270535 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly dev.information_schema, now DEV.information_schema)
[0m19:17:03.295290 [debug] [ThreadPool]: Using snowflake connection "DEV.information_schema"
[0m19:17:03.295290 [debug] [ThreadPool]: On DEV.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "DEV.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from DEV.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_order_complete' and upper("table_name") = upper('stg_order_complete')

                )
             or 
                (
                    
    "table_schema" ilike 'odl' and upper("table_schema") = upper('odl')

                    and 
    "table_name" ilike 'fact_order_complete' and upper("table_name") = upper('fact_order_complete')

                )
             or 
                (
                    
    "table_schema" ilike 'odl' and upper("table_schema") = upper('odl')

                    and 
    "table_name" ilike 'dim_pets' and upper("table_name") = upper('dim_pets')

                )
             or 
                (
                    
    "table_schema" ilike 'odl' and upper("table_schema") = upper('odl')

                    and 
    "table_name" ilike 'fact_orders' and upper("table_name") = upper('fact_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'odl' and upper("table_schema") = upper('odl')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from DEV.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_order_complete' and upper("table_name") = upper('stg_order_complete')

                )
             or 
                (
                    
    "table_schema" ilike 'odl' and upper("table_schema") = upper('odl')

                    and 
    "table_name" ilike 'fact_order_complete' and upper("table_name") = upper('fact_order_complete')

                )
             or 
                (
                    
    "table_schema" ilike 'odl' and upper("table_schema") = upper('odl')

                    and 
    "table_name" ilike 'dim_pets' and upper("table_name") = upper('dim_pets')

                )
             or 
                (
                    
    "table_schema" ilike 'odl' and upper("table_schema") = upper('odl')

                    and 
    "table_name" ilike 'fact_orders' and upper("table_name") = upper('fact_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'odl' and upper("table_schema") = upper('odl')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m19:17:08.883620 [debug] [ThreadPool]: SQL status: SUCCESS 82 in 5.583 seconds
[0m19:17:09.077176 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\HP\Documents\manypets\ManyPets\target\catalog.json
[0m19:17:09.149226 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m19:17:09.153507 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m19:17:09.154508 [info ] [MainThread]: Catalog written to C:\Users\HP\Documents\manypets\ManyPets\target\catalog.json
[0m19:17:09.158440 [debug] [MainThread]: Command `dbt docs generate` succeeded at 19:17:09.158440 after 14.43 seconds
[0m19:17:09.158440 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m19:17:09.158440 [debug] [MainThread]: Connection 'DEV.information_schema' was left open.
[0m19:17:09.158440 [debug] [MainThread]: On DEV.information_schema: Close
[0m19:17:09.261995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019638E65F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001963AC322C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001963776DFC0>]}
[0m19:17:09.261995 [debug] [MainThread]: Flushing usage events
[0m19:17:10.200041 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:17:37.347934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001730E2E6020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173102329E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017310232800>]}


============================== 19:17:37.355916 | f262ce76-0979-4736-b058-7cbb0bad4de4 ==============================
[0m19:17:37.355916 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:17:37.360690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:17:38.511549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f262ce76-0979-4736-b058-7cbb0bad4de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001730FD9EDA0>]}
[0m19:17:38.623897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f262ce76-0979-4736-b058-7cbb0bad4de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001730E62FF40>]}
[0m19:18:28.847424 [error] [MainThread]: Encountered an error:

[0m19:18:28.862161 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
  File "C:\Users\HP\Documents\manypets\ManyPets\dbt_venv\lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\HP\AppData\Local\Programs\Python\Python310\lib\socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "C:\Users\HP\AppData\Local\Programs\Python\Python310\lib\selectors.py", line 324, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "C:\Users\HP\AppData\Local\Programs\Python\Python310\lib\selectors.py", line 315, in _select
    r, w, x = select.select(r, w, w, timeout)
KeyboardInterrupt

[0m19:18:28.890616 [debug] [MainThread]: Command `dbt docs serve` failed at 19:18:28.889637 after 51.70 seconds
[0m19:18:28.890616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001730E2E6020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017310CEE650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017310CEE740>]}
[0m19:18:28.898765 [debug] [MainThread]: Flushing usage events
[0m19:18:29.656394 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:26:57.471142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002375AA960E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002375ADDE2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002375C9D0160>]}


============================== 19:26:57.478713 | 466e092f-5dda-4c92-b640-5e3974354645 ==============================
[0m19:26:57.478713 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:26:57.483766 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_customers', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:26:58.805169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '466e092f-5dda-4c92-b640-5e3974354645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002375C50BC40>]}
[0m19:26:58.956096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '466e092f-5dda-4c92-b640-5e3974354645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002375C862350>]}
[0m19:26:58.962464 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:26:59.700596 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:27:00.234138 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:27:00.234138 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:27:00.330516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '466e092f-5dda-4c92-b640-5e3974354645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002375E884130>]}
[0m19:27:00.684578 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m19:27:00.692391 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m19:27:00.775596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '466e092f-5dda-4c92-b640-5e3974354645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002375D42FE50>]}
[0m19:27:00.776593 [info ] [MainThread]: Found 6 models, 9 data tests, 2 sources, 591 macros
[0m19:27:00.781117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '466e092f-5dda-4c92-b640-5e3974354645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002375D635AB0>]}
[0m19:27:00.783126 [info ] [MainThread]: 
[0m19:27:00.786133 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:27:00.789951 [info ] [MainThread]: 
[0m19:27:00.792869 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:27:00.797724 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m19:27:01.122996 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m19:27:01.122996 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m19:27:01.122996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:02.172279 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.050 seconds
[0m19:27:02.227538 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m19:27:02.273307 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m19:27:02.273307 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m19:27:02.273307 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:03.011630 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.734 seconds
[0m19:27:03.011630 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m19:27:03.030779 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m19:27:03.030779 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m19:27:03.159426 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.121 seconds
[0m19:27:03.174611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '466e092f-5dda-4c92-b640-5e3974354645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002375D42F4C0>]}
[0m19:27:03.199285 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m19:27:03.199285 [info ] [Thread-1 (]: 1 of 1 START sql incremental model odl.dim_customers ........................... [RUN]
[0m19:27:03.205806 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.dim_customers'
[0m19:27:03.205806 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m19:27:03.360289 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m19:27:03.360289 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m19:27:03.515094 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m19:27:03.515094 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace  temporary view DEV.odl.dim_customers__dbt_tmp
  
   as (
    
WITH stg_data AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date  
    FROM DEV.staging.stg_orders
    
    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.dim_customers)
    
),
dedup AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date,
        ROW_NUMBER() OVER (PARTITION BY customer_email ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    customer_email                                                          AS customer_nk, 
    md5(cast(coalesce(cast(customer_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                 AS customer_sk,
    customer_name,
    customer_dob,
    customer_phone,
    customer_address,
    customer_city,
    customer_country,
    customer_postcode,
    ingest_date
FROM dedup
WHERE rnk = 1
  );
[0m19:27:03.515094 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:27:04.509082 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.991 seconds
[0m19:27:04.531196 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m19:27:04.531196 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table DEV.odl.dim_customers__dbt_tmp
[0m19:27:04.715630 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.179 seconds
[0m19:27:04.732784 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m19:27:04.732784 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table DEV.odl.dim_customers
[0m19:27:04.872404 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.133 seconds
[0m19:27:04.914821 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m19:27:04.914821 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table "DEV"."ODL"."DIM_CUSTOMERS"
[0m19:27:05.049037 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.124 seconds
[0m19:27:05.179662 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_customers"
[0m19:27:05.183710 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m19:27:05.183710 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m19:27:05.273462 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.100 seconds
[0m19:27:05.289128 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m19:27:05.289128 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
merge into DEV.odl.dim_customers as DBT_INTERNAL_DEST
        using DEV.odl.dim_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.customer_nk = DBT_INTERNAL_DEST.customer_nk))

    
    when matched then update set
        "CUSTOMER_NK" = DBT_INTERNAL_SOURCE."CUSTOMER_NK","CUSTOMER_SK" = DBT_INTERNAL_SOURCE."CUSTOMER_SK","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("CUSTOMER_NK", "CUSTOMER_SK", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "INGEST_DATE")
    values
        ("CUSTOMER_NK", "CUSTOMER_SK", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "INGEST_DATE")

;
[0m19:27:06.663822 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.373 seconds
[0m19:27:06.663822 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m19:27:06.663822 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
COMMIT
[0m19:27:06.942033 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.270 seconds
[0m19:27:06.987367 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_customers__dbt_tmp
[0m19:27:07.020872 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m19:27:07.020872 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
drop view if exists DEV.odl.dim_customers__dbt_tmp cascade
[0m19:27:07.168920 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.143 seconds
[0m19:27:07.278199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '466e092f-5dda-4c92-b640-5e3974354645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002375F00EEF0>]}
[0m19:27:07.279196 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model odl.dim_customers ...................... [[32mSUCCESS 0[0m in 4.06s]
[0m19:27:07.282709 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m19:27:07.285704 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:27:07.286703 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m19:27:07.286703 [debug] [MainThread]: On list_DEV: Close
[0m19:27:07.389117 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m19:27:07.389117 [debug] [MainThread]: On list_DEV_staging: Close
[0m19:27:07.486376 [debug] [MainThread]: Connection 'model.ManyPets.dim_customers' was left open.
[0m19:27:07.486376 [debug] [MainThread]: On model.ManyPets.dim_customers: Close
[0m19:27:07.612783 [info ] [MainThread]: 
[0m19:27:07.618688 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.82 seconds (6.82s).
[0m19:27:07.622760 [debug] [MainThread]: Command end result
[0m19:27:07.810560 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m19:27:07.817712 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m19:27:07.839126 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m19:27:07.841534 [info ] [MainThread]: 
[0m19:27:07.846072 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:27:07.850117 [info ] [MainThread]: 
[0m19:27:07.851666 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:27:07.856329 [debug] [MainThread]: Command `dbt run` succeeded at 19:27:07.856329 after 10.58 seconds
[0m19:27:07.856329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002375AA960E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002375E761C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002375D42C220>]}
[0m19:27:07.856329 [debug] [MainThread]: Flushing usage events
[0m19:27:08.602404 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:27:19.675555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A342F760B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A344E9EC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A344E9EA40>]}


============================== 19:27:19.689921 | 3bd07733-47e2-48d4-9573-9ddbd00849f0 ==============================
[0m19:27:19.689921 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:27:19.692903 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:27:20.865217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3bd07733-47e2-48d4-9573-9ddbd00849f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3449B4B80>]}
[0m19:27:20.966455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3bd07733-47e2-48d4-9573-9ddbd00849f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A345753490>]}
[0m19:27:20.975518 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:27:21.754468 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:27:22.301084 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:27:22.301084 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:27:22.459726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3bd07733-47e2-48d4-9573-9ddbd00849f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A346D64130>]}
[0m19:27:22.787100 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m19:27:22.798623 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m19:27:22.890425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3bd07733-47e2-48d4-9573-9ddbd00849f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A346CD98D0>]}
[0m19:27:22.892389 [info ] [MainThread]: Found 6 models, 9 data tests, 2 sources, 591 macros
[0m19:27:22.894786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bd07733-47e2-48d4-9573-9ddbd00849f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A34590DB40>]}
[0m19:27:22.900857 [info ] [MainThread]: 
[0m19:27:22.903420 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:27:22.906358 [info ] [MainThread]: 
[0m19:27:22.909402 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:27:22.913868 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m19:27:23.147104 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m19:27:23.147104 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m19:27:23.147104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:24.062475 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.915 seconds
[0m19:27:24.102373 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m19:27:24.149035 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m19:27:24.149035 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m19:27:24.149035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:24.886462 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.737 seconds
[0m19:27:24.886462 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m19:27:24.905902 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m19:27:24.905902 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m19:27:25.035943 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.118 seconds
[0m19:27:25.035943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bd07733-47e2-48d4-9573-9ddbd00849f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A34588C100>]}
[0m19:27:25.068420 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m19:27:25.069428 [info ] [Thread-1 (]: 1 of 1 START sql incremental model odl.dim_customers ........................... [RUN]
[0m19:27:25.075849 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.dim_customers'
[0m19:27:25.075849 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m19:27:25.203187 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m19:27:25.203187 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m19:27:25.337699 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m19:27:25.337699 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace  temporary view DEV.odl.dim_customers__dbt_tmp
  
   as (
    
WITH stg_data AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date  
    FROM DEV.staging.stg_orders
    
    
    WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.dim_customers)
    
),
dedup AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date,
        ROW_NUMBER() OVER (PARTITION BY customer_email ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    customer_email                                                          AS customer_nk, 
    md5(cast(coalesce(cast(customer_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                 AS customer_sk,
    customer_name,
    customer_dob,
    customer_phone,
    customer_address,
    customer_city,
    customer_country,
    customer_postcode,
    ingest_date
FROM dedup
WHERE rnk = 1
  );
[0m19:27:25.337699 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:27:26.316492 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.978 seconds
[0m19:27:26.356412 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m19:27:26.356412 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table DEV.odl.dim_customers__dbt_tmp
[0m19:27:26.456716 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.097 seconds
[0m19:27:26.472294 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m19:27:26.487918 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table DEV.odl.dim_customers
[0m19:27:26.602004 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.116 seconds
[0m19:27:26.688740 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m19:27:26.704361 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
describe table "DEV"."ODL"."DIM_CUSTOMERS"
[0m19:27:26.797960 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.090 seconds
[0m19:27:26.909461 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_customers"
[0m19:27:26.916910 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m19:27:26.916910 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m19:27:27.135277 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.222 seconds
[0m19:27:27.135277 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m19:27:27.135277 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
merge into DEV.odl.dim_customers as DBT_INTERNAL_DEST
        using DEV.odl.dim_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.customer_nk = DBT_INTERNAL_DEST.customer_nk))

    
    when matched then update set
        "CUSTOMER_NK" = DBT_INTERNAL_SOURCE."CUSTOMER_NK","CUSTOMER_SK" = DBT_INTERNAL_SOURCE."CUSTOMER_SK","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_DOB" = DBT_INTERNAL_SOURCE."CUSTOMER_DOB","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_CITY" = DBT_INTERNAL_SOURCE."CUSTOMER_CITY","CUSTOMER_COUNTRY" = DBT_INTERNAL_SOURCE."CUSTOMER_COUNTRY","CUSTOMER_POSTCODE" = DBT_INTERNAL_SOURCE."CUSTOMER_POSTCODE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("CUSTOMER_NK", "CUSTOMER_SK", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "INGEST_DATE")
    values
        ("CUSTOMER_NK", "CUSTOMER_SK", "CUSTOMER_NAME", "CUSTOMER_DOB", "CUSTOMER_PHONE", "CUSTOMER_ADDRESS", "CUSTOMER_CITY", "CUSTOMER_COUNTRY", "CUSTOMER_POSTCODE", "INGEST_DATE")

;
[0m19:27:28.368895 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.222 seconds
[0m19:27:28.368895 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m19:27:28.368895 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
COMMIT
[0m19:27:28.781256 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.403 seconds
[0m19:27:28.813997 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_customers__dbt_tmp
[0m19:27:28.850073 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m19:27:28.850073 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
drop view if exists DEV.odl.dim_customers__dbt_tmp cascade
[0m19:27:28.972227 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.119 seconds
[0m19:27:29.078226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bd07733-47e2-48d4-9573-9ddbd00849f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3474DF7C0>]}
[0m19:27:29.078226 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model odl.dim_customers ...................... [[32mSUCCESS 0[0m in 3.99s]
[0m19:27:29.085957 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m19:27:29.092710 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:27:29.092710 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m19:27:29.092710 [debug] [MainThread]: On list_DEV: Close
[0m19:27:29.199510 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m19:27:29.199510 [debug] [MainThread]: On list_DEV_odl: Close
[0m19:27:29.353936 [debug] [MainThread]: Connection 'model.ManyPets.dim_customers' was left open.
[0m19:27:29.353936 [debug] [MainThread]: On model.ManyPets.dim_customers: Close
[0m19:27:29.467400 [info ] [MainThread]: 
[0m19:27:29.482006 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.56 seconds (6.56s).
[0m19:27:29.486584 [debug] [MainThread]: Command end result
[0m19:27:29.658835 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m19:27:29.678377 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m19:27:29.700050 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m19:27:29.711665 [info ] [MainThread]: 
[0m19:27:29.713972 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:27:29.716724 [info ] [MainThread]: 
[0m19:27:29.718793 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:27:29.720178 [debug] [MainThread]: Command `dbt run` succeeded at 19:27:29.720178 after 10.29 seconds
[0m19:27:29.723341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A342F760B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A344EB08B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3432BCBB0>]}
[0m19:27:29.723341 [debug] [MainThread]: Flushing usage events
[0m19:27:30.417172 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:55:40.253634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288AC206020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288AE12EB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288AE12E9B0>]}


============================== 19:55:40.259322 | d7dae099-bceb-4bea-ae2d-38779d0a4313 ==============================
[0m19:55:40.259322 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:55:40.263185 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_pets', 'send_anonymous_usage_stats': 'True'}
[0m19:55:41.131696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7dae099-bceb-4bea-ae2d-38779d0a4313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288AB289C60>]}
[0m19:55:41.243202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7dae099-bceb-4bea-ae2d-38779d0a4313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288ADFCDF00>]}
[0m19:55:41.246189 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:55:41.757132 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:55:42.148295 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:55:42.153304 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:55:42.232702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7dae099-bceb-4bea-ae2d-38779d0a4313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288AFFF4130>]}
[0m19:55:42.515870 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m19:55:42.524680 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m19:55:42.601603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7dae099-bceb-4bea-ae2d-38779d0a4313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288AED6E4D0>]}
[0m19:55:42.601603 [info ] [MainThread]: Found 6 models, 9 data tests, 2 sources, 591 macros
[0m19:55:42.609614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7dae099-bceb-4bea-ae2d-38779d0a4313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288AFFC0A00>]}
[0m19:55:42.614247 [info ] [MainThread]: 
[0m19:55:42.618028 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:55:42.621822 [info ] [MainThread]: 
[0m19:55:42.623881 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:55:42.627813 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m19:55:42.830492 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m19:55:42.830492 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m19:55:42.830492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:43.597546 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.755 seconds
[0m19:55:43.614741 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m19:55:43.642022 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m19:55:43.643020 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m19:55:43.645382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:44.170649 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.536 seconds
[0m19:55:44.185773 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m19:55:44.201398 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m19:55:44.201398 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m19:55:44.353823 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.141 seconds
[0m19:55:44.356041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7dae099-bceb-4bea-ae2d-38779d0a4313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288B0599930>]}
[0m19:55:44.383985 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_pets
[0m19:55:44.383985 [info ] [Thread-1 (]: 1 of 1 START sql incremental model odl.dim_pets ................................ [RUN]
[0m19:55:44.391883 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.dim_pets'
[0m19:55:44.393956 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_pets
[0m19:55:44.452633 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_pets"
[0m19:55:44.452633 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_pets
[0m19:55:44.532212 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m19:55:44.532212 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
create or replace  temporary view DEV.odl.dim_pets__dbt_tmp
  
   as (
    

WITH stg_data AS (
    SELECT
        customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date
    FROM DEV.staging.stg_orders
    
    
        WHERE ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.dim_pets)
    
),

dedup AS (
    SELECT
        customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date,
        ROW_NUMBER() OVER(PARTITION BY customer_email, pet_dob, pet_name, pet_breed ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    d.customer_email ||'|'||d.pet_name || '|' || d.pet_dob || '|' || d.pet_breed      AS pet_nk,  
    md5(cast(coalesce(cast(pet_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                                AS pet_sk,  
    d.pet_name,
    d.pet_dob,
    d.pet_breed,
    d.pet_gender,
    d.pet_species,
    d.pedigree_type,
    d.spayed_neutered,
    d.pet_postcode,
    d.pet_value,
    d.ingest_date,
    c.customer_sk
FROM dedup AS d
    INNER JOIN DEV.odl.dim_customers AS c ON (c.customer_nk=d.customer_email)
WHERE d.rnk = 1
  );
[0m19:55:44.532212 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:55:45.314049 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.772 seconds
[0m19:55:45.350418 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m19:55:45.350418 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
describe table DEV.odl.dim_pets__dbt_tmp
[0m19:55:45.451040 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.105 seconds
[0m19:55:45.476350 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m19:55:45.477349 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
describe table DEV.odl.dim_pets
[0m19:55:45.701820 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.236 seconds
[0m19:55:45.752368 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m19:55:45.752368 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
describe table "DEV"."ODL"."DIM_PETS"
[0m19:55:45.862548 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.110 seconds
[0m19:55:45.937218 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_pets"
[0m19:55:45.951584 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m19:55:45.951584 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
-- back compat for old kwarg name
  
  begin;
[0m19:55:46.040087 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.090 seconds
[0m19:55:46.040087 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m19:55:46.049758 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
merge into DEV.odl.dim_pets as DBT_INTERNAL_DEST
        using DEV.odl.dim_pets__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.pet_nk = DBT_INTERNAL_DEST.pet_nk))

    
    when matched then update set
        "PET_NK" = DBT_INTERNAL_SOURCE."PET_NK","PET_SK" = DBT_INTERNAL_SOURCE."PET_SK","PET_NAME" = DBT_INTERNAL_SOURCE."PET_NAME","PET_DOB" = DBT_INTERNAL_SOURCE."PET_DOB","PET_BREED" = DBT_INTERNAL_SOURCE."PET_BREED","PET_GENDER" = DBT_INTERNAL_SOURCE."PET_GENDER","PET_SPECIES" = DBT_INTERNAL_SOURCE."PET_SPECIES","PEDIGREE_TYPE" = DBT_INTERNAL_SOURCE."PEDIGREE_TYPE","SPAYED_NEUTERED" = DBT_INTERNAL_SOURCE."SPAYED_NEUTERED","PET_POSTCODE" = DBT_INTERNAL_SOURCE."PET_POSTCODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE","CUSTOMER_SK" = DBT_INTERNAL_SOURCE."CUSTOMER_SK"
    

    when not matched then insert
        ("PET_NK", "PET_SK", "PET_NAME", "PET_DOB", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "INGEST_DATE", "CUSTOMER_SK")
    values
        ("PET_NK", "PET_SK", "PET_NAME", "PET_DOB", "PET_BREED", "PET_GENDER", "PET_SPECIES", "PEDIGREE_TYPE", "SPAYED_NEUTERED", "PET_POSTCODE", "PET_VALUE", "INGEST_DATE", "CUSTOMER_SK")

;
[0m19:55:47.864995 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.814 seconds
[0m19:55:47.864995 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m19:55:47.864995 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
COMMIT
[0m19:55:48.166853 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.293 seconds
[0m19:55:48.182502 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_pets__dbt_tmp
[0m19:55:48.199304 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m19:55:48.199304 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
drop view if exists DEV.odl.dim_pets__dbt_tmp cascade
[0m19:55:48.311600 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.112 seconds
[0m19:55:48.382736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7dae099-bceb-4bea-ae2d-38779d0a4313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288B06D3910>]}
[0m19:55:48.382736 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model odl.dim_pets ........................... [[32mSUCCESS 0[0m in 3.97s]
[0m19:55:48.386434 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_pets
[0m19:55:48.388591 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:55:48.389588 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m19:55:48.389588 [debug] [MainThread]: On list_DEV: Close
[0m19:55:48.500726 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m19:55:48.500726 [debug] [MainThread]: On list_DEV_staging: Close
[0m19:55:48.637420 [debug] [MainThread]: Connection 'model.ManyPets.dim_pets' was left open.
[0m19:55:48.637420 [debug] [MainThread]: On model.ManyPets.dim_pets: Close
[0m19:55:48.747850 [info ] [MainThread]: 
[0m19:55:48.764774 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.12 seconds (6.12s).
[0m19:55:48.771037 [debug] [MainThread]: Command end result
[0m19:55:48.887491 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m19:55:48.891391 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m19:55:48.905540 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m19:55:48.907638 [info ] [MainThread]: 
[0m19:55:48.909354 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:55:48.910403 [info ] [MainThread]: 
[0m19:55:48.911562 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:55:48.913856 [debug] [MainThread]: Command `dbt run` succeeded at 19:55:48.913856 after 8.82 seconds
[0m19:55:48.914856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288AC206020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288AC503A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288B07BF1C0>]}
[0m19:55:48.914856 [debug] [MainThread]: Flushing usage events
[0m19:55:49.801392 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:10:21.634571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001873CF85FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001873EE7C040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001873EE7E1A0>]}


============================== 20:10:21.639708 | e8797028-4646-48ad-986c-2e390075ff34 ==============================
[0m20:10:21.639708 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:10:21.642878 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:10:22.531424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8797028-4646-48ad-986c-2e390075ff34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001873B809C60>]}
[0m20:10:22.647846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8797028-4646-48ad-986c-2e390075ff34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001873EEC3D90>]}
[0m20:10:22.654386 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:10:23.197269 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:10:23.641721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:10:23.641721 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:10:23.763740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8797028-4646-48ad-986c-2e390075ff34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018740D99510>]}
[0m20:10:24.050015 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:10:24.057029 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:10:24.178584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8797028-4646-48ad-986c-2e390075ff34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001873E9F8040>]}
[0m20:10:24.181154 [info ] [MainThread]: Found 6 models, 17 data tests, 2 sources, 591 macros
[0m20:10:24.182590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8797028-4646-48ad-986c-2e390075ff34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001873E9FB850>]}
[0m20:10:24.192858 [info ] [MainThread]: 
[0m20:10:24.195288 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:10:24.197975 [info ] [MainThread]: 
[0m20:10:24.202391 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:10:24.234422 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m20:10:24.429372 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m20:10:24.429372 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m20:10:24.429372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:25.235215 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.808 seconds
[0m20:10:25.246249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m20:10:25.254254 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m20:10:25.254254 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m20:10:25.498557 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.243 seconds
[0m20:10:25.514148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8797028-4646-48ad-986c-2e390075ff34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001873B67D450>]}
[0m20:10:25.530374 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_dim_customers_customer_nk.27b28815ba
[0m20:10:25.531379 [info ] [Thread-1 (]: 1 of 17 START test not_null_dim_customers_customer_nk .......................... [RUN]
[0m20:10:25.534057 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.ManyPets.not_null_dim_customers_customer_nk.27b28815ba'
[0m20:10:25.535078 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_dim_customers_customer_nk.27b28815ba
[0m20:10:25.573914 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_dim_customers_customer_nk.27b28815ba"
[0m20:10:25.580222 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_dim_customers_customer_nk.27b28815ba
[0m20:10:25.613694 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_dim_customers_customer_nk.27b28815ba"
[0m20:10:25.620102 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_dim_customers_customer_nk.27b28815ba"
[0m20:10:25.621106 [debug] [Thread-1 (]: On test.ManyPets.not_null_dim_customers_customer_nk.27b28815ba: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_dim_customers_customer_nk.27b28815ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_nk
from DEV.odl.dim_customers
where customer_nk is null



      
    ) dbt_internal_test
[0m20:10:25.621106 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:10:26.729057 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.114 seconds
[0m20:10:26.778070 [info ] [Thread-1 (]: 1 of 17 PASS not_null_dim_customers_customer_nk ................................ [[32mPASS[0m in 1.25s]
[0m20:10:26.783315 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_dim_customers_customer_nk.27b28815ba
[0m20:10:26.784422 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_dim_customers_customer_sk.8ae5836863
[0m20:10:26.784422 [info ] [Thread-1 (]: 2 of 17 START test not_null_dim_customers_customer_sk .......................... [RUN]
[0m20:10:26.787804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_dim_customers_customer_nk.27b28815ba, now test.ManyPets.not_null_dim_customers_customer_sk.8ae5836863)
[0m20:10:26.788809 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_dim_customers_customer_sk.8ae5836863
[0m20:10:26.802696 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_dim_customers_customer_sk.8ae5836863"
[0m20:10:26.807278 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_dim_customers_customer_sk.8ae5836863
[0m20:10:26.812220 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_dim_customers_customer_sk.8ae5836863"
[0m20:10:26.820899 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_dim_customers_customer_sk.8ae5836863"
[0m20:10:26.821413 [debug] [Thread-1 (]: On test.ManyPets.not_null_dim_customers_customer_sk.8ae5836863: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_dim_customers_customer_sk.8ae5836863"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_sk
from DEV.odl.dim_customers
where customer_sk is null



      
    ) dbt_internal_test
[0m20:10:27.454718 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.635 seconds
[0m20:10:27.468657 [info ] [Thread-1 (]: 2 of 17 PASS not_null_dim_customers_customer_sk ................................ [[32mPASS[0m in 0.68s]
[0m20:10:27.471747 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_dim_customers_customer_sk.8ae5836863
[0m20:10:27.476036 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_dim_customers_ingest_date.e7f6423ffa
[0m20:10:27.481054 [info ] [Thread-1 (]: 3 of 17 START test not_null_dim_customers_ingest_date .......................... [RUN]
[0m20:10:27.486167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_dim_customers_customer_sk.8ae5836863, now test.ManyPets.not_null_dim_customers_ingest_date.e7f6423ffa)
[0m20:10:27.490448 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_dim_customers_ingest_date.e7f6423ffa
[0m20:10:27.501333 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_dim_customers_ingest_date.e7f6423ffa"
[0m20:10:27.509782 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_dim_customers_ingest_date.e7f6423ffa
[0m20:10:27.515258 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_dim_customers_ingest_date.e7f6423ffa"
[0m20:10:27.521785 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_dim_customers_ingest_date.e7f6423ffa"
[0m20:10:27.522779 [debug] [Thread-1 (]: On test.ManyPets.not_null_dim_customers_ingest_date.e7f6423ffa: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_dim_customers_ingest_date.e7f6423ffa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ingest_date
from DEV.odl.dim_customers
where ingest_date is null



      
    ) dbt_internal_test
[0m20:10:28.479903 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.958 seconds
[0m20:10:28.491677 [info ] [Thread-1 (]: 3 of 17 PASS not_null_dim_customers_ingest_date ................................ [[32mPASS[0m in 1.00s]
[0m20:10:28.496864 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_dim_customers_ingest_date.e7f6423ffa
[0m20:10:28.496864 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_dim_pets_ingest_date.2c5c336f9b
[0m20:10:28.502075 [info ] [Thread-1 (]: 4 of 17 START test not_null_dim_pets_ingest_date ............................... [RUN]
[0m20:10:28.506076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_dim_customers_ingest_date.e7f6423ffa, now test.ManyPets.not_null_dim_pets_ingest_date.2c5c336f9b)
[0m20:10:28.511697 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_dim_pets_ingest_date.2c5c336f9b
[0m20:10:28.535972 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_dim_pets_ingest_date.2c5c336f9b"
[0m20:10:28.541423 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_dim_pets_ingest_date.2c5c336f9b
[0m20:10:28.545089 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_dim_pets_ingest_date.2c5c336f9b"
[0m20:10:28.553280 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_dim_pets_ingest_date.2c5c336f9b"
[0m20:10:28.553280 [debug] [Thread-1 (]: On test.ManyPets.not_null_dim_pets_ingest_date.2c5c336f9b: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_dim_pets_ingest_date.2c5c336f9b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ingest_date
from DEV.odl.dim_pets
where ingest_date is null



      
    ) dbt_internal_test
[0m20:10:29.402048 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.847 seconds
[0m20:10:29.409972 [info ] [Thread-1 (]: 4 of 17 PASS not_null_dim_pets_ingest_date ..................................... [[32mPASS[0m in 0.90s]
[0m20:10:29.415802 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_dim_pets_ingest_date.2c5c336f9b
[0m20:10:29.415802 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_dim_pets_pet_nk.6060c02b98
[0m20:10:29.422646 [info ] [Thread-1 (]: 5 of 17 START test not_null_dim_pets_pet_nk .................................... [RUN]
[0m20:10:29.428464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_dim_pets_ingest_date.2c5c336f9b, now test.ManyPets.not_null_dim_pets_pet_nk.6060c02b98)
[0m20:10:29.431233 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_dim_pets_pet_nk.6060c02b98
[0m20:10:29.448893 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_dim_pets_pet_nk.6060c02b98"
[0m20:10:29.460645 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_dim_pets_pet_nk.6060c02b98
[0m20:10:29.464908 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_dim_pets_pet_nk.6060c02b98"
[0m20:10:29.470531 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_dim_pets_pet_nk.6060c02b98"
[0m20:10:29.471515 [debug] [Thread-1 (]: On test.ManyPets.not_null_dim_pets_pet_nk.6060c02b98: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_dim_pets_pet_nk.6060c02b98"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pet_nk
from DEV.odl.dim_pets
where pet_nk is null



      
    ) dbt_internal_test
[0m20:10:30.109593 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.638 seconds
[0m20:10:30.117610 [info ] [Thread-1 (]: 5 of 17 PASS not_null_dim_pets_pet_nk .......................................... [[32mPASS[0m in 0.69s]
[0m20:10:30.128700 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_dim_pets_pet_nk.6060c02b98
[0m20:10:30.133276 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_dim_pets_pet_sk.c4a65555ba
[0m20:10:30.136597 [info ] [Thread-1 (]: 6 of 17 START test not_null_dim_pets_pet_sk .................................... [RUN]
[0m20:10:30.140894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_dim_pets_pet_nk.6060c02b98, now test.ManyPets.not_null_dim_pets_pet_sk.c4a65555ba)
[0m20:10:30.143552 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_dim_pets_pet_sk.c4a65555ba
[0m20:10:30.165171 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_dim_pets_pet_sk.c4a65555ba"
[0m20:10:30.169293 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_dim_pets_pet_sk.c4a65555ba
[0m20:10:30.176996 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_dim_pets_pet_sk.c4a65555ba"
[0m20:10:30.190247 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_dim_pets_pet_sk.c4a65555ba"
[0m20:10:30.191558 [debug] [Thread-1 (]: On test.ManyPets.not_null_dim_pets_pet_sk.c4a65555ba: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_dim_pets_pet_sk.c4a65555ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pet_sk
from DEV.odl.dim_pets
where pet_sk is null



      
    ) dbt_internal_test
[0m20:10:31.040453 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.850 seconds
[0m20:10:31.048542 [info ] [Thread-1 (]: 6 of 17 PASS not_null_dim_pets_pet_sk .......................................... [[32mPASS[0m in 0.91s]
[0m20:10:31.059362 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_dim_pets_pet_sk.c4a65555ba
[0m20:10:31.059362 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m20:10:31.062711 [info ] [Thread-1 (]: 7 of 17 START test not_null_stg_order_complete_customer_id ..................... [RUN]
[0m20:10:31.065409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_dim_pets_pet_sk.c4a65555ba, now test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b)
[0m20:10:31.067149 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m20:10:31.078948 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b"
[0m20:10:31.078948 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m20:10:31.094232 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b"
[0m20:10:31.098186 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b"
[0m20:10:31.099164 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from DEV.staging.stg_order_complete
where customer_id is null



      
    ) dbt_internal_test
[0m20:10:31.196677 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.099 seconds
[0m20:10:31.209802 [info ] [Thread-1 (]: 7 of 17 PASS not_null_stg_order_complete_customer_id ........................... [[32mPASS[0m in 0.15s]
[0m20:10:31.215496 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m20:10:31.215496 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m20:10:31.222588 [info ] [Thread-1 (]: 8 of 17 START test not_null_stg_order_complete_ingest_date ..................... [RUN]
[0m20:10:31.228460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b, now test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec)
[0m20:10:31.231312 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m20:10:31.264251 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m20:10:31.274958 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m20:10:31.283025 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m20:10:31.293263 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m20:10:31.295261 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ingest_date
from DEV.staging.stg_order_complete
where ingest_date is null



      
    ) dbt_internal_test
[0m20:10:31.377943 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.085 seconds
[0m20:10:31.391937 [info ] [Thread-1 (]: 8 of 17 PASS not_null_stg_order_complete_ingest_date ........................... [[32mPASS[0m in 0.16s]
[0m20:10:31.397985 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m20:10:31.397985 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m20:10:31.403072 [info ] [Thread-1 (]: 9 of 17 START test not_null_stg_order_complete_order_id ........................ [RUN]
[0m20:10:31.409755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec, now test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce)
[0m20:10:31.411871 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m20:10:31.457433 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m20:10:31.466531 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m20:10:31.482315 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m20:10:31.486792 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m20:10:31.488217 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from DEV.staging.stg_order_complete
where order_id is null



      
    ) dbt_internal_test
[0m20:10:31.574493 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.090 seconds
[0m20:10:31.592775 [info ] [Thread-1 (]: 9 of 17 PASS not_null_stg_order_complete_order_id .............................. [[32mPASS[0m in 0.19s]
[0m20:10:31.598840 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m20:10:31.599839 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m20:10:31.603284 [info ] [Thread-1 (]: 10 of 17 START test not_null_stg_order_complete_pet_id ......................... [RUN]
[0m20:10:31.609558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce, now test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1)
[0m20:10:31.611668 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m20:10:31.630423 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1"
[0m20:10:31.630423 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m20:10:31.646295 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1"
[0m20:10:31.652072 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1"
[0m20:10:31.653068 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pet_id
from DEV.staging.stg_order_complete
where pet_id is null



      
    ) dbt_internal_test
[0m20:10:31.749021 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.099 seconds
[0m20:10:31.758737 [info ] [Thread-1 (]: 10 of 17 PASS not_null_stg_order_complete_pet_id ............................... [[32mPASS[0m in 0.15s]
[0m20:10:31.768714 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m20:10:31.772930 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_customer_email.f7618da361
[0m20:10:31.776613 [info ] [Thread-1 (]: 11 of 17 START test not_null_stg_orders_customer_email ......................... [RUN]
[0m20:10:31.781420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1, now test.ManyPets.not_null_stg_orders_customer_email.f7618da361)
[0m20:10:31.783523 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_customer_email.f7618da361
[0m20:10:31.825366 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_customer_email.f7618da361"
[0m20:10:31.834370 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_customer_email.f7618da361
[0m20:10:31.857731 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_customer_email.f7618da361"
[0m20:10:31.871933 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_customer_email.f7618da361"
[0m20:10:31.877016 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_customer_email.f7618da361: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_customer_email.f7618da361"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_email
from DEV.staging.stg_orders
where customer_email is null



      
    ) dbt_internal_test
[0m20:10:31.993315 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.115 seconds
[0m20:10:32.005022 [info ] [Thread-1 (]: 11 of 17 PASS not_null_stg_orders_customer_email ............................... [[32mPASS[0m in 0.22s]
[0m20:10:32.009555 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_customer_email.f7618da361
[0m20:10:32.009555 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m20:10:32.015464 [info ] [Thread-1 (]: 12 of 17 START test not_null_stg_orders_ingest_date ............................ [RUN]
[0m20:10:32.022250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_customer_email.f7618da361, now test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e)
[0m20:10:32.023243 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m20:10:32.043076 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m20:10:32.047149 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m20:10:32.062010 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m20:10:32.066475 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m20:10:32.066475 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ingest_date
from DEV.staging.stg_orders
where ingest_date is null



      
    ) dbt_internal_test
[0m20:10:32.144773 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.079 seconds
[0m20:10:32.154507 [info ] [Thread-1 (]: 12 of 17 PASS not_null_stg_orders_ingest_date .................................. [[32mPASS[0m in 0.13s]
[0m20:10:32.158058 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m20:10:32.159097 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m20:10:32.161489 [info ] [Thread-1 (]: 13 of 17 START test not_null_stg_orders_order_id ............................... [RUN]
[0m20:10:32.164536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e, now test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64)
[0m20:10:32.167379 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m20:10:32.193676 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:10:32.198546 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m20:10:32.211230 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:10:32.225509 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:10:32.225509 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from DEV.staging.stg_orders
where order_id is null



      
    ) dbt_internal_test
[0m20:10:32.326286 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.098 seconds
[0m20:10:32.338150 [info ] [Thread-1 (]: 13 of 17 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.17s]
[0m20:10:32.342985 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m20:10:32.342985 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m20:10:32.351134 [info ] [Thread-1 (]: 14 of 17 START test not_null_stg_orders_pet_dob ................................ [RUN]
[0m20:10:32.355614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64, now test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6)
[0m20:10:32.360371 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m20:10:32.404991 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m20:10:32.407137 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m20:10:32.423463 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m20:10:32.436282 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m20:10:32.438430 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pet_dob
from DEV.staging.stg_orders
where pet_dob is null



      
    ) dbt_internal_test
[0m20:10:32.674642 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.238 seconds
[0m20:10:32.691455 [info ] [Thread-1 (]: 14 of 17 PASS not_null_stg_orders_pet_dob ...................................... [[32mPASS[0m in 0.33s]
[0m20:10:32.697763 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m20:10:32.704557 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m20:10:32.711614 [info ] [Thread-1 (]: 15 of 17 START test not_null_stg_orders_pet_name ............................... [RUN]
[0m20:10:32.718787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6, now test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5)
[0m20:10:32.726224 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m20:10:32.746281 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m20:10:32.746281 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m20:10:32.760438 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m20:10:32.766954 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m20:10:32.766954 [debug] [Thread-1 (]: On test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pet_name
from DEV.staging.stg_orders
where pet_name is null



      
    ) dbt_internal_test
[0m20:10:32.840423 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.076 seconds
[0m20:10:32.854317 [info ] [Thread-1 (]: 15 of 17 PASS not_null_stg_orders_pet_name ..................................... [[32mPASS[0m in 0.13s]
[0m20:10:32.860710 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m20:10:32.862802 [debug] [Thread-1 (]: Began running node test.ManyPets.unique_dim_customers_customer_nk.ec01fc9806
[0m20:10:32.866127 [info ] [Thread-1 (]: 16 of 17 START test unique_dim_customers_customer_nk ........................... [RUN]
[0m20:10:32.868697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5, now test.ManyPets.unique_dim_customers_customer_nk.ec01fc9806)
[0m20:10:32.871625 [debug] [Thread-1 (]: Began compiling node test.ManyPets.unique_dim_customers_customer_nk.ec01fc9806
[0m20:10:32.893441 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.unique_dim_customers_customer_nk.ec01fc9806"
[0m20:10:32.895873 [debug] [Thread-1 (]: Began executing node test.ManyPets.unique_dim_customers_customer_nk.ec01fc9806
[0m20:10:32.898869 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.unique_dim_customers_customer_nk.ec01fc9806"
[0m20:10:32.911951 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.unique_dim_customers_customer_nk.ec01fc9806"
[0m20:10:32.912953 [debug] [Thread-1 (]: On test.ManyPets.unique_dim_customers_customer_nk.ec01fc9806: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.unique_dim_customers_customer_nk.ec01fc9806"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_nk as unique_field,
    count(*) as n_records

from DEV.odl.dim_customers
where customer_nk is not null
group by customer_nk
having count(*) > 1



      
    ) dbt_internal_test
[0m20:10:33.406755 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.494 seconds
[0m20:10:33.414809 [info ] [Thread-1 (]: 16 of 17 PASS unique_dim_customers_customer_nk ................................. [[32mPASS[0m in 0.55s]
[0m20:10:33.422351 [debug] [Thread-1 (]: Finished running node test.ManyPets.unique_dim_customers_customer_nk.ec01fc9806
[0m20:10:33.423645 [debug] [Thread-1 (]: Began running node test.ManyPets.unique_dim_pets_pet_nk.abaa6f5bc2
[0m20:10:33.425207 [info ] [Thread-1 (]: 17 of 17 START test unique_dim_pets_pet_nk ..................................... [RUN]
[0m20:10:33.428129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.unique_dim_customers_customer_nk.ec01fc9806, now test.ManyPets.unique_dim_pets_pet_nk.abaa6f5bc2)
[0m20:10:33.429133 [debug] [Thread-1 (]: Began compiling node test.ManyPets.unique_dim_pets_pet_nk.abaa6f5bc2
[0m20:10:33.444358 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.unique_dim_pets_pet_nk.abaa6f5bc2"
[0m20:10:33.447756 [debug] [Thread-1 (]: Began executing node test.ManyPets.unique_dim_pets_pet_nk.abaa6f5bc2
[0m20:10:33.459574 [debug] [Thread-1 (]: Writing runtime sql for node "test.ManyPets.unique_dim_pets_pet_nk.abaa6f5bc2"
[0m20:10:33.462159 [debug] [Thread-1 (]: Using snowflake connection "test.ManyPets.unique_dim_pets_pet_nk.abaa6f5bc2"
[0m20:10:33.463164 [debug] [Thread-1 (]: On test.ManyPets.unique_dim_pets_pet_nk.abaa6f5bc2: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "test.ManyPets.unique_dim_pets_pet_nk.abaa6f5bc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    pet_nk as unique_field,
    count(*) as n_records

from DEV.odl.dim_pets
where pet_nk is not null
group by pet_nk
having count(*) > 1



      
    ) dbt_internal_test
[0m20:10:34.377690 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.918 seconds
[0m20:10:34.389040 [info ] [Thread-1 (]: 17 of 17 PASS unique_dim_pets_pet_nk ........................................... [[32mPASS[0m in 0.96s]
[0m20:10:34.398801 [debug] [Thread-1 (]: Finished running node test.ManyPets.unique_dim_pets_pet_nk.abaa6f5bc2
[0m20:10:34.407585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:10:34.410550 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m20:10:34.410550 [debug] [MainThread]: On list_DEV_odl: Close
[0m20:10:34.522742 [debug] [MainThread]: Connection 'test.ManyPets.unique_dim_pets_pet_nk.abaa6f5bc2' was left open.
[0m20:10:34.530751 [debug] [MainThread]: On test.ManyPets.unique_dim_pets_pet_nk.abaa6f5bc2: Close
[0m20:10:34.652875 [info ] [MainThread]: 
[0m20:10:34.656990 [info ] [MainThread]: Finished running 17 data tests in 0 hours 0 minutes and 10.45 seconds (10.45s).
[0m20:10:34.679848 [debug] [MainThread]: Command end result
[0m20:10:34.836329 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:10:34.846120 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:10:34.870725 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m20:10:34.870725 [info ] [MainThread]: 
[0m20:10:34.874079 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:10:34.875247 [info ] [MainThread]: 
[0m20:10:34.877481 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m20:10:34.881387 [debug] [MainThread]: Command `dbt test` succeeded at 20:10:34.880388 after 13.42 seconds
[0m20:10:34.881387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001873CF85FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018740D34C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018740D34E80>]}
[0m20:10:34.881387 [debug] [MainThread]: Flushing usage events
[0m20:10:35.638682 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:13:25.544360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EBCD15FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EBD05DDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EBEC534F0>]}


============================== 20:13:25.549309 | 6b9fb45c-9f5d-4f3a-a210-2b492bbac0b6 ==============================
[0m20:13:25.549309 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:13:25.552518 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:13:27.307881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b9fb45c-9f5d-4f3a-a210-2b492bbac0b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EBD052800>]}
[0m20:13:27.407886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b9fb45c-9f5d-4f3a-a210-2b492bbac0b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EBEAE22C0>]}
[0m20:13:27.413928 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:13:28.257142 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:13:29.776801 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:13:29.776801 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:13:29.889026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b9fb45c-9f5d-4f3a-a210-2b492bbac0b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EC0B29510>]}
[0m20:13:30.024935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b9fb45c-9f5d-4f3a-a210-2b492bbac0b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EBF86BCA0>]}
[0m20:13:30.024935 [info ] [MainThread]: Found 6 models, 17 data tests, 2 sources, 591 macros
[0m20:13:30.028615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b9fb45c-9f5d-4f3a-a210-2b492bbac0b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EBF86A0E0>]}
[0m20:13:30.029615 [info ] [MainThread]: 
[0m20:13:30.034473 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:13:30.036851 [info ] [MainThread]: 
[0m20:13:30.039406 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:13:30.053948 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m20:13:32.170384 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m20:13:32.170384 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m20:13:32.170384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:33.028958 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.860 seconds
[0m20:13:33.037113 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m20:13:33.065872 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m20:13:33.066876 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m20:13:33.196689 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.130 seconds
[0m20:13:33.211877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b9fb45c-9f5d-4f3a-a210-2b492bbac0b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EBB47D450>]}
[0m20:13:33.234072 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_order_complete
[0m20:13:33.236796 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_order_complete'
[0m20:13:33.236796 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_order_complete
[0m20:13:33.269180 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_order_complete"
[0m20:13:33.269180 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_order_complete
[0m20:13:33.278742 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_order_complete
[0m20:13:33.279743 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m20:13:33.280757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_order_complete, now model.ManyPets.stg_orders)
[0m20:13:33.282133 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m20:13:33.287805 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m20:13:33.287805 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m20:13:33.295799 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m20:13:33.296796 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m20:13:33.297723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_orders, now test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b)
[0m20:13:33.298726 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m20:13:33.319012 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b"
[0m20:13:33.319012 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m20:13:33.324115 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b
[0m20:13:33.324115 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m20:13:33.326354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_customer_id.dc2e4d770b, now test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec)
[0m20:13:33.327360 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m20:13:33.335700 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec"
[0m20:13:33.335700 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m20:13:33.338950 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec
[0m20:13:33.340424 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m20:13:33.341430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_ingest_date.4f6b3598ec, now test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce)
[0m20:13:33.341430 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m20:13:33.341430 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce"
[0m20:13:33.349470 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m20:13:33.352838 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce
[0m20:13:33.353708 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m20:13:33.354712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_order_id.211bc957ce, now test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1)
[0m20:13:33.354712 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m20:13:33.354712 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1"
[0m20:13:33.363379 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m20:13:33.366284 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1
[0m20:13:33.367058 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m20:13:33.368064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_order_complete_pet_id.13b63a0de1, now model.ManyPets.dim_customers)
[0m20:13:33.368948 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m20:13:33.394796 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m20:13:33.394796 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m20:13:33.398805 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m20:13:33.399548 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_customer_email.f7618da361
[0m20:13:33.400646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_customers, now test.ManyPets.not_null_stg_orders_customer_email.f7618da361)
[0m20:13:33.402232 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_customer_email.f7618da361
[0m20:13:33.402232 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_customer_email.f7618da361"
[0m20:13:33.411680 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_customer_email.f7618da361
[0m20:13:33.412682 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_customer_email.f7618da361
[0m20:13:33.412682 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m20:13:33.416001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_customer_email.f7618da361, now test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e)
[0m20:13:33.417261 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m20:13:33.435700 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e"
[0m20:13:33.438680 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m20:13:33.440243 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e
[0m20:13:33.441679 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m20:13:33.442678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_ingest_date.3ea3986b2e, now test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64)
[0m20:13:33.442678 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m20:13:33.450698 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:13:33.452874 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m20:13:33.455332 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64
[0m20:13:33.455332 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m20:13:33.457006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_order_id.81cfe2fe64, now test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6)
[0m20:13:33.457006 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m20:13:33.462889 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6"
[0m20:13:33.462889 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m20:13:33.470055 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6
[0m20:13:33.471212 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m20:13:33.472495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_pet_dob.e961ad87a6, now test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5)
[0m20:13:33.473500 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m20:13:33.481648 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5"
[0m20:13:33.482654 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m20:13:33.485505 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5
[0m20:13:33.486447 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_pets
[0m20:13:33.486961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_stg_orders_pet_name.7c2d9f9ac5, now model.ManyPets.dim_pets)
[0m20:13:33.487977 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_pets
[0m20:13:33.496022 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_pets"
[0m20:13:33.498694 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_pets
[0m20:13:33.501765 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_pets
[0m20:13:33.502831 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_dim_customers_customer_nk.27b28815ba
[0m20:13:33.504971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_pets, now test.ManyPets.not_null_dim_customers_customer_nk.27b28815ba)
[0m20:13:33.505971 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_dim_customers_customer_nk.27b28815ba
[0m20:13:33.518422 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_dim_customers_customer_nk.27b28815ba"
[0m20:13:33.520314 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_dim_customers_customer_nk.27b28815ba
[0m20:13:33.522170 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_dim_customers_customer_nk.27b28815ba
[0m20:13:33.523370 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_dim_customers_customer_sk.8ae5836863
[0m20:13:33.524360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_dim_customers_customer_nk.27b28815ba, now test.ManyPets.not_null_dim_customers_customer_sk.8ae5836863)
[0m20:13:33.524360 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_dim_customers_customer_sk.8ae5836863
[0m20:13:33.532408 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_dim_customers_customer_sk.8ae5836863"
[0m20:13:33.535599 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_dim_customers_customer_sk.8ae5836863
[0m20:13:33.537552 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_dim_customers_customer_sk.8ae5836863
[0m20:13:33.538522 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_dim_customers_ingest_date.e7f6423ffa
[0m20:13:33.539521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_dim_customers_customer_sk.8ae5836863, now test.ManyPets.not_null_dim_customers_ingest_date.e7f6423ffa)
[0m20:13:33.540520 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_dim_customers_ingest_date.e7f6423ffa
[0m20:13:33.540520 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_dim_customers_ingest_date.e7f6423ffa"
[0m20:13:33.549172 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_dim_customers_ingest_date.e7f6423ffa
[0m20:13:33.550554 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_dim_customers_ingest_date.e7f6423ffa
[0m20:13:33.553106 [debug] [Thread-1 (]: Began running node test.ManyPets.unique_dim_customers_customer_nk.ec01fc9806
[0m20:13:33.555149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_dim_customers_ingest_date.e7f6423ffa, now test.ManyPets.unique_dim_customers_customer_nk.ec01fc9806)
[0m20:13:33.556176 [debug] [Thread-1 (]: Began compiling node test.ManyPets.unique_dim_customers_customer_nk.ec01fc9806
[0m20:13:33.565328 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.unique_dim_customers_customer_nk.ec01fc9806"
[0m20:13:33.569094 [debug] [Thread-1 (]: Began executing node test.ManyPets.unique_dim_customers_customer_nk.ec01fc9806
[0m20:13:33.571272 [debug] [Thread-1 (]: Finished running node test.ManyPets.unique_dim_customers_customer_nk.ec01fc9806
[0m20:13:33.571272 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_order_complete
[0m20:13:33.572664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.unique_dim_customers_customer_nk.ec01fc9806, now model.ManyPets.fact_order_complete)
[0m20:13:33.572664 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_order_complete
[0m20:13:33.581725 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_order_complete"
[0m20:13:33.585780 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_order_complete
[0m20:13:33.587353 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_order_complete
[0m20:13:33.587353 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m20:13:33.589948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.fact_order_complete, now model.ManyPets.fact_orders)
[0m20:13:33.590974 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_orders
[0m20:13:33.602278 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_orders"
[0m20:13:33.602278 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_orders
[0m20:13:33.607019 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m20:13:33.607019 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_dim_pets_ingest_date.2c5c336f9b
[0m20:13:33.611287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.fact_orders, now test.ManyPets.not_null_dim_pets_ingest_date.2c5c336f9b)
[0m20:13:33.612289 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_dim_pets_ingest_date.2c5c336f9b
[0m20:13:33.628144 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_dim_pets_ingest_date.2c5c336f9b"
[0m20:13:33.635563 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_dim_pets_ingest_date.2c5c336f9b
[0m20:13:33.637990 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_dim_pets_ingest_date.2c5c336f9b
[0m20:13:33.639738 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_dim_pets_pet_nk.6060c02b98
[0m20:13:33.640739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_dim_pets_ingest_date.2c5c336f9b, now test.ManyPets.not_null_dim_pets_pet_nk.6060c02b98)
[0m20:13:33.640739 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_dim_pets_pet_nk.6060c02b98
[0m20:13:33.648771 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_dim_pets_pet_nk.6060c02b98"
[0m20:13:33.652140 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_dim_pets_pet_nk.6060c02b98
[0m20:13:33.655994 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_dim_pets_pet_nk.6060c02b98
[0m20:13:33.658004 [debug] [Thread-1 (]: Began running node test.ManyPets.not_null_dim_pets_pet_sk.c4a65555ba
[0m20:13:33.659550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_dim_pets_pet_nk.6060c02b98, now test.ManyPets.not_null_dim_pets_pet_sk.c4a65555ba)
[0m20:13:33.660549 [debug] [Thread-1 (]: Began compiling node test.ManyPets.not_null_dim_pets_pet_sk.c4a65555ba
[0m20:13:33.668832 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.not_null_dim_pets_pet_sk.c4a65555ba"
[0m20:13:33.668832 [debug] [Thread-1 (]: Began executing node test.ManyPets.not_null_dim_pets_pet_sk.c4a65555ba
[0m20:13:33.672471 [debug] [Thread-1 (]: Finished running node test.ManyPets.not_null_dim_pets_pet_sk.c4a65555ba
[0m20:13:33.674753 [debug] [Thread-1 (]: Began running node test.ManyPets.unique_dim_pets_pet_nk.abaa6f5bc2
[0m20:13:33.674753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ManyPets.not_null_dim_pets_pet_sk.c4a65555ba, now test.ManyPets.unique_dim_pets_pet_nk.abaa6f5bc2)
[0m20:13:33.674753 [debug] [Thread-1 (]: Began compiling node test.ManyPets.unique_dim_pets_pet_nk.abaa6f5bc2
[0m20:13:33.685404 [debug] [Thread-1 (]: Writing injected SQL for node "test.ManyPets.unique_dim_pets_pet_nk.abaa6f5bc2"
[0m20:13:33.686924 [debug] [Thread-1 (]: Began executing node test.ManyPets.unique_dim_pets_pet_nk.abaa6f5bc2
[0m20:13:33.690037 [debug] [Thread-1 (]: Finished running node test.ManyPets.unique_dim_pets_pet_nk.abaa6f5bc2
[0m20:13:33.691977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:13:33.691977 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m20:13:33.692975 [debug] [MainThread]: On list_DEV_odl: Close
[0m20:13:33.780899 [debug] [MainThread]: Connection 'test.ManyPets.unique_dim_pets_pet_nk.abaa6f5bc2' was properly closed.
[0m20:13:33.787099 [debug] [MainThread]: Command end result
[0m20:13:34.098551 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:13:34.112799 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:13:34.142200 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m20:13:35.120329 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m20:13:35.121332 [info ] [MainThread]: Building catalog
[0m20:13:35.154037 [debug] [ThreadPool]: Acquiring new snowflake connection 'DEV.information_schema'
[0m20:13:35.183645 [debug] [ThreadPool]: Using snowflake connection "DEV.information_schema"
[0m20:13:35.184646 [debug] [ThreadPool]: On DEV.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "DEV.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from DEV.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'odl' and upper("table_schema") = upper('odl')

                    and 
    "table_name" ilike 'fact_orders' and upper("table_name") = upper('fact_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_order_complete' and upper("table_name") = upper('stg_order_complete')

                )
             or 
                (
                    
    "table_schema" ilike 'odl' and upper("table_schema") = upper('odl')

                    and 
    "table_name" ilike 'dim_pets' and upper("table_name") = upper('dim_pets')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'odl' and upper("table_schema") = upper('odl')

                    and 
    "table_name" ilike 'fact_order_complete' and upper("table_name") = upper('fact_order_complete')

                )
             or 
                (
                    
    "table_schema" ilike 'odl' and upper("table_schema") = upper('odl')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from DEV.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'odl' and upper("table_schema") = upper('odl')

                    and 
    "table_name" ilike 'fact_orders' and upper("table_name") = upper('fact_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_order_complete' and upper("table_name") = upper('stg_order_complete')

                )
             or 
                (
                    
    "table_schema" ilike 'odl' and upper("table_schema") = upper('odl')

                    and 
    "table_name" ilike 'dim_pets' and upper("table_name") = upper('dim_pets')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'odl' and upper("table_schema") = upper('odl')

                    and 
    "table_name" ilike 'fact_order_complete' and upper("table_name") = upper('fact_order_complete')

                )
             or 
                (
                    
    "table_schema" ilike 'odl' and upper("table_schema") = upper('odl')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m20:13:35.185645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:39.930778 [debug] [ThreadPool]: SQL status: SUCCESS 82 in 4.747 seconds
[0m20:13:39.996159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly DEV.information_schema, now dev.information_schema)
[0m20:13:39.998601 [debug] [ThreadPool]: Using snowflake connection "dev.information_schema"
[0m20:13:39.998601 [debug] [ThreadPool]: On dev.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "dev.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from dev.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'rdl' and upper("table_schema") = upper('rdl')

                    and 
    "table_name" ilike 'orders' and upper("table_name") = upper('orders')

                )
             or 
                (
                    
    "table_schema" ilike 'rdl' and upper("table_schema") = upper('rdl')

                    and 
    "table_name" ilike 'order_complete' and upper("table_name") = upper('order_complete')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from dev.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'rdl' and upper("table_schema") = upper('rdl')

                    and 
    "table_name" ilike 'orders' and upper("table_name") = upper('orders')

                )
             or 
                (
                    
    "table_schema" ilike 'rdl' and upper("table_schema") = upper('rdl')

                    and 
    "table_name" ilike 'order_complete' and upper("table_name") = upper('order_complete')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m20:13:43.137234 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 3.134 seconds
[0m20:13:43.216026 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\HP\Documents\manypets\ManyPets\target\catalog.json
[0m20:13:43.267832 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:13:43.276646 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:13:43.277792 [info ] [MainThread]: Catalog written to C:\Users\HP\Documents\manypets\ManyPets\target\catalog.json
[0m20:13:43.280798 [debug] [MainThread]: Command `dbt docs generate` succeeded at 20:13:43.279798 after 17.90 seconds
[0m20:13:43.280798 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m20:13:43.280798 [debug] [MainThread]: Connection 'dev.information_schema' was left open.
[0m20:13:43.280798 [debug] [MainThread]: On dev.information_schema: Close
[0m20:13:43.377810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EBCD15FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EC0A8C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EC0A8D600>]}
[0m20:13:43.385856 [debug] [MainThread]: Flushing usage events
[0m20:13:44.262323 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:19:31.961551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7D9DA5FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7DBCCE980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7DBCCE7A0>]}


============================== 20:19:31.971243 | d3eb8efd-22b3-4943-ba3f-67ac07185975 ==============================
[0m20:19:31.971243 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:19:31.973147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_orders', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:19:32.857938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3eb8efd-22b3-4943-ba3f-67ac07185975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7DA0FDED0>]}
[0m20:19:32.983039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3eb8efd-22b3-4943-ba3f-67ac07185975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7DBB3B2B0>]}
[0m20:19:32.986704 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:19:33.540474 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:19:33.998811 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:19:33.998811 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:19:34.107488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3eb8efd-22b3-4943-ba3f-67ac07185975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7DDBBD3C0>]}
[0m20:19:34.402770 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:19:34.409929 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:19:34.479741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3eb8efd-22b3-4943-ba3f-67ac07185975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7DDA8D810>]}
[0m20:19:34.481887 [info ] [MainThread]: Found 6 models, 17 data tests, 2 sources, 591 macros
[0m20:19:34.484323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3eb8efd-22b3-4943-ba3f-67ac07185975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7D9C18F70>]}
[0m20:19:34.484323 [info ] [MainThread]: 
[0m20:19:34.490307 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:19:34.492931 [info ] [MainThread]: 
[0m20:19:34.494716 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:19:34.499895 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m20:19:34.715320 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m20:19:34.715320 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m20:19:34.715320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:35.489574 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.772 seconds
[0m20:19:35.510431 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m20:19:35.531124 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m20:19:35.531124 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m20:19:35.531124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:35.882251 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.350 seconds
[0m20:19:35.890319 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m20:19:35.905950 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m20:19:35.913833 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m20:19:36.024858 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.114 seconds
[0m20:19:36.043296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3eb8efd-22b3-4943-ba3f-67ac07185975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7DDBCF130>]}
[0m20:19:36.063497 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m20:19:36.064684 [info ] [Thread-1 (]: 1 of 1 START sql incremental model staging.stg_orders .......................... [RUN]
[0m20:19:36.071888 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_orders'
[0m20:19:36.073929 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m20:19:36.117543 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m20:19:36.117543 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m20:19:36.221444 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m20:19:36.229904 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m20:19:36.229904 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace transient table DEV.staging.stg_orders
         as
        (

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_effective_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS type,
        data:time::TIMESTAMP                            AS order_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
),
dedup AS
(
    SELECT
        *
        ,ROW_NUMBER() OVER(PARTITION BY order_id, email, pet_dob, pet_name, pet_breed  ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)
SELECT 
    order_id ,
    email                                                       AS customer_email,
    COALESCE(NULLIF(TRIM(COALESCE(first_name, '') || ' ' || 
            COALESCE(last_name, '')), ''), 'unknown')           AS customer_name,
    dob                                                         AS customer_dob,
    phone                                                       AS customer_phone,
    address_line1 || ' ' || address_line2                       AS customer_address,
    city                                                        AS customer_city,
    country                                                     AS customer_country,
    postcode                                                    AS customer_postcode,
    pet_dob,
    pet_name,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_time::DATE                                            AS order_create_date,
    order_time                                                  AS order_create_timestamp,
    cessation_date,
    affiliate_code,
    source,
    type,
    order_effective_date,
    ingest_date
FROM dedup
WHERE 
    rnk =1
        );
[0m20:19:36.229904 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:19:38.350996 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.117 seconds
[0m20:19:38.388628 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_orders__dbt_tmp
[0m20:19:38.394707 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m20:19:38.394707 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
drop view if exists DEV.staging.stg_orders__dbt_tmp cascade
[0m20:19:38.471233 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.074 seconds
[0m20:19:38.533366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3eb8efd-22b3-4943-ba3f-67ac07185975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7DE23A080>]}
[0m20:19:38.534372 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model staging.stg_orders ..................... [[32mSUCCESS 1[0m in 2.46s]
[0m20:19:38.537158 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m20:19:38.539701 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:19:38.540705 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m20:19:38.540705 [debug] [MainThread]: On list_DEV: Close
[0m20:19:38.645719 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m20:19:38.645719 [debug] [MainThread]: On list_DEV_odl: Close
[0m20:19:38.782123 [debug] [MainThread]: Connection 'model.ManyPets.stg_orders' was left open.
[0m20:19:38.782123 [debug] [MainThread]: On model.ManyPets.stg_orders: Close
[0m20:19:38.910345 [info ] [MainThread]: 
[0m20:19:38.914491 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.41 seconds (4.41s).
[0m20:19:38.918658 [debug] [MainThread]: Command end result
[0m20:19:38.996930 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:19:39.001373 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:19:39.017767 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m20:19:39.019765 [info ] [MainThread]: 
[0m20:19:39.021765 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:19:39.023045 [info ] [MainThread]: 
[0m20:19:39.024634 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:19:39.027419 [debug] [MainThread]: Command `dbt run` succeeded at 20:19:39.027419 after 7.25 seconds
[0m20:19:39.027419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7D9DA5FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7D5A44700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7DA0FDA50>]}
[0m20:19:39.027419 [debug] [MainThread]: Flushing usage events
[0m20:19:39.783380 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:48:18.334961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002487F266080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002480125E9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002480125E800>]}


============================== 20:48:18.343461 | 81d74437-b6f7-45a4-8a88-d3233591cd56 ==============================
[0m20:48:18.343461 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:48:18.347754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select fact_orders', 'send_anonymous_usage_stats': 'True'}
[0m20:48:19.508928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81d74437-b6f7-45a4-8a88-d3233591cd56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248011F7CD0>]}
[0m20:48:19.615293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81d74437-b6f7-45a4-8a88-d3233591cd56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002487FCADB10>]}
[0m20:48:19.625424 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:48:20.231157 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:48:20.657988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:48:20.657988 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:48:20.756074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81d74437-b6f7-45a4-8a88-d3233591cd56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002480324D450>]}
[0m20:48:21.053936 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:48:21.066387 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:48:21.146298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81d74437-b6f7-45a4-8a88-d3233591cd56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024801C13820>]}
[0m20:48:21.149126 [info ] [MainThread]: Found 6 models, 17 data tests, 2 sources, 591 macros
[0m20:48:21.151162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81d74437-b6f7-45a4-8a88-d3233591cd56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024801C11840>]}
[0m20:48:21.155670 [info ] [MainThread]: 
[0m20:48:21.158600 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:48:21.160863 [info ] [MainThread]: 
[0m20:48:21.163313 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:48:21.174068 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m20:48:21.402057 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m20:48:21.403329 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m20:48:21.405588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:48:23.831420 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.429 seconds
[0m20:48:23.875805 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m20:48:23.904554 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m20:48:23.904554 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m20:48:23.904554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:48:24.612155 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.707 seconds
[0m20:48:24.620142 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m20:48:24.635870 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m20:48:24.635870 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m20:48:24.835143 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.194 seconds
[0m20:48:24.845820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81d74437-b6f7-45a4-8a88-d3233591cd56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024801C666E0>]}
[0m20:48:24.876837 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m20:48:24.876837 [info ] [Thread-1 (]: 1 of 1 START sql incremental model odl.fact_orders ............................. [RUN]
[0m20:48:24.884040 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.fact_orders'
[0m20:48:24.886524 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_orders
[0m20:48:24.945507 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_orders"
[0m20:48:24.950764 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_orders
[0m20:48:25.094208 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.fact_orders"
[0m20:48:25.104322 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m20:48:25.105384 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
create or replace transient table DEV.odl.fact_orders
         as
        ( 
WITH fact_data AS (
    SELECT 
        f.order_id,
        f.order_date,
        f.cessation_date,
        f.affiliate_code,
        f.pet_value,
        f.source,
        f.type,
        f.order_create_date,
        f.order_create_timestamp,
        /*f.event_time,
        f.envelope_version,
        f.detail_version,
        f.intent,
        f.tenant,
        f.experiments,*/
        c.customer_sk,
        p.pet_sk,
        f.ingest_date
    FROM DEV.staging.stg_orders f
    LEFT JOIN DEV.odl.dim_customers c 
        ON f.customer_email = c.customer_nk
    LEFT JOIN DEV.odl.dim_pets p 
        ON f.pet_name = p.pet_name 
        AND f.pet_dob = p.pet_dob
        AND f.pet_breed = p.pet_breed

    
)

, dedup AS (
    SELECT 
        f.*,
        ROW_NUMBER() OVER(PARTITION BY f.order_id, f.customer_sk, f.pet_sk ORDER BY f.ingest_date DESC) AS rnk
    FROM fact_data f
)

SELECT 
     order_id || '|' || customer_sk || '|'|| pet_sk         AS order_nk,
    md5(cast(coalesce(cast(order_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))    AS order_sk,
    -- order_id is added as connecting between order and order_complete on order_sk is not feasible due to missing customer_id and pet_id in the dataset.
    order_id                                                AS order_id,
    customer_sk                                             AS customer_sk,
    pet_sk                                                  AS pet_sk,
    order_date                                              AS order_date,
    cessation_date                                          AS cessation_date,
    COALESCE(affiliate_code, 'unknown')                     AS affiliate_code,
    pet_value                                               AS pet_value,
    source                                                  AS order_source,
    event_type                                              AS order_type,
/*
    event_time,
    envelope_version,
    detail_version,
    intent,
    tenant,
    experiments,
*/
    ingest_date
FROM dedup
WHERE rnk = 1
        );
[0m20:48:25.107132 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:48:26.084627 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb135b-0000-e39c-0001-b3ce0001c746
[0m20:48:26.084627 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 8
invalid identifier 'F.ORDER_DATE'
[0m20:48:26.113667 [debug] [Thread-1 (]: Database Error in model fact_orders (models\fact\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'F.ORDER_DATE'
  compiled code at target\run\ManyPets\models\fact\fact_orders.sql
[0m20:48:26.119475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81d74437-b6f7-45a4-8a88-d3233591cd56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024803A7A3B0>]}
[0m20:48:26.119475 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model odl.fact_orders .................... [[31mERROR[0m in 1.23s]
[0m20:48:26.122877 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m20:48:26.123877 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_orders (models\fact\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'F.ORDER_DATE'
  compiled code at target\run\ManyPets\models\fact\fact_orders.sql.
[0m20:48:26.127529 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:48:26.128529 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m20:48:26.129104 [debug] [MainThread]: On list_DEV: Close
[0m20:48:26.273068 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m20:48:26.273068 [debug] [MainThread]: On list_DEV_odl: Close
[0m20:48:26.419383 [debug] [MainThread]: Connection 'model.ManyPets.fact_orders' was left open.
[0m20:48:26.419383 [debug] [MainThread]: On model.ManyPets.fact_orders: Close
[0m20:48:26.543368 [info ] [MainThread]: 
[0m20:48:26.553879 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.38 seconds (5.38s).
[0m20:48:26.558006 [debug] [MainThread]: Command end result
[0m20:48:26.664762 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:48:26.669379 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:48:26.684476 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m20:48:26.685475 [info ] [MainThread]: 
[0m20:48:26.687653 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:48:26.688707 [info ] [MainThread]: 
[0m20:48:26.690099 [error] [MainThread]:   Database Error in model fact_orders (models\fact\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'F.ORDER_DATE'
  compiled code at target\run\ManyPets\models\fact\fact_orders.sql
[0m20:48:26.692634 [info ] [MainThread]: 
[0m20:48:26.693985 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:48:26.696937 [debug] [MainThread]: Command `dbt run` failed at 20:48:26.696937 after 8.53 seconds
[0m20:48:26.696937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002487F266080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002480311CA60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002480311DE40>]}
[0m20:48:26.696937 [debug] [MainThread]: Flushing usage events
[0m20:48:27.429566 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:50:02.397269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC81236050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC8315E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC8315E7D0>]}


============================== 20:50:02.403533 | 74d10b05-5bf3-4298-8c32-0c3cfce4bb07 ==============================
[0m20:50:02.403533 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:50:02.406776 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select fact_orders', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:50:03.418229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74d10b05-5bf3-4298-8c32-0c3cfce4bb07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC82CEA500>]}
[0m20:50:03.517989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74d10b05-5bf3-4298-8c32-0c3cfce4bb07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC830028C0>]}
[0m20:50:03.529188 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:50:04.076453 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:50:04.525723 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:50:04.525723 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:50:04.643546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74d10b05-5bf3-4298-8c32-0c3cfce4bb07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC8514D420>]}
[0m20:50:04.925362 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:50:04.937931 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:50:04.998263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74d10b05-5bf3-4298-8c32-0c3cfce4bb07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC83C30790>]}
[0m20:50:05.000223 [info ] [MainThread]: Found 6 models, 17 data tests, 2 sources, 591 macros
[0m20:50:05.003193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74d10b05-5bf3-4298-8c32-0c3cfce4bb07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC82CD7730>]}
[0m20:50:05.003739 [info ] [MainThread]: 
[0m20:50:05.008993 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:50:05.011866 [info ] [MainThread]: 
[0m20:50:05.014809 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:50:05.014809 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m20:50:05.242163 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m20:50:05.242163 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m20:50:05.242163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:06.158693 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.916 seconds
[0m20:50:06.198814 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m20:50:06.216176 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m20:50:06.216176 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m20:50:06.216176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:06.794183 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.580 seconds
[0m20:50:06.808388 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m20:50:06.832832 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m20:50:06.832832 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m20:50:06.975400 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.142 seconds
[0m20:50:06.990046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74d10b05-5bf3-4298-8c32-0c3cfce4bb07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC8576A3B0>]}
[0m20:50:07.009009 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m20:50:07.011183 [info ] [Thread-1 (]: 1 of 1 START sql incremental model odl.fact_orders ............................. [RUN]
[0m20:50:07.016706 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.fact_orders'
[0m20:50:07.017704 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_orders
[0m20:50:07.084750 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_orders"
[0m20:50:07.090499 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_orders
[0m20:50:07.192318 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.fact_orders"
[0m20:50:07.200186 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m20:50:07.200186 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
create or replace transient table DEV.odl.fact_orders
         as
        ( 
WITH fact_data AS (
    SELECT 
        f.order_id,
        f.cessation_date,
        f.affiliate_code,
        f.pet_value,
        f.source,
        f.type,
        f.order_create_date,
        f.order_create_timestamp,
        /*f.event_time,
        f.envelope_version,
        f.detail_version,
        f.intent,
        f.tenant,
        f.experiments,*/
        c.customer_sk,
        p.pet_sk,
        f.ingest_date
    FROM DEV.staging.stg_orders f
    LEFT JOIN DEV.odl.dim_customers c 
        ON f.customer_email = c.customer_nk
    LEFT JOIN DEV.odl.dim_pets p 
        ON f.pet_name = p.pet_name 
        AND f.pet_dob = p.pet_dob
        AND f.pet_breed = p.pet_breed

    
)

, dedup AS (
    SELECT 
        f.*,
        ROW_NUMBER() OVER(PARTITION BY f.order_id, f.customer_sk, f.pet_sk ORDER BY f.ingest_date DESC) AS rnk
    FROM fact_data f
)

SELECT 
     order_id || '|' || customer_sk || '|'|| pet_sk         AS order_nk,
    md5(cast(coalesce(cast(order_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))    AS order_sk,
    -- order_id is added as connecting between order and order_complete on order_sk is not feasible due to missing customer_id and pet_id in the dataset.
    order_id                                                AS order_id,
    customer_sk                                             AS customer_sk,
    pet_sk                                                  AS pet_sk,
    order_create_date                                       AS order_create_date,
    order_create_timestamp                                  AS order_create_timestamp,
    cessation_date                                          AS cessation_date,
    COALESCE(affiliate_code, 'unknown')                     AS affiliate_code,
    pet_value                                               AS pet_value,
    source                                                  AS order_source,
    event_type                                              AS order_type,
/*
    event_time,
    envelope_version,
    detail_version,
    intent,
    tenant,
    experiments,
*/
    ingest_date
FROM dedup
WHERE rnk = 1
        );
[0m20:50:07.200186 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:50:08.098983 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb135d-0000-e3bf-0001-b3ce000196c6
[0m20:50:08.098983 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 54 at position 4
invalid identifier 'EVENT_TYPE'
[0m20:50:08.111730 [debug] [Thread-1 (]: Database Error in model fact_orders (models\fact\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 54 at position 4
  invalid identifier 'EVENT_TYPE'
  compiled code at target\run\ManyPets\models\fact\fact_orders.sql
[0m20:50:08.117701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74d10b05-5bf3-4298-8c32-0c3cfce4bb07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC857BA590>]}
[0m20:50:08.118708 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model odl.fact_orders .................... [[31mERROR[0m in 1.10s]
[0m20:50:08.122383 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m20:50:08.123371 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_orders (models\fact\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 54 at position 4
  invalid identifier 'EVENT_TYPE'
  compiled code at target\run\ManyPets\models\fact\fact_orders.sql.
[0m20:50:08.127164 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:50:08.128163 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m20:50:08.128163 [debug] [MainThread]: On list_DEV: Close
[0m20:50:08.247403 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m20:50:08.247403 [debug] [MainThread]: On list_DEV_staging: Close
[0m20:50:08.373875 [debug] [MainThread]: Connection 'model.ManyPets.fact_orders' was left open.
[0m20:50:08.381954 [debug] [MainThread]: On model.ManyPets.fact_orders: Close
[0m20:50:08.496390 [info ] [MainThread]: 
[0m20:50:08.508108 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.48 seconds (3.48s).
[0m20:50:08.511838 [debug] [MainThread]: Command end result
[0m20:50:08.697892 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:50:08.702114 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:50:08.715554 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m20:50:08.717743 [info ] [MainThread]: 
[0m20:50:08.720277 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:50:08.721747 [info ] [MainThread]: 
[0m20:50:08.723530 [error] [MainThread]:   Database Error in model fact_orders (models\fact\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 54 at position 4
  invalid identifier 'EVENT_TYPE'
  compiled code at target\run\ManyPets\models\fact\fact_orders.sql
[0m20:50:08.725873 [info ] [MainThread]: 
[0m20:50:08.728719 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:50:08.735426 [debug] [MainThread]: Command `dbt run` failed at 20:50:08.733142 after 6.51 seconds
[0m20:50:08.738718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC81236050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCFF8AEA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC81532380>]}
[0m20:50:08.738718 [debug] [MainThread]: Flushing usage events
[0m20:50:09.628541 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:51:37.072296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD7FE76080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD01E5E9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD01E5E800>]}


============================== 20:51:37.077170 | 65a4e094-cfc9-4d89-bdae-54297f0d90d7 ==============================
[0m20:51:37.077170 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:51:37.080595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select fact_orders', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:51:37.997612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65a4e094-cfc9-4d89-bdae-54297f0d90d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD01DF7CD0>]}
[0m20:51:38.121781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65a4e094-cfc9-4d89-bdae-54297f0d90d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD0194DB10>]}
[0m20:51:38.125229 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:51:38.679887 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:51:39.095247 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:51:39.095247 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:51:39.211892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65a4e094-cfc9-4d89-bdae-54297f0d90d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD03E4D450>]}
[0m20:51:39.507842 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:51:39.514742 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:51:39.589804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65a4e094-cfc9-4d89-bdae-54297f0d90d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD02813820>]}
[0m20:51:39.591246 [info ] [MainThread]: Found 6 models, 17 data tests, 2 sources, 591 macros
[0m20:51:39.595311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65a4e094-cfc9-4d89-bdae-54297f0d90d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD02811840>]}
[0m20:51:39.595311 [info ] [MainThread]: 
[0m20:51:39.602964 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:51:39.604823 [info ] [MainThread]: 
[0m20:51:39.606775 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:51:39.611085 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m20:51:39.820802 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m20:51:39.820802 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m20:51:39.820802 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:40.744058 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.924 seconds
[0m20:51:40.771510 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m20:51:40.802485 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m20:51:40.802485 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m20:51:40.802485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:41.336284 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.533 seconds
[0m20:51:41.347087 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m20:51:41.360875 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m20:51:41.368494 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m20:51:41.480135 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.111 seconds
[0m20:51:41.486208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65a4e094-cfc9-4d89-bdae-54297f0d90d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD0194EC80>]}
[0m20:51:41.511699 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m20:51:41.512698 [info ] [Thread-1 (]: 1 of 1 START sql incremental model odl.fact_orders ............................. [RUN]
[0m20:51:41.521828 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.fact_orders'
[0m20:51:41.521828 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_orders
[0m20:51:41.586609 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_orders"
[0m20:51:41.586609 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_orders
[0m20:51:41.692891 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.fact_orders"
[0m20:51:41.703613 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m20:51:41.703613 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
create or replace transient table DEV.odl.fact_orders
         as
        ( 
WITH fact_data AS (
    SELECT 
        f.order_id,
        f.cessation_date,
        f.affiliate_code,
        f.pet_value,
        f.source,
        f.type,
        f.order_create_date,
        f.order_create_timestamp,
        /*f.event_time,
        f.envelope_version,
        f.detail_version,
        f.intent,
        f.tenant,
        f.experiments,*/
        c.customer_sk,
        p.pet_sk,
        f.ingest_date
    FROM DEV.staging.stg_orders f
    LEFT JOIN DEV.odl.dim_customers c 
        ON f.customer_email = c.customer_nk
    LEFT JOIN DEV.odl.dim_pets p 
        ON f.pet_name = p.pet_name 
        AND f.pet_dob = p.pet_dob
        AND f.pet_breed = p.pet_breed

    
)

, dedup AS (
    SELECT 
        f.*,
        ROW_NUMBER() OVER(PARTITION BY f.order_id, f.customer_sk, f.pet_sk ORDER BY f.ingest_date DESC) AS rnk
    FROM fact_data f
)

SELECT 
     order_id || '|' || customer_sk || '|'|| pet_sk         AS order_nk,
    md5(cast(coalesce(cast(order_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))    AS order_sk,
    -- order_id is added as connecting between order and order_complete on order_sk is not feasible due to missing customer_id and pet_id in the dataset.
    order_id                                                AS order_id,
    customer_sk                                             AS customer_sk,
    pet_sk                                                  AS pet_sk,
    order_create_date                                       AS order_create_date,
    order_create_timestamp                                  AS order_create_timestamp,
    cessation_date                                          AS cessation_date,
    COALESCE(affiliate_code, 'unknown')                     AS affiliate_code,
    pet_value                                               AS pet_value,
    source                                                  AS order_source,
    type                                                    AS order_type,
/*
    event_time,
    envelope_version,
    detail_version,
    intent,
    tenant,
    experiments,
*/
    ingest_date
FROM dedup
WHERE rnk = 1
        );
[0m20:51:41.703613 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:51:44.717288 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.008 seconds
[0m20:51:44.731987 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.fact_orders__dbt_tmp
[0m20:51:44.743780 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m20:51:44.743780 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
drop view if exists DEV.odl.fact_orders__dbt_tmp cascade
[0m20:51:44.833032 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.086 seconds
[0m20:51:44.932387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65a4e094-cfc9-4d89-bdae-54297f0d90d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD7E4F0340>]}
[0m20:51:44.934341 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model odl.fact_orders ........................ [[32mSUCCESS 1[0m in 3.40s]
[0m20:51:44.936022 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m20:51:44.939114 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:51:44.940119 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m20:51:44.941639 [debug] [MainThread]: On list_DEV: Close
[0m20:51:45.040051 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m20:51:45.049862 [debug] [MainThread]: On list_DEV_odl: Close
[0m20:51:45.172724 [debug] [MainThread]: Connection 'model.ManyPets.fact_orders' was left open.
[0m20:51:45.183067 [debug] [MainThread]: On model.ManyPets.fact_orders: Close
[0m20:51:45.300744 [info ] [MainThread]: 
[0m20:51:45.309407 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.69 seconds (5.69s).
[0m20:51:45.315823 [debug] [MainThread]: Command end result
[0m20:51:45.421293 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:51:45.425518 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:51:45.438435 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m20:51:45.440441 [info ] [MainThread]: 
[0m20:51:45.442615 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:51:45.443533 [info ] [MainThread]: 
[0m20:51:45.444528 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:51:45.446587 [debug] [MainThread]: Command `dbt run` succeeded at 20:51:45.446587 after 8.53 seconds
[0m20:51:45.448358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD7FE76080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD03D1DBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD03D1C0D0>]}
[0m20:51:45.448358 [debug] [MainThread]: Flushing usage events
[0m20:51:46.276911 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:51:53.285180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8DA996050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8DC8BE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8DC8BE7D0>]}


============================== 20:51:53.290922 | c142bbfc-89a7-4c93-8ec3-8c3226cddf7c ==============================
[0m20:51:53.290922 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:51:53.294731 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select fact_orders', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:51:54.264542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c142bbfc-89a7-4c93-8ec3-8c3226cddf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8DC44A500>]}
[0m20:51:54.373234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c142bbfc-89a7-4c93-8ec3-8c3226cddf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8DC7628C0>]}
[0m20:51:54.383735 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:51:54.947180 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:51:55.380115 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:51:55.380115 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:51:55.475236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c142bbfc-89a7-4c93-8ec3-8c3226cddf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8DE7AD420>]}
[0m20:51:55.751332 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:51:55.758976 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:51:55.826887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c142bbfc-89a7-4c93-8ec3-8c3226cddf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8DD290790>]}
[0m20:51:55.827710 [info ] [MainThread]: Found 6 models, 17 data tests, 2 sources, 591 macros
[0m20:51:55.831811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c142bbfc-89a7-4c93-8ec3-8c3226cddf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8DC437730>]}
[0m20:51:55.832820 [info ] [MainThread]: 
[0m20:51:55.837687 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:51:55.839612 [info ] [MainThread]: 
[0m20:51:55.843052 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:51:55.847732 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m20:51:56.067240 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m20:51:56.067240 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m20:51:56.067240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:57.082227 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.014 seconds
[0m20:51:57.121571 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m20:51:57.149871 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m20:51:57.149871 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m20:51:57.153268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:57.571342 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.421 seconds
[0m20:51:57.579343 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m20:51:57.603717 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m20:51:57.604289 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m20:51:57.954430 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.348 seconds
[0m20:51:57.968638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c142bbfc-89a7-4c93-8ec3-8c3226cddf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8DD2F7850>]}
[0m20:51:57.989115 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m20:51:57.990113 [info ] [Thread-1 (]: 1 of 1 START sql incremental model odl.fact_orders ............................. [RUN]
[0m20:51:57.994579 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.fact_orders'
[0m20:51:57.995585 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_orders
[0m20:51:58.054320 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_orders"
[0m20:51:58.056654 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_orders
[0m20:51:58.161132 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m20:51:58.161132 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
create or replace  temporary view DEV.odl.fact_orders__dbt_tmp
  
   as (
     
WITH fact_data AS (
    SELECT 
        f.order_id,
        f.cessation_date,
        f.affiliate_code,
        f.pet_value,
        f.source,
        f.type,
        f.order_create_date,
        f.order_create_timestamp,
        /*f.event_time,
        f.envelope_version,
        f.detail_version,
        f.intent,
        f.tenant,
        f.experiments,*/
        c.customer_sk,
        p.pet_sk,
        f.ingest_date
    FROM DEV.staging.stg_orders f
    LEFT JOIN DEV.odl.dim_customers c 
        ON f.customer_email = c.customer_nk
    LEFT JOIN DEV.odl.dim_pets p 
        ON f.pet_name = p.pet_name 
        AND f.pet_dob = p.pet_dob
        AND f.pet_breed = p.pet_breed

    
        WHERE f.ingest_date > (SELECT MAX(ingest_date) FROM DEV.odl.fact_orders)
    
)

, dedup AS (
    SELECT 
        f.*,
        ROW_NUMBER() OVER(PARTITION BY f.order_id, f.customer_sk, f.pet_sk ORDER BY f.ingest_date DESC) AS rnk
    FROM fact_data f
)

SELECT 
     order_id || '|' || customer_sk || '|'|| pet_sk         AS order_nk,
    md5(cast(coalesce(cast(order_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))    AS order_sk,
    -- order_id is added as connecting between order and order_complete on order_sk is not feasible due to missing customer_id and pet_id in the dataset.
    order_id                                                AS order_id,
    customer_sk                                             AS customer_sk,
    pet_sk                                                  AS pet_sk,
    order_create_date                                       AS order_create_date,
    order_create_timestamp                                  AS order_create_timestamp,
    cessation_date                                          AS cessation_date,
    COALESCE(affiliate_code, 'unknown')                     AS affiliate_code,
    pet_value                                               AS pet_value,
    source                                                  AS order_source,
    type                                                    AS order_type,
/*
    event_time,
    envelope_version,
    detail_version,
    intent,
    tenant,
    experiments,
*/
    ingest_date
FROM dedup
WHERE rnk = 1
  );
[0m20:51:58.162706 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:51:59.203571 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.040 seconds
[0m20:51:59.235371 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m20:51:59.235371 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
describe table DEV.odl.fact_orders__dbt_tmp
[0m20:51:59.359191 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.124 seconds
[0m20:51:59.386444 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m20:51:59.386444 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
describe table DEV.odl.fact_orders
[0m20:51:59.503094 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.113 seconds
[0m20:51:59.552593 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m20:51:59.552593 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
describe table "DEV"."ODL"."FACT_ORDERS"
[0m20:51:59.662858 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.110 seconds
[0m20:51:59.746726 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.fact_orders"
[0m20:51:59.751254 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m20:51:59.752768 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m20:51:59.895447 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.146 seconds
[0m20:51:59.905180 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m20:51:59.905798 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
merge into DEV.odl.fact_orders as DBT_INTERNAL_DEST
        using DEV.odl.fact_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_nk = DBT_INTERNAL_DEST.order_nk))

    
    when matched then update set
        "ORDER_NK" = DBT_INTERNAL_SOURCE."ORDER_NK","ORDER_SK" = DBT_INTERNAL_SOURCE."ORDER_SK","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_SK" = DBT_INTERNAL_SOURCE."CUSTOMER_SK","PET_SK" = DBT_INTERNAL_SOURCE."PET_SK","ORDER_CREATE_DATE" = DBT_INTERNAL_SOURCE."ORDER_CREATE_DATE","ORDER_CREATE_TIMESTAMP" = DBT_INTERNAL_SOURCE."ORDER_CREATE_TIMESTAMP","CESSATION_DATE" = DBT_INTERNAL_SOURCE."CESSATION_DATE","AFFILIATE_CODE" = DBT_INTERNAL_SOURCE."AFFILIATE_CODE","PET_VALUE" = DBT_INTERNAL_SOURCE."PET_VALUE","ORDER_SOURCE" = DBT_INTERNAL_SOURCE."ORDER_SOURCE","ORDER_TYPE" = DBT_INTERNAL_SOURCE."ORDER_TYPE","INGEST_DATE" = DBT_INTERNAL_SOURCE."INGEST_DATE"
    

    when not matched then insert
        ("ORDER_NK", "ORDER_SK", "ORDER_ID", "CUSTOMER_SK", "PET_SK", "ORDER_CREATE_DATE", "ORDER_CREATE_TIMESTAMP", "CESSATION_DATE", "AFFILIATE_CODE", "PET_VALUE", "ORDER_SOURCE", "ORDER_TYPE", "INGEST_DATE")
    values
        ("ORDER_NK", "ORDER_SK", "ORDER_ID", "CUSTOMER_SK", "PET_SK", "ORDER_CREATE_DATE", "ORDER_CREATE_TIMESTAMP", "CESSATION_DATE", "AFFILIATE_CODE", "PET_VALUE", "ORDER_SOURCE", "ORDER_TYPE", "INGEST_DATE")

;
[0m20:52:00.555130 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.645 seconds
[0m20:52:00.555130 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m20:52:00.555130 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
COMMIT
[0m20:52:00.725624 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.167 seconds
[0m20:52:00.767622 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.fact_orders__dbt_tmp
[0m20:52:00.783753 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m20:52:00.783753 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
drop view if exists DEV.odl.fact_orders__dbt_tmp cascade
[0m20:52:00.918098 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.133 seconds
[0m20:52:00.980010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c142bbfc-89a7-4c93-8ec3-8c3226cddf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8D9090310>]}
[0m20:52:00.981014 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model odl.fact_orders ........................ [[32mSUCCESS 0[0m in 2.98s]
[0m20:52:00.983709 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m20:52:00.986281 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:52:00.987284 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m20:52:00.987284 [debug] [MainThread]: On list_DEV: Close
[0m20:52:01.317536 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m20:52:01.317536 [debug] [MainThread]: On list_DEV_odl: Close
[0m20:52:01.450846 [debug] [MainThread]: Connection 'model.ManyPets.fact_orders' was left open.
[0m20:52:01.450846 [debug] [MainThread]: On model.ManyPets.fact_orders: Close
[0m20:52:01.615163 [info ] [MainThread]: 
[0m20:52:01.618326 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.77 seconds (5.77s).
[0m20:52:01.621651 [debug] [MainThread]: Command end result
[0m20:52:01.703306 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:52:01.708317 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:52:01.723746 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m20:52:01.724747 [info ] [MainThread]: 
[0m20:52:01.727084 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:52:01.728083 [info ] [MainThread]: 
[0m20:52:01.729527 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:52:01.733941 [debug] [MainThread]: Command `dbt run` succeeded at 20:52:01.733632 after 8.61 seconds
[0m20:52:01.735588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8DA996050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8DC8D21D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8DAC91090>]}
[0m20:52:01.736588 [debug] [MainThread]: Flushing usage events
[0m20:52:02.423314 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:56:55.556720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D208F5FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D2281EB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D2281E980>]}


============================== 20:56:55.562337 | 94af4f1e-9788-459d-b417-b99fde28fd3c ==============================
[0m20:56:55.562337 [info ] [MainThread]: Running with dbt=1.9.3
[0m20:56:55.566117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select fact_order_complete', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:56:56.475024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94af4f1e-9788-459d-b417-b99fde28fd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D1F179C60>]}
[0m20:56:56.582077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94af4f1e-9788-459d-b417-b99fde28fd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D231807F0>]}
[0m20:56:56.587629 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m20:56:57.140073 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m20:56:57.564456 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:56:57.564456 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:56:57.673959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94af4f1e-9788-459d-b417-b99fde28fd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D2470D3F0>]}
[0m20:56:57.955928 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:56:57.962961 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:56:58.028392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94af4f1e-9788-459d-b417-b99fde28fd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D24667640>]}
[0m20:56:58.029180 [info ] [MainThread]: Found 6 models, 17 data tests, 2 sources, 591 macros
[0m20:56:58.030701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94af4f1e-9788-459d-b417-b99fde28fd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D1C502320>]}
[0m20:56:58.033703 [info ] [MainThread]: 
[0m20:56:58.040317 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:56:58.042949 [info ] [MainThread]: 
[0m20:56:58.045337 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:56:58.057339 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m20:56:58.264374 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m20:56:58.264374 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m20:56:58.271726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:59.106886 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.842 seconds
[0m20:56:59.155269 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m20:56:59.171780 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m20:56:59.171780 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m20:56:59.171780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:59.758401 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.585 seconds
[0m20:56:59.772007 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m20:56:59.788806 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m20:56:59.795332 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m20:57:00.030216 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.239 seconds
[0m20:57:00.049267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94af4f1e-9788-459d-b417-b99fde28fd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D23196C20>]}
[0m20:57:00.065648 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_order_complete
[0m20:57:00.066646 [info ] [Thread-1 (]: 1 of 1 START sql incremental model odl.fact_order_complete ..................... [RUN]
[0m20:57:00.070242 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.fact_order_complete'
[0m20:57:00.070871 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_order_complete
[0m20:57:00.124076 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_order_complete"
[0m20:57:00.124076 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_order_complete
[0m20:57:00.245398 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.fact_order_complete"
[0m20:57:00.248751 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_order_complete"
[0m20:57:00.248751 [debug] [Thread-1 (]: On model.ManyPets.fact_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_order_complete"} */
create or replace transient table DEV.odl.fact_order_complete
         as
        ( 

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING        AS order_id,
        data:detail:intent::STRING          AS intent,
        data:detail:tenant::STRING          AS tenant,
        data:detail:customer_id::STRING     AS customer_id,
        pet.value                           AS pet_id,  
        data:time::TIMESTAMP                AS event_time,
        data:source::STRING                 AS source,
        data:type::STRING                   AS event_type,
        ingest_date                         AS ingest_date
    FROM dev.rdl.order_complete o,
    LATERAL FLATTEN(input => o.data:detail:pet_ids) AS pet   

    
),
fact_data AS (
    SELECT
        s.order_id,
        s.intent,
        s.tenant,
        s.source,
        s.type,
        s.ingest_date,
        s.order_complete_date,
        s.order_complete_timestamp,
        c.customer_sk,
        p.pet_sk
    FROM source_data s
    LEFT JOIN DEV.odl.dim_customers c 
        ON s.customer_id = c.customer_nk   
    LEFT JOIN DEV.odl.dim_pets p 
        ON s.pet_id = p.pet_nk            
),

dedup AS (
    SELECT 
        *,
        ROW_NUMBER() OVER ( PARTITION BY order_id ORDER BY ingest_date DESC ) AS rnk
    FROM fact_data
)

SELECT 
    --order_id || '|' || customer_sk || '|' || pet_sk       AS order_nk,
    --customer_sk and pet_sk will be null 
    order_id                                                AS order_nk,
    md5(cast(coalesce(cast(order_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))    AS order_sk,
    -- order_id is added as connecting between order and order_complete on order_sk is not feasible due to missing customer_id and pet_id in the dataset.
    order_id                                                AS order_id,
    customer_sk                                             AS customer_sk,
    pet_sk                                                  AS pet_sk,
    intent                                                  AS intent,
    tenant                                                  AS tenant,
    order_complete_date                                     AS order_complete_date,
    order_complete_timestamp                                AS order_complete_timestamp,
    source                                                  AS order_complete_source,
    type                                                    AS order_complete_type,
    ingest_date                                             AS ingest_date
FROM dedup
WHERE rnk = 1
        );
[0m20:57:00.253760 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:57:00.954069 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb1364-0000-e3bf-0001-b3ce000196ce
[0m20:57:00.954069 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 27 at position 8
invalid identifier 'S.TYPE'
[0m20:57:00.954069 [debug] [Thread-1 (]: Database Error in model fact_order_complete (models\fact\fact_order_complete.sql)
  000904 (42000): SQL compilation error: error line 27 at position 8
  invalid identifier 'S.TYPE'
  compiled code at target\run\ManyPets\models\fact\fact_order_complete.sql
[0m20:57:00.963273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94af4f1e-9788-459d-b417-b99fde28fd3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D20761240>]}
[0m20:57:00.964279 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model odl.fact_order_complete ............ [[31mERROR[0m in 0.88s]
[0m20:57:00.967264 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_order_complete
[0m20:57:00.968263 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.fact_order_complete' to be skipped because of status 'error'.  Reason: Database Error in model fact_order_complete (models\fact\fact_order_complete.sql)
  000904 (42000): SQL compilation error: error line 27 at position 8
  invalid identifier 'S.TYPE'
  compiled code at target\run\ManyPets\models\fact\fact_order_complete.sql.
[0m20:57:00.971774 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:57:00.972780 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m20:57:00.972780 [debug] [MainThread]: On list_DEV: Close
[0m20:57:01.078949 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m20:57:01.078949 [debug] [MainThread]: On list_DEV_staging: Close
[0m20:57:01.206069 [debug] [MainThread]: Connection 'model.ManyPets.fact_order_complete' was left open.
[0m20:57:01.206069 [debug] [MainThread]: On model.ManyPets.fact_order_complete: Close
[0m20:57:01.336209 [info ] [MainThread]: 
[0m20:57:01.340613 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.29 seconds (3.29s).
[0m20:57:01.344479 [debug] [MainThread]: Command end result
[0m20:57:01.443142 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m20:57:01.447630 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m20:57:01.461445 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m20:57:01.462447 [info ] [MainThread]: 
[0m20:57:01.465684 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:57:01.467540 [info ] [MainThread]: 
[0m20:57:01.469658 [error] [MainThread]:   Database Error in model fact_order_complete (models\fact\fact_order_complete.sql)
  000904 (42000): SQL compilation error: error line 27 at position 8
  invalid identifier 'S.TYPE'
  compiled code at target\run\ManyPets\models\fact\fact_order_complete.sql
[0m20:57:01.472752 [info ] [MainThread]: 
[0m20:57:01.475000 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:57:01.478853 [debug] [MainThread]: Command `dbt run` failed at 20:57:01.478853 after 6.08 seconds
[0m20:57:01.480630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D208F5FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D231F0B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D20C4DA50>]}
[0m20:57:01.480630 [debug] [MainThread]: Flushing usage events
[0m20:57:02.398016 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:00:57.963485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BAE7806050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BAE972EBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BAE972EA10>]}


============================== 21:00:57.970043 | a28e1a4e-1e84-4693-a425-b6545bcf37bb ==============================
[0m21:00:57.970043 [info ] [MainThread]: Running with dbt=1.9.3
[0m21:00:57.974435 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select fact_order_complete', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:00:58.997691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a28e1a4e-1e84-4693-a425-b6545bcf37bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BAE7B4E6E0>]}
[0m21:00:59.130965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a28e1a4e-1e84-4693-a425-b6545bcf37bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BAE95D1240>]}
[0m21:00:59.135400 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m21:00:59.696745 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m21:01:00.146717 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:01:00.146717 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:01:00.254442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a28e1a4e-1e84-4693-a425-b6545bcf37bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BAEB61D4B0>]}
[0m21:01:00.573989 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m21:01:00.582315 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m21:01:00.644499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a28e1a4e-1e84-4693-a425-b6545bcf37bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BAEB503820>]}
[0m21:01:00.647377 [info ] [MainThread]: Found 6 models, 17 data tests, 2 sources, 591 macros
[0m21:01:00.648961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a28e1a4e-1e84-4693-a425-b6545bcf37bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BAE92BA590>]}
[0m21:01:00.652822 [info ] [MainThread]: 
[0m21:01:00.656613 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:01:00.659313 [info ] [MainThread]: 
[0m21:01:00.662843 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:01:00.667315 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m21:01:00.879014 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m21:01:00.879014 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m21:01:00.879014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:01.628996 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.742 seconds
[0m21:01:01.648871 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m21:01:01.671746 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m21:01:01.671746 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m21:01:01.672749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:02.398239 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.726 seconds
[0m21:01:02.407962 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m21:01:02.428566 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m21:01:02.428566 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m21:01:02.553545 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.126 seconds
[0m21:01:02.570473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a28e1a4e-1e84-4693-a425-b6545bcf37bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BAEB641E40>]}
[0m21:01:02.589143 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_order_complete
[0m21:01:02.590152 [info ] [Thread-1 (]: 1 of 1 START sql incremental model odl.fact_order_complete ..................... [RUN]
[0m21:01:02.598195 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.fact_order_complete'
[0m21:01:02.598195 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_order_complete
[0m21:01:02.672311 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_order_complete"
[0m21:01:02.672311 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_order_complete
[0m21:01:02.794083 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.fact_order_complete"
[0m21:01:02.797596 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_order_complete"
[0m21:01:02.797596 [debug] [Thread-1 (]: On model.ManyPets.fact_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_order_complete"} */
create or replace transient table DEV.odl.fact_order_complete
         as
        ( 

WITH fact_data AS (
    SELECT
        s.order_id,
        s.intent,
        s.tenant,
        s.source,
        s.type,
        s.ingest_date,
        s.order_complete_date,
        s.order_complete_timestamp,
        c.customer_sk,
        p.pet_sk
    FROM DEV.staging.stg_order_complete s
    LEFT JOIN DEV.odl.dim_customers c 
        ON s.customer_id = c.customer_nk   
    LEFT JOIN DEV.odl.dim_pets p 
        ON s.pet_id = p.pet_nk 

               
),
dedup AS (
    SELECT 
        *,
        ROW_NUMBER() OVER ( PARTITION BY order_id ORDER BY ingest_date DESC ) AS rnk
    FROM fact_data
)

SELECT 
    --order_id || '|' || customer_sk || '|' || pet_sk       AS order_nk,
    --customer_sk and pet_sk will be null 
    order_id                                                AS order_nk,
    md5(cast(coalesce(cast(order_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))    AS order_sk,
    -- order_id is added as connecting between order and order_complete on order_sk is not feasible due to missing customer_id and pet_id in the dataset.
    order_id                                                AS order_id,
    customer_sk                                             AS customer_sk,
    pet_sk                                                  AS pet_sk,
    intent                                                  AS intent,
    tenant                                                  AS tenant,
    order_complete_date                                     AS order_complete_date,
    order_complete_timestamp                                AS order_complete_timestamp,
    source                                                  AS order_complete_source,
    type                                                    AS order_complete_type,
    ingest_date                                             AS ingest_date
FROM dedup
WHERE rnk = 1
        );
[0m21:01:02.797596 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:01:05.359825 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.565 seconds
[0m21:01:05.409141 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.fact_order_complete__dbt_tmp
[0m21:01:05.442872 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_order_complete"
[0m21:01:05.442872 [debug] [Thread-1 (]: On model.ManyPets.fact_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_order_complete"} */
drop view if exists DEV.odl.fact_order_complete__dbt_tmp cascade
[0m21:01:05.537723 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.090 seconds
[0m21:01:05.597732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a28e1a4e-1e84-4693-a425-b6545bcf37bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BAE5E70310>]}
[0m21:01:05.597732 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model odl.fact_order_complete ................ [[32mSUCCESS 1[0m in 3.00s]
[0m21:01:05.604029 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_order_complete
[0m21:01:05.608006 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:01:05.608996 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m21:01:05.608996 [debug] [MainThread]: On list_DEV: Close
[0m21:01:05.725100 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m21:01:05.725820 [debug] [MainThread]: On list_DEV_staging: Close
[0m21:01:05.842070 [debug] [MainThread]: Connection 'model.ManyPets.fact_order_complete' was left open.
[0m21:01:05.842070 [debug] [MainThread]: On model.ManyPets.fact_order_complete: Close
[0m21:01:05.976693 [info ] [MainThread]: 
[0m21:01:05.984868 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.32 seconds (5.32s).
[0m21:01:05.988618 [debug] [MainThread]: Command end result
[0m21:01:06.165194 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m21:01:06.169628 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m21:01:06.181803 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m21:01:06.182802 [info ] [MainThread]: 
[0m21:01:06.188169 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:01:06.191097 [info ] [MainThread]: 
[0m21:01:06.193736 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:01:06.198885 [debug] [MainThread]: Command `dbt run` succeeded at 21:01:06.197852 after 8.40 seconds
[0m21:01:06.199882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BAE7806050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BAE34D4640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BAEA0A7DF0>]}
[0m21:01:06.199882 [debug] [MainThread]: Flushing usage events
[0m21:01:06.910808 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:22:02.989764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB5036050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB6F5E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB6F5E7D0>]}


============================== 22:22:02.999761 | db972116-819f-4290-9412-c0aee7158c55 ==============================
[0m22:22:02.999761 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:22:03.001496 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_orders --full-refresh', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:22:04.034186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db972116-819f-4290-9412-c0aee7158c55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB6AEA500>]}
[0m22:22:04.136753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db972116-819f-4290-9412-c0aee7158c55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB6E028C0>]}
[0m22:22:04.139754 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:22:04.677489 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:22:05.071209 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:22:05.072210 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:22:05.166236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db972116-819f-4290-9412-c0aee7158c55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB8E4D480>]}
[0m22:22:05.422205 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:22:05.433525 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:22:05.509984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db972116-819f-4290-9412-c0aee7158c55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB78D7430>]}
[0m22:22:05.511979 [info ] [MainThread]: Found 6 models, 17 data tests, 2 sources, 591 macros
[0m22:22:05.512989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db972116-819f-4290-9412-c0aee7158c55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB7933AF0>]}
[0m22:22:05.517644 [info ] [MainThread]: 
[0m22:22:05.519644 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:22:05.521646 [info ] [MainThread]: 
[0m22:22:05.523650 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:22:05.527645 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m22:22:05.808799 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m22:22:05.809801 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m22:22:05.810800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:06.602550 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.791 seconds
[0m22:22:06.629609 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m22:22:06.648106 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m22:22:06.648106 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m22:22:06.649111 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:07.183691 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.535 seconds
[0m22:22:07.188679 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m22:22:07.197608 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m22:22:07.198615 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m22:22:07.454767 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.255 seconds
[0m22:22:07.466625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db972116-819f-4290-9412-c0aee7158c55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB7997850>]}
[0m22:22:07.482621 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m22:22:07.484618 [info ] [Thread-1 (]: 1 of 1 START sql incremental model staging.stg_orders .......................... [RUN]
[0m22:22:07.485619 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_orders'
[0m22:22:07.486624 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m22:22:07.520199 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m22:22:07.522196 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m22:22:07.616770 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m22:22:07.623760 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m22:22:07.623760 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace transient table DEV.staging.stg_orders
         as
        (

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_effective_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS type,
        data:intent::STRING                             AS intent,
        data:tenant::STRING                             AS tenant,
        data:time::TIMESTAMP                            AS order_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
),
dedup AS
(
    SELECT
        *
        ,ROW_NUMBER() OVER(PARTITION BY order_id, email, pet_dob, pet_name, pet_breed  ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)
SELECT 
    order_id ,
    email                                                       AS customer_email,
    COALESCE(NULLIF(TRIM(COALESCE(first_name, '') || ' ' || 
            COALESCE(last_name, '')), ''), 'unknown')           AS customer_name,
    dob                                                         AS customer_dob,
    phone                                                       AS customer_phone,
    address_line1 || ' ' || address_line2                       AS customer_address,
    city                                                        AS customer_city,
    country                                                     AS customer_country,
    postcode                                                    AS customer_postcode,
    pet_dob,
    pet_name,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_time::DATE                                            AS order_create_date,
    order_time                                                  AS order_create_timestamp,
    cessation_date,
    affiliate_code,
    source,
    type,
    order_effective_date,
    ingest_date
FROM dedup
WHERE 
    rnk =1
        );
[0m22:22:07.624761 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:22:10.366809 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.741 seconds
[0m22:22:10.395800 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_orders__dbt_tmp
[0m22:22:10.405797 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m22:22:10.406797 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
drop view if exists DEV.staging.stg_orders__dbt_tmp cascade
[0m22:22:10.499895 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.092 seconds
[0m22:22:10.560840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db972116-819f-4290-9412-c0aee7158c55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB36B0310>]}
[0m22:22:10.562111 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model staging.stg_orders ..................... [[32mSUCCESS 1[0m in 3.07s]
[0m22:22:10.564107 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m22:22:10.566376 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:22:10.566376 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m22:22:10.567376 [debug] [MainThread]: On list_DEV: Close
[0m22:22:10.669430 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m22:22:10.670430 [debug] [MainThread]: On list_DEV_odl: Close
[0m22:22:10.831471 [debug] [MainThread]: Connection 'model.ManyPets.stg_orders' was left open.
[0m22:22:10.832452 [debug] [MainThread]: On model.ManyPets.stg_orders: Close
[0m22:22:10.956753 [info ] [MainThread]: 
[0m22:22:10.961857 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.43 seconds (5.43s).
[0m22:22:10.968855 [debug] [MainThread]: Command end result
[0m22:22:11.047466 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:22:11.052457 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:22:11.065475 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m22:22:11.066460 [info ] [MainThread]: 
[0m22:22:11.068461 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:22:11.069457 [info ] [MainThread]: 
[0m22:22:11.070459 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:22:11.072460 [debug] [MainThread]: Command `dbt run` succeeded at 22:22:11.072460 after 8.25 seconds
[0m22:22:11.073461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB5036050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB6F721D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB5331090>]}
[0m22:22:11.074460 [debug] [MainThread]: Flushing usage events
[0m22:22:11.586978 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:22:37.074487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236484A60B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002364A3CEC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002364A3CEA40>]}


============================== 22:22:37.080488 | d5b9c435-6762-4e1d-93c3-11f8190bfcb8 ==============================
[0m22:22:37.080488 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:22:37.082491 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select fact_orders --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:22:37.907078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5b9c435-6762-4e1d-93c3-11f8190bfcb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023649EE4B80>]}
[0m22:22:38.006115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5b9c435-6762-4e1d-93c3-11f8190bfcb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002364AC83490>]}
[0m22:22:38.008751 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:22:38.533046 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:22:38.948488 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:22:38.949490 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:22:39.042567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5b9c435-6762-4e1d-93c3-11f8190bfcb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002364C2BD4E0>]}
[0m22:22:39.292282 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:22:39.299276 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:22:39.360849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5b9c435-6762-4e1d-93c3-11f8190bfcb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002364C18C1C0>]}
[0m22:22:39.362852 [info ] [MainThread]: Found 6 models, 17 data tests, 2 sources, 591 macros
[0m22:22:39.363859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5b9c435-6762-4e1d-93c3-11f8190bfcb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023649F47790>]}
[0m22:22:39.369653 [info ] [MainThread]: 
[0m22:22:39.371650 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:22:39.374654 [info ] [MainThread]: 
[0m22:22:39.377652 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:22:39.386484 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m22:22:39.565493 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m22:22:39.567104 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m22:22:39.567104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:40.224309 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.656 seconds
[0m22:22:40.239057 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m22:22:40.255867 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m22:22:40.255867 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m22:22:40.256868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:40.775002 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.518 seconds
[0m22:22:40.786287 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m22:22:40.798205 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m22:22:40.799655 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m22:22:40.921260 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.121 seconds
[0m22:22:40.934494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5b9c435-6762-4e1d-93c3-11f8190bfcb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002364C18DD50>]}
[0m22:22:40.945942 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m22:22:40.946943 [info ] [Thread-1 (]: 1 of 1 START sql incremental model odl.fact_orders ............................. [RUN]
[0m22:22:40.950375 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.fact_orders'
[0m22:22:40.952374 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_orders
[0m22:22:41.008117 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_orders"
[0m22:22:41.011966 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_orders
[0m22:22:41.108146 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.fact_orders"
[0m22:22:41.113164 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m22:22:41.114149 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
create or replace transient table DEV.odl.fact_orders
         as
        ( 
WITH fact_data AS (
    SELECT 
        f.order_id,
        f.cessation_date,
        f.affiliate_code,
        f.pet_value,
        f.source,
        f.type,
        f.order_create_date,
        f.order_create_timestamp,
        f.intent,
        f.tenant,
        /*f.event_time,
        f.envelope_version,
        f.detail_version,
        f.experiments,*/
        c.customer_sk,
        p.pet_sk,
        f.ingest_date
    FROM DEV.staging.stg_orders f
    LEFT JOIN DEV.odl.dim_customers c 
        ON f.customer_email = c.customer_nk
    LEFT JOIN DEV.odl.dim_pets p 
        ON f.pet_name = p.pet_name 
        AND f.pet_dob = p.pet_dob
        AND f.pet_breed = p.pet_breed

    
)

, dedup AS (
    SELECT 
        f.*,
        ROW_NUMBER() OVER(PARTITION BY f.order_id, f.customer_sk, f.pet_sk ORDER BY f.ingest_date DESC) AS rnk
    FROM fact_data f
)

SELECT 
     order_id || '|' || customer_sk || '|'|| pet_sk         AS order_nk,
    md5(cast(coalesce(cast(order_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))    AS order_sk,
    -- order_id is added as connecting between order and order_complete on order_sk is not feasible due to missing customer_id and pet_id in the dataset.
    order_id                                                AS order_id,
    customer_sk                                             AS customer_sk,
    pet_sk                                                  AS pet_sk,
    order_create_date                                       AS order_create_date,
    order_create_timestamp                                  AS order_create_timestamp,
    cessation_date                                          AS cessation_date,
    COALESCE(affiliate_code, 'unknown')                     AS affiliate_code,
    pet_value                                               AS pet_value,
    source                                                  AS order_source,
    type                                                    AS order_type,
    intent                                                  AS intent,
    tenant                                                  AS tenant,
/*
    event_time,
    envelope_version,
    detail_version,
    intent,
    tenant,
    experiments,
*/
    ingest_date
FROM dedup
WHERE rnk = 1
        );
[0m22:22:41.114149 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:22:41.735167 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb13b9-0000-e437-0001-b3ce0002e03e
[0m22:22:41.736169 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 14 at position 8
invalid identifier 'F.INTENT'
[0m22:22:41.742168 [debug] [Thread-1 (]: Database Error in model fact_orders (models\fact\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 14 at position 8
  invalid identifier 'F.INTENT'
  compiled code at target\run\ManyPets\models\fact\fact_orders.sql
[0m22:22:41.745762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5b9c435-6762-4e1d-93c3-11f8190bfcb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023648312F50>]}
[0m22:22:41.746773 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model odl.fact_orders .................... [[31mERROR[0m in 0.79s]
[0m22:22:41.749540 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m22:22:41.750540 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_orders (models\fact\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 14 at position 8
  invalid identifier 'F.INTENT'
  compiled code at target\run\ManyPets\models\fact\fact_orders.sql.
[0m22:22:41.752536 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:22:41.753534 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m22:22:41.753534 [debug] [MainThread]: On list_DEV: Close
[0m22:22:41.856025 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m22:22:41.856996 [debug] [MainThread]: On list_DEV_odl: Close
[0m22:22:41.969558 [debug] [MainThread]: Connection 'model.ManyPets.fact_orders' was left open.
[0m22:22:41.971578 [debug] [MainThread]: On model.ManyPets.fact_orders: Close
[0m22:22:42.079800 [info ] [MainThread]: 
[0m22:22:42.081589 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.70 seconds (2.70s).
[0m22:22:42.083594 [debug] [MainThread]: Command end result
[0m22:22:42.166313 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:22:42.170323 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:22:42.183312 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m22:22:42.184318 [info ] [MainThread]: 
[0m22:22:42.185319 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:22:42.186320 [info ] [MainThread]: 
[0m22:22:42.188314 [error] [MainThread]:   Database Error in model fact_orders (models\fact\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 14 at position 8
  invalid identifier 'F.INTENT'
  compiled code at target\run\ManyPets\models\fact\fact_orders.sql
[0m22:22:42.189883 [info ] [MainThread]: 
[0m22:22:42.190883 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:22:42.193881 [debug] [MainThread]: Command `dbt run` failed at 22:22:42.193881 after 5.27 seconds
[0m22:22:42.195882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236484A60B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002364831B9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023644182350>]}
[0m22:22:42.196883 [debug] [MainThread]: Flushing usage events
[0m22:22:42.658846 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:23:37.513947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019459736020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001945B65EB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001945B65E9B0>]}


============================== 22:23:37.519947 | c53ec09f-21a3-40b9-8a6f-e5b029b30670 ==============================
[0m22:23:37.519947 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:23:37.521950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_orders', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:23:38.325423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c53ec09f-21a3-40b9-8a6f-e5b029b30670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019457FB5C60>]}
[0m22:23:38.422299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c53ec09f-21a3-40b9-8a6f-e5b029b30670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001945B501B70>]}
[0m22:23:38.424316 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:23:38.950009 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:23:39.353034 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:23:39.354021 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:23:39.447735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c53ec09f-21a3-40b9-8a6f-e5b029b30670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001945D54D450>]}
[0m22:23:39.699364 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:23:39.708363 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:23:39.762891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c53ec09f-21a3-40b9-8a6f-e5b029b30670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001945BF7A770>]}
[0m22:23:39.764889 [info ] [MainThread]: Found 6 models, 17 data tests, 2 sources, 591 macros
[0m22:23:39.765890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c53ec09f-21a3-40b9-8a6f-e5b029b30670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001945B2B2710>]}
[0m22:23:39.769888 [info ] [MainThread]: 
[0m22:23:39.771889 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:23:39.773890 [info ] [MainThread]: 
[0m22:23:39.775894 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:23:39.779123 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m22:23:39.961784 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m22:23:39.964786 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m22:23:39.966784 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:23:40.689022 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.722 seconds
[0m22:23:40.703928 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m22:23:40.721137 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m22:23:40.721137 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m22:23:40.722137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:23:41.284360 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.562 seconds
[0m22:23:41.289361 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m22:23:41.300266 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m22:23:41.301284 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m22:23:41.446013 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.144 seconds
[0m22:23:41.457996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c53ec09f-21a3-40b9-8a6f-e5b029b30670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001945C0977F0>]}
[0m22:23:41.470655 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m22:23:41.471686 [info ] [Thread-1 (]: 1 of 1 START sql incremental model staging.stg_orders .......................... [RUN]
[0m22:23:41.473693 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_orders'
[0m22:23:41.474691 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m22:23:41.498671 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m22:23:41.500674 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m22:23:41.606802 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m22:23:41.621657 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m22:23:41.622658 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace transient table DEV.staging.stg_orders
         as
        (

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_effective_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS type,
        data:intent::STRING                             AS intent,
        data:tenant::STRING                             AS tenant,
        data:time::TIMESTAMP                            AS order_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
),
dedup AS
(
    SELECT
        *
        ,ROW_NUMBER() OVER(PARTITION BY order_id, email, pet_dob, pet_name, pet_breed  ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)
SELECT 
    order_id ,
    email                                                       AS customer_email,
    COALESCE(NULLIF(TRIM(COALESCE(first_name, '') || ' ' || 
            COALESCE(last_name, '')), ''), 'unknown')           AS customer_name,
    dob                                                         AS customer_dob,
    phone                                                       AS customer_phone,
    address_line1 || ' ' || address_line2                       AS customer_address,
    city                                                        AS customer_city,
    country                                                     AS customer_country,
    postcode                                                    AS customer_postcode,
    pet_dob,
    pet_name,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_time::DATE                                            AS order_create_date,
    order_time                                                  AS order_create_timestamp,
    cessation_date,
    affiliate_code,
    source,
    type,
    order_effective_date,
    ingest_date
FROM dedup
WHERE 
    rnk =1
        );
[0m22:23:41.623658 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:23:43.838859 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.215 seconds
[0m22:23:43.865224 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_orders__dbt_tmp
[0m22:23:43.876627 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m22:23:43.877642 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
drop view if exists DEV.staging.stg_orders__dbt_tmp cascade
[0m22:23:43.953077 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.074 seconds
[0m22:23:43.998607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c53ec09f-21a3-40b9-8a6f-e5b029b30670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019457DB02E0>]}
[0m22:23:43.999634 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model staging.stg_orders ..................... [[32mSUCCESS 1[0m in 2.52s]
[0m22:23:44.001653 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m22:23:44.003635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:23:44.004634 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m22:23:44.004634 [debug] [MainThread]: On list_DEV: Close
[0m22:23:44.110025 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m22:23:44.110025 [debug] [MainThread]: On list_DEV_odl: Close
[0m22:23:44.216640 [debug] [MainThread]: Connection 'model.ManyPets.stg_orders' was left open.
[0m22:23:44.218649 [debug] [MainThread]: On model.ManyPets.stg_orders: Close
[0m22:23:44.315778 [info ] [MainThread]: 
[0m22:23:44.317783 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.54 seconds (4.54s).
[0m22:23:44.321615 [debug] [MainThread]: Command end result
[0m22:23:44.393031 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:23:44.396001 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:23:44.409003 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m22:23:44.410006 [info ] [MainThread]: 
[0m22:23:44.412003 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:23:44.413004 [info ] [MainThread]: 
[0m22:23:44.414002 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:23:44.416003 [debug] [MainThread]: Command `dbt run` succeeded at 22:23:44.416003 after 7.04 seconds
[0m22:23:44.416003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019459736020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001945BFC38B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019459A33A00>]}
[0m22:23:44.418008 [debug] [MainThread]: Flushing usage events
[0m22:23:44.925681 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:23:59.495453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1FA5960E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1FA8DE2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1FC4D0160>]}


============================== 22:23:59.502448 | ee848b6c-6ed0-41ed-ab1e-87115c197805 ==============================
[0m22:23:59.502448 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:23:59.503451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select fact_orders', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:24:00.300828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee848b6c-6ed0-41ed-ab1e-87115c197805', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1FC00BC40>]}
[0m22:24:00.399844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee848b6c-6ed0-41ed-ab1e-87115c197805', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1FC362350>]}
[0m22:24:00.402116 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:24:00.921838 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:24:01.314373 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:24:01.314373 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:24:01.408296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee848b6c-6ed0-41ed-ab1e-87115c197805', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1FE3AD510>]}
[0m22:24:01.659856 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:24:01.665874 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:24:01.724210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee848b6c-6ed0-41ed-ab1e-87115c197805', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1FCDDBEB0>]}
[0m22:24:01.726209 [info ] [MainThread]: Found 6 models, 17 data tests, 2 sources, 591 macros
[0m22:24:01.728211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee848b6c-6ed0-41ed-ab1e-87115c197805', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1F6184610>]}
[0m22:24:01.732221 [info ] [MainThread]: 
[0m22:24:01.733222 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:24:01.736205 [info ] [MainThread]: 
[0m22:24:01.739216 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:24:01.741952 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m22:24:01.935609 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m22:24:01.936612 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m22:24:01.936612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:02.625791 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.689 seconds
[0m22:24:02.648955 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m22:24:02.666240 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m22:24:02.667258 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m22:24:02.667258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:03.261323 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.593 seconds
[0m22:24:03.266324 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m22:24:03.278630 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m22:24:03.278630 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m22:24:03.465092 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.185 seconds
[0m22:24:03.477623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee848b6c-6ed0-41ed-ab1e-87115c197805', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1FC4D0A30>]}
[0m22:24:03.490566 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m22:24:03.492588 [info ] [Thread-1 (]: 1 of 1 START sql incremental model odl.fact_orders ............................. [RUN]
[0m22:24:03.494571 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.fact_orders'
[0m22:24:03.495571 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_orders
[0m22:24:03.542500 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_orders"
[0m22:24:03.544515 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_orders
[0m22:24:03.636959 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.fact_orders"
[0m22:24:03.641695 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m22:24:03.642687 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
create or replace transient table DEV.odl.fact_orders
         as
        ( 
WITH fact_data AS (
    SELECT 
        f.order_id,
        f.cessation_date,
        f.affiliate_code,
        f.pet_value,
        f.source,
        f.type,
        f.order_create_date,
        f.order_create_timestamp,
        f.intent,
        f.tenant,
        /*f.event_time,
        f.envelope_version,
        f.detail_version,
        f.experiments,*/
        c.customer_sk,
        p.pet_sk,
        f.ingest_date
    FROM DEV.staging.stg_orders f
    LEFT JOIN DEV.odl.dim_customers c 
        ON f.customer_email = c.customer_nk
    LEFT JOIN DEV.odl.dim_pets p 
        ON f.pet_name = p.pet_name 
        AND f.pet_dob = p.pet_dob
        AND f.pet_breed = p.pet_breed

    
)

, dedup AS (
    SELECT 
        f.*,
        ROW_NUMBER() OVER(PARTITION BY f.order_id, f.customer_sk, f.pet_sk ORDER BY f.ingest_date DESC) AS rnk
    FROM fact_data f
)

SELECT 
     order_id || '|' || customer_sk || '|'|| pet_sk         AS order_nk,
    md5(cast(coalesce(cast(order_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))    AS order_sk,
    -- order_id is added as connecting between order and order_complete on order_sk is not feasible due to missing customer_id and pet_id in the dataset.
    order_id                                                AS order_id,
    customer_sk                                             AS customer_sk,
    pet_sk                                                  AS pet_sk,
    order_create_date                                       AS order_create_date,
    order_create_timestamp                                  AS order_create_timestamp,
    cessation_date                                          AS cessation_date,
    COALESCE(affiliate_code, 'unknown')                     AS affiliate_code,
    pet_value                                               AS pet_value,
    source                                                  AS order_source,
    type                                                    AS order_type,
    intent                                                  AS intent,
    tenant                                                  AS tenant,
/*
    event_time,
    envelope_version,
    detail_version,
    intent,
    tenant,
    experiments,
*/
    ingest_date
FROM dedup
WHERE rnk = 1
        );
[0m22:24:03.643687 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:24:04.214313 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb13bb-0000-e432-0001-b3ce0003003a
[0m22:24:04.216313 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 14 at position 8
invalid identifier 'F.INTENT'
[0m22:24:04.220313 [debug] [Thread-1 (]: Database Error in model fact_orders (models\fact\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 14 at position 8
  invalid identifier 'F.INTENT'
  compiled code at target\run\ManyPets\models\fact\fact_orders.sql
[0m22:24:04.225804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee848b6c-6ed0-41ed-ab1e-87115c197805', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1FA402FB0>]}
[0m22:24:04.227823 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model odl.fact_orders .................... [[31mERROR[0m in 0.73s]
[0m22:24:04.229814 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m22:24:04.230805 [debug] [Thread-4 (]: Marking all children of 'model.ManyPets.fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_orders (models\fact\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 14 at position 8
  invalid identifier 'F.INTENT'
  compiled code at target\run\ManyPets\models\fact\fact_orders.sql.
[0m22:24:04.233665 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:24:04.233665 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m22:24:04.234679 [debug] [MainThread]: On list_DEV: Close
[0m22:24:04.345445 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m22:24:04.346443 [debug] [MainThread]: On list_DEV_odl: Close
[0m22:24:04.463461 [debug] [MainThread]: Connection 'model.ManyPets.fact_orders' was left open.
[0m22:24:04.463461 [debug] [MainThread]: On model.ManyPets.fact_orders: Close
[0m22:24:04.585678 [info ] [MainThread]: 
[0m22:24:04.590148 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.85 seconds (2.85s).
[0m22:24:04.595144 [debug] [MainThread]: Command end result
[0m22:24:04.671025 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:24:04.674997 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:24:04.685997 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m22:24:04.688006 [info ] [MainThread]: 
[0m22:24:04.689996 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:24:04.690638 [info ] [MainThread]: 
[0m22:24:04.691655 [error] [MainThread]:   Database Error in model fact_orders (models\fact\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 14 at position 8
  invalid identifier 'F.INTENT'
  compiled code at target\run\ManyPets\models\fact\fact_orders.sql
[0m22:24:04.694221 [info ] [MainThread]: 
[0m22:24:04.695217 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:24:04.698230 [debug] [MainThread]: Command `dbt run` failed at 22:24:04.697217 after 5.33 seconds
[0m22:24:04.698230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1FA5960E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1FBFAE770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1F8E72440>]}
[0m22:24:04.699226 [debug] [MainThread]: Flushing usage events
[0m22:24:05.168953 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:26:37.559392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C366716050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C36863E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C36863E7D0>]}


============================== 22:26:37.559392 | 1bcd2f46-d9b0-4cf1-9a38-b533389419aa ==============================
[0m22:26:37.559392 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:26:37.559392 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_orders', 'send_anonymous_usage_stats': 'True'}
[0m22:26:38.326857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1bcd2f46-d9b0-4cf1-9a38-b533389419aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3681CE500>]}
[0m22:26:38.407532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1bcd2f46-d9b0-4cf1-9a38-b533389419aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3684E28C0>]}
[0m22:26:38.423161 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:26:38.926284 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:26:39.287285 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:26:39.287285 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:26:39.375851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1bcd2f46-d9b0-4cf1-9a38-b533389419aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C36A52D480>]}
[0m22:26:39.600064 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:26:39.615678 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:26:39.669090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1bcd2f46-d9b0-4cf1-9a38-b533389419aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C368FB5630>]}
[0m22:26:39.669090 [info ] [MainThread]: Found 6 models, 17 data tests, 2 sources, 591 macros
[0m22:26:39.669090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bcd2f46-d9b0-4cf1-9a38-b533389419aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C369011210>]}
[0m22:26:39.669090 [info ] [MainThread]: 
[0m22:26:39.684733 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:26:39.684733 [info ] [MainThread]: 
[0m22:26:39.688611 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:26:39.693402 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m22:26:39.855404 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m22:26:39.855404 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m22:26:39.855404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:26:41.591104 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.740 seconds
[0m22:26:41.606739 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m22:26:41.622412 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m22:26:41.622412 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m22:26:41.622412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:26:42.325720 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.701 seconds
[0m22:26:42.340981 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m22:26:42.340981 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m22:26:42.356597 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m22:26:42.710845 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.353 seconds
[0m22:26:42.710845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bcd2f46-d9b0-4cf1-9a38-b533389419aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C369077850>]}
[0m22:26:42.742063 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m22:26:42.742063 [info ] [Thread-1 (]: 1 of 1 START sql incremental model staging.stg_orders .......................... [RUN]
[0m22:26:42.742063 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_orders'
[0m22:26:42.742063 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m22:26:42.775556 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m22:26:42.775556 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m22:26:42.870409 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m22:26:42.870409 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m22:26:42.870409 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace transient table DEV.staging.stg_orders
         as
        (

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_effective_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS type,
        data:intent::STRING                             AS intent,
        data:tenant::STRING                             AS tenant,
        data:time::TIMESTAMP                            AS order_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
),
dedup AS
(
    SELECT
        *
        ,ROW_NUMBER() OVER(PARTITION BY order_id, email, pet_dob, pet_name, pet_breed  ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)
SELECT 
    order_id ,
    email                                                       AS customer_email,
    COALESCE(NULLIF(TRIM(COALESCE(first_name, '') || ' ' || 
            COALESCE(last_name, '')), ''), 'unknown')           AS customer_name,
    dob                                                         AS customer_dob,
    COALESCE(phone,'unknown')                                   AS customer_phone,
    address_line1 || ' ' || address_line2                       AS customer_address,
    city                                                        AS customer_city,
    country                                                     AS customer_country,
    postcode                                                    AS customer_postcode,
    pet_dob,
    pet_name,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_time::DATE                                            AS order_create_date,
    order_time                                                  AS order_create_timestamp,
    cessation_date,
    affiliate_code,
    source,
    type,
    intent,
    tenant,
    order_effective_date,
    ingest_date
FROM dedup
WHERE 
    rnk =1
        );
[0m22:26:42.870409 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:26:45.140927 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.267 seconds
[0m22:26:45.154442 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_orders__dbt_tmp
[0m22:26:45.172488 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m22:26:45.172488 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
drop view if exists DEV.staging.stg_orders__dbt_tmp cascade
[0m22:26:45.256365 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.079 seconds
[0m22:26:45.287662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bcd2f46-d9b0-4cf1-9a38-b533389419aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C364D90310>]}
[0m22:26:45.287662 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model staging.stg_orders ..................... [[32mSUCCESS 1[0m in 2.55s]
[0m22:26:45.287662 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m22:26:45.287662 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:26:45.287662 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m22:26:45.287662 [debug] [MainThread]: On list_DEV: Close
[0m22:26:45.404173 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m22:26:45.404173 [debug] [MainThread]: On list_DEV_odl: Close
[0m22:26:45.543820 [debug] [MainThread]: Connection 'model.ManyPets.stg_orders' was left open.
[0m22:26:45.544820 [debug] [MainThread]: On model.ManyPets.stg_orders: Close
[0m22:26:45.653031 [info ] [MainThread]: 
[0m22:26:45.653031 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.97 seconds (5.97s).
[0m22:26:45.668586 [debug] [MainThread]: Command end result
[0m22:26:45.739017 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:26:45.739017 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:26:45.755257 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m22:26:45.755257 [info ] [MainThread]: 
[0m22:26:45.755257 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:26:45.770885 [info ] [MainThread]: 
[0m22:26:45.770885 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:26:45.770885 [debug] [MainThread]: Command `dbt run` succeeded at 22:26:45.770885 after 8.33 seconds
[0m22:26:45.777396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C366716050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3686521D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C366A11090>]}
[0m22:26:45.779397 [debug] [MainThread]: Flushing usage events
[0m22:26:46.266582 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:29:54.317861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229C2C66080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229C4B8E9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229C4B8E800>]}


============================== 22:29:54.333498 | 26d00b13-0a31-4155-a603-0597a32f2362 ==============================
[0m22:29:54.333498 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:29:54.333498 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_orders', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:29:55.151289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26d00b13-0a31-4155-a603-0597a32f2362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229C4B27CD0>]}
[0m22:29:55.251552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26d00b13-0a31-4155-a603-0597a32f2362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229C467DB10>]}
[0m22:29:55.251552 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:29:55.737182 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:29:56.117274 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:29:56.117274 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:29:56.208558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26d00b13-0a31-4155-a603-0597a32f2362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229C6A7D4B0>]}
[0m22:29:56.450022 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:29:56.452053 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:29:56.501432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26d00b13-0a31-4155-a603-0597a32f2362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229C5441840>]}
[0m22:29:56.517044 [info ] [MainThread]: Found 6 models, 17 data tests, 2 sources, 591 macros
[0m22:29:56.517044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26d00b13-0a31-4155-a603-0597a32f2362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229C4707760>]}
[0m22:29:56.517044 [info ] [MainThread]: 
[0m22:29:56.517044 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:29:56.536451 [info ] [MainThread]: 
[0m22:29:56.561152 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:29:56.568288 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m22:29:56.854000 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m22:29:56.854000 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m22:29:56.854000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:29:57.536403 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.690 seconds
[0m22:29:57.567647 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_staging'
[0m22:29:57.583260 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m22:29:57.583260 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m22:29:57.583260 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:29:58.085507 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.499 seconds
[0m22:29:58.085507 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_staging, now list_DEV_odl)
[0m22:29:58.085507 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m22:29:58.101130 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m22:29:58.208229 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.106 seconds
[0m22:29:58.208229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26d00b13-0a31-4155-a603-0597a32f2362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229C5805A80>]}
[0m22:29:58.223875 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m22:29:58.223875 [info ] [Thread-1 (]: 1 of 1 START sql incremental model staging.stg_orders .......................... [RUN]
[0m22:29:58.223875 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_orders'
[0m22:29:58.223875 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m22:29:58.259243 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m22:29:58.259243 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m22:29:58.356367 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m22:29:58.356367 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m22:29:58.371951 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace transient table DEV.staging.stg_orders
         as
        (

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_effective_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS type,
        data:detail:intent::STRING                      AS intent,
        data:detail:tenant::STRING                      AS tenant,
        data:time::TIMESTAMP                            AS order_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
),
dedup AS
(
    SELECT
        *
        ,ROW_NUMBER() OVER(PARTITION BY order_id, email, pet_dob, pet_name, pet_breed  ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)
SELECT 
    order_id ,
    email                                                       AS customer_email,
    COALESCE(NULLIF(TRIM(COALESCE(first_name, '') || ' ' || 
            COALESCE(last_name, '')), ''), 'unknown')           AS customer_name,
    dob                                                         AS customer_dob,
    COALESCE(phone,'unknown')                                   AS customer_phone,
    address_line1 || ' ' || address_line2                       AS customer_address,
    city                                                        AS customer_city,
    country                                                     AS customer_country,
    postcode                                                    AS customer_postcode,
    pet_dob,
    pet_name,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_time::DATE                                            AS order_create_date,
    order_time                                                  AS order_create_timestamp,
    cessation_date,
    affiliate_code,
    source,
    type,
    intent,
    tenant,
    order_effective_date,
    ingest_date
FROM dedup
WHERE 
    rnk =1
        );
[0m22:29:58.371951 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:30:00.448444 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.081 seconds
[0m22:30:00.463760 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_orders__dbt_tmp
[0m22:30:00.463760 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m22:30:00.463760 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
drop view if exists DEV.staging.stg_orders__dbt_tmp cascade
[0m22:30:00.564552 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.093 seconds
[0m22:30:00.611063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26d00b13-0a31-4155-a603-0597a32f2362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229C12E0340>]}
[0m22:30:00.611063 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model staging.stg_orders ..................... [[32mSUCCESS 1[0m in 2.37s]
[0m22:30:00.611063 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m22:30:00.611063 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:30:00.611063 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m22:30:00.617575 [debug] [MainThread]: On list_DEV: Close
[0m22:30:00.718424 [debug] [MainThread]: Connection 'list_DEV_odl' was left open.
[0m22:30:00.718424 [debug] [MainThread]: On list_DEV_odl: Close
[0m22:30:00.818687 [debug] [MainThread]: Connection 'model.ManyPets.stg_orders' was left open.
[0m22:30:00.818687 [debug] [MainThread]: On model.ManyPets.stg_orders: Close
[0m22:30:00.950337 [info ] [MainThread]: 
[0m22:30:00.950337 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.39 seconds (4.39s).
[0m22:30:00.950337 [debug] [MainThread]: Command end result
[0m22:30:01.021638 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:30:01.021638 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:30:01.048626 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m22:30:01.049627 [info ] [MainThread]: 
[0m22:30:01.051627 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:30:01.052628 [info ] [MainThread]: 
[0m22:30:01.054532 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:30:01.057624 [debug] [MainThread]: Command `dbt run` succeeded at 22:30:01.056610 after 6.89 seconds
[0m22:30:01.057624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229C2C66080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229C5561390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229C5441840>]}
[0m22:30:01.058607 [debug] [MainThread]: Flushing usage events
[0m22:30:01.535825 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:30:21.116565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD4C6F6020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD4E662B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD4E6629B0>]}


============================== 22:30:21.116565 | b2f601c2-cc05-484a-a983-5a57b9e8a281 ==============================
[0m22:30:21.116565 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:30:21.116565 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select fact_orders', 'send_anonymous_usage_stats': 'True'}
[0m22:30:21.875208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2f601c2-cc05-484a-a983-5a57b9e8a281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD4AF89C60>]}
[0m22:30:21.975497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2f601c2-cc05-484a-a983-5a57b9e8a281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD4E4C1B70>]}
[0m22:30:21.975497 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:30:22.441832 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:30:22.814915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:30:22.814915 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:30:22.908234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2f601c2-cc05-484a-a983-5a57b9e8a281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD5050D450>]}
[0m22:30:23.141833 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:30:23.151951 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:30:23.201105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2f601c2-cc05-484a-a983-5a57b9e8a281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD4EF3A140>]}
[0m22:30:23.202110 [info ] [MainThread]: Found 6 models, 17 data tests, 2 sources, 591 macros
[0m22:30:23.204105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2f601c2-cc05-484a-a983-5a57b9e8a281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD503DE2C0>]}
[0m22:30:23.207107 [info ] [MainThread]: 
[0m22:30:23.209106 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:30:23.210109 [info ] [MainThread]: 
[0m22:30:23.212403 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:30:23.215409 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m22:30:23.448822 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m22:30:23.448822 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m22:30:23.448822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:30:24.150796 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.695 seconds
[0m22:30:24.166418 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m22:30:24.182046 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m22:30:24.182046 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m22:30:24.182046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:30:24.669049 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.477 seconds
[0m22:30:24.669049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m22:30:24.684649 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m22:30:24.684649 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m22:30:24.808074 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.122 seconds
[0m22:30:24.823743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2f601c2-cc05-484a-a983-5a57b9e8a281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD4EF39C60>]}
[0m22:30:24.823743 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m22:30:24.839337 [info ] [Thread-1 (]: 1 of 1 START sql incremental model odl.fact_orders ............................. [RUN]
[0m22:30:24.839337 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.fact_orders'
[0m22:30:24.839337 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_orders
[0m22:30:24.891856 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_orders"
[0m22:30:24.893854 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_orders
[0m22:30:24.978385 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.fact_orders"
[0m22:30:24.978385 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m22:30:24.978385 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
create or replace transient table DEV.odl.fact_orders
         as
        ( 
WITH fact_data AS (
    SELECT 
        f.order_id,
        f.cessation_date,
        f.affiliate_code,
        f.pet_value,
        f.source,
        f.type,
        f.order_create_date,
        f.order_create_timestamp,
        f.intent,
        f.tenant,
        /*f.event_time,
        f.envelope_version,
        f.detail_version,
        f.experiments,*/
        c.customer_sk,
        p.pet_sk,
        f.ingest_date
    FROM DEV.staging.stg_orders f
    LEFT JOIN DEV.odl.dim_customers c 
        ON f.customer_email = c.customer_nk
    LEFT JOIN DEV.odl.dim_pets p 
        ON f.pet_name = p.pet_name 
        AND f.pet_dob = p.pet_dob
        AND f.pet_breed = p.pet_breed

    
)

, dedup AS (
    SELECT 
        f.*,
        ROW_NUMBER() OVER(PARTITION BY f.order_id, f.customer_sk, f.pet_sk ORDER BY f.ingest_date DESC) AS rnk
    FROM fact_data f
)

SELECT 
     order_id || '|' || customer_sk || '|'|| pet_sk         AS order_nk,
    md5(cast(coalesce(cast(order_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))    AS order_sk,
    -- order_id is added as connecting between order and order_complete on order_sk is not feasible due to missing customer_id and pet_id in the dataset.
    order_id                                                AS order_id,
    customer_sk                                             AS customer_sk,
    pet_sk                                                  AS pet_sk,
    order_create_date                                       AS order_create_date,
    order_create_timestamp                                  AS order_create_timestamp,
    cessation_date                                          AS cessation_date,
    COALESCE(affiliate_code, 'unknown')                     AS affiliate_code,
    pet_value                                               AS pet_value,
    source                                                  AS order_source,
    type                                                    AS order_type,
    intent                                                  AS intent,
    tenant                                                  AS tenant,
/*
    event_time,
    envelope_version,
    detail_version,
    intent,
    tenant,
    experiments,
*/
    ingest_date
FROM dedup
WHERE rnk = 1
        );
[0m22:30:24.978385 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:30:27.217753 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.232 seconds
[0m22:30:27.233405 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.fact_orders__dbt_tmp
[0m22:30:27.233405 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m22:30:27.233405 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
drop view if exists DEV.odl.fact_orders__dbt_tmp cascade
[0m22:30:27.318542 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.077 seconds
[0m22:30:27.349812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f601c2-cc05-484a-a983-5a57b9e8a281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD4ADB02E0>]}
[0m22:30:27.349812 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model odl.fact_orders ........................ [[32mSUCCESS 1[0m in 2.51s]
[0m22:30:27.349812 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m22:30:27.349812 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:30:27.349812 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m22:30:27.349812 [debug] [MainThread]: On list_DEV: Close
[0m22:30:27.460786 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m22:30:27.460786 [debug] [MainThread]: On list_DEV_staging: Close
[0m22:30:27.566070 [debug] [MainThread]: Connection 'model.ManyPets.fact_orders' was left open.
[0m22:30:27.566070 [debug] [MainThread]: On model.ManyPets.fact_orders: Close
[0m22:30:27.682193 [info ] [MainThread]: 
[0m22:30:27.697350 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.47 seconds (4.47s).
[0m22:30:27.697350 [debug] [MainThread]: Command end result
[0m22:30:27.769484 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:30:27.772481 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:30:27.786385 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m22:30:27.787387 [info ] [MainThread]: 
[0m22:30:27.788724 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:30:27.790754 [info ] [MainThread]: 
[0m22:30:27.791308 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:30:27.793320 [debug] [MainThread]: Command `dbt run` succeeded at 22:30:27.793320 after 6.81 seconds
[0m22:30:27.794320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD4C6F6020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD4EF7B8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD4C9F3A00>]}
[0m22:30:27.794320 [debug] [MainThread]: Flushing usage events
[0m22:30:28.236411 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:34:49.767960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141782B5F60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001417A1DEAA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001417A1DE8C0>]}


============================== 22:34:49.775197 | 6ab5408a-fc35-4d38-b192-752f3f6e663b ==============================
[0m22:34:49.775197 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:34:49.776197 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_orders', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:34:50.803545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ab5408a-fc35-4d38-b192-752f3f6e663b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001417A177C10>]}
[0m22:34:50.909360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ab5408a-fc35-4d38-b192-752f3f6e663b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001417968E3E0>]}
[0m22:34:50.911356 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m22:34:51.429716 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:34:51.826420 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:34:51.826420 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:34:51.922366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ab5408a-fc35-4d38-b192-752f3f6e663b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001417C0CD390>]}
[0m22:34:52.171995 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:34:52.178023 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:34:52.235737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ab5408a-fc35-4d38-b192-752f3f6e663b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001417BFB8910>]}
[0m22:34:52.237742 [info ] [MainThread]: Found 6 models, 17 data tests, 2 sources, 591 macros
[0m22:34:52.239740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ab5408a-fc35-4d38-b192-752f3f6e663b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001417C09D6C0>]}
[0m22:34:52.242739 [info ] [MainThread]: 
[0m22:34:52.244744 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:34:52.245735 [info ] [MainThread]: 
[0m22:34:52.248739 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:34:52.251739 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m22:34:52.440454 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m22:34:52.440454 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m22:34:52.441453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:53.083958 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.642 seconds
[0m22:34:53.095967 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m22:34:53.111921 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m22:34:53.112922 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m22:34:53.113922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:53.677840 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.564 seconds
[0m22:34:53.688371 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m22:34:53.701324 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m22:34:53.702339 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m22:34:53.811732 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.110 seconds
[0m22:34:53.815411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ab5408a-fc35-4d38-b192-752f3f6e663b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001417AE0FFA0>]}
[0m22:34:53.823405 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m22:34:53.824380 [info ] [Thread-1 (]: 1 of 1 START sql incremental model staging.stg_orders .......................... [RUN]
[0m22:34:53.825379 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_orders'
[0m22:34:53.826378 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m22:34:53.854110 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m22:34:53.856100 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m22:34:53.973226 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m22:34:53.980820 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m22:34:53.981824 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace transient table DEV.staging.stg_orders
         as
        (

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_effective_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS type,
        data:detail:intent::STRING                      AS intent,
        data:detail:tenant::STRING                      AS tenant,
        data:time::TIMESTAMP                            AS order_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets) AS pet

    
),
dedup AS
(
    SELECT
        *
        ,ROW_NUMBER() OVER(PARTITION BY order_id, email, pet_dob, pet_name, pet_breed  ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)
SELECT 
    order_id ,
    email                                                       AS customer_email,
    COALESCE(NULLIF(TRIM(COALESCE(first_name, '') || ' ' || 
            COALESCE(last_name, '')), ''), 'unknown')           AS customer_name,
    dob                                                         AS customer_dob,
    COALESCE(phone,'unknown')                                   AS customer_phone,
    address_line1 || ' ' || address_line2                       AS customer_address,
    city                                                        AS customer_city,
    country                                                     AS customer_country,
    postcode                                                    AS customer_postcode,
    pet_dob,
    pet_name,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_time::DATE                                            AS order_create_date,
    order_time                                                  AS order_create_timestamp,
    cessation_date,
    affiliate_code,
    source,
    type,
    intent,
    tenant,
    order_effective_date,
    ingest_date
FROM dedup
WHERE 
    rnk =1
        );
[0m22:34:53.982837 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:34:55.610042 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.627 seconds
[0m22:34:55.629707 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_orders__dbt_tmp
[0m22:34:55.641706 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m22:34:55.642707 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
drop view if exists DEV.staging.stg_orders__dbt_tmp cascade
[0m22:34:55.722042 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.078 seconds
[0m22:34:55.771212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ab5408a-fc35-4d38-b192-752f3f6e663b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014176930220>]}
[0m22:34:55.772215 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model staging.stg_orders ..................... [[32mSUCCESS 1[0m in 1.94s]
[0m22:34:55.774223 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m22:34:55.776212 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:34:55.777214 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m22:34:55.777214 [debug] [MainThread]: On list_DEV: Close
[0m22:34:55.884261 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m22:34:55.885262 [debug] [MainThread]: On list_DEV_staging: Close
[0m22:34:55.991032 [debug] [MainThread]: Connection 'model.ManyPets.stg_orders' was left open.
[0m22:34:55.994032 [debug] [MainThread]: On model.ManyPets.stg_orders: Close
[0m22:34:56.113597 [info ] [MainThread]: 
[0m22:34:56.116782 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.87 seconds (3.87s).
[0m22:34:56.122796 [debug] [MainThread]: Command end result
[0m22:34:56.199448 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m22:34:56.202467 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m22:34:56.215756 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m22:34:56.217757 [info ] [MainThread]: 
[0m22:34:56.218756 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:34:56.219759 [info ] [MainThread]: 
[0m22:34:56.221757 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:34:56.223572 [debug] [MainThread]: Command `dbt run` succeeded at 22:34:56.223572 after 6.60 seconds
[0m22:34:56.224547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141782B5F60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141785FF4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001417AA93F70>]}
[0m22:34:56.224547 [debug] [MainThread]: Flushing usage events
[0m22:34:56.741282 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:03:21.321670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020793E55FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020795D7E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020795D7E740>]}


============================== 23:03:21.337278 | 3c18e51a-75b2-4405-a52d-db155be4387b ==============================
[0m23:03:21.337278 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:03:21.352909 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:03:22.265343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c18e51a-75b2-4405-a52d-db155be4387b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207941A9ED0>]}
[0m23:03:22.355038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c18e51a-75b2-4405-a52d-db155be4387b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020795BEB2B0>]}
[0m23:03:22.370663 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m23:03:22.855685 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:03:23.215251 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:03:23.215251 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:03:23.315373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c18e51a-75b2-4405-a52d-db155be4387b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020797C693F0>]}
[0m23:03:23.593286 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m23:03:23.601440 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m23:03:23.673994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c18e51a-75b2-4405-a52d-db155be4387b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020796680CD0>]}
[0m23:03:23.673994 [info ] [MainThread]: Found 6 models, 17 data tests, 2 sources, 591 macros
[0m23:03:23.673994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c18e51a-75b2-4405-a52d-db155be4387b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207958F76D0>]}
[0m23:03:23.673994 [info ] [MainThread]: 
[0m23:03:23.689623 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:03:23.689623 [info ] [MainThread]: 
[0m23:03:23.689623 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:03:23.716636 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m23:03:23.879562 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m23:03:23.879562 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m23:03:23.879562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:24.713283 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.832 seconds
[0m23:03:24.713283 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m23:03:24.713283 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m23:03:24.807315 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.089 seconds
[0m23:03:24.813329 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_odl'
[0m23:03:24.828971 [debug] [ThreadPool]: Using snowflake connection "list_DEV_odl"
[0m23:03:24.828971 [debug] [ThreadPool]: On list_DEV_odl: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_odl"} */
show objects in DEV.odl limit 10000;
[0m23:03:24.828971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:25.262148 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.427 seconds
[0m23:03:25.262148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_odl, now list_DEV_staging)
[0m23:03:25.262148 [debug] [ThreadPool]: Using snowflake connection "list_DEV_staging"
[0m23:03:25.277381 [debug] [ThreadPool]: On list_DEV_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "connection_name": "list_DEV_staging"} */
show objects in DEV.staging limit 10000;
[0m23:03:25.362474 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.092 seconds
[0m23:03:25.362474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c18e51a-75b2-4405-a52d-db155be4387b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207983907F0>]}
[0m23:03:25.377958 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_order_complete
[0m23:03:25.377958 [info ] [Thread-1 (]: 1 of 6 START sql incremental model staging.stg_order_complete .................. [RUN]
[0m23:03:25.394324 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.ManyPets.stg_order_complete'
[0m23:03:25.394324 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_order_complete
[0m23:03:25.416097 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_order_complete"
[0m23:03:25.417843 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_order_complete
[0m23:03:25.515043 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_order_complete"
[0m23:03:25.515043 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:03:25.515043 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
create or replace transient table DEV.staging.stg_order_complete
         as
        (

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING        AS order_id,
        data:detail:intent::STRING          AS intent,
        data:detail:tenant::STRING          AS tenant,
        data:detail:customer_id::STRING     AS customer_id,
        pet.value                           AS pet_id,  
        data:time::TIMESTAMP                AS order_time,
        data:source::STRING                 AS source,
        data:type::STRING                   AS type,
        ingest_date                         AS ingest_date
    FROM dev.rdl.order_complete o,
    LATERAL FLATTEN(input => o.data:detail:pet_ids,OUTER => TRUE) AS pet  

    
)
,
dedup AS (
    SELECT 
        *,
        ROW_NUMBER() OVER ( PARTITION BY order_id, customer_id, pet_id ORDER BY ingest_date DESC ) AS rnk
    FROM source_data
)
SELECT 
    order_id,
    customer_id,
    pet_id,
    intent,
    tenant,
    order_time::DATE            AS order_complete_date,
    order_time                  AS order_complete_timestamp,
    source,
    type,
    ingest_date
FROM dedup
WHERE rnk =1
        );
[0m23:03:25.515043 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:03:27.254301 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.736 seconds
[0m23:03:27.285166 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_order_complete__dbt_tmp
[0m23:03:27.285166 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_order_complete"
[0m23:03:27.285166 [debug] [Thread-1 (]: On model.ManyPets.stg_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_order_complete"} */
drop view if exists DEV.staging.stg_order_complete__dbt_tmp cascade
[0m23:03:27.370202 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.077 seconds
[0m23:03:27.400786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c18e51a-75b2-4405-a52d-db155be4387b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020797BFE290>]}
[0m23:03:27.400786 [info ] [Thread-1 (]: 1 of 6 OK created sql incremental model staging.stg_order_complete ............. [[32mSUCCESS 1[0m in 2.01s]
[0m23:03:27.400786 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_order_complete
[0m23:03:27.400786 [debug] [Thread-1 (]: Began running node model.ManyPets.stg_orders
[0m23:03:27.416392 [info ] [Thread-1 (]: 2 of 6 START sql incremental model staging.stg_orders .......................... [RUN]
[0m23:03:27.416392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_order_complete, now model.ManyPets.stg_orders)
[0m23:03:27.416392 [debug] [Thread-1 (]: Began compiling node model.ManyPets.stg_orders
[0m23:03:27.422915 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.stg_orders"
[0m23:03:27.422915 [debug] [Thread-1 (]: Began executing node model.ManyPets.stg_orders
[0m23:03:27.422915 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.stg_orders"
[0m23:03:27.438558 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:03:27.438558 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
create or replace transient table DEV.staging.stg_orders
         as
        (

WITH source_data AS (
    SELECT
        data:detail:order_id::STRING                    AS order_id,
        data:detail:customer:email::STRING              AS email,
        data:detail:customer:first_name::STRING         AS first_name,
        data:detail:customer:last_name::STRING          AS last_name,
        data:detail:customer:dob::DATE                  AS dob,
        data:detail:customer:phone::STRING              AS phone,
        data:detail:customer:address:line1::STRING      AS address_line1,
        data:detail:customer:address:line2::STRING      AS address_line2,
        data:detail:customer:address:city::STRING       AS city,
        data:detail:customer:address:country::STRING    AS country,
        data:detail:customer:address:postcode::STRING   AS postcode,
        pet.value:name::STRING                          AS pet_name,
        pet.value:dob::DATE                             AS pet_dob,
        pet.value:breed_value::STRING                   AS pet_breed,
        pet.value:gender::STRING                        AS pet_gender,
        pet.value:species::STRING                       AS pet_species,
        pet.value:pedigree_type::STRING                 AS pedigree_type,
        pet.value:spayed_neutered::BOOLEAN              AS spayed_neutered,
        pet.value:postcode::STRING                      AS pet_postcode,
        pet.value:value::NUMBER                         AS pet_value,
        data:detail:effective_date::DATE                AS order_effective_date,
        data:detail:cessation_date::DATE                AS cessation_date,
        data:detail:affiliate_code::STRING              AS affiliate_code,
        data:source::STRING                             AS source,
        data:type::STRING                               AS type,
        data:detail:intent::STRING                      AS intent,
        data:detail:tenant::STRING                      AS tenant,
        data:time::TIMESTAMP                            AS order_time,
        ingest_date
    FROM dev.rdl.orders o,
    LATERAL FLATTEN(input => o.data:detail:pets,OUTER => TRUE) AS pet

    
),
dedup AS
(
    SELECT
        *
        ,ROW_NUMBER() OVER(PARTITION BY order_id, email, pet_dob, pet_name, pet_breed  ORDER BY ingest_date DESC) AS rnk
    FROM source_data
)
SELECT 
    order_id ,
    email                                                       AS customer_email,
    COALESCE(NULLIF(TRIM(COALESCE(first_name, '') || ' ' || 
            COALESCE(last_name, '')), ''), 'unknown')           AS customer_name,
    dob                                                         AS customer_dob,
    COALESCE(phone,'unknown')                                   AS customer_phone,
    address_line1 || ' ' || address_line2                       AS customer_address,
    city                                                        AS customer_city,
    country                                                     AS customer_country,
    postcode                                                    AS customer_postcode,
    pet_dob,
    pet_name,
    pet_breed,
    pet_gender,
    pet_species,
    pedigree_type,
    spayed_neutered,
    pet_postcode,
    pet_value,
    order_time::DATE                                            AS order_create_date,
    order_time                                                  AS order_create_timestamp,
    cessation_date,
    affiliate_code,
    source,
    type,
    intent,
    tenant,
    order_effective_date,
    ingest_date
FROM dedup
WHERE 
    rnk =1
        );
[0m23:03:29.030442 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.595 seconds
[0m23:03:29.046102 [debug] [Thread-1 (]: Applying DROP to: DEV.staging.stg_orders__dbt_tmp
[0m23:03:29.046102 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.stg_orders"
[0m23:03:29.046102 [debug] [Thread-1 (]: On model.ManyPets.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.stg_orders"} */
drop view if exists DEV.staging.stg_orders__dbt_tmp cascade
[0m23:03:29.131070 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.084 seconds
[0m23:03:29.146722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c18e51a-75b2-4405-a52d-db155be4387b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020793CC1240>]}
[0m23:03:29.146722 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model staging.stg_orders ..................... [[32mSUCCESS 1[0m in 1.73s]
[0m23:03:29.146722 [debug] [Thread-1 (]: Finished running node model.ManyPets.stg_orders
[0m23:03:29.146722 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_customers
[0m23:03:29.146722 [info ] [Thread-1 (]: 3 of 6 START sql incremental model odl.dim_customers ........................... [RUN]
[0m23:03:29.160160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.stg_orders, now model.ManyPets.dim_customers)
[0m23:03:29.162157 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_customers
[0m23:03:29.186491 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_customers"
[0m23:03:29.186491 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_customers
[0m23:03:29.200977 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_customers"
[0m23:03:29.205066 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m23:03:29.205066 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
create or replace transient table DEV.odl.dim_customers
         as
        (
WITH stg_data AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date  
    FROM DEV.staging.stg_orders
    
    
),
dedup AS (
    SELECT
        customer_email,
        customer_name,
        customer_dob,
        customer_phone,
        customer_address,
        customer_city,
        customer_country,
        customer_postcode,
        ingest_date,
        ROW_NUMBER() OVER (PARTITION BY customer_email ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    customer_email                                                          AS customer_nk, 
    md5(cast(coalesce(cast(customer_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                 AS customer_sk,
    customer_name,
    customer_dob,
    customer_phone,
    customer_address,
    customer_city,
    customer_country,
    customer_postcode,
    ingest_date
FROM dedup
WHERE rnk = 1
        );
[0m23:03:30.314968 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.113 seconds
[0m23:03:30.314968 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_customers__dbt_tmp
[0m23:03:30.314968 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_customers"
[0m23:03:30.314968 [debug] [Thread-1 (]: On model.ManyPets.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_customers"} */
drop view if exists DEV.odl.dim_customers__dbt_tmp cascade
[0m23:03:30.400155 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.077 seconds
[0m23:03:30.400155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c18e51a-75b2-4405-a52d-db155be4387b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002079850C070>]}
[0m23:03:30.400155 [info ] [Thread-1 (]: 3 of 6 OK created sql incremental model odl.dim_customers ...................... [[32mSUCCESS 1[0m in 1.24s]
[0m23:03:30.400155 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_customers
[0m23:03:30.400155 [debug] [Thread-1 (]: Began running node model.ManyPets.dim_pets
[0m23:03:30.400155 [info ] [Thread-1 (]: 4 of 6 START sql incremental model odl.dim_pets ................................ [RUN]
[0m23:03:30.415356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_customers, now model.ManyPets.dim_pets)
[0m23:03:30.415356 [debug] [Thread-1 (]: Began compiling node model.ManyPets.dim_pets
[0m23:03:30.415356 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.dim_pets"
[0m23:03:30.415356 [debug] [Thread-1 (]: Began executing node model.ManyPets.dim_pets
[0m23:03:30.439307 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.dim_pets"
[0m23:03:30.449478 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m23:03:30.450477 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
create or replace transient table DEV.odl.dim_pets
         as
        (

WITH stg_data AS (
    SELECT
        customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date
    FROM DEV.staging.stg_orders
    
    
),

dedup AS (
    SELECT
        customer_email,
        pet_dob,
        pet_name,
        pet_breed,
        pet_gender,
        pet_species,
        pedigree_type,
        spayed_neutered,
        pet_postcode,
        pet_value,
        ingest_date,
        ROW_NUMBER() OVER(PARTITION BY customer_email, pet_dob, pet_name, pet_breed ORDER BY ingest_date DESC) AS rnk
    FROM stg_data
)
SELECT
    d.customer_email ||'|'||d.pet_name || '|' || d.pet_dob || '|' || d.pet_breed      AS pet_nk,  
    md5(cast(coalesce(cast(pet_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                                AS pet_sk,  
    d.pet_name,
    d.pet_dob,
    d.pet_breed,
    d.pet_gender,
    d.pet_species,
    d.pedigree_type,
    d.spayed_neutered,
    d.pet_postcode,
    d.pet_value,
    d.ingest_date,
    c.customer_sk
FROM dedup AS d
    INNER JOIN DEV.odl.dim_customers AS c ON (c.customer_nk=d.customer_email)
WHERE d.rnk = 1
        );
[0m23:03:31.792076 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.343 seconds
[0m23:03:31.792076 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.dim_pets__dbt_tmp
[0m23:03:31.792076 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.dim_pets"
[0m23:03:31.792076 [debug] [Thread-1 (]: On model.ManyPets.dim_pets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.dim_pets"} */
drop view if exists DEV.odl.dim_pets__dbt_tmp cascade
[0m23:03:31.859482 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.068 seconds
[0m23:03:31.874619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c18e51a-75b2-4405-a52d-db155be4387b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207983B03A0>]}
[0m23:03:31.874619 [info ] [Thread-1 (]: 4 of 6 OK created sql incremental model odl.dim_pets ........................... [[32mSUCCESS 1[0m in 1.46s]
[0m23:03:31.874619 [debug] [Thread-1 (]: Finished running node model.ManyPets.dim_pets
[0m23:03:31.874619 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_order_complete
[0m23:03:31.874619 [info ] [Thread-1 (]: 5 of 6 START sql incremental model odl.fact_order_complete ..................... [RUN]
[0m23:03:31.874619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.dim_pets, now model.ManyPets.fact_order_complete)
[0m23:03:31.874619 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_order_complete
[0m23:03:31.899870 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_order_complete"
[0m23:03:31.901840 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_order_complete
[0m23:03:31.908377 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.fact_order_complete"
[0m23:03:31.911682 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_order_complete"
[0m23:03:31.911682 [debug] [Thread-1 (]: On model.ManyPets.fact_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_order_complete"} */
create or replace transient table DEV.odl.fact_order_complete
         as
        ( 

WITH fact_data AS (
    SELECT
        s.order_id,
        s.intent,
        s.tenant,
        s.source,
        s.type,
        s.ingest_date,
        s.order_complete_date,
        s.order_complete_timestamp,
        c.customer_sk,
        p.pet_sk
    FROM DEV.staging.stg_order_complete s
    LEFT JOIN DEV.odl.dim_customers c 
        ON s.customer_id = c.customer_nk   
    LEFT JOIN DEV.odl.dim_pets p 
        ON s.pet_id = p.pet_nk 

               
),
dedup AS (
    SELECT 
        *,
        ROW_NUMBER() OVER ( PARTITION BY order_id ORDER BY ingest_date DESC ) AS rnk
    FROM fact_data
)

SELECT 
    --order_id || '|' || customer_sk || '|' || pet_sk       AS order_nk,
    --customer_sk and pet_sk will be null 
    order_id                                                AS order_nk,
    md5(cast(coalesce(cast(order_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))    AS order_sk,
    -- order_id is added as connecting between order and order_complete on order_sk is not feasible due to missing customer_id and pet_id in the dataset.
    order_id                                                AS order_id,
    customer_sk                                             AS customer_sk,
    pet_sk                                                  AS pet_sk,
    intent                                                  AS intent,
    tenant                                                  AS tenant,
    order_complete_date                                     AS order_complete_date,
    order_complete_timestamp                                AS order_complete_timestamp,
    source                                                  AS order_complete_source,
    type                                                    AS order_complete_type,
    ingest_date                                             AS ingest_date
FROM dedup
WHERE rnk = 1
        );
[0m23:03:33.497016 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.591 seconds
[0m23:03:33.512210 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.fact_order_complete__dbt_tmp
[0m23:03:33.512210 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_order_complete"
[0m23:03:33.512210 [debug] [Thread-1 (]: On model.ManyPets.fact_order_complete: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_order_complete"} */
drop view if exists DEV.odl.fact_order_complete__dbt_tmp cascade
[0m23:03:33.582161 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.073 seconds
[0m23:03:33.597528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c18e51a-75b2-4405-a52d-db155be4387b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002079851D630>]}
[0m23:03:33.597528 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model odl.fact_order_complete ................ [[32mSUCCESS 1[0m in 1.72s]
[0m23:03:33.597528 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_order_complete
[0m23:03:33.597528 [debug] [Thread-1 (]: Began running node model.ManyPets.fact_orders
[0m23:03:33.597528 [info ] [Thread-1 (]: 6 of 6 START sql incremental model odl.fact_orders ............................. [RUN]
[0m23:03:33.613149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ManyPets.fact_order_complete, now model.ManyPets.fact_orders)
[0m23:03:33.616036 [debug] [Thread-1 (]: Began compiling node model.ManyPets.fact_orders
[0m23:03:33.626891 [debug] [Thread-1 (]: Writing injected SQL for node "model.ManyPets.fact_orders"
[0m23:03:33.626891 [debug] [Thread-1 (]: Began executing node model.ManyPets.fact_orders
[0m23:03:33.642124 [debug] [Thread-1 (]: Writing runtime sql for node "model.ManyPets.fact_orders"
[0m23:03:33.650637 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m23:03:33.650637 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
create or replace transient table DEV.odl.fact_orders
         as
        ( 
WITH fact_data AS (
    SELECT 
        f.order_id,
        f.cessation_date,
        f.affiliate_code,
        f.pet_value,
        f.source,
        f.type,
        f.order_create_date,
        f.order_create_timestamp,
        f.intent,
        f.tenant,
        /*f.event_time,
        f.envelope_version,
        f.detail_version,
        f.experiments,*/
        c.customer_sk,
        p.pet_sk,
        f.ingest_date
    FROM DEV.staging.stg_orders f
    LEFT JOIN DEV.odl.dim_customers c 
        ON f.customer_email = c.customer_nk
    LEFT JOIN DEV.odl.dim_pets p 
        ON f.pet_name = p.pet_name 
        AND f.pet_dob = p.pet_dob
        AND f.pet_breed = p.pet_breed

    
)

, dedup AS (
    SELECT 
        f.*,
        ROW_NUMBER() OVER(PARTITION BY f.order_id, f.customer_sk, f.pet_sk ORDER BY f.ingest_date DESC) AS rnk
    FROM fact_data f
)

SELECT 
     order_id || '|' || customer_sk || '|'|| pet_sk         AS order_nk,
    md5(cast(coalesce(cast(order_nk as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))    AS order_sk,
    -- order_id is added as connecting between order and order_complete on order_sk is not feasible due to missing customer_id and pet_id in the dataset.
    order_id                                                AS order_id,
    customer_sk                                             AS customer_sk,
    pet_sk                                                  AS pet_sk,
    order_create_date                                       AS order_create_date,
    order_create_timestamp                                  AS order_create_timestamp,
    cessation_date                                          AS cessation_date,
    COALESCE(affiliate_code, 'unknown')                     AS affiliate_code,
    pet_value                                               AS pet_value,
    source                                                  AS order_source,
    type                                                    AS order_type,
    intent                                                  AS intent,
    tenant                                                  AS tenant,
/*
    event_time,
    envelope_version,
    detail_version,
    intent,
    tenant,
    experiments,
*/
    ingest_date
FROM dedup
WHERE rnk = 1
        );
[0m23:03:35.505405 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.853 seconds
[0m23:03:35.505405 [debug] [Thread-1 (]: Applying DROP to: DEV.odl.fact_orders__dbt_tmp
[0m23:03:35.505405 [debug] [Thread-1 (]: Using snowflake connection "model.ManyPets.fact_orders"
[0m23:03:35.505405 [debug] [Thread-1 (]: On model.ManyPets.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ManyPets", "target_name": "dev", "node_id": "model.ManyPets.fact_orders"} */
drop view if exists DEV.odl.fact_orders__dbt_tmp cascade
[0m23:03:35.589688 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.075 seconds
[0m23:03:35.589688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c18e51a-75b2-4405-a52d-db155be4387b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207984EDB10>]}
[0m23:03:35.589688 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model odl.fact_orders ........................ [[32mSUCCESS 1[0m in 1.98s]
[0m23:03:35.589688 [debug] [Thread-1 (]: Finished running node model.ManyPets.fact_orders
[0m23:03:35.589688 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:03:35.589688 [debug] [MainThread]: Connection 'list_DEV' was left open.
[0m23:03:35.589688 [debug] [MainThread]: On list_DEV: Close
[0m23:03:35.704140 [debug] [MainThread]: Connection 'list_DEV_staging' was left open.
[0m23:03:35.704140 [debug] [MainThread]: On list_DEV_staging: Close
[0m23:03:35.821729 [debug] [MainThread]: Connection 'model.ManyPets.fact_orders' was left open.
[0m23:03:35.821729 [debug] [MainThread]: On model.ManyPets.fact_orders: Close
[0m23:03:35.937905 [info ] [MainThread]: 
[0m23:03:35.937905 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 0 minutes and 12.25 seconds (12.25s).
[0m23:03:35.937905 [debug] [MainThread]: Command end result
[0m23:03:36.017920 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Documents\manypets\ManyPets\target\manifest.json
[0m23:03:36.022593 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Documents\manypets\ManyPets\target\semantic_manifest.json
[0m23:03:36.034607 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Documents\manypets\ManyPets\target\run_results.json
[0m23:03:36.035582 [info ] [MainThread]: 
[0m23:03:36.036585 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:03:36.038582 [info ] [MainThread]: 
[0m23:03:36.038643 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m23:03:36.038643 [debug] [MainThread]: Command `dbt run` succeeded at 23:03:36.038643 after 14.84 seconds
[0m23:03:36.038643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020793E55FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020794153A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207941A9ED0>]}
[0m23:03:36.038643 [debug] [MainThread]: Flushing usage events
[0m23:03:36.708907 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:10:53.329064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AF8429F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AFA33E830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AFA33E650>]}


============================== 06:10:53.340114 | 35adafae-9343-4434-b550-1fd701856e47 ==============================
[0m06:10:53.340114 [info ] [MainThread]: Running with dbt=1.9.3
[0m06:10:53.343112 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:10:53.615370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35adafae-9343-4434-b550-1fd701856e47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AFA33D990>]}
[0m06:10:53.677500 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m06:10:53.828638 [debug] [MainThread]: Set downloads directory='C:\Users\HP\AppData\Local\Temp\dbt-downloads-y75hvurv'
[0m06:10:53.829637 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:10:53.980303 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:10:53.980303 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:10:54.070050 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:10:54.094202 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:10:55.046805 [info ] [MainThread]: Installed from version 1.3.0
[0m06:10:55.047807 [info ] [MainThread]: Up to date!
[0m06:10:55.047807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '35adafae-9343-4434-b550-1fd701856e47', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AF871E7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AF77AEC50>]}
[0m06:10:55.054615 [debug] [MainThread]: Command `cli deps` succeeded at 06:10:55.054615 after 1.91 seconds
[0m06:10:55.056615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AF8429F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AFA33FBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AF8292650>]}
[0m06:10:55.057616 [debug] [MainThread]: Flushing usage events
[0m06:10:55.789821 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:21:37.922709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E16479F60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E1838E890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E1838E6B0>]}


============================== 11:21:37.934423 | 1f59aeb6-f49b-494d-ab81-0551a88f310c ==============================
[0m11:21:37.934423 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:21:37.936392 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:21:38.290098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f59aeb6-f49b-494d-ab81-0551a88f310c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E1838E9E0>]}
[0m11:21:38.356477 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:21:38.597943 [debug] [MainThread]: Set downloads directory='C:\Users\HP\AppData\Local\Temp\dbt-downloads-bn_6i662'
[0m11:21:38.599940 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:21:38.770788 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:21:38.772777 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:21:38.856125 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:21:38.864520 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m11:21:39.848291 [info ] [MainThread]: Installed from version 1.3.0
[0m11:21:39.850289 [info ] [MainThread]: Up to date!
[0m11:21:39.852292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1f59aeb6-f49b-494d-ab81-0551a88f310c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E167B2650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E1586B9A0>]}
[0m11:21:39.857489 [debug] [MainThread]: Command `cli deps` succeeded at 11:21:39.856289 after 2.09 seconds
[0m11:21:39.865994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E16479F60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E162E2740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E1846B490>]}
[0m11:21:39.867993 [debug] [MainThread]: Flushing usage events
[0m11:21:40.377209 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:29:58.690855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F72AB9FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F749CE890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F749CE6B0>]}


============================== 11:29:58.690855 | f504b427-63c8-4a70-9e34-7c18ccfae176 ==============================
[0m11:29:58.690855 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:29:58.707421 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'log_path': 'c:\\Users\\HP\\Documents\\manypets\\ManyPets\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:29:59.007412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f504b427-63c8-4a70-9e34-7c18ccfae176', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F74B17190>]}
[0m11:29:59.058938 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:29:59.207982 [debug] [MainThread]: Set downloads directory='C:\Users\HP\AppData\Local\Temp\dbt-downloads-uvsv218x'
[0m11:29:59.209978 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:29:59.357937 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:29:59.358935 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:29:59.422740 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:29:59.422740 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m11:30:00.124253 [info ] [MainThread]: Installed from version 1.3.0
[0m11:30:00.125239 [info ] [MainThread]: Up to date!
[0m11:30:00.127826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f504b427-63c8-4a70-9e34-7c18ccfae176', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F72DE6980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F71E3EC50>]}
[0m11:30:00.127826 [debug] [MainThread]: Command `cli deps` succeeded at 11:30:00.127826 after 1.63 seconds
[0m11:30:00.134372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F72AB9FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F72923430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F72DE79D0>]}
[0m11:30:00.144800 [debug] [MainThread]: Flushing usage events
[0m11:30:00.660073 [debug] [MainThread]: An error was encountered while trying to flush usage events
